mysql> SHOW TABLES FROM housekeeping LIKE '%sop%';
+--------------------------------+
| Tables_in_housekeeping (%sop%) |
+--------------------------------+
| order_sop_records              |
| sop_checklist_items            |
| sop_checklist_logs             |
| sop_checklists                 |
| sop_point_photos               |
| sop_sensitive_logs             |
| sop_templates                  |
+--------------------------------+
7 rows in set (1.94 sec)


mysql> SHOW TABLES FROM housekeeping;
+-----------------------------+
| Tables_in_housekeeping      |
+-----------------------------+
| acceptance_records          |
| addresses                   |
| admin_audit_logs            |
| admin_operation_logs        |
| admin_permissions           |
| admin_role_permissions      |
| admin_roles                 |
| admin_sensitive_logs        |
| admin_sensitive_permissions |
| admin_user_roles            |
| admin_users                 |
| arbitration_votes           |
| arbitrations                |
| arrival_verifications       |
| cms_activities              |
| cms_announcements           |
| cms_article_categories      |
| cms_articles                |
| cms_banners                 |
| cms_component_templates     |
| cms_material_groups         |
| cms_materials               |
| cms_page_versions           |
| cms_pages                   |
| compliance_confirmation     |
| conversation_messages       |
| credit_score_logs           |
| entry_safety_check          |
| field_definitions           |
| field_permissions           |
| finance_daily_statistics    |
| finance_platform_logs       |
| finance_platform_wallet     |
| finance_refunds             |
| finance_settlements         |
| finance_wallet_logs         |
| finance_wallets             |
| finance_withdrawal_rules    |
| finance_withdrawals         |
| kyc_logs                    |
| notifications               |
| order_conversations         |
| order_overtime_records      |
| order_sessions              |
| order_sop_records           |
| order_status_logs           |
| order_tips                  |
| orders                      |
| overtime_alerts             |
| payments                    |
| review_score_logs           |
| reviews                     |
| service_categories          |
| services                    |
| sop_checklist_items         |
| sop_checklist_logs          |
| sop_checklists              |
| sop_point_photos            |
| sop_sensitive_logs          |
| sop_templates               |
| status_logs                 |
| system_configs              |
| system_messages             |
| users                       |
| violation_records           |
| workers                     |
+-----------------------------+
66 rows in set (0.32 sec)


mysql> DESCRIBE housekeeping.sop_templates;
+------------------+--------------------------------------+------+-----+-------------------+-----------------------------+
| Field            | Type                                 | Null | Key | Default           | Extra                       |
+------------------+--------------------------------------+------+-----+-------------------+-----------------------------+
| id               | int                                  | NO   | PRI | NULL              | auto_increment              |
| template_name    | varchar(100)                         | NO   | MUL | NULL              |                             |
| service_category | enum('point_comparison','checklist') | NO   | MUL | NULL              |                             |
| version          | int                                  | NO   |     | 1                 |                             |
| status           | enum('active','archived')            | NO   | MUL | active            |                             |
| config_json      | json                                 | NO   |     | NULL              |                             |
| description      | varchar(500)                         | YES  |     | NULL              |                             |
| created_at       | datetime                             | NO   |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED           |
| updated_at       | datetime                             | YES  |     | NULL              | on update CURRENT_TIMESTAMP |
| created_by       | int                                  | YES  |     | NULL              |                             |
+------------------+--------------------------------------+------+-----+-------------------+-----------------------------+
10 rows in set (2.06 sec)


mysql> DESCRIBE housekeeping.order_sop_records;
+------------------------+---------------------------------------------------------+------+-----+-------------------+-----------------------------+
| Field                  | Type                                                    | Null | Key | Default           | Extra                       |
+------------------------+---------------------------------------------------------+------+-----+-------------------+-----------------------------+
| id                     | bigint                                                  | NO   | PRI | NULL              | auto_increment              |
| order_id               | bigint                                                  | NO   | UNI | NULL              |                             |
| template_id            | int                                                     | NO   | MUL | NULL              |                             |
| sop_type               | enum('point_comparison','checklist')                    | NO   |     | NULL              |                             |
| entry_time             | datetime                                                | YES  | MUL | NULL              |                             |
| entry_gps_lat          | decimal(10,7)                                           | YES  |     | NULL              |                             |
| entry_gps_lng          | decimal(10,7)                                           | YES  |     | NULL              |                             |
| entry_gps_offset       | int                                                     | YES  |     | NULL              |                             |
| entry_face_verified    | tinyint(1)                                              | NO   |     | 0                 |                             |
| entry_code_verified    | tinyint(1)                                              | NO   |     | 0                 |                             |
| entry_address          | varchar(255)                                            | YES  |     | NULL              |                             |
| exit_time              | datetime                                                | YES  |     | NULL              |                             |
| exit_gps_lat           | decimal(10,7)                                           | YES  |     | NULL              |                             |
| exit_gps_lng           | decimal(10,7)                                           | YES  |     | NULL              |                             |
| service_end_time       | datetime                                                | YES  |     | NULL              |                             |
| customer_confirmed_at  | datetime                                                | YES  |     | NULL              |                             |
| customer_signature_url | varchar(500)                                            | YES  |     | NULL              |                             |
| signature_gps_lat      | decimal(10,7)                                           | YES  |     | NULL              |                             |
| signature_gps_lng      | decimal(10,7)                                           | YES  |     | NULL              |                             |
| acceptance_status      | enum('pending','confirmed','auto_confirmed','disputed') | NO   | MUL | pending           |                             |
| auto_confirm_at        | datetime                                                | YES  |     | NULL              |                             |
| arbitration_id         | bigint                                                  | YES  |     | NULL              |                             |
| reminded_30            | tinyint(1)                                              | YES  |     | 0                 |                             |
| reminded_60            | tinyint(1)                                              | YES  |     | 0                 |                             |
| worker_id              | bigint                                                  | YES  | MUL | NULL              |                             |
| worker_name            | varchar(50)                                             | YES  |     | NULL              |                             |
| captain_id             | int                                                     | YES  | MUL | NULL              |                             |
| customer_id            | bigint                                                  | YES  |     | NULL              |                             |
| customer_name          | varchar(50)                                             | YES  |     | NULL              |                             |
| customer_phone         | varchar(20)                                             | YES  |     | NULL              |                             |
| created_at             | datetime                                                | NO   | MUL | CURRENT_TIMESTAMP | DEFAULT_GENERATED           |
| updated_at             | datetime                                                | YES  |     | NULL              | on update CURRENT_TIMESTAMP |
+------------------------+---------------------------------------------------------+------+-----+-------------------+-----------------------------+
32 rows in set (0.16 sec)


mysql> DESCRIBE housekeeping.sop_point_photos;
+---------------+-------------+------+-----+-------------------+-----------------------------+
| Field         | Type        | Null | Key | Default           | Extra                       |
+---------------+-------------+------+-----+-------------------+-----------------------------+
| id            | bigint      | NO   | PRI | NULL              | auto_increment              |
| order_id      | bigint      | NO   | MUL | NULL              |                             |
| point_name    | varchar(50) | NO   |     | NULL              |                             |
| point_order   | int         | NO   |     | 1                 |                             |
| before_photos | json        | YES  |     | NULL              |                             |
| after_photos  | json        | YES  |     | NULL              |                             |
| created_at    | datetime    | NO   |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED           |
| updated_at    | datetime    | YES  |     | NULL              | on update CURRENT_TIMESTAMP |
+---------------+-------------+------+-----+-------------------+-----------------------------+
8 rows in set (0.25 sec)


mysql> DESCRIBE housekeeping.sop_checklist_logs;
+-----------------------+--------------+------+-----+-------------------+-----------------------------+
| Field                 | Type         | Null | Key | Default           | Extra                       |
+-----------------------+--------------+------+-----+-------------------+-----------------------------+
| id                    | bigint       | NO   | PRI | NULL              | auto_increment              |
| order_id              | bigint       | NO   | MUL | NULL              |                             |
| service_date          | date         | NO   | MUL | NULL              |                             |
| task_time             | varchar(10)  | NO   |     | NULL              |                             |
| task_name             | varchar(100) | NO   |     | NULL              |                             |
| task_required         | tinyint(1)   | NO   |     | 1                 |                             |
| need_photo            | tinyint(1)   | NO   |     | 0                 |                             |
| completed             | tinyint(1)   | NO   |     | 0                 |                             |
| completed_at          | datetime     | YES  |     | NULL              |                             |
| photo_url             | varchar(500) | YES  |     | NULL              |                             |
| notes                 | text         | YES  |     | NULL              |                             |
| customer_confirmed    | tinyint(1)   | NO   |     | 0                 |                             |
| customer_confirmed_at | datetime     | YES  |     | NULL              |                             |
| created_at            | datetime     | NO   |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED           |
| updated_at            | datetime     | YES  |     | NULL              | on update CURRENT_TIMESTAMP |
+-----------------------+--------------+------+-----+-------------------+-----------------------------+
15 rows in set (0.02 sec)


mysql> DESCRIBE housekeeping.sop_sensitive_logs;
+---------------+-----------------------------------------------------------------------------------------------------------+------+-----+-------------------+-------------------+
| Field         | Type                                                                                                      | Null | Key | Default           | Extra             |
+---------------+-----------------------------------------------------------------------------------------------------------+------+-----+-------------------+-------------------+
| id            | bigint                                                                                                    | NO   | PRI | NULL              | auto_increment    |
| admin_id      | int                                                                                                       | NO   | MUL | NULL              |                   |
| admin_name    | varchar(50)                                                                                               | YES  |     | NULL              |                   |
| admin_role    | varchar(50)                                                                                               | YES  |     | NULL              |                   |
| action_type   | enum('view_customer_phone','view_worker_idcard','view_gps_detail','view_signature_original','export_pdf') | NO   |     | NULL              |                   |
| order_id      | bigint                                                                                                    | NO   | MUL | NULL              |                   |
| data_accessed | text                                                                                                      | YES  |     | NULL              |                   |
| ip_address    | varchar(50)                                                                                               | YES  |     | NULL              |                   |
| user_agent    | varchar(500)                                                                                              | YES  |     | NULL              |                   |
| created_at    | datetime                                                                                                  | NO   | MUL | CURRENT_TIMESTAMP | DEFAULT_GENERATED |
+---------------+-----------------------------------------------------------------------------------------------------------+------+-----+-------------------+-------------------+
10 rows in set (0.16 sec)


mysql> SHOW TABLES FROM housekeeping LIKE '%service%';
+------------------------------------+
| Tables_in_housekeeping (%service%) |
+------------------------------------+
| service_categories                 |
| services                           |
+------------------------------------+
2 rows in set (0.00 sec)


mysql> DESCRIBE housekeeping.services;
+------------------------+----------------------+------+-----+---------+----------------+
| Field                  | Type                 | Null | Key | Default | Extra          |
+------------------------+----------------------+------+-----+---------+----------------+
| id                     | int                  | NO   | PRI | NULL    | auto_increment |
| category_id            | int                  | YES  | MUL | NULL    |                |
| order_type             | tinyint              | YES  |     | 1       |                |
| name                   | varchar(100)         | NO   |     | NULL    |                |
| description            | text                 | YES  |     | NULL    |                |
| main_image             | varchar(500)         | YES  |     | NULL    |                |
| carousel_images        | json                 | YES  |     | NULL    |                |
| detail_content         | longtext             | YES  |     | NULL    |                |
| price                  | decimal(10,2)        | YES  |     | NULL    |                |
| price_unit             | varchar(20)          | YES  |     | 小时    |                |
| duration               | int                  | YES  |     | NULL    |                |
| icon                   | varchar(255)         | YES  |     | NULL    |                |
| images                 | text                 | YES  |     | NULL    |                |
| sort_order             | int                  | YES  |     | 0       |                |
| status                 | tinyint              | YES  |     | 1       |                |
| created_at             | datetime             | NO   |     | NULL    |                |
| updated_at             | datetime             | NO   |     | NULL    |                |
| base_price             | decimal(10,2)        | YES  |     | 0.00    |                |
| commission_rate        | decimal(5,4)         | YES  |     | 0.2000  |                |
| captain_rate           | decimal(5,4)         | YES  |     | 0.0500  |                |
| settlement_type        | enum('once','daily') | YES  | MUL | once    |                |
| management_fee_monthly | decimal(10,2)        | YES  |     | 0.00    |                |
| unit                   | varchar(20)          | YES  |     | 次      |                |
| image                  | varchar(255)         | YES  |     |         |                |
+------------------------+----------------------+------+-----+---------+----------------+
24 rows in set (0.03 sec)


mysql> DESCRIBE housekeeping.sop_checklist_items;
+---------------+----------------------------------------------------+------+-----+-------------------+-----------------------------------------------+
| Field         | Type                                               | Null | Key | Default           | Extra                                         |
+---------------+----------------------------------------------------+------+-----+-------------------+-----------------------------------------------+
| id            | int                                                | NO   | PRI | NULL              | auto_increment                                |
| checklist_id  | int                                                | NO   | MUL | NULL              |                                               |
| item_name     | varchar(200)                                       | NO   |     | NULL              |                                               |
| description   | varchar(500)                                       | YES  |     | NULL              |                                               |
| group_name    | varchar(100)                                       | YES  |     | 默认分组          |                                               |
| check_type    | enum('checkbox','photo','input','number','select') | YES  |     | checkbox          |                                               |
| is_required   | tinyint(1)                                         | YES  |     | 1                 |                                               |
| sort_order    | int                                                | YES  |     | 0                 |                                               |
| status        | enum('pending','completed','abnormal','skipped')   | YES  | MUL | pending           |                                               |
| check_time    | datetime                                           | YES  |     | NULL              |                                               |
| check_result  | varchar(500)                                       | YES  |     | NULL              |                                               |
| abnormal_type | varchar(100)                                       | YES  |     | NULL              |                                               |
| abnormal_desc | varchar(500)                                       | YES  |     | NULL              |                                               |
| abnormal_time | datetime                                           | YES  |     | NULL              |                                               |
| skip_reason   | varchar(200)                                       | YES  |     | NULL              |                                               |
| attachments   | text                                               | YES  |     | NULL              |                                               |
| remark        | varchar(500)                                       | YES  |     | NULL              |                                               |
| resolved      | tinyint(1)                                         | YES  |     | 0                 |                                               |
| resolved_by   | int                                                | YES  |     | NULL              |                                               |
| resolved_time | datetime                                           | YES  |     | NULL              |                                               |
| resolution    | varchar(500)                                       | YES  |     | NULL              |                                               |
| created_at    | datetime                                           | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED                             |
| updated_at    | datetime                                           | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED on update CURRENT_TIMESTAMP |
+---------------+----------------------------------------------------+------+-----+-------------------+-----------------------------------------------+
23 rows in set (0.68 sec)


mysql> DESCRIBE housekeeping.sop_checklists;
+-----------------+------------------------------------------------------+------+-----+-------------------+-----------------------------------------------+
| Field           | Type                                                 | Null | Key | Default           | Extra                                         |
+-----------------+------------------------------------------------------+------+-----+-------------------+-----------------------------------------------+
| id              | int                                                  | NO   | PRI | NULL              | auto_increment                                |
| order_id        | int                                                  | NO   | MUL | NULL              |                                               |
| template_id     | int                                                  | NO   |     | NULL              |                                               |
| worker_id       | int                                                  | YES  |     | NULL              |                                               |
| service_date    | date                                                 | NO   | MUL | NULL              |                                               |
| status          | enum('pending','in_progress','completed','abnormal') | YES  | MUL | pending           |                                               |
| total_items     | int                                                  | YES  |     | 0                 |                                               |
| completed_items | int                                                  | YES  |     | 0                 |                                               |
| completion_rate | int                                                  | YES  |     | 0                 |                                               |
| abnormal_count  | int                                                  | YES  |     | 0                 |                                               |
| start_time      | datetime                                             | YES  |     | NULL              |                                               |
| end_time        | datetime                                             | YES  |     | NULL              |                                               |
| reminder_time   | varchar(10)                                          | YES  |     | NULL              |                                               |
| remark          | varchar(500)                                         | YES  |     | NULL              |                                               |
| created_by      | int                                                  | YES  |     | NULL              |                                               |
| created_at      | datetime                                             | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED                             |
| updated_at      | datetime                                             | YES  |     | CURRENT_TIMESTAMP | DEFAULT_GENERATED on update CURRENT_TIMESTAMP |
+-----------------+------------------------------------------------------+------+-----+-------------------+-----------------------------------------------+
17 rows in set (0.07 sec)


mysql> DESCRIBE housekeeping.service_categories;
+------------+--------------+------+-----+---------+----------------+
| Field      | Type         | Null | Key | Default | Extra          |
+------------+--------------+------+-----+---------+----------------+
| id         | int          | NO   | PRI | NULL    | auto_increment |
| name       | varchar(50)  | NO   |     | NULL    |                |
| icon       | varchar(255) | YES  |     | NULL    |                |
| sort_order | int          | YES  |     | 0       |                |
| status     | tinyint      | YES  |     | 1       |                |
| created_at | datetime     | NO   |     | NULL    |                |
+------------+--------------+------+-----+---------+----------------+
6 rows in set (0.24 sec)


mysql> SELECT id, template_name, service_category, version, status FROM housekeeping.sop_templates;
+----+---------------+------------------+---------+--------+
| id | template_name | service_category | version | status |
+----+---------------+------------------+---------+--------+
|  1 | 日常保洁      | point_comparison |       1 | active |
|  2 | 开荒保洁      | point_comparison |       1 | active |
|  3 | 家电清洗      | point_comparison |       1 | active |
|  4 | 月嫂服务      | checklist        |       1 | active |
|  5 | 育儿嫂服务    | checklist        |       1 | active |
|  6 | 保姆老人护理  | checklist        |       1 | active |
+----+---------------+------------------+---------+--------+
6 rows in set (0.07 sec)


mysql> SELECT id, name, category_id, settlement_type FROM housekeeping.services LIMIT 10;
+----+--------------+-------------+-----------------+
| id | name         | category_id | settlement_type |
+----+--------------+-------------+-----------------+
|  1 | 日常保洁     |           1 | once            |
|  2 | 精细保洁     |           1 | once            |
|  3 | 全屋深度清洁 |           2 | once            |
|  4 | 开荒保洁     |           2 | once            |
|  5 | 油烟机清洗   |           3 | once            |
|  6 | 空调清洗     |           3 | once            |
|  7 | 洗衣机清洗   |           3 | once            |
|  8 | 月嫂服务     |           4 | once            |
|  9 | 育儿嫂       |           4 | once            |
| 10 | 居家养老     |           5 | once            |
+----+--------------+-------------+-----------------+
10 rows in set (0.90 sec)


PS D:\housekeeping-platform> Get-ChildItem -Recurse -Filter "*.js" | Select-String -Pattern "sop" -List | Select-Object Path


Path
----
D:\housekeeping-platform\admin-frontend\node_modules\.vite\deps\@wangeditor_editor.js
D:\housekeeping-platform\admin-frontend\node_modules\.vite\deps\chunk-QJ6DQKGF.js
D:\housekeeping-platform\admin-frontend\node_modules\.vite\deps\chunk-XVQGOPP4.js
D:\housekeeping-platform\admin-frontend\node_modules\.vite\deps\echarts.js
D:\housekeeping-platform\admin-frontend\node_modules\.vite\deps\pinia.js
D:\housekeeping-platform\admin-frontend\node_modules\.vite\deps\vue-router.js
D:\housekeeping-platform\admin-frontend\node_modules\@babel\parser\lib\index.js
D:\housekeeping-platform\admin-frontend\node_modules\@babel\types\lib\asserts\generated\index.js
D:\housekeeping-platform\admin-frontend\node_modules\@babel\types\lib\builders\generated\lowercase.js
D:\housekeeping-platform\admin-frontend\node_modules\@babel\types\lib\builders\generated\uppercase.js
D:\housekeeping-platform\admin-frontend\node_modules\@babel\types\lib\definitions\typescript.js
D:\housekeeping-platform\admin-frontend\node_modules\@babel\types\lib\validators\generated\index.js
D:\housekeeping-platform\admin-frontend\node_modules\@uppy\companion-client\lib\Socket.js
D:\housekeeping-platform\admin-frontend\node_modules\@uppy\companion-client\src\Socket.js
D:\housekeeping-platform\admin-frontend\node_modules\@uppy\utils\lib\sampleImageDataURI.js
D:\housekeeping-platform\admin-frontend\node_modules\@uppy\utils\src\sampleImageDataURI.js
D:\housekeeping-platform\admin-frontend\node_modules\@vue\compiler-core\dist\compiler-core.cjs.js
D:\housekeeping-platform\admin-frontend\node_modules\@vue\compiler-core\dist\compiler-core.cjs.pro...
D:\housekeeping-platform\admin-frontend\node_modules\@vue\compiler-core\dist\compiler-core.esm-bun...
D:\housekeeping-platform\admin-frontend\node_modules\@vue\compiler-dom\dist\compiler-dom.cjs.js
D:\housekeeping-platform\admin-frontend\node_modules\@vue\compiler-dom\dist\compiler-dom.cjs.prod.js
D:\housekeeping-platform\admin-frontend\node_modules\@vue\compiler-dom\dist\compiler-dom.esm-brows...
D:\housekeeping-platform\admin-frontend\node_modules\@vue\compiler-dom\dist\compiler-dom.global.js
D:\housekeeping-platform\admin-frontend\node_modules\@vue\compiler-sfc\dist\compiler-sfc.cjs.js
D:\housekeeping-platform\admin-frontend\node_modules\@vue\compiler-sfc\dist\compiler-sfc.esm-brows...
D:\housekeeping-platform\admin-frontend\node_modules\@vue\compiler-ssr\dist\compiler-ssr.cjs.js
D:\housekeeping-platform\admin-frontend\node_modules\@vue\runtime-core\dist\runtime-core.cjs.js
D:\housekeeping-platform\admin-frontend\node_modules\@vue\runtime-core\dist\runtime-core.cjs.prod.js
D:\housekeeping-platform\admin-frontend\node_modules\@vue\runtime-core\dist\runtime-core.esm-bundl...
D:\housekeeping-platform\admin-frontend\node_modules\@vue\runtime-dom\dist\runtime-dom.esm-browser.js
D:\housekeeping-platform\admin-frontend\node_modules\@vue\runtime-dom\dist\runtime-dom.esm-browser...
D:\housekeeping-platform\admin-frontend\node_modules\@vue\runtime-dom\dist\runtime-dom.global.js
D:\housekeeping-platform\admin-frontend\node_modules\@vue\runtime-dom\dist\runtime-dom.global.prod.js
D:\housekeeping-platform\admin-frontend\node_modules\@vue\server-renderer\dist\server-renderer.esm...
D:\housekeeping-platform\admin-frontend\node_modules\@vue\server-renderer\dist\server-renderer.esm...
D:\housekeeping-platform\admin-frontend\node_modules\@vueuse\shared\index.iife.js
D:\housekeeping-platform\admin-frontend\node_modules\@wangeditor\code-highlight\dist\index.esm.js
D:\housekeeping-platform\admin-frontend\node_modules\@wangeditor\code-highlight\dist\index.js
D:\housekeeping-platform\admin-frontend\node_modules\@wangeditor\core\dist\index.esm.js
D:\housekeeping-platform\admin-frontend\node_modules\@wangeditor\core\dist\index.js
D:\housekeeping-platform\admin-frontend\node_modules\@wangeditor\editor\dist\index.esm.js
D:\housekeeping-platform\admin-frontend\node_modules\@wangeditor\editor\dist\index.js
D:\housekeeping-platform\admin-frontend\node_modules\brace-expansion\index.js
D:\housekeeping-platform\admin-frontend\node_modules\braces\lib\compile.js
D:\housekeeping-platform\admin-frontend\node_modules\braces\lib\parse.js
D:\housekeeping-platform\admin-frontend\node_modules\braces\lib\stringify.js
D:\housekeeping-platform\admin-frontend\node_modules\braces\lib\utils.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\dist\echarts.common.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\dist\echarts.esm.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\dist\echarts.esm.min.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\dist\echarts.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\dist\echarts.min.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\dist\echarts.simple.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\animation\universalTransition.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\chart\funnel\FunnelSeries.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\chart\lines\LinesSeries.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\chart\pie\PieSeries.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\chart\radar\backwardCompat.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\chart\treemap\treemapLayout.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\component\axisPointer\modelHelper.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\component\brush\BrushModel.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\component\dataZoom\DataZoomModel.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\component\graphic\GraphicModel.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\component\marker\checkMarkerInSer...
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\component\parallel\install.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\component\timeline\SliderTimeline...
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\component\timeline\TimelineModel.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\component\toolbox\feature\DataVie...
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\component\toolbox\feature\MagicTy...
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\component\visualMap\PiecewiseMode...
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\component\visualMap\VisualMapMode...
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\coord\axisAlignTicks.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\coord\axisHelper.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\coord\axisModelCreator.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\coord\parallel\ParallelModel.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\coord\parallel\parallelPreprocess...
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\data\Source.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\data\helper\transform.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\model\Series.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\preprocessor\backwardCompat.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\preprocessor\helper\compatStyle.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\util\layout.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\visual\VisualMapping.js
D:\housekeeping-platform\admin-frontend\node_modules\echarts\lib\visual\visualSolution.js
D:\housekeeping-platform\admin-frontend\node_modules\element-plus\dist\index.full.js
D:\housekeeping-platform\admin-frontend\node_modules\element-plus\lib\components\menu\src\menu.js
D:\housekeeping-platform\admin-frontend\node_modules\element-plus\lib\components\select\src\option...
D:\housekeeping-platform\admin-frontend\node_modules\element-plus\lib\components\select\src\useSel...
D:\housekeeping-platform\admin-frontend\node_modules\element-plus\lib\components\select-v2\src\use...
D:\housekeeping-platform\admin-frontend\node_modules\element-plus\lib\components\select-v2\src\use...
D:\housekeeping-platform\admin-frontend\node_modules\entities\dist\commonjs\generated\encode-html.js
D:\housekeeping-platform\admin-frontend\node_modules\entities\dist\esm\generated\encode-html.js
D:\housekeeping-platform\admin-frontend\node_modules\ext\string\random.js
D:\housekeeping-platform\admin-frontend\node_modules\i18next\i18next.js
D:\housekeeping-platform\admin-frontend\node_modules\i18next\dist\cjs\i18next.js
D:\housekeeping-platform\admin-frontend\node_modules\i18next\dist\esm\i18next.js
D:\housekeeping-platform\admin-frontend\node_modules\i18next\dist\umd\i18next.js
D:\housekeeping-platform\admin-frontend\node_modules\lodash\lodash.js
D:\housekeeping-platform\admin-frontend\node_modules\lodash\_unicodeSize.js
D:\housekeeping-platform\admin-frontend\node_modules\lodash\_unicodeToArray.js
D:\housekeeping-platform\admin-frontend\node_modules\lodash\_unicodeWords.js
D:\housekeeping-platform\admin-frontend\node_modules\lodash-es\_unicodeSize.js
D:\housekeeping-platform\admin-frontend\node_modules\lodash-es\_unicodeToArray.js
D:\housekeeping-platform\admin-frontend\node_modules\lodash-es\_unicodeWords.js
D:\housekeeping-platform\admin-frontend\node_modules\lodash.camelcase\index.js
D:\housekeeping-platform\admin-frontend\node_modules\lodash.toarray\index.js
D:\housekeeping-platform\admin-frontend\node_modules\pinia\dist\pinia.esm-browser.js
D:\housekeeping-platform\admin-frontend\node_modules\pinia\dist\pinia.iife.js
D:\housekeeping-platform\admin-frontend\node_modules\postcss\lib\postcss.js
D:\housekeeping-platform\admin-frontend\node_modules\prismjs\components\prism-bash.js
D:\housekeeping-platform\admin-frontend\node_modules\prismjs\components\prism-bash.min.js
D:\housekeeping-platform\admin-frontend\node_modules\prismjs\components\prism-psl.js
D:\housekeeping-platform\admin-frontend\node_modules\prismjs\components\prism-psl.min.js
D:\housekeeping-platform\admin-frontend\node_modules\prismjs\components\prism-sas.js
D:\housekeeping-platform\admin-frontend\node_modules\prismjs\components\prism-sas.min.js
D:\housekeeping-platform\admin-frontend\node_modules\prismjs\components\prism-vim.js
D:\housekeeping-platform\admin-frontend\node_modules\prismjs\components\prism-vim.min.js
D:\housekeeping-platform\admin-frontend\node_modules\prismjs\plugins\keep-markup\prism-keep-markup.js
D:\housekeeping-platform\admin-frontend\node_modules\prismjs\plugins\keep-markup\prism-keep-markup...
D:\housekeeping-platform\admin-frontend\node_modules\rollup\dist\es\shared\node-entry.js
D:\housekeeping-platform\admin-frontend\node_modules\rollup\dist\es\shared\parseAst.js
D:\housekeeping-platform\admin-frontend\node_modules\rollup\dist\es\shared\watch.js
D:\housekeeping-platform\admin-frontend\node_modules\rollup\dist\shared\index.js
D:\housekeeping-platform\admin-frontend\node_modules\rollup\dist\shared\parseAst.js
D:\housekeeping-platform\admin-frontend\node_modules\rollup\dist\shared\rollup.js
D:\housekeeping-platform\admin-frontend\node_modules\sass\sass.dart.js
D:\housekeeping-platform\admin-frontend\node_modules\scroll-into-view-if-needed\index.js
D:\housekeeping-platform\admin-frontend\node_modules\scroll-into-view-if-needed\es\index.js
D:\housekeeping-platform\admin-frontend\node_modules\scroll-into-view-if-needed\umd\scroll-into-vi...
D:\housekeeping-platform\admin-frontend\node_modules\slate\dist\index.es.js
D:\housekeeping-platform\admin-frontend\node_modules\slate\dist\index.js
D:\housekeeping-platform\admin-frontend\node_modules\slate\dist\slate.js
D:\housekeeping-platform\admin-frontend\node_modules\slate\dist\slate.min.js
D:\housekeeping-platform\admin-frontend\node_modules\slate-history\dist\index.es.js
D:\housekeeping-platform\admin-frontend\node_modules\slate-history\dist\index.js
D:\housekeeping-platform\admin-frontend\node_modules\slate-history\dist\slate-history.js
D:\housekeeping-platform\admin-frontend\node_modules\slate-history\dist\slate-history.min.js
D:\housekeeping-platform\admin-frontend\node_modules\type\ensure.js
D:\housekeeping-platform\admin-frontend\node_modules\type\array\ensure.js
D:\housekeeping-platform\admin-frontend\node_modules\type\iterable\ensure.js
D:\housekeeping-platform\admin-frontend\node_modules\type\lib\resolve-exception.js
D:\housekeeping-platform\admin-frontend\node_modules\type\plain-object\ensure.js
D:\housekeeping-platform\admin-frontend\node_modules\unplugin-vue-components\dist\resolvers.js
D:\housekeeping-platform\admin-frontend\node_modules\vite\dist\node\cli.js
D:\housekeeping-platform\admin-frontend\node_modules\vite\dist\node\chunks\dep-BK3b2jBa.js
D:\housekeeping-platform\admin-frontend\node_modules\vite\dist\node\chunks\dep-Dnp7gl8U.js
D:\housekeeping-platform\admin-frontend\node_modules\vite\dist\node\chunks\dep-IQS-Za7F.js
D:\housekeeping-platform\admin-frontend\node_modules\vue\dist\vue.esm-browser.js
D:\housekeeping-platform\admin-frontend\node_modules\vue\dist\vue.esm-browser.prod.js
D:\housekeeping-platform\admin-frontend\node_modules\vue\dist\vue.global.js
D:\housekeeping-platform\admin-frontend\node_modules\vue\dist\vue.global.prod.js
D:\housekeeping-platform\admin-frontend\node_modules\vue\dist\vue.runtime.esm-browser.js
D:\housekeeping-platform\admin-frontend\node_modules\vue\dist\vue.runtime.esm-browser.prod.js
D:\housekeeping-platform\admin-frontend\node_modules\vue\dist\vue.runtime.global.js
D:\housekeeping-platform\admin-frontend\node_modules\vue\dist\vue.runtime.global.prod.js
D:\housekeeping-platform\admin-frontend\node_modules\vue-router\dist\vue-router.esm-browser.js
D:\housekeeping-platform\admin-frontend\node_modules\vue-router\dist\vue-router.esm-browser.prod.js
D:\housekeeping-platform\admin-frontend\node_modules\vue-router\dist\vue-router.global.js
D:\housekeeping-platform\admin-frontend\node_modules\vue-router\dist\vue-router.global.prod.js
D:\housekeeping-platform\admin-frontend\src\api\sop.js
D:\housekeeping-platform\admin-frontend\src\router\index.js
D:\housekeeping-platform\admin-frontend\src\utils\sopPermission.js
D:\housekeeping-platform\backend\app.js
D:\housekeeping-platform\backend\test-models-01.js
D:\housekeeping-platform\backend\jobs\acceptanceReminder.js
D:\housekeeping-platform\backend\jobs\autoAcceptance.js
D:\housekeeping-platform\backend\middleware\secondVerify.js
D:\housekeeping-platform\backend\middleware\sopDataMask - 副本.js
D:\housekeeping-platform\backend\middleware\sopDataMask.js
D:\housekeeping-platform\backend\middleware\sopSensitiveLog.js
D:\housekeeping-platform\backend\models\index - 副本.js
D:\housekeeping-platform\backend\models\index.js
D:\housekeeping-platform\backend\models\index_wrong.js
D:\housekeeping-platform\backend\models\orderSopRecord.js
D:\housekeeping-platform\backend\models\sopChecklist - 副本.js
D:\housekeeping-platform\backend\models\sopChecklist.js
D:\housekeeping-platform\backend\models\sopChecklistItem - 副本.js
D:\housekeeping-platform\backend\models\sopChecklistItem.js
D:\housekeeping-platform\backend\models\sopChecklistLog - 副本.js
D:\housekeeping-platform\backend\models\sopChecklistLog.js
D:\housekeeping-platform\backend\models\sopPointPhoto.js
D:\housekeeping-platform\backend\models\sopSensitiveLog.js
D:\housekeeping-platform\backend\models\soptemplate.js
D:\housekeeping-platform\backend\models\finance\FinanceSettlement.js
D:\housekeeping-platform\backend\node_modules\@redis\client\dist\lib\client\index.js
D:\housekeeping-platform\backend\node_modules\@redis\client\dist\lib\client\socket.js
D:\housekeeping-platform\backend\node_modules\@redis\client\dist\lib\cluster\cluster-slots.js
D:\housekeeping-platform\backend\node_modules\@redis\client\dist\lib\cluster\index.js
D:\housekeeping-platform\backend\node_modules\@redis\client\dist\lib\commands\CLIENT_TRACKING.js
D:\housekeeping-platform\backend\node_modules\ast-types\def\typescript.js
D:\housekeeping-platform\backend\node_modules\aws-ssl-profiles\lib\profiles\ca\defaults.js
D:\housekeeping-platform\backend\node_modules\bare-url\index.js
D:\housekeeping-platform\backend\node_modules\basic-ftp\dist\Client.js
D:\housekeeping-platform\backend\node_modules\basic-ftp\dist\FtpContext.js
D:\housekeeping-platform\backend\node_modules\basic-ftp\dist\netUtils.js
D:\housekeeping-platform\backend\node_modules\basic-ftp\dist\transfer.js
D:\housekeeping-platform\backend\node_modules\braces\lib\compile.js
D:\housekeeping-platform\backend\node_modules\braces\lib\parse.js
D:\housekeeping-platform\backend\node_modules\braces\lib\stringify.js
D:\housekeeping-platform\backend\node_modules\braces\lib\utils.js
D:\housekeeping-platform\backend\node_modules\bull\lib\queue.js
D:\housekeeping-platform\backend\node_modules\chromium-bidi\lib\iife\mapperTab.js
D:\housekeeping-platform\backend\node_modules\cors\lib\index.js
D:\housekeeping-platform\backend\node_modules\echarts\dist\echarts.common.js
D:\housekeeping-platform\backend\node_modules\echarts\dist\echarts.esm.js
D:\housekeeping-platform\backend\node_modules\echarts\dist\echarts.esm.min.js
D:\housekeeping-platform\backend\node_modules\echarts\dist\echarts.js
D:\housekeeping-platform\backend\node_modules\echarts\dist\echarts.min.js
D:\housekeeping-platform\backend\node_modules\echarts\dist\echarts.simple.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\animation\universalTransition.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\chart\funnel\FunnelSeries.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\chart\lines\LinesSeries.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\chart\pie\PieSeries.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\chart\radar\backwardCompat.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\chart\treemap\treemapLayout.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\component\axisPointer\modelHelper.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\component\brush\BrushModel.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\component\dataZoom\DataZoomModel.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\component\graphic\GraphicModel.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\component\marker\checkMarkerInSeries.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\component\parallel\install.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\component\timeline\SliderTimelineView.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\component\timeline\TimelineModel.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\component\toolbox\feature\DataView.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\component\toolbox\feature\MagicType.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\component\visualMap\PiecewiseModel.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\component\visualMap\VisualMapModel.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\coord\axisAlignTicks.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\coord\axisHelper.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\coord\axisModelCreator.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\coord\parallel\ParallelModel.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\coord\parallel\parallelPreprocessor.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\data\Source.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\data\helper\transform.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\model\Series.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\preprocessor\backwardCompat.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\preprocessor\helper\compatStyle.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\util\layout.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\visual\VisualMapping.js
D:\housekeeping-platform\backend\node_modules\echarts\lib\visual\visualSolution.js
D:\housekeeping-platform\backend\node_modules\esprima\dist\esprima.js
D:\housekeeping-platform\backend\node_modules\ioredis\built\Redis.js
D:\housekeeping-platform\backend\node_modules\ioredis\built\cluster\ConnectionPool.js
D:\housekeeping-platform\backend\node_modules\ioredis\built\cluster\index.js
D:\housekeeping-platform\backend\node_modules\ioredis\built\cluster\util.js
D:\housekeeping-platform\backend\node_modules\lodash\lodash.js
D:\housekeeping-platform\backend\node_modules\lodash\_unicodeSize.js
D:\housekeeping-platform\backend\node_modules\lodash\_unicodeToArray.js
D:\housekeeping-platform\backend\node_modules\lodash\_unicodeWords.js
D:\housekeeping-platform\backend\node_modules\moment\dist\locale\ku-kmr.js
D:\housekeeping-platform\backend\node_modules\moment\locale\ku-kmr.js
D:\housekeeping-platform\backend\node_modules\moment\min\locales.js
D:\housekeeping-platform\backend\node_modules\moment\min\moment-with-locales.js
D:\housekeeping-platform\backend\node_modules\moment\src\locale\ku-kmr.js
D:\housekeeping-platform\backend\node_modules\nodemon\node_modules\brace-expansion\index.js
D:\housekeeping-platform\backend\node_modules\puppeteer-core\lib\cjs\puppeteer\cdp\ExtensionTransp...
D:\housekeeping-platform\backend\node_modules\puppeteer-core\lib\es5-iife\puppeteer-core-browser.js
D:\housekeeping-platform\backend\node_modules\puppeteer-core\lib\esm\puppeteer\cdp\ExtensionTransp...
D:\housekeeping-platform\backend\node_modules\sequelize\lib\model.js
D:\housekeeping-platform\backend\node_modules\sharp\lib\input.js
D:\housekeeping-platform\backend\node_modules\socks-proxy-agent\dist\index.js
D:\housekeeping-platform\backend\node_modules\tencentcloud-sdk-nodejs\es\services\cvm\v20170312\cv...
D:\housekeeping-platform\backend\node_modules\tencentcloud-sdk-nodejs\es\services\tcss\v20201101\t...
D:\housekeeping-platform\backend\node_modules\tencentcloud-sdk-nodejs\es\services\tdmq\v20200217\t...
D:\housekeeping-platform\backend\node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\cvm\v2...
D:\housekeeping-platform\backend\node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\tcss\v...
D:\housekeeping-platform\backend\node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\tdmq\v...
D:\housekeeping-platform\backend\node_modules\validator\validator.js
D:\housekeeping-platform\backend\node_modules\validator\es\lib\contains.js
D:\housekeeping-platform\backend\node_modules\validator\lib\contains.js
D:\housekeeping-platform\backend\node_modules\yargs-parser\build\lib\yargs-parser.js
D:\housekeeping-platform\backend\node_modules\yauzl\index.js
D:\housekeeping-platform\backend\node_modules\zod\v3\types.js
D:\housekeeping-platform\backend\node_modules\zod\v4\classic\schemas.js
D:\housekeeping-platform\backend\node_modules\zod\v4\core\schemas.js
D:\housekeeping-platform\backend\routes\admin\index - 副本 (2).js
D:\housekeeping-platform\backend\routes\admin\index.js
D:\housekeeping-platform\backend\routes\admin\index_wrong.js
D:\housekeeping-platform\backend\routes\admin\sopChecklist - 副本 (2).js
D:\housekeeping-platform\backend\routes\admin\sopChecklist - 副本.js
D:\housekeeping-platform\backend\routes\admin\sopChecklist.js
D:\housekeeping-platform\backend\routes\admin\sopEntrySafety.js
D:\housekeeping-platform\backend\routes\admin\sopPointComparison.js
D:\housekeeping-platform\backend\routes\admin\sopSensitiveLogs.js
D:\housekeeping-platform\backend\routes\admin\sopTemplate.js
D:\housekeeping-platform\backend\services\finance\settlementService.js
D:\housekeeping-platform\backend\utils\pdfGenerator.js
D:\housekeeping-platform\backend\utils\finance\sopAdapter.js
D:\housekeeping-platform\miniprogram\pages\acceptance\records\records.js
D:\housekeeping-platform\miniprogram - 副本\pages\worker\index.js




PS D:\housekeeping-platform\backend> Get-ChildItem -Path .\routes -Filter *.js -Recurse -Name
adminRoutes.js
arbitrationRoutes.js
authRoutes.js
chatRoutes.js
customerRoutes.js
evidenceRoutes.js
fix-server.js
kycRoutes.js
leaderRoutes.js
matchingRoutes.js
messageRoutes.js
orderRoutes.js
paymentRoutes.js
profileRoutes.js
serviceRoutes.js
supportRoutes.js
upload.js
verificationRoutes.js
workerRoutes.js
workerSearchRoutes.js
admin\auth.js
admin\conversation.js
admin\customer.js
admin\finance.js
admin\index - 副本 (2).js
admin\index - 副本.js
admin\index.js
admin\index_bak.js
admin\index_wrong.js
admin\log.js
admin\order.js
admin\order_v6_broken.js
admin\permission.js
admin\role.js
admin\sensitivePermission.js
admin\service.js
admin\serviceCategory.js
admin\sopChecklist - 副本 (2).js
admin\sopChecklist - 副本.js
admin\sopChecklist.js
admin\sopEntrySafety.js
admin\sopPointComparison.js
admin\sopSensitiveLogs.js
admin\sopTemplate.js
admin\upload.js
admin\user.js
admin\worker.js
admin\worker_bak.js




PS D:\housekeeping-platform\backend> Get-ChildItem -Path .\controllers -Filter *.js -Recurse -Name
adminController.js
arbitrationController.js
authController.js
chatController.js
creditController.js
customerController.js
depositController.js
evidenceController.js
leaderController.js
matchingController.js
messageController.js
orderController.js
ordersController.js
paymentController.js
servicesController.js
supportController.js
verificationController.js
workerController.js


PS D:\housekeeping-platform\backend> # 即使services文件夹不存在，也不会报错
>> Get-ChildItem -Path .\services -Filter *.js -Recurse -Name -ErrorAction SilentlyContinue
adminService.js
aiDetectionService.js
arbitrationService.js
configService.js
confirmationService.js
depositService.js
kycService.js
leaderService.js
messageService.js
notificationService.js
paymentService.js
reviewerService.js
tencentKycService.js
verdictService.js
verificationService.js
auth-service\controllers\adminKycController.js
auth-service\controllers\authController.js
auth-service\controllers\kycController.js
auth-service\models\KycDocument.js
auth-service\models\User.js
auth-service\routes\authRoutes.js
auth-service\routes\kycRoutes.js
file-service\index.js
finance\refundCalculator.js
finance\refundService.js
finance\reportservice.js
finance\settlementService.js
finance\walletService.js
finance\withdrawalService.js
notification-service\index.js




module.exports = router;
PS D:\housekeeping-platform\backend> Select-String -Path .\routes\admin\sopTemplate.js -Pattern "router\."


routes\admin\sopTemplate.js:54:router.get('/', async (req, res) => {
routes\admin\sopTemplate.js:90:router.get('/active', async (req, res) => {
routes\admin\sopTemplate.js:114:router.get('/:id', async (req, res) => {
routes\admin\sopTemplate.js:135:router.get('/:id/versions', async (req, res) => {
routes\admin\sopTemplate.js:159:router.post('/', checkTemplatePermission, async (req, res) => {
routes\admin\sopTemplate.js:205:router.put('/:id', checkTemplatePermission, async (req, res) => {
routes\admin\sopTemplate.js:239:router.delete('/:id', checkTemplatePermission, async (req, res) => {
routes\admin\sopTemplate.js:272:router.post('/:id/restore', checkTemplatePermission, async (req, res) => {
routes\admin\sopTemplate.js:316:router.get('/category/:category', async (req, res) => {




PS D:\housekeeping-platform\backend> Select-String -Path .\routes\admin\sopPointComparison.js -Pattern "router\."


routes\admin\sopPointComparison.js:38:router.use(captainDataFilterMiddleware);
routes\admin\sopPointComparison.js:44:router.get('/', sopDataMaskMiddleware(), async (req, res) => {
routes\admin\sopPointComparison.js:121:router.get('/:orderId',
routes\admin\sopPointComparison.js:170:router.get('/:orderId/points',
routes\admin\sopPointComparison.js:203:router.get('/:orderId/points/:pointId',
routes\admin\sopPointComparison.js:239:router.get('/:orderId/signature',
routes\admin\sopPointComparison.js:297:router.get('/:orderId/export-pdf',
routes\admin\sopPointComparison.js:357:router.get('/:orderId/countdown',
routes\admin\sopPointComparison.js:392:router.get('/stats/overview', async (req, res) => {




PS D:\housekeeping-platform\backend> Select-String -Path .\routes\admin\sopChecklist.js -Pattern "router\."


routes\admin\sopChecklist.js:22:router.use(authMiddleware.verifyToken);
routes\admin\sopChecklist.js:28:router.get('/list', async (req, res) => {
routes\admin\sopChecklist.js:135:router.get('/statistics', async (req, res) => {
routes\admin\sopChecklist.js:160:router.get('/:id', async (req, res) => {
routes\admin\sopChecklist.js:221:router.get('/:id/items', async (req, res) => {
routes\admin\sopChecklist.js:274:router.get('/:id/timeline', async (req, res) => {
routes\admin\sopChecklist.js:323:router.get('/:id/abnormal', async (req, res) => {
routes\admin\sopChecklist.js:359:router.post('/abnormal/:itemId/resolve', async (req, res) => {
routes\admin\sopChecklist.js:406:router.post('/', async (req, res) => {
routes\admin\sopChecklist.js:479:router.put('/:id', async (req, res) => {
routes\admin\sopChecklist.js:506:router.get('/:id/export', async (req, res) => {
routes\admin\sopChecklist.js:522:router.get('/export', async (req, res) => {




PS D:\housekeeping-platform\backend> Get-ChildItem -Path . -Recurse -Filter *.js | Select-String -Pattern "order_sop_records" | Select-Object -First 20


models\orderSopRecord.js:3: * 对应数据库表: order_sop_records
models\orderSopRecord.js:46:    tableName: 'order_sop_records',




PS D:\housekeeping-platform\backend> Get-ChildItem -Path . -Recurse -Filter *.js | Select-String -Pattern "sop_checklists" | Select-Object -First 20


models\sopChecklist - 副本.js:4: * 对应数据库表: sop_checklists
models\sopChecklist - 副本.js:93:    tableName: 'sop_checklists',
models\sopChecklist.js:4: * 对应数据库表: sop_checklists
models\sopChecklist.js:93:    tableName: 'sop_checklists',




PS D:\housekeeping-platform\backend> Get-ChildItem -Path . -Recurse -Filter *.js | Select-String -Pattern "template_id" | Select-Object -First 30


jobs\acceptanceReminder.js:58:      templateId: process.env.WECHAT_REMINDER_TEMPLATE_ID
libs\notification.js:47:      //   template_id: templateId,
models\index - 副本.js:10:OrderSopRecord.belongsTo(SopTemplate, { foreignKey: 'template_id', as: 'template' });
models\index - 副本.js:11:SopTemplate.hasMany(OrderSopRecord, { foreignKey: 'template_id', as: 'records' });
models\index.js:408:SopTemplate.hasMany(OrderSopRecord, { foreignKey: 'template_id', as: 'records' });
models\index.js:409:OrderSopRecord.belongsTo(SopTemplate, { foreignKey: 'template_id', as: 'template' });
models\index.js:420:SopChecklist.belongsTo(SopTemplate, { as: 'template', foreignKey: 'template_id' });
models\index_wrong.js:19:  foreignKey: 'template_id',
models\index_wrong.js:23:  foreignKey: 'template_id',
models\MessageTemplate.js:24:    wechat_template_id: {
models\MessageTemplate.js:35:    sms_template_id: {
models\orderSopRecord.js:12:    template_id: { type: DataTypes.INTEGER, allowNull: false },
models\sopChecklist - 副本.js:22:    template_id: {
models\sopChecklist.js:22:    template_id: {
routes\admin\sopChecklist - 副本 (2).js:432:      template_id: templateId,
routes\admin\sopChecklist.js:432:      template_id: templateId,
services\messageService.js:143:    if (!template.wechat_template_id) {
services\messageService.js:172:        template_id: template.wechat_template_id,
services\messageService.js:262:    if (!template.sms_template_id) {
services\messageService.js:334:      TemplateCode: template.sms_template_id,
tasks\jurorDecayTasks.js:163:    //   template_id: 'xxx',




PS D:\housekeeping-platform\backend> Get-ChildItem -Path . -Recurse -Directory | Where-Object { $_.Name -match "cron|job|schedule|task" }




    目录: D:\housekeeping-platform\backend




Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----         2026/1/23     13:24                cron
d-----          2026/2/2     10:25                jobs
d-----         2026/1/19     15:54                tasks




    目录: D:\housekeeping-platform\backend\node_modules




Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----        2025/12/19     22:13                cron-parser
d-----          2026/1/7     10:17                node-cron
d-----          2026/2/2     10:36                node-schedule




    目录: D:\housekeeping-platform\backend\node_modules\node-cron\dist\cjs




Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----          2026/1/7     10:17                scheduler
d-----          2026/1/7     10:17                tasks




    目录: D:\housekeeping-platform\backend\node_modules\node-cron\dist\cjs\tasks




Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----          2026/1/7     10:17                background-scheduled-task




    目录: D:\housekeeping-platform\backend\node_modules\node-cron\dist\esm




Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----          2026/1/7     10:17                scheduler
d-----          2026/1/7     10:17                tasks




    目录: D:\housekeeping-platform\backend\node_modules\node-cron\dist\esm\tasks




Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
d-----          2026/1/7     10:17                background-scheduled-task




PS D:\housekeeping-platform\backend> Get-ChildItem -Path . -Recurse -Filter *.js | Select-String -Pattern "cron|schedule|setInterval" | Select-Object -First 20


app-api-fixed.js:115:        scheduled_time DATETIME,
app-api-fixed.js:508:    const { customer_id, service_id, scheduled_time, address, lat, lng, notes } = req.body;
app-api-fixed.js:510:    if (!customer_id || !service_id || !scheduled_time || !address) {
app-api-fixed.js:513:        message: "缺少必要参数: customer_id, service_id, scheduled_time, address",
app-api-fixed.js:558:                          scheduled_time, address, lat, lng, customer_notes)
app-api-fixed.js:561:       scheduled_time, address, lat || null, lng || null, notes || null]
app-api-fixed.js:640:      scheduled_time: order.scheduled_time ? new Date(order.scheduled_time).toISOString() : null,
app-api.js:115:        scheduled_time DATETIME,
app-api.js:481:    const { customer_id, service_id, scheduled_time, address, lat, lng, notes } = req.body;
app-api.js:483:    if (!customer_id || !service_id || !scheduled_time || !address) {
app-api.js:528:                          scheduled_time, address, lat, lng, customer_notes)
app-api.js:531:       scheduled_time, address, lat || null, lng || null, notes || null]
app-api.js:606:      scheduled_time: order.scheduled_time ? new Date(order.scheduled_time).toISOString() : null,
app.js:432:        setInterval(async () => {
simple-test-fixed.js:59:      scheduled_time: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),
test-api.js:56:      scheduled_time: new Date(Date.now() + 24 * 60 * 60 * 1000).toISOString(),
test-chat-client.js:67:      scheduled_time: new Date(Date.now() + 30 * 60 * 1000).toISOString(),
test-evidence.js:66:      scheduled_time: new Date(Date.now() + 30 * 60 * 1000).toISOString(),
test-matching.js:107:      scheduled_time: new Date(Date.now() + 30 * 60 * 1000).toISOString(),
test-order-workflow.js:41:      scheduled_time: new Date(Date.now() + 30 * 60 * 1000).toISOString(), // 30分钟后




PS D:\housekeeping-platform\backend>




PS D:\housekeeping-platform\backend> Get-ChildItem -Path .\cron -Filter *.js -Name
PS D:\housekeeping-platform\backend> Get-ChildItem -Path .\jobs -Filter *.js -Name
acceptanceReminder.js
autoAcceptance.js
PS D:\housekeeping-platform\backend> Get-ChildItem -Path .\tasks -Filter *.js -Name
arbitrationTasks.js
autoSettlement.js
jurorDecayTasks.js
leaderTasks.js
orderTasks.js
verificationTasks.js
PS D:\housekeeping-platform\backend> Get-ChildItem -Path .\cron,.\jobs,.\tasks -Recurse -Filter *.js | Select-String -Pattern "75|仲裁|arbitration"


jobs\acceptanceReminder.js:20:    TOTAL_DURATION: 75 * 60 * 1000
jobs\autoAcceptance.js:6: * - 超过75分钟自动确认验收
jobs\autoAcceptance.js:111:    // 计算超时时间点（当前时间 - 75分钟）
tasks\arbitrationTasks.js:1:// tasks/arbitrationTasks.js
tasks\arbitrationTasks.js:2:// 仲裁相关定时任务
tasks\arbitrationTasks.js:9:class ArbitrationTaskManager {
tasks\arbitrationTasks.js:29:      console.log('⚠️ 仲裁定时任务已在运行中');
tasks\arbitrationTasks.js:39:    console.log('🚀 启动仲裁定时任务...');
tasks\arbitrationTasks.js:57:    console.log('✅ 仲裁定时任务启动完成');
tasks\arbitrationTasks.js:67:    console.log('⏹️ 仲裁定时任务已停止');
tasks\arbitrationTasks.js:77:    console.log(`[${timestamp}] 执行仲裁分钟任务...`);
tasks\arbitrationTasks.js:112:    console.log(`[${new Date().toISOString()}] 执行仲裁小时任务...`);
tasks\arbitrationTasks.js:156:    console.log(`[${new Date().toISOString()}] 执行仲裁每日任务...`);
tasks\arbitrationTasks.js:159:      // 1. 检查6个月无仲裁记录的家政员，重置保证金要求
tasks\arbitrationTasks.js:181:    const { ServiceConfirmation, Order, ArbitrationCase } = this.db;
tasks\arbitrationTasks.js:187:        arbitration_window_end: { [Op.lt]: new Date() }
tasks\arbitrationTasks.js:194:      // 检查是否有进行中的仲裁
tasks\arbitrationTasks.js:195:      const existingCase = await ArbitrationCase.findOne({
tasks\arbitrationTasks.js:231:    const { ArbitrationCase } = this.db;
tasks\arbitrationTasks.js:232:    if (!ArbitrationCase) return;
tasks\arbitrationTasks.js:234:    const casesToStartVoting = await ArbitrationCase.findAll({
tasks\arbitrationTasks.js:241:    for (const arbitrationCase of casesToStartVoting) {
tasks\arbitrationTasks.js:245:        await arbitrationCase.update({
tasks\arbitrationTasks.js:251:        console.log(`✅ 案件 ${arbitrationCase.case_no} 开始投票阶段`);
tasks\arbitrationTasks.js:254:        await this.inviteReviewersForCase(arbitrationCase.id);
tasks\arbitrationTasks.js:257:        console.error(`案件 ${arbitrationCase.case_no} 开启投票失败:`, err.message);
tasks\arbitrationTasks.js:266:    const { ArbitrationReviewer } = this.db;
tasks\arbitrationTasks.js:267:    if (!ArbitrationReviewer) return;
tasks\arbitrationTasks.js:269:    const result = await ArbitrationReviewer.update(
tasks\arbitrationTasks.js:288:    const { ArbitrationReviewer } = this.db;
tasks\arbitrationTasks.js:289:    if (!ArbitrationReviewer) return;
tasks\arbitrationTasks.js:291:    const result = await ArbitrationReviewer.update(
tasks\arbitrationTasks.js:311:    const { ArbitrationCase, ArbitrationReviewer } = this.db;
tasks\arbitrationTasks.js:312:    if (!ArbitrationCase || !ArbitrationReviewer) return;
tasks\arbitrationTasks.js:314:    const activeCases = await ArbitrationCase.findAll({
tasks\arbitrationTasks.js:318:    for (const arbitrationCase of activeCases) {
tasks\arbitrationTasks.js:320:      const completedCount = await ArbitrationReviewer.count({
tasks\arbitrationTasks.js:322:          case_id: arbitrationCase.id,
tasks\arbitrationTasks.js:330:      const acceptedCount = await ArbitrationReviewer.count({
tasks\arbitrationTasks.js:332:          case_id: arbitrationCase.id,
tasks\arbitrationTasks.js:337:      const pendingCount = await ArbitrationReviewer.count({
tasks\arbitrationTasks.js:339:          case_id: arbitrationCase.id,
tasks\arbitrationTasks.js:346:        await this.inviteReviewersForCase(arbitrationCase.id, 5);
tasks\arbitrationTasks.js:355:    const { ArbitrationCase, ArbitrationReviewer, User, ReviewerLevel } = this.db;
tasks\arbitrationTasks.js:358:    const arbitrationCase = await ArbitrationCase.findByPk(caseId);
tasks\arbitrationTasks.js:359:    if (!arbitrationCase) return;
tasks\arbitrationTasks.js:362:    const existingReviewers = await ArbitrationReviewer.findAll({
tasks\arbitrationTasks.js:367:    excludeUserIds.push(arbitrationCase.applicant_id, arbitrationCase.respondent_id);
tasks\arbitrationTasks.js:405:      await ArbitrationReviewer.bulkCreate(invitations, { ignoreDuplicates: true });
tasks\arbitrationTasks.js:406:      console.log(`✅ 案件 ${arbitrationCase.case_no} 邀请了 ${invitations.length} 名评审
员`);
tasks\arbitrationTasks.js:414:    const { ArbitrationCase, ArbitrationReviewer } = this.db;
tasks\arbitrationTasks.js:415:    if (!ArbitrationCase || !ArbitrationReviewer) return;
tasks\arbitrationTasks.js:417:    const votingCases = await ArbitrationCase.findAll({
tasks\arbitrationTasks.js:421:    for (const arbitrationCase of votingCases) {
tasks\arbitrationTasks.js:422:      const completedCount = await ArbitrationReviewer.count({
tasks\arbitrationTasks.js:424:          case_id: arbitrationCase.id,
tasks\arbitrationTasks.js:432:        await arbitrationCase.reload();
tasks\arbitrationTasks.js:434:        if (arbitrationCase.vote_applicant === 5 && arbitrationCase.vote_respondent === 5
) {
tasks\arbitrationTasks.js:436:          await arbitrationCase.update({ status: 'pending_platform_vote' });
tasks\arbitrationTasks.js:437:          console.log(`⚠️ 案件 ${arbitrationCase.case_no} 出现平票，等待平台投票`);
tasks\arbitrationTasks.js:440:          await this.calculateVerdictResult(arbitrationCase);
tasks\arbitrationTasks.js:449:  async calculateVerdictResult(arbitrationCase) {
tasks\arbitrationTasks.js:450:    const result = arbitrationCase.vote_applicant > arbitrationCase.vote_respondent
tasks\arbitrationTasks.js:454:    const effectiveTime = arbitrationCase.is_professional
tasks\arbitrationTasks.js:458:    await arbitrationCase.update({
tasks\arbitrationTasks.js:460:      status: arbitrationCase.is_professional ? 'completed' : 'verdict_pending',
tasks\arbitrationTasks.js:465:    console.log(`✅ 案件 ${arbitrationCase.case_no} 已裁决: ${result}`);
tasks\arbitrationTasks.js:467:    // 如果是专业仲裁，立即执行
tasks\arbitrationTasks.js:468:    if (arbitrationCase.is_professional) {
tasks\arbitrationTasks.js:469:      await this.executeVerdict(arbitrationCase.id);
tasks\arbitrationTasks.js:477:    const { ArbitrationCase } = this.db;
tasks\arbitrationTasks.js:478:    if (!ArbitrationCase) return;
tasks\arbitrationTasks.js:480:    const casesToExecute = await ArbitrationCase.findAll({
tasks\arbitrationTasks.js:489:    for (const arbitrationCase of casesToExecute) {
tasks\arbitrationTasks.js:490:      // 检查是否有专业仲裁在进行
tasks\arbitrationTasks.js:491:      const professionalCase = await ArbitrationCase.findOne({
tasks\arbitrationTasks.js:493:          parent_case_id: arbitrationCase.id,
tasks\arbitrationTasks.js:499:        await this.executeVerdict(arbitrationCase.id);
tasks\arbitrationTasks.js:508:    const { ArbitrationCase } = this.db;
tasks\arbitrationTasks.js:523:    const { ArbitrationCase, ArbitrationReviewer, PlatformBackupAccount } = this.db;
tasks\arbitrationTasks.js:524:    if (!ArbitrationCase || !PlatformBackupAccount) return;
tasks\arbitrationTasks.js:527:    const activeCases = await ArbitrationCase.findAll({
tasks\arbitrationTasks.js:534:    for (const arbitrationCase of activeCases) {
tasks\arbitrationTasks.js:535:      const acceptedCount = await ArbitrationReviewer.count({
tasks\arbitrationTasks.js:537:          case_id: arbitrationCase.id,
tasks\arbitrationTasks.js:554:            case_id: arbitrationCase.id,
tasks\arbitrationTasks.js:564:          await ArbitrationReviewer.bulkCreate(invitations, { ignoreDuplicates: true });
tasks\arbitrationTasks.js:565:          console.log(`⚠️ 案件 ${arbitrationCase.case_no} 启用了 ${backupAccounts.length}
 个兜底账号`);
tasks\arbitrationTasks.js:592:          last_arbitration_date: { [Op.lte]: sixMonthsAgo }
tasks\arbitrationTasks.js:606:    const { UserArbitrationStats } = this.db;
tasks\arbitrationTasks.js:607:    if (!UserArbitrationStats) return;
tasks\arbitrationTasks.js:609:    await UserArbitrationStats.update(
tasks\arbitrationTasks.js:650:    const { ArbitrationCase } = this.db;
tasks\arbitrationTasks.js:651:    if (!ArbitrationCase) return;
tasks\arbitrationTasks.js:654:      active_cases: await ArbitrationCase.count({
tasks\arbitrationTasks.js:657:      pending_verdict: await ArbitrationCase.count({
tasks\arbitrationTasks.js:660:      completed_today: await ArbitrationCase.count({
tasks\arbitrationTasks.js:668:    console.log('📊 仲裁统计:', JSON.stringify(stats));
tasks\arbitrationTasks.js:673:module.exports = new ArbitrationTaskManager();
tasks\autoSettlement.js:7: * 2. 排除 status=in_arbitration 的订单（仲裁中不结算）
tasks\autoSettlement.js:201:    if (order.status === 'in_arbitration') {
tasks\autoSettlement.js:202:      return { success: false, message: '仲裁中的订单不能结算' };
tasks\orderTasks.js:7: * 2. 仲裁超时检测-75分钟（每分钟）
tasks\orderTasks.js:47:    // 任务2: 仲裁超时检测-75分钟（每分钟执行）
tasks\orderTasks.js:51:          await this.checkArbitrationTimeout();
tasks\orderTasks.js:53:          console.error('[仲裁超时] 任务执行失败:', error.message);
tasks\orderTasks.js:93:    console.log('   - 仲裁超时: 每分钟检查');
tasks\orderTasks.js:172:   * 任务2: 仲裁超时检测（75分钟）
tasks\orderTasks.js:176:   * - 超过 arbitration_deadline（服务完成+75分钟）
tasks\orderTasks.js:177:   * - 未发起仲裁的订单，视为放弃仲裁权
tasks\orderTasks.js:180:  async checkArbitrationTimeout() {
tasks\orderTasks.js:182:      // 查找超过75分钟仲裁期限的订单
tasks\orderTasks.js:187:         AND arbitration_deadline IS NOT NULL
tasks\orderTasks.js:188:         AND arbitration_deadline <= NOW()
tasks\orderTasks.js:189:         AND arbitration_started_at IS NULL`,
tasks\orderTasks.js:197:      console.log(`[仲裁超时] 发现 ${orders.length} 个超时订单`);
tasks\orderTasks.js:200:        // 更新订单：清除仲裁截止时间，标记为已过仲裁期
tasks\orderTasks.js:203:            arbitration_deadline = NULL,
tasks\orderTasks.js:213:           VALUES (?, 'pending_confirm', 'pending_confirm', '75分钟仲裁期限已过，客户放弃仲裁权
', 'system', '系统', NOW())`,
tasks\orderTasks.js:217:        console.log(`[仲裁超时] 订单 ${order.order_no} 仲裁期限已过`);




PS D:\housekeeping-platform\backend> Get-ChildItem -Path .\cron,.\jobs,.\tasks -Recurse -Filter *.js | Select-String -Pattern "36|结算|settlement"


cron\finance\dailySettle.js:2: * 财务模块 - 每日结算脚本
cron\finance\dailySettle.js:11:async function runDailySettlement() {
cron\finance\dailySettle.js:12:    console.log(`[${new Date().toISOString()}] === 开始执行每日结算 ===`);
cron\finance\dailySettle.js:16:        // 1. 查找所有"已完成"且"未结算"的订单
cron\finance\dailySettle.js:17:        // 假设订单状态 'completed', 结算状态 'unsettled'
cron\finance\dailySettle.js:22:                // settlement_status: 'unsettled' // 暂时注释，以免因字段缺失报错
cron\finance\dailySettle.js:28:        console.log(`扫描到 ${orders.length} 个待结算订单`);
cron\finance\dailySettle.js:31:            // 2. 简单的结算逻辑 (7-2-1 模型简化版：全额转入家政员钱包，扣除平台费在Wall
etService处理)
cron\finance\dailySettle.js:32:            // 这里仅做演示，实际需调用 settlementEngine.js
cron\finance\dailySettle.js:43:                    remark: `订单 ${order.order_no} 结算收入`,
cron\finance\dailySettle.js:55:                // 更新订单为"已结算"
cron\finance\dailySettle.js:56:                // order.settlement_status = 'settled';
cron\finance\dailySettle.js:58:                console.log(`> 订单 ${order.order_no} 结算完成`);
cron\finance\dailySettle.js:63:        console.log('=== 每日结算执行成功 ===');
cron\finance\dailySettle.js:67:        console.error('❌ 结算失败:', error.message);
cron\finance\dailySettle.js:81:runDailySettlement();
jobs\autoAcceptance.js:7: * - 更新订单状态并触发结算流程
jobs\autoAcceptance.js:212:        // 触发结算流程（异步，不阻塞）
jobs\autoAcceptance.js:213:        triggerSettlement(order_id).catch(err => {
jobs\autoAcceptance.js:214:          console.error(`[自动验收任务] 触发结算失败，订单: ${order_id}`, err);
jobs\autoAcceptance.js:253: * 触发结算流程
jobs\autoAcceptance.js:257:async function triggerSettlement(orderId) {
jobs\autoAcceptance.js:258:  // TODO: 调用结算模块的API或事件
jobs\autoAcceptance.js:259:  console.log(`[自动验收任务] 触发结算流程，订单: ${orderId}`);
jobs\autoAcceptance.js:264:  // 示例：调用结算服务
jobs\autoAcceptance.js:265:  // await settlementService.startSettlement(orderId, 'auto_accepted');
jobs\autoAcceptance.js:289:  //   message: '订单已自动验收，款项将在36小时内结算'
tasks\autoSettlement.js:2: * 36小时自动结算定时任务
tasks\autoSettlement.js:3: * 路径：backend/tasks/autoSettlement.js
tasks\autoSettlement.js:7: * 2. 排除 status=in_arbitration 的订单（仲裁中不结算）
tasks\autoSettlement.js:9: * 4. 记录结算日志
tasks\autoSettlement.js:31: * 执行自动结算
tasks\autoSettlement.js:34:async function runAutoSettlement() {
tasks\autoSettlement.js:46:    console.log(`[${new Date().toISOString()}] 开始执行自动结算任务...`);
tasks\autoSettlement.js:48:    // 查询待结算订单
tasks\autoSettlement.js:67:    console.log(`找到 ${pendingOrders.length} 个待结算订单`);
tasks\autoSettlement.js:89:        // 执行结算
tasks\autoSettlement.js:99:        // 记录结算日志（如果有结算日志表）
tasks\autoSettlement.js:102:            INSERT INTO settlement_logs
tasks\autoSettlement.js:103:            (order_id, order_no, amount, worker_id, settlement_type, created_at)
tasks\autoSettlement.js:111:          console.log('结算日志记录失败（表可能不存在）:', logError.message);
tasks\autoSettlement.js:123:        console.log(`✓ 订单 ${order.order_no} 已结算，金额: ¥${order.total_amount}`);
tasks\autoSettlement.js:133:        console.error(`✗ 订单 ${order.order_no} 结算失败:`, orderError.message);
tasks\autoSettlement.js:138:    console.log(`[${new Date().toISOString()}] 自动结算任务完成`);
tasks\autoSettlement.js:147:    console.error('自动结算任务执行失败:', error);
tasks\autoSettlement.js:154: * 检查待结算订单数量
tasks\autoSettlement.js:157:async function checkPendingSettlements() {
tasks\autoSettlement.js:182: * 手动触发单个订单结算
tasks\autoSettlement.js:184: * @returns {Object} 结算结果
tasks\autoSettlement.js:198:      return { success: false, message: '只有已完成的订单可以结算' };
tasks\autoSettlement.js:202:      return { success: false, message: '仲裁中的订单不能结算' };
tasks\autoSettlement.js:216:      message: '订单结算成功',
tasks\autoSettlement.js:226:      message: '结算失败',
tasks\autoSettlement.js:232:// 如果直接运行此文件，执行一次结算任务
tasks\autoSettlement.js:234:  runAutoSettlement()
tasks\autoSettlement.js:236:      console.log('\n结算结果:', JSON.stringify(result, null, 2));
tasks\autoSettlement.js:246:  runAutoSettlement,
tasks\autoSettlement.js:247:  checkPendingSettlements,
tasks\leaderTasks.js:7: * 2. 每月1号结算上月佣金（可选）
tasks\leaderTasks.js:36:    // 每月1号凌晨3点进行月度结算统计
tasks\leaderTasks.js:38:      await this.monthlySettlement();
tasks\leaderTasks.js:167:   * 月度结算统计
tasks\leaderTasks.js:169:  async monthlySettlement() {
tasks\leaderTasks.js:176:      console.log(`[月度结算] 开始处理 ${lastMonth} 的佣金结算`);
tasks\leaderTasks.js:178:      // 查找所有待结算的佣金记录
tasks\leaderTasks.js:187:        console.log('[月度结算] 没有待结算的佣金记录');
tasks\leaderTasks.js:206:      console.log(`[月度结算] ${lastMonth} 共有 ${Object.keys(leaderStats).length} 位队长待结
算`);
tasks\leaderTasks.js:211:        console.log(`[月度结算] 队长 ${leaderId}: ${stats.count}笔, 共 ${(stats.total / 100).t
oFixed(2)}元`);
tasks\leaderTasks.js:216:        // 更新状态为已结算（在实际打款成功后）
tasks\leaderTasks.js:223:      console.log('[月度结算] 结算统计完成');
tasks\leaderTasks.js:226:      console.error('[月度结算] 任务执行失败:', error);
tasks\leaderTasks.js:236:    const random = Math.random().toString(36).substring(2, 8).toUpperCase();
tasks\leaderTasks.js:241:   * 获取当前结算周期
tasks\orderTasks.js:6: * 1. 36小时自动结算（每分钟）
tasks\orderTasks.js:36:    // 任务1: 36小时自动结算（每分钟执行）
tasks\orderTasks.js:42:          console.error('[自动结算] 任务执行失败:', error.message);
tasks\orderTasks.js:92:    console.log('   - 自动结算: 每分钟检查');
tasks\orderTasks.js:109:   * 任务1: 36小时自动结算
tasks\orderTasks.js:114:   * - 自动结算给家政员
tasks\orderTasks.js:120:      // 查找需要自动结算的订单
tasks\orderTasks.js:135:      console.log(`[自动结算] 发现 ${orders.length} 个待结算订单`);
tasks\orderTasks.js:153:           VALUES (?, 'pending_confirm', 'completed', '36小时无异议自动结算', 'system', '系统',
 NOW())`,
tasks\orderTasks.js:157:        // TODO: 结算金额到家政员账户（需要钱包模块支持）
tasks\orderTasks.js:159:        console.log(`[自动结算] 订单 ${order.order_no} 已自动结算`);
tasks\orderTasks.js:163:      console.log(`[自动结算] 成功结算 ${orders.length} 个订单`);




PS D:\housekeeping-platform\backend> Get-ChildItem -Path .\cron,.\jobs,.\tasks -Recurse -Filter *.js | Select-String -Pattern "sop|SOP"


jobs\acceptanceReminder.js:10:const { OrderSopRecord, Order, User, Worker } = require('../models');
jobs\acceptanceReminder.js:157:    // 只查询 OrderSopRecord 中存在的字段
jobs\acceptanceReminder.js:158:    const orders = await OrderSopRecord.findAll({
jobs\acceptanceReminder.js:184:    for (const sopRecord of orders) {
jobs\acceptanceReminder.js:185:      const orderId = sopRecord.order_id;
jobs\acceptanceReminder.js:193:          customerId: sopRecord.order?.customer_id,
jobs\acceptanceReminder.js:194:          customerPhone: sopRecord.order?.customer?.phone,
jobs\acceptanceReminder.js:195:          workerName: sopRecord.order?.worker?.name,
jobs\acceptanceReminder.js:196:          serviceType: sopRecord.order?.service_name,
jobs\acceptanceReminder.js:200:          serviceEndTime: sopRecord.service_end_time
jobs\acceptanceReminder.js:298:  const sopRecord = await OrderSopRecord.findOne({
jobs\acceptanceReminder.js:311:  if (!sopRecord) {
jobs\acceptanceReminder.js:312:    throw new Error(`订单 ${orderId} 的SOP记录不存在`);
jobs\acceptanceReminder.js:319:    customerId: sopRecord.order?.customer_id,
jobs\acceptanceReminder.js:320:    customerPhone: sopRecord.order?.customer?.phone,
jobs\acceptanceReminder.js:321:    workerName: sopRecord.order?.worker?.name,
jobs\acceptanceReminder.js:322:    serviceType: sopRecord.order?.service_name,
jobs\acceptanceReminder.js:326:    serviceEndTime: sopRecord.service_end_time
jobs\autoAcceptance.js:18:const { OrderSopRecord, Order } = require('../models');
jobs\autoAcceptance.js:115:    const pendingOrders = await OrderSopRecord.findAll({
jobs\autoAcceptance.js:139:    for (const sopRecord of pendingOrders) {
jobs\autoAcceptance.js:140:      const result = await processAutoAcceptance(sopRecord);
jobs\autoAcceptance.js:166: * @param {Object} sopRecord - SOP记录
jobs\autoAcceptance.js:169:async function processAutoAcceptance(sopRecord) {
jobs\autoAcceptance.js:170:  const { order_id, service_end_time } = sopRecord;
jobs\autoAcceptance.js:177:      const transaction = await OrderSopRecord.sequelize.transaction();
jobs\autoAcceptance.js:181:        const currentRecord = await OrderSopRecord.findOne({
jobs\autoAcceptance.js:198:        // 更新SOP记录状态
jobs\autoAcceptance.js:199:        await OrderSopRecord.update({
jobs\autoAcceptance.js:272: * @param {Object} sopRecord - SOP记录
jobs\autoAcceptance.js:274:async function sendAutoAcceptanceNotification(orderId, sopRecord) {
jobs\autoAcceptance.js:279:  // await notificationService.sendToCustomer(sopRecord.customer_id, {
jobs\autoAcceptance.js:286:  // await notificationService.sendToWorker(sopRecord.worker_id, {
jobs\autoAcceptance.js:374:    const sopRecord = await OrderSopRecord.findOne({
jobs\autoAcceptance.js:378:    if (!sopRecord) {
jobs\autoAcceptance.js:379:      throw new Error(`订单 ${orderId} 的SOP记录不存在`);
jobs\autoAcceptance.js:382:    return await processAutoAcceptance(sopRecord);




PS D:\housekeeping-platform\backend> Select-String -Path .\controllers\orderController.js -Pattern "create|insert|sop"


controllers\orderController.js:14:exports.createOrder = async (req, res) => {
controllers\orderController.js:71:    const order = await Order.create({
controllers\orderController.js:220:    const result = await paymentService.createPayment({




PS D:\housekeeping-platform\backend> Select-String -Path .\routes\admin\order.js -Pattern "router.post|sop"


routes\admin\order.js:196:router.post('/', async (req, res) => {




PS D:\housekeeping-platform\backend> Get-ChildItem -Path . -Recurse -Filter *.js | Select-String -Pattern "Order.create|createOrder|新建订单" | Select-Object -First 10


app-api-fixed.js:641:      created_at: order.created_at ? new Date(order.created_at).toISOString() : null,
app-api.js:607:      created_at: order.created_at ? new Date(order.created_at).toISOString() : null
check-order-status.js:47:      console.log(`     创建时间: ${order.created_at}`);
controllers\orderController.js:14:exports.createOrder = async (req, res) => {
controllers\orderController.js:71:    const order = await Order.create({
controllers\ordersController.js:27:  async createOrder(req, res) {
controllers\ordersController.js:76:      const order = await Order.create({
models\MessageTemplate.js:16:      comment: '模板编码，如 ORDER_CREATED, ORDER_COMPLETED'




PS D:\housekeeping-platform\backend> Select-String -Path .\controllers\ordersController.js -Pattern "createOrder" -Context 20,20


  controllers\ordersController.js:7:const OrderEvent = db.OrderEvent;
  controllers\ordersController.js:8:const Service = db.Service;
  controllers\ordersController.js:9:const User = db.User;
  controllers\ordersController.js:10:const WorkerProfile = db.WorkerProfile;
  controllers\ordersController.js:11:const CustomerProfile = db.CustomerProfile;
  controllers\ordersController.js:12:
  controllers\ordersController.js:13:// 生成订单号
  controllers\ordersController.js:14:function generateOrderNo() {
  controllers\ordersController.js:15:  const date = new Date();
  controllers\ordersController.js:16:  const year = date.getFullYear().toString().slice(2);
  controllers\ordersController.js:17:  const month = (date.getMonth() + 1).toString().padStart(2, '0');
  controllers\ordersController.js:18:  const day = date.getDate().toString().padStart(2, '0');
  controllers\ordersController.js:19:  const random = Math.floor(Math.random() * 1000).toString().padStart(3, '0');
  controllers\ordersController.js:20:  return `ORD${year}${month}${day}${random}`;
  controllers\ordersController.js:21:}
  controllers\ordersController.js:22:
  controllers\ordersController.js:23:const ordersController = {
  controllers\ordersController.js:24:  // ========== 基础订单操作 ==========
  controllers\ordersController.js:25:
  controllers\ordersController.js:26:  // 创建订单
> controllers\ordersController.js:27:  async createOrder(req, res) {
  controllers\ordersController.js:28:    try {
  controllers\ordersController.js:29:      const userId = req.user.id;
  controllers\ordersController.js:30:      const {
  controllers\ordersController.js:31:        service_id,
  controllers\ordersController.js:32:        scheduled_time,
  controllers\ordersController.js:33:        address,
  controllers\ordersController.js:34:        lat,
  controllers\ordersController.js:35:        lng,
  controllers\ordersController.js:36:        price_cents,
  controllers\ordersController.js:37:        customer_notes,
  controllers\ordersController.js:38:        pre_assigned_worker_id, // 可选：指定家政员ID
  controllers\ordersController.js:39:        order_type = 'platform' // platform 或 assigned
  controllers\ordersController.js:40:      } = req.body;
  controllers\ordersController.js:41:
  controllers\ordersController.js:42:      // 参数验证
  controllers\ordersController.js:43:      if (!service_id || !scheduled_time || !address || !price_cents) {
  controllers\ordersController.js:44:        return res.status(400).json({
  controllers\ordersController.js:45:          success: false,
  controllers\ordersController.js:46:          message: '服务、预约时间、地址和价格不能为空'
  controllers\ordersController.js:47:        });




PS D:\housekeeping-platform\backend> Select-String -Path .\controllers\orderController.js -Pattern "sop|template|SOP"
PS D:\housekeeping-platform\backend> Select-String -Path .\controllers\ordersController.js -Pattern "sop|template|SOP"
PS D:\housekeeping-platform\backend>




D:\housekeeping-platform\backend>findstr /s /i /n "order_sop_records" *.js
models\orderSopRecord.js:3: * 瀵瑰簲鏁版嵁搴撹〃: order_sop_records
models\orderSopRecord.js:46:    tableName: 'order_sop_records',


D:\housekeeping-platform\backend>findstr /s /i /n "sop_checklists" *.js
models\sopChecklist - 副本.js:4: * 瀵瑰簲鏁版嵁搴撹〃: sop_checklists
models\sopChecklist - 副本.js:93:    tableName: 'sop_checklists',
models\sopChecklist.js:4: * 瀵瑰簲鏁版嵁搴撹〃: sop_checklists
models\sopChecklist.js:93:    tableName: 'sop_checklists',


D:\housekeeping-platform\backend>findstr /s /i /n "template_id" *.js
jobs\acceptanceReminder.js:58:      templateId: process.env.WECHAT_REMINDER_TEMPLATE_ID
libs\notification.js:47:      //   template_id: templateId,
models\index - 副本.js:10:OrderSopRecord.belongsTo(SopTemplate, { foreignKey: 'template_id', as: 'template' });
models\index - 副本.js:11:SopTemplate.hasMany(OrderSopRecord, { foreignKey: 'template_id', as: 'records' });
models\index.js:408:SopTemplate.hasMany(OrderSopRecord, { foreignKey: 'template_id', as: 'records' });
models\index.js:409:OrderSopRecord.belongsTo(SopTemplate, { foreignKey: 'template_id', as: 'template' });
models\index.js:420:SopChecklist.belongsTo(SopTemplate, { as: 'template', foreignKey: 'template_id' });
models\index_wrong.js:19:  foreignKey: 'template_id',
models\index_wrong.js:23:  foreignKey: 'template_id',
models\MessageTemplate.js:24:    wechat_template_id: {
models\MessageTemplate.js:35:    sms_template_id: {
models\orderSopRecord.js:12:    template_id: { type: DataTypes.INTEGER, allowNull: false },
models\sopChecklist - 副本.js:22:    template_id: {
models\sopChecklist.js:22:    template_id: {
routes\admin\sopChecklist - 副本 (2).js:432:      template_id: templateId,
routes\admin\sopChecklist.js:432:      template_id: templateId,
services\messageService.js:143:    if (!template.wechat_template_id) {
services\messageService.js:172:        template_id: template.wechat_template_id,
services\messageService.js:262:    if (!template.sms_template_id) {
services\messageService.js:334:      TemplateCode: template.sms_template_id,
tasks\jurorDecayTasks.js:163:    //   template_id: 'xxx',


D:\housekeeping-platform\backend>findstr /s /i /n "cron" *.js
cron\finance\dailySettle.js:3: * 璺緞: backend/cron/finance/dailySettle.js
cron\finance\dailySettle.js:4: * 杩愯鏂瑰紡: node cron/finance/dailySettle.js
jobs\acceptanceReminder.js:28:  cronExpression: '* * * * *',
jobs\acceptanceReminder.js:98:  scheduledJob = schedule.scheduleJob(CONFIG.cronExpression, async () => {
jobs\acceptanceReminder.js:106:  console.log(`[楠屾敹鎻愰啋浠诲姟] 宸插惎鍔紝鎵ц璁″垝: ${CONFIG.cronExpression}`);
jobs\acceptanceReminder.js:338:      cronExpression: CONFIG.cronExpression,
jobs\autoAcceptance.js:26:  cronExpression: '*/5 * * * *',
jobs\autoAcceptance.js:76:  scheduledJob = schedule.scheduleJob(CONFIG.cronExpression, async () => {
jobs\autoAcceptance.js:80:  console.log(`[鑷姩楠屾敹浠诲姟] 宸插惎鍔紝鎵ц璁″垝: ${CONFIG.cronExpression}`);
node_modules\bull\lib\repeatable.js:4:const parser = require('cron-parser');
node_modules\bull\lib\repeatable.js:151:      cron: data[4]
node_modules\bull\lib\repeatable.js:171:          tz: data.cron ? data.tz : null,
node_modules\bull\lib\repeatable.js:172:          cron: data.cron || null,
node_modules\bull\lib\repeatable.js:173:          every: !data.cron ? parseInt(data.tz) : null,
node_modules\bull\lib\repeatable.js:194:    const suffix = repeat.cron ? tz + repeat.cron : String(repeat.every);
node_modules\bull\lib\repeatable.js:200:    if (opts.cron && opts.every) {
node_modules\bull\lib\repeatable.js:202:        'Both .cron and .every options are defined for this repeatable job'
node_modules\bull\lib\repeatable.js:215:      opts.cron,
node_modules\cron-parser\lib\date.js:5:CronDate.prototype.addYear = function() {
node_modules\cron-parser\lib\date.js:9:CronDate.prototype.addMonth = function() {
node_modules\cron-parser\lib\date.js:13:CronDate.prototype.addDay = function() {
node_modules\cron-parser\lib\date.js:17:CronDate.prototype.addHour = function() {
node_modules\cron-parser\lib\date.js:25:CronDate.prototype.addMinute = function() {
node_modules\cron-parser\lib\date.js:33:CronDate.prototype.addSecond = function() {
node_modules\cron-parser\lib\date.js:41:CronDate.prototype.subtractYear = function() {
node_modules\cron-parser\lib\date.js:45:CronDate.prototype.subtractMonth = function() {
node_modules\cron-parser\lib\date.js:52:CronDate.prototype.subtractDay = function() {
node_modules\cron-parser\lib\date.js:59:CronDate.prototype.subtractHour = function() {
node_modules\cron-parser\lib\date.js:70:CronDate.prototype.subtractMinute = function() {
node_modules\cron-parser\lib\date.js:80:CronDate.prototype.subtractSecond = function() {
node_modules\cron-parser\lib\date.js:90:CronDate.prototype.getDate = function() {
node_modules\cron-parser\lib\date.js:94:CronDate.prototype.getFullYear = function() {
node_modules\cron-parser\lib\date.js:98:CronDate.prototype.getDay = function() {
node_modules\cron-parser\lib\date.js:103:CronDate.prototype.getMonth = function() {
node_modules\cron-parser\lib\date.js:107:CronDate.prototype.getHours = function() {
node_modules\cron-parser\lib\date.js:111:CronDate.prototype.getMinutes = function() {
node_modules\cron-parser\lib\date.js:115:CronDate.prototype.getSeconds = function() {
node_modules\cron-parser\lib\date.js:119:CronDate.prototype.getMilliseconds = function() {
node_modules\cron-parser\lib\date.js:123:CronDate.prototype.getTime = function() {
node_modules\cron-parser\lib\date.js:127:CronDate.prototype.getUTCDate = function() {
node_modules\cron-parser\lib\date.js:131:CronDate.prototype.getUTCFullYear = function() {
node_modules\cron-parser\lib\date.js:135:CronDate.prototype.getUTCDay = function() {
node_modules\cron-parser\lib\date.js:140:CronDate.prototype.getUTCMonth = function() {
node_modules\cron-parser\lib\date.js:144:CronDate.prototype.getUTCHours = function() {
node_modules\cron-parser\lib\date.js:148:CronDate.prototype.getUTCMinutes = function() {
node_modules\cron-parser\lib\date.js:152:CronDate.prototype.getUTCSeconds = function() {
node_modules\cron-parser\lib\date.js:156:CronDate.prototype.toISOString = function() {
node_modules\cron-parser\lib\date.js:160:CronDate.prototype.toJSON = function() {
node_modules\cron-parser\lib\date.js:164:CronDate.prototype.setDate = function(d) {
node_modules\cron-parser\lib\date.js:168:CronDate.prototype.setFullYear = function(y) {
node_modules\cron-parser\lib\date.js:172:CronDate.prototype.setDay = function(d) {
node_modules\cron-parser\lib\date.js:176:CronDate.prototype.setMonth = function(m) {
node_modules\cron-parser\lib\date.js:180:CronDate.prototype.setHours = function(h) {
node_modules\cron-parser\lib\date.js:184:CronDate.prototype.setMinutes = function(m) {
node_modules\cron-parser\lib\date.js:188:CronDate.prototype.setSeconds = function(s) {
node_modules\cron-parser\lib\date.js:192:CronDate.prototype.setMilliseconds = function(s) {
node_modules\cron-parser\lib\date.js:196:CronDate.prototype._getUTC = function() {
node_modules\cron-parser\lib\date.js:200:CronDate.prototype.toString = function() {
node_modules\cron-parser\lib\date.js:204:CronDate.prototype.toDate = function() {
node_modules\cron-parser\lib\date.js:208:CronDate.prototype.isLastDayOfMonth = function() {
node_modules\cron-parser\lib\date.js:218:CronDate.prototype.isLastWeekdayOfMonth = function() {
node_modules\cron-parser\lib\date.js:225:function CronDate (timestamp, tz) {
node_modules\cron-parser\lib\date.js:229:  } else if (timestamp instanceof CronDate) {
node_modules\cron-parser\lib\date.js:244:    throw new Error('CronDate: unhandled timestamp: ' + JSON.stringify(timestamp));
node_modules\cron-parser\lib\date.js:252:module.exports = CronDate;
node_modules\cron-parser\lib\expression.js:4:var CronDate = require('./date');
node_modules\cron-parser\lib\expression.js:9: * Cron iteration loop safety limit
node_modules\cron-parser\lib\expression.js:25:function CronExpression (fields, options) {
node_modules\cron-parser\lib\expression.js:29:  this._currentDate = new CronDate(options.currentDate, this._tz);
node_modules\cron-parser\lib\expression.js:30:  this._startDate = options.startDate ? new CronDate(options.startDate, this._tz) : null;
node_modules\cron-parser\lib\expression.js:31:  this._endDate = options.endDate ? new CronDate(options.endDate, this._tz) : null;
node_modules\cron-parser\lib\expression.js:35:  this.fields = CronExpression._freezeFields(fields);
node_modules\cron-parser\lib\expression.js:42:CronExpression.map = [ 'second', 'minute', 'hour', 'dayOfMonth', 'month', 'dayOfWeek' ];
node_modules\cron-parser\lib\expression.js:48:CronExpression.predefined = {
node_modules\cron-parser\lib\expression.js:60:CronExpression.constraints = [
node_modules\cron-parser\lib\expression.js:73:CronExpression.daysInMonth = [
node_modules\cron-parser\lib\expression.js:92:CronExpression.aliases = {
node_modules\cron-parser\lib\expression.js:123:CronExpression.parseDefaults = [ '0', '*', '*', '*', '*', '*' ];
node_modules\cron-parser\lib\expression.js:125:CronExpression.standardValidCharacters = /^[,*\d/-]+$/;
node_modules\cron-parser\lib\expression.js:126:CronExpression.dayOfWeekValidCharacters = /^[?,*\dL#/-]+$/;
node_modules\cron-parser\lib\expression.js:127:CronExpression.dayOfMonthValidCharacters = /^[?,*\dL/-]+$/;
node_modules\cron-parser\lib\expression.js:128:CronExpression.validCharacters = {
node_modules\cron-parser\lib\expression.js:129:  second: CronExpression.standardValidCharacters,
node_modules\cron-parser\lib\expression.js:130:  minute: CronExpression.standardValidCharacters,
node_modules\cron-parser\lib\expression.js:131:  hour: CronExpression.standardValidCharacters,
node_modules\cron-parser\lib\expression.js:132:  dayOfMonth: CronExpression.dayOfMonthValidCharacters,
node_modules\cron-parser\lib\expression.js:133:  month: CronExpression.standardValidCharacters,
node_modules\cron-parser\lib\expression.js:134:  dayOfWeek: CronExpression.dayOfWeekValidCharacters,
node_modules\cron-parser\lib\expression.js:137:CronExpression._isValidConstraintChar = function _isValidConstraintChar(constraints, value) {
node_modules\cron-parser\lib\expression.js:156:CronExpression._parseField = function _parseField (field, value, constraints) {
node_modules\cron-parser\lib\expression.js:161:      var aliases = CronExpression.aliases[field];
node_modules\cron-parser\lib\expression.js:176:  if (!(CronExpression.validCharacters[field].test(value))) {
node_modules\cron-parser\lib\expression.js:210:          if (CronExpression._isValidConstraintChar(constraints, value)) {
node_modules\cron-parser\lib\expression.js:226:        if (CronExpression._isValidConstraintChar(constraints, result)) {
node_modules\cron-parser\lib\expression.js:264:    stack.sort(CronExpression._sortCompareFn);
node_modules\cron-parser\lib\expression.js:366:CronExpression._sortCompareFn = function(a, b) {
node_modules\cron-parser\lib\expression.js:385:CronExpression._handleMaxDaysInMonth = function(mappedFields) {
node_modules\cron-parser\lib\expression.js:388:    var daysInMonth = CronExpression.daysInMonth[mappedFields.month[0] - 1];
node_modules\cron-parser\lib\expression.js:398:      .sort(CronExpression._sortCompareFn);
node_modules\cron-parser\lib\expression.js:402:CronExpression._freezeFields = function(fields) {
node_modules\cron-parser\lib\expression.js:403:  for (var i = 0, c = CronExpression.map.length; i < c; ++i) {
node_modules\cron-parser\lib\expression.js:404:    var field = CronExpression.map[i]; // Field name
node_modules\cron-parser\lib\expression.js:411:CronExpression.prototype._applyTimezoneShift = function(currentDate, dateMathVerb, method) {
node_modules\cron-parser\lib\expression.js:453: * @return {CronDate}
node_modules\cron-parser\lib\expression.js:456:CronExpression.prototype._findSchedule = function _findSchedule (reverse) {
node_modules\cron-parser\lib\expression.js:480:   * @param {CronDate} date
node_modules\cron-parser\lib\expression.js:520:  var currentDate = new CronDate(this._currentDate, this._tz);
node_modules\cron-parser\lib\expression.js:569:    // http://unixhelp.ed.ac.uk/CGI/man-cgi?crontab+5
node_modules\cron-parser\lib\expression.js:580:    var isDayOfMonthWildcardMatch = this.fields.dayOfMonth.length >= CronExpression.daysInMonth[currentDate.getMonth()];
node_modules\cron-parser\lib\expression.js:581:    var isDayOfWeekWildcardMatch = this.fields.dayOfWeek.length === CronExpression.constraints[5].max - CronExpression.constraints[5].min + 1;
node_modules\cron-parser\lib\expression.js:666:  this._currentDate = new CronDate(currentDate, this._tz);
node_modules\cron-parser\lib\expression.js:676: * @return {CronDate|Object}
node_modules\cron-parser\lib\expression.js:678:CronExpression.prototype.next = function next () {
node_modules\cron-parser\lib\expression.js:696: * @return {CronDate|Object}
node_modules\cron-parser\lib\expression.js:698:CronExpression.prototype.prev = function prev () {
node_modules\cron-parser\lib\expression.js:718:CronExpression.prototype.hasNext = function() {
node_modules\cron-parser\lib\expression.js:739:CronExpression.prototype.hasPrev = function() {
node_modules\cron-parser\lib\expression.js:762:CronExpression.prototype.iterate = function iterate (steps, callback) {
node_modules\cron-parser\lib\expression.js:803:CronExpression.prototype.reset = function reset (newDate) {
node_modules\cron-parser\lib\expression.js:804:  this._currentDate = new CronDate(newDate || this._options.currentDate);
node_modules\cron-parser\lib\expression.js:814:CronExpression.prototype.stringify = function stringify(includeSeconds) {
node_modules\cron-parser\lib\expression.js:816:  for (var i = includeSeconds ? 0 : 1, c = CronExpression.map.length; i < c; ++i) {
node_modules\cron-parser\lib\expression.js:817:    var field = CronExpression.map[i];
node_modules\cron-parser\lib\expression.js:819:    var constraint = CronExpression.constraints[i];
node_modules\cron-parser\lib\expression.js:822:      constraint = { min: 1, max: CronExpression.daysInMonth[this.fields.month[0] - 1] };
node_modules\cron-parser\lib\expression.js:841:CronExpression.parse = function parse(expression, options) {
node_modules\cron-parser\lib\expression.js:853:      options.currentDate = new CronDate(undefined, self._tz);
node_modules\cron-parser\lib\expression.js:857:    if (CronExpression.predefined[expression]) {
node_modules\cron-parser\lib\expression.js:858:      expression = CronExpression.predefined[expression];
node_modules\cron-parser\lib\expression.js:866:      throw new Error('Invalid cron expression');
node_modules\cron-parser\lib\expression.js:870:    var start = (CronExpression.map.length - atoms.length);
node_modules\cron-parser\lib\expression.js:871:    for (var i = 0, c = CronExpression.map.length; i < c; ++i) {
node_modules\cron-parser\lib\expression.js:872:      var field = CronExpression.map[i]; // Field name
node_modules\cron-parser\lib\expression.js:876:        fields.push(CronExpression._parseField(
node_modules\cron-parser\lib\expression.js:878:          CronExpression.parseDefaults[i],
node_modules\cron-parser\lib\expression.js:879:          CronExpression.constraints[i]
node_modules\cron-parser\lib\expression.js:885:        fields.push(CronExpression._parseField(
node_modules\cron-parser\lib\expression.js:888:          CronExpression.constraints[i]
node_modules\cron-parser\lib\expression.js:895:    for (var i = 0, c = CronExpression.map.length; i < c; i++) {
node_modules\cron-parser\lib\expression.js:896:      var key = CronExpression.map[i];
node_modules\cron-parser\lib\expression.js:900:    var dayOfMonth = CronExpression._handleMaxDaysInMonth(mappedFields);
node_modules\cron-parser\lib\expression.js:902:    return new CronExpression(mappedFields, options);
node_modules\cron-parser\lib\expression.js:942: * Convert cron fields back to Cron Expression
node_modules\cron-parser\lib\expression.js:949:CronExpression.fieldsToExpression = function fieldsToExpression(fields, options) {
node_modules\cron-parser\lib\expression.js:960:      if (CronExpression._isValidConstraintChar(constraints, value)) {
node_modules\cron-parser\lib\expression.js:975:  for (var i = 0, c = CronExpression.map.length; i < c; ++i) {
node_modules\cron-parser\lib\expression.js:976:    var field = CronExpression.map[i]; // Field name
node_modules\cron-parser\lib\expression.js:981:      CronExpression.constraints[i]
node_modules\cron-parser\lib\expression.js:988:    values = copy.sort(CronExpression._sortCompareFn)
node_modules\cron-parser\lib\expression.js:997:  var dayOfMonth = CronExpression._handleMaxDaysInMonth(mappedFields);
node_modules\cron-parser\lib\expression.js:999:  return new CronExpression(mappedFields, options || {});
node_modules\cron-parser\lib\expression.js:1002:module.exports = CronExpression;
node_modules\cron-parser\lib\parser.js:3:var CronExpression = require('./expression');
node_modules\cron-parser\lib\parser.js:5:function CronParser() {}
node_modules\cron-parser\lib\parser.js:8: * Parse crontab entry
node_modules\cron-parser\lib\parser.js:11: * @param {String} entry Crontab file entry/line
node_modules\cron-parser\lib\parser.js:13:CronParser._parseEntry = function _parseEntry (entry) {
node_modules\cron-parser\lib\parser.js:18:      interval: CronExpression.parse(entry)
node_modules\cron-parser\lib\parser.js:22:      interval: CronExpression.parse(
node_modules\cron-parser\lib\parser.js:33: * Wrapper for CronExpression.parser method
node_modules\cron-parser\lib\parser.js:40:CronParser.parseExpression = function parseExpression (expression, options) {
node_modules\cron-parser\lib\parser.js:41:  return CronExpression.parse(expression, options);
node_modules\cron-parser\lib\parser.js:45: * Wrapper for CronExpression.fieldsToExpression method
node_modules\cron-parser\lib\parser.js:52:CronParser.fieldsToExpression = function fieldsToExpression (fields, options) {
node_modules\cron-parser\lib\parser.js:53:  return CronExpression.fieldsToExpression(fields, options);
node_modules\cron-parser\lib\parser.js:60: * @param {String} data Crontab content
node_modules\cron-parser\lib\parser.js:63:CronParser.parseString = function parseString (data) {
node_modules\cron-parser\lib\parser.js:86:          result = CronParser._parseEntry('0 ' + entry);
node_modules\cron-parser\lib\parser.js:99: * Parse crontab file
node_modules\cron-parser\lib\parser.js:105:CronParser.parseFile = function parseFile (filePath, callback) {
node_modules\cron-parser\lib\parser.js:112:    return callback(null, CronParser.parseString(data.toString()));
node_modules\cron-parser\lib\parser.js:116:module.exports = CronParser;
node_modules\esprima\dist\esprima.js:6420:          Omicron: '\u039F',
node_modules\esprima\dist\esprima.js:6444:          omicron: '\u03BF',
node_modules\exifr\dist\full.esm.js:1:var e="undefined"!=typeof self?self:global;const t="undefined"!=typeof navigator,i=t&&"undefined"==typeof HTMLImageElement,n=!("undefined"==typeof global||"undefined"==typeof process||!process.versions||!process.versions.node),s=e.Buffer,r=e.BigInt,a=!!s,o=e=>e;function l(e,t=o){if(n)try{return"function"==typeof require?Promise.resolve(t(require(e))):import(/* webpackIgnore: true */ e).then(t)}catch(t){console.warn(`Couldn't load ${e}`)}}let h=e.fetch;const u=e=>h=e;if(!e.fetch){const e=l("http",(e=>e)),t=l("https",(e=>e)),i=(n,{headers:s}={})=>new Promise((async(r,a)=>{let{port:o,hostname:l,pathname:h,protocol:u,search:c}=new URL(n);const f={method:"GET",hostname:l,path:encodeURI(h)+c,headers:s};""!==o&&(f.port=Number(o));const d=("https:"===u?await t:await e).request(f,(e=>{if(301===e.statusCode||302===e.statusCode){let t=new URL(e.headers.location,n).toString();return i(t,{headers:s}).then(r).catch(a)}r({status:e.statusCode,arrayBuffer:()=>new Promise((t=>{let i=[];e.on("data",(e=>i.push(e))),e.on("end",(()=>t(Buffer.concat(i))))}))})}));d.on("error",a),d.end()}));u(i)}function c(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const f=e=>p(e)?void 0:e,d=e=>void 0!==e;function p(e){return void 0===e||(e instanceof Map?0===e.size:0===Object.values(e).filter(d).length)}function g(e){let t=new Error(e);throw delete t.stack,t}function m(e){return""===(e=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(e).trim())?void 0:e}function S(e){let t=function(e){let t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}const C=e=>String.fromCharCode.apply(null,e),y="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;function b(e){return y?y.decode(e):a?Buffer.from(e).toString("utf8"):decodeURIComponent(escape(C(e)))}class I{static from(e,t){return e instanceof this&&e.le===t?e:new I(e,void 0,void 0,t)}constructor(e,t=0,i,n){if("boolean"==typeof n&&(this.le=n),Array.isArray(e)&&(e=new Uint8Array(e)),0===e)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){void 0===i&&(i=e.byteLength-t);let n=new DataView(e,t,i);this._swapDataView(n)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof I){void 0===i&&(i=e.byteLength-t),(t+=e.byteOffset)+i>e.byteOffset+e.byteLength&&g("Creating view outside of available memory in ArrayBuffer");let n=new DataView(e.buffer,t,i);this._swapDataView(n)}else if("number"==typeof e){let t=new DataView(new ArrayBuffer(e));this._swapDataView(t)}else g("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,i=I){return e instanceof DataView||e instanceof I?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||g("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new i(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new I(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return b(this.getUint8Array(e,t))}getLatin1String(e=0,t=this.byteLength){let i=this.getUint8Array(e,t);return C(i)}getUnicodeString(e=0,t=this.byteLength){const i=[];for(let n=0;n<t&&e+n<this.byteLength;n+=2)i.push(this.getUint16(e+n));return C(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,i){switch(t){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,t,i){switch(t){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function P(e,t){g(`${e} '${t}' was not loaded, try using full build of exifr.`)}class k extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||P(this.kind,e),t&&(e in t||function(e,t){g(`Unknown ${e} '${t}'.`)}(this.kind,e),t[e].enabled||P(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var w=new k("file parser"),T=new k("segment parser"),A=new k("file reader");function D(e,n){return"string"==typeof e?O(e,n):t&&!i&&e instanceof HTMLImageElement?O(e.src,n):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new I(e):t&&e instanceof Blob?x(e,n,"blob",R):void g("Invalid input argument")}function O(e,i){return(s=e).startsWith("data:")||s.length>1e4?v(e,i,"base64"):n&&e.includes("://")?x(e,i,"url",M):n?v(e,i,"fs"):t?x(e,i,"url",M):void g("Invalid input argument");var s}async function x(e,t,i,n){return A.has(i)?v(e,t,i):n?async function(e,t){let i=await t(e);return new I(i)}(e,n):void g(`Parser ${i} is not loaded`)}async function v(e,t,i){let n=new(A.get(i))(e,t);return await n.read(),n}const M=e=>h(e).then((e=>e.arrayBuffer())),R=e=>new Promise(((t,i)=>{let n=new FileReader;n.onloadend=()=>t(n.result||new ArrayBuffer),n.onerror=i,n.readAsArrayBuffer(e)}));class L extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function U(e,t,i){let n=new L;for(let[e,t]of i)n.set(e,t);if(Array.isArray(t))for(let i of t)e.set(i,n);else e.set(t,n);return n}function F(e,t,i){let n,s=e.get(t);for(n of i)s.set(n[0],n[1])}const E=new Map,B=new Map,N=new Map,G=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],V=["jfif","xmp","icc","iptc","ihdr"],z=["tiff",...V],H=["ifd0","ifd1","exif","gps","interop"],j=[...z,...H],W=["makerNote","userComment"],K=["translateKeys","translateValues","reviveValues","multiSegment"],X=[...K,"sanitize","mergeOutput","silentErrors"];class _{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class Y extends _{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,i,n){if(super(),c(this,"enabled",!1),c(this,"skip",new Set),c(this,"pick",new Set),c(this,"deps",new Set),c(this,"translateKeys",!1),c(this,"translateValues",!1),c(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(n),this.canBeFiltered=H.includes(e),this.canBeFiltered&&(this.dict=E.get(e)),void 0!==i)if(Array.isArray(i))this.parse=this.enabled=!0,this.canBeFiltered&&i.length>0&&this.translateTagSet(i,this.pick);else if("object"==typeof i){if(this.enabled=!0,this.parse=!1!==i.parse,this.canBeFiltered){let{pick:e,skip:t}=i;e&&e.length>0&&this.translateTagSet(e,this.pick),t&&t.length>0&&this.translateTagSet(t,this.skip)}this.applyInheritables(i)}else!0===i||!1===i?this.parse=this.enabled=i:g(`Invalid options argument: ${i}`)}applyInheritables(e){let t,i;for(t of K)i=e[t],void 0!==i&&(this[t]=i)}translateTagSet(e,t){if(this.dict){let i,n,{tagKeys:s,tagValues:r}=this.dict;for(i of e)"string"==typeof i?(n=r.indexOf(i),-1===n&&(n=s.indexOf(Number(i))),-1!==n&&t.add(Number(s[n]))):t.add(i)}else for(let i of e)t.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,ee(this.pick,this.deps)):this.enabled&&this.pick.size>0&&ee(this.pick,this.deps)}}var $={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},J=new Map;class q extends _{static useCached(e){let t=J.get(e);return void 0!==t||(t=new this(e),J.set(e,t)),t}constructor(e){super(),!0===e?this.setupFromTrue():void 0===e?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):"object"==typeof e?this.setupFromObject(e):g(`Invalid options argument ${e}`),void 0===this.firstChunkSize&&(this.firstChunkSize=t?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of G)this[e]=$[e];for(e of X)this[e]=$[e];for(e of W)this[e]=$[e];for(e of j)this[e]=new Y(e,$[e],void 0,this)}setupFromTrue(){let e;for(e of G)this[e]=$[e];for(e of X)this[e]=$[e];for(e of W)this[e]=!0;for(e of j)this[e]=new Y(e,!0,void 0,this)}setupFromArray(e){let t;for(t of G)this[t]=$[t];for(t of X)this[t]=$[t];for(t of W)this[t]=$[t];for(t of j)this[t]=new Y(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,H)}setupFromObject(e){let t;for(t of(H.ifd0=H.ifd0||H.image,H.ifd1=H.ifd1||H.thumbnail,Object.assign(this,e),G))this[t]=Z(e[t],$[t]);for(t of X)this[t]=Z(e[t],$[t]);for(t of W)this[t]=Z(e[t],$[t]);for(t of z)this[t]=new Y(t,$[t],e[t],this);for(t of H)this[t]=new Y(t,$[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,H,j),!0===e.tiff?this.batchEnableWithBool(H,!0):!1===e.tiff?this.batchEnableWithUserValue(H,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,H):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,H)}batchEnableWithBool(e,t){for(let i of e)this[i].enabled=t}batchEnableWithUserValue(e,t){for(let i of e){let e=t[i];this[i].enabled=!1!==e&&void 0!==e}}setupGlobalFilters(e,t,i,n=i){if(e&&e.length){for(let e of n)this[e].enabled=!1;let t=Q(e,i);for(let[e,i]of t)ee(this[e].pick,i),this[e].enabled=!0}else if(t&&t.length){let e=Q(t,i);for(let[t,i]of e)ee(this[t].skip,i)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:i,iptc:n,icc:s}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),i.enabled||e.skip.add(700),n.enabled||e.skip.add(33723),s.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:i,interop:n}=this;n.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),i.needed&&e.deps.add(34853),this.tiff.enabled=H.some((e=>!0===this[e].enabled))||this.makerNote||this.userComment;for(let e of H)this[e].finalizeFilters()}get onlyTiff(){return!V.map((e=>this[e].enabled)).some((e=>!0===e))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of z)this[e].enabled&&!T.has(e)&&P("segment parser",e)}}function Q(e,t){let i,n,s,r,a=[];for(s of t){for(r of(i=E.get(s),n=[],i))(e.includes(r[0])||e.includes(r[1]))&&n.push(r[0]);n.length&&a.push([s,n])}return a}function Z(e,t){return void 0!==e?e:void 0!==t?t:void 0}function ee(e,t){for(let i of t)e.add(i)}c(q,"default",$);class te{constructor(e){c(this,"parsers",{}),c(this,"output",{}),c(this,"errors",[]),c(this,"pushToErrors",(e=>this.errors.push(e))),this.options=q.useCached(e)}async read(e){this.file=await D(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[i,n]of w)if(n.canHandle(e,t))return this.fileParser=new n(this.options,this.file,this.parsers),e[i]=!0;this.file.close&&this.file.close(),g("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),f(e)}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map((async t=>{let i=await t.parse();t.assignToOutput(e,i)}));this.options.silentErrors&&(t=t.map((e=>e.catch(this.pushToErrors)))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,i=T.get("tiff",e);var n;if(t.tiff?n={start:0,type:"tiff"}:t.jpeg&&(n=await this.fileParser.getOrFindSegment("tiff")),void 0===n)return;let s=await this.fileParser.ensureSegmentChunk(n),r=this.parsers.tiff=new i(s,e,t),a=await r.extractThumbnail();return t.close&&t.close(),a}}async function ie(e,t){let i=new te(t);return await i.read(e),i.parse()}var ne=Object.freeze({__proto__:null,parse:ie,Exifr:te,fileParsers:w,segmentParsers:T,fileReaders:A,tagKeys:E,tagValues:B,tagRevivers:N,createDictionary:U,extendDictionary:F,fetchUrlAsArrayBuffer:M,readBlobAsArrayBuffer:R,chunkedProps:G,otherSegments:V,segments:z,tiffBlocks:H,segmentsAndBlocks:j,tiffExtractables:W,inheritables:K,allFormatters:X,Options:q});class se{constructor(e,t,i){c(this,"errors",[]),c(this,"ensureSegmentChunk",(async e=>{let t=e.start,i=e.size||65536;if(this.file.chunked)if(this.file.available(t,i))e.chunk=this.file.subarray(t,i);else try{e.chunk=await this.file.readChunk(t,i)}catch(t){g(`Couldn't read segment: ${JSON.stringify(e)}. ${t.message}`)}else this.file.byteLength>t+i?e.chunk=this.file.subarray(t,i):void 0===e.size?e.chunk=this.file.subarray(t):g("Segment unreachable: "+JSON.stringify(e));return e.chunk})),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=i}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let i=new(T.get(e))(t,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let t of e){let{type:e,chunk:i}=t,n=this.options[e];if(n&&n.enabled){let t=this.parsers[e];t&&t.append||t||this.createParser(e,i)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}class re{static findPosition(e,t){let i=e.getUint16(t+2)+2,n="function"==typeof this.headerLength?this.headerLength(e,t,i):this.headerLength,s=t+n,r=i-n;return{offset:t,length:i,headerLength:n,start:s,size:r,end:s+r}}static parse(e,t={}){return new this(e,new q({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof I?e:new I(e)}constructor(e,t={},i){c(this,"errors",[]),c(this,"raw",new Map),c(this,"handleError",(e=>{if(!this.options.silentErrors)throw e;this.errors.push(e.message)})),this.chunk=this.normalizeInput(e),this.file=i,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let i=N.get(t),n=B.get(t),s=E.get(t),r=this.options[t],a=r.reviveValues&&!!i,o=r.translateValues&&!!n,l=r.translateKeys&&!!s,h={};for(let[t,r]of e)a&&i.has(t)?r=i.get(t)(r):o&&n.has(t)&&(r=this.translateValue(r,n.get(t))),l&&s.has(t)&&(t=s.get(t)||t),h[t]=r;return h}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[t]?Object.assign(e[t],i):e[t]=i}}c(re,"headerLength",4),c(re,"type",void 0),c(re,"multiSegment",!1),c(re,"canHandle",(()=>!1));function ae(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function oe(e){return e>=224&&e<=239}function le(e,t,i){for(let[n,s]of T)if(s.canHandle(e,t,i))return n}class he extends se{constructor(...e){super(...e),c(this,"appSegments",[]),c(this,"jpegSegments",[]),c(this,"unknownSegments",[])}static canHandle(e,t){return 65496===t}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){!0===e?(this.findAll=!0,this.wanted=new Set(T.keyList())):(e=void 0===e?T.keyList().filter((e=>this.options[e].enabled)):e.filter((e=>this.options[e].enabled&&T.has(e))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:i,findAll:n,wanted:s,remaining:r}=this;if(!n&&this.file.chunked&&(n=Array.from(s).some((e=>{let t=T.get(e),i=this.options[e];return t.multiSegment&&i.multiSegment})),n&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let t=!1;for(;r.size>0&&!t&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:n}=i,s=this.appSegments.some((e=>!this.file.available(e.offset||e.start,e.length||e.size)));if(t=e>n&&!s?!await i.readNextChunk(e):!await i.readNextChunk(n),void 0===(e=this.findAppSegmentsInRange(e,i.byteLength)))return}}}findAppSegmentsInRange(e,t){t-=2;let i,n,s,r,a,o,{file:l,findAll:h,wanted:u,remaining:c,options:f}=this;for(;e<t;e++)if(255===l.getUint8(e))if(i=l.getUint8(e+1),oe(i)){if(n=l.getUint16(e+2),s=le(l,e,n),s&&u.has(s)&&(r=T.get(s),a=r.findPosition(l,e),o=f[s],a.type=s,this.appSegments.push(a),!h&&(r.multiSegment&&o.multiSegment?(this.unfinishedMultiSegment=a.chunkNumber<a.chunkCount,this.unfinishedMultiSegment||c.delete(s)):c.delete(s),0===c.size)))break;f.recordUnknownSegments&&(a=re.findPosition(l,e),a.marker=i,this.unknownSegments.push(a)),e+=n+1}else if(ae(i)){if(n=l.getUint16(e+2),218===i&&!1!==f.stopAfterSos)return;f.recordJpegSegments&&this.jpegSegments.push({offset:e,length:n,marker:i}),e+=n+1}return e}mergeMultiSegments(){if(!this.appSegments.some((e=>e.multiSegment)))return;let e=function(e,t){let i,n,s,r=new Map;for(let a=0;a<e.length;a++)i=e[a],n=i[t],r.has(n)?s=r.get(n):r.set(n,s=[]),s.push(i);return Array.from(r)}(this.appSegments,"type");this.mergedAppSegments=e.map((([e,t])=>{let i=T.get(e,this.options);if(i.handleMultiSegments){return{type:e,chunk:i.handleMultiSegments(t)}}return t[0]}))}getSegment(e){return this.appSegments.find((t=>t.type===e))}async getOrFindSegment(e){let t=this.getSegment(e);return void 0===t&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}c(he,"type","jpeg"),w.set("jpeg",he);const ue=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class ce extends re{parseHeader(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,i=new Map){let{pick:n,skip:s}=this.options[t];n=new Set(n);let r=n.size>0,a=0===s.size,o=this.chunk.getUint16(e);e+=2;for(let l=0;l<o;l++){let o=this.chunk.getUint16(e);if(r){if(n.has(o)&&(i.set(o,this.parseTag(e,o,t)),n.delete(o),0===n.size))break}else!a&&s.has(o)||i.set(o,this.parseTag(e,o,t));e+=12}return i}parseTag(e,t,i){let{chunk:n}=this,s=n.getUint16(e+2),r=n.getUint32(e+4),a=ue[s];if(a*r<=4?e+=8:e=n.getUint32(e+8),(s<1||s>13)&&g(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e}`),e>n.byteLength&&g(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e} is outside of chunk size ${n.byteLength}`),1===s)return n.getUint8Array(e,r);if(2===s)return m(n.getString(e,r));if(7===s)return n.getUint8Array(e,r);if(1===r)return this.parseTagValue(s,e);{let t=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(s))(r),i=a;for(let n=0;n<r;n++)t[n]=this.parseTagValue(s,e),e+=i;return t}}parseTagValue(e,t){let{chunk:i}=this;switch(e){case 1:return i.getUint8(t);case 3:return i.getUint16(t);case 4:return i.getUint32(t);case 5:return i.getUint32(t)/i.getUint32(t+4);case 6:return i.getInt8(t);case 8:return i.getInt16(t);case 9:return i.getInt32(t);case 10:return i.getInt32(t)/i.getInt32(t+4);case 11:return i.getFloat(t);case 12:return i.getDouble(t);case 13:return i.getUint32(t);default:g(`Invalid tiff type ${e}`)}}}class fe extends ce{static canHandle(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}findIfd0Offset(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(void 0===this.ifd1Offset){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let i=new Map;return this[t]=i,this.parseTags(e,t,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&g("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&g(`IFD0 offset points to outside of file.\nthis.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,S(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return 0!==t.size?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.exifOffset)return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,S(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let i=e.get(t);i&&1===i.length&&e.set(t,i[0])}async parseGpsBlock(){if(this.gps)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.gpsOffset)return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",de(...e.get(2),e.get(1))),e.set("longitude",de(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),void 0!==this.interopOffset||this.exif||await this.parseExifBlock(),void 0!==this.interopOffset))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),void 0===this.ifd1)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,i,n={};for(t of H)if(e=this[t],!p(e))if(i=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if("ifd1"===t)continue;Object.assign(n,i)}else n[t]=i;return this.makerNote&&(n.makerNote=this.makerNote),this.userComment&&(n.userComment=this.userComment),n}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[i,n]of Object.entries(t))this.assignObjectToOutput(e,i,n)}}function de(e,t,i,n){var s=e+t/60+i/3600;return"S"!==n&&"W"!==n||(s*=-1),s}c(fe,"type","tiff"),c(fe,"headerLength",10),T.set("tiff",fe);var pe=Object.freeze({__proto__:null,default:ne,Exifr:te,fileParsers:w,segmentParsers:T,fileReaders:A,tagKeys:E,tagValues:B,tagRevivers:N,createDictionary:U,extendDictionary:F,fetchUrlAsArrayBuffer:M,readBlobAsArrayBuffer:R,chunkedProps:G,otherSegments:V,segments:z,tiffBlocks:H,segmentsAndBlocks:j,tiffExtractables:W,inheritables:K,allFormatters:X,Options:q,parse:ie});const ge={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},me=Object.assign({},ge,{firstChunkSize:4e4,gps:[1,2,3,4]});async function Se(e){let t=new te(me);await t.read(e);let i=await t.parse();if(i&&i.gps){let{latitude:e,longitude:t}=i.gps;return{latitude:e,longitude:t}}}const Ce=Object.assign({},ge,{tiff:!1,ifd1:!0,mergeOutput:!1});async function ye(e){let t=new te(Ce);await t.read(e);let i=await t.extractThumbnail();return i&&a?s.from(i):i}async function be(e){let t=await this.thumbnail(e);if(void 0!==t){let e=new Blob([t]);return URL.createObjectURL(e)}}const Ie=Object.assign({},ge,{firstChunkSize:4e4,ifd0:[274]});async function Pe(e){let t=new te(Ie);await t.read(e);let i=await t.parse();if(i&&i.ifd0)return i.ifd0[274]}const ke=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let we=!0,Te=!0;if("object"==typeof navigator){let e=navigator.userAgent;if(e.includes("iPad")||e.includes("iPhone")){let t=e.match(/OS (\d+)_(\d+)/);if(t){let[,e,i]=t,n=Number(e)+.1*Number(i);we=n<13.4,Te=!1}}else if(e.includes("OS X 10")){let[,t]=e.match(/OS X 10[_.](\d+)/);we=Te=Number(t)<15}if(e.includes("Chrome/")){let[,t]=e.match(/Chrome\/(\d+)/);we=Te=Number(t)<81}else if(e.includes("Firefox/")){let[,t]=e.match(/Firefox\/(\d+)/);we=Te=Number(t)<77}}async function Ae(e){let t=await Pe(e);return Object.assign({canvas:we,css:Te},ke[t])}class De extends I{constructor(...e){super(...e),c(this,"ranges",new Oe),0!==this.byteLength&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,i){if(0===e&&0===this.byteLength&&i){let e=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(e)}else{let i=e+t;if(i>this.byteLength){let{dataView:e}=this._extend(i);this._swapDataView(e)}}}_extend(e){let t;t=a?s.allocUnsafe(e):new Uint8Array(e);let i=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:i}}subarray(e,t,i=!1){return t=t||this._lengthToEnd(e),i&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,i=!1){i&&this._tryExtend(t,e.byteLength,e);let n=super.set(e,t);return this.ranges.add(t,n.byteLength),n}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class Oe{constructor(){c(this,"list",[])}get length(){return this.list.length}add(e,t,i=0){let n=e+t,s=this.list.filter((t=>xe(e,t.offset,n)||xe(e,t.end,n)));if(s.length>0){e=Math.min(e,...s.map((e=>e.offset))),n=Math.max(n,...s.map((e=>e.end))),t=n-e;let i=s.shift();i.offset=e,i.length=t,i.end=n,this.list=this.list.filter((e=>!s.includes(e)))}else this.list.push({offset:e,length:t,end:n})}available(e,t){let i=e+t;return this.list.some((t=>t.offset<=e&&i<=t.end))}}function xe(e,t,i){return e<=t&&t<=i}class ve extends De{constructor(e,t){super(0),c(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,i=await this.readChunk(e,t);return!!i&&i.byteLength===t}async readChunk(e,t){if(this.chunksRead++,0!==(t=this.safeWrapAddress(e,t)))return this._readChunk(e,t)}safeWrapAddress(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return void 0!==this.size&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}A.set("blob",class extends ve{async readWhole(){this.chunked=!1;let e=await R(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let i=t?e+t:void 0,n=this.input.slice(e,i),s=await R(n);return this.set(s,e,!0)}});var Me=Object.freeze({__proto__:null,default:pe,Exifr:te,fileParsers:w,segmentParsers:T,fileReaders:A,tagKeys:E,tagValues:B,tagRevivers:N,createDictionary:U,extendDictionary:F,fetchUrlAsArrayBuffer:M,readBlobAsArrayBuffer:R,chunkedProps:G,otherSegments:V,segments:z,tiffBlocks:H,segmentsAndBlocks:j,tiffExtractables:W,inheritables:K,allFormatters:X,Options:q,parse:ie,gpsOnlyOptions:me,gps:Se,thumbnailOnlyOptions:Ce,thumbnail:ye,thumbnailUrl:be,orientationOnlyOptions:Ie,orientation:Pe,rotations:ke,get rotateCanvas(){return we},get rotateCss(){return Te},rotation:Ae});A.set("url",class extends ve{async readWhole(){this.chunked=!1;let e=await M(this.input);e instanceof ArrayBuffer?this._swapArrayBuffer(e):e instanceof Uint8Array&&this._swapBuffer(e)}async _readChunk(e,t){let i=t?e+t-1:void 0,n=this.options.httpHeaders||{};(e||i)&&(n.range=`bytes=${[e,i].join("-")}`);let s=await h(this.input,{headers:n}),r=await s.arrayBuffer(),a=r.byteLength;if(416!==s.status)return a!==t&&(this.size=e+a),this.set(r,e,!0)}});I.prototype.getUint64=function(e){let t=this.getUint32(e),i=this.getUint32(e+4);return t<1048575?t<<32|i:void 0!==typeof r?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),r(t)<<r(32)|r(i)):void g("Trying to read 64b value but JS can only handle 53b numbers.")};class Re extends se{parseBoxes(e=0){let t=[];for(;e<this.file.byteLength-4;){let i=this.parseBoxHead(e);if(t.push(i),0===i.length)break;e+=i.length}return t}parseSubBoxes(e){e.boxes=this.parseBoxes(e.start)}findBox(e,t){return void 0===e.boxes&&this.parseSubBoxes(e),e.boxes.find((e=>e.kind===t))}parseBoxHead(e){let t=this.file.getUint32(e),i=this.file.getString(e+4,4),n=e+8;return 1===t&&(t=this.file.getUint64(e+8),n+=8),{offset:e,length:t,kind:i,start:n}}parseBoxFullHead(e){if(void 0!==e.version)return;let t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}class Le extends Re{static canHandle(e,t){if(0!==t)return!1;let i=e.getUint16(2);if(i>50)return!1;let n=16,s=[];for(;n<i;)s.push(e.getString(n,4)),n+=4;return s.includes(this.type)}async parse(){let e=this.file.getUint32(0),t=this.parseBoxHead(e);for(;"meta"!==t.kind;)e+=t.length,await this.file.ensureChunk(e,16),t=this.parseBoxHead(e);await this.file.ensureChunk(t.offset,t.length),this.parseBoxFullHead(t),this.parseSubBoxes(t),this.options.icc.enabled&&await this.findIcc(t),this.options.tiff.enabled&&await this.findExif(t)}async registerSegment(e,t,i){await this.file.ensureChunk(t,i);let n=this.file.subarray(t,i);this.createParser(e,n)}async findIcc(e){let t=this.findBox(e,"iprp");if(void 0===t)return;let i=this.findBox(t,"ipco");if(void 0===i)return;let n=this.findBox(i,"colr");void 0!==n&&await this.registerSegment("icc",n.offset+12,n.length)}async findExif(e){let t=this.findBox(e,"iinf");if(void 0===t)return;let i=this.findBox(e,"iloc");if(void 0===i)return;let n=this.findExifLocIdInIinf(t),s=this.findExtentInIloc(i,n);if(void 0===s)return;let[r,a]=s;await this.file.ensureChunk(r,a);let o=4+this.file.getUint32(r);r+=o,a-=o,await this.registerSegment("tiff",r,a)}findExifLocIdInIinf(e){this.parseBoxFullHead(e);let t,i,n,s,r=e.start,a=this.file.getUint16(r);for(r+=2;a--;){if(t=this.parseBoxHead(r),this.parseBoxFullHead(t),i=t.start,t.version>=2&&(n=3===t.version?4:2,s=this.file.getString(i+n+2,4),"Exif"===s))return this.file.getUintBytes(i,n);r+=t.length}}get8bits(e){let t=this.file.getUint8(e);return[t>>4,15&t]}findExtentInIloc(e,t){this.parseBoxFullHead(e);let i=e.start,[n,s]=this.get8bits(i++),[r,a]=this.get8bits(i++),o=2===e.version?4:2,l=1===e.version||2===e.version?2:0,h=a+n+s,u=2===e.version?4:2,c=this.file.getUintBytes(i,u);for(i+=u;c--;){let e=this.file.getUintBytes(i,o);i+=o+l+2+r;let u=this.file.getUint16(i);if(i+=2,e===t)return u>1&&console.warn("ILOC box has more than one extent but we're only processing one\nPlease create an issue at https://github.com/MikeKovarik/exifr with this file"),[this.file.getUintBytes(i+a,n),this.file.getUintBytes(i+a+n,s)];i+=u*h}}}class Ue extends Le{}c(Ue,"type","heic");class Fe extends Le{}c(Fe,"type","avif"),w.set("heic",Ue),w.set("avif",Fe),U(E,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),U(E,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),U(E,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),U(B,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let Ee=U(B,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const Be={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};Ee.set(37392,Be),Ee.set(41488,Be);const Ne={0:"Normal",1:"Low",2:"High"};function Ge(e){return"object"==typeof e&&void 0!==e.length?e[0]:e}function Ve(e){let t=Array.from(e).slice(1);return t[1]>15&&(t=t.map((e=>String.fromCharCode(e)))),"0"!==t[2]&&0!==t[2]||t.pop(),t.join(".")}function ze(e){if("string"==typeof e){var[t,i,n,s,r,a]=e.trim().split(/[-: ]/g).map(Number),o=new Date(t,i-1,n);return Number.isNaN(s)||Number.isNaN(r)||Number.isNaN(a)||(o.setHours(s),o.setMinutes(r),o.setSeconds(a)),Number.isNaN(+o)?e:o}}function He(e){if("string"==typeof e)return e;let t=[];if(0===e[1]&&0===e[e.length-1])for(let i=0;i<e.length;i+=2)t.push(je(e[i+1],e[i]));else for(let i=0;i<e.length;i+=2)t.push(je(e[i],e[i+1]));return m(String.fromCodePoint(...t))}function je(e,t){return e<<8|t}Ee.set(41992,Ne),Ee.set(41993,Ne),Ee.set(41994,Ne),U(N,["ifd0","ifd1"],[[50827,function(e){return"string"!=typeof e?b(e):e}],[306,ze],[40091,He],[40092,He],[40093,He],[40094,He],[40095,He]]),U(N,"exif",[[40960,Ve],[36864,Ve],[36867,ze],[36868,ze],[40962,Ge],[40963,Ge]]),U(N,"gps",[[0,e=>Array.from(e).join(".")],[7,e=>Array.from(e).join(":")]]);class We extends re{static canHandle(e,t){return 225===e.getUint8(t+1)&&1752462448===e.getUint32(t+4)&&"http://ns.adobe.com/"===e.getString(t+4,"http://ns.adobe.com/".length)}static headerLength(e,t){return"http://ns.adobe.com/xmp/extension/"===e.getString(t+4,"http://ns.adobe.com/xmp/extension/".length)?79:4+"http://ns.adobe.com/xap/1.0/".length+1}static findPosition(e,t){let i=super.findPosition(e,t);return i.multiSegment=i.extended=79===i.headerLength,i.multiSegment?(i.chunkCount=e.getUint8(t+72),i.chunkNumber=e.getUint8(t+76),0!==e.getUint8(t+77)&&i.chunkNumber++):(i.chunkCount=1/0,i.chunkNumber=-1),i}static handleMultiSegments(e){return e.map((e=>e.chunk.getString())).join("")}normalizeInput(e){return"string"==typeof e?e:I.from(e).getString()}parse(e=this.chunk){if(!this.localOptions.parse)return e;e=function(e){let t={},i={};for(let e of Ze)t[e]=[],i[e]=0;return e.replace(et,((e,n,s)=>{if("<"===n){let n=++i[s];return t[s].push(n),`${e}#${n}`}return`${e}#${t[s].pop()}`}))}(e);let t=Xe.findAll(e,"rdf","Description");0===t.length&&t.push(new Xe("rdf","Description",void 0,e));let i,n={};for(let e of t)for(let t of e.properties)i=Je(t.ns,n),_e(t,i);return function(e){let t;for(let i in e)t=e[i]=f(e[i]),void 0===t&&delete e[i];return f(e)}(n)}assignToOutput(e,t){if(this.localOptions.parse)for(let[i,n]of Object.entries(t))switch(i){case"tiff":this.assignObjectToOutput(e,"ifd0",n);break;case"exif":this.assignObjectToOutput(e,"exif",n);break;case"xmlns":break;default:this.assignObjectToOutput(e,i,n)}else e.xmp=t}}c(We,"type","xmp"),c(We,"multiSegment",!0),T.set("xmp",We);class Ke{static findAll(e){return qe(e,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(Ke.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[3].slice(1,-1);return n=Qe(n),new Ke(t,i,n)}constructor(e,t,i){this.ns=e,this.name=t,this.value=i}serialize(){return this.value}}class Xe{static findAll(e,t,i){if(void 0!==t||void 0!==i){t=t||"[\\w\\d-]+",i=i||"[\\w\\d-]+";var n=new RegExp(`<(${t}):(${i})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else n=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return qe(e,n).map(Xe.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[4],s=e[8];return new Xe(t,i,n,s)}constructor(e,t,i,n){this.ns=e,this.name=t,this.attrString=i,this.innerXml=n,this.attrs=Ke.findAll(i),this.children=Xe.findAll(n),this.value=0===this.children.length?Qe(n):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return void 0!==this.value&&0===this.attrs.length&&0===this.children.length}get isListContainer(){return 1===this.children.length&&this.children[0].isList}get isList(){let{ns:e,name:t}=this;return"rdf"===e&&("Seq"===t||"Bag"===t||"Alt"===t)}get isListItem(){return"rdf"===this.ns&&"li"===this.name}serialize(){if(0===this.properties.length&&void 0===this.value)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return $e(this.children.map(Ye));if(this.isListItem&&1===this.children.length&&0===this.attrs.length)return this.children[0].serialize();let e={};for(let t of this.properties)_e(t,e);return void 0!==this.value&&(e.value=this.value),f(e)}}function _e(e,t){let i=e.serialize();void 0!==i&&(t[e.name]=i)}var Ye=e=>e.serialize(),$e=e=>1===e.length?e[0]:e,Je=(e,t)=>t[e]?t[e]:t[e]={};function qe(e,t){let i,n=[];if(!e)return n;for(;null!==(i=t.exec(e));)n.push(i);return n}function Qe(e){if(function(e){return null==e||"null"===e||"undefined"===e||""===e||""===e.trim()}(e))return;let t=Number(e);if(!Number.isNaN(t))return t;let i=e.toLowerCase();return"true"===i||"false"!==i&&e.trim()}const Ze=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],et=new RegExp(`(<|\\/)(${Ze.join("|")})`,"g");var tt=Object.freeze({__proto__:null,default:Me,Exifr:te,fileParsers:w,segmentParsers:T,fileReaders:A,tagKeys:E,tagValues:B,tagRevivers:N,createDictionary:U,extendDictionary:F,fetchUrlAsArrayBuffer:M,readBlobAsArrayBuffer:R,chunkedProps:G,otherSegments:V,segments:z,tiffBlocks:H,segmentsAndBlocks:j,tiffExtractables:W,inheritables:K,allFormatters:X,Options:q,parse:ie,gpsOnlyOptions:me,gps:Se,thumbnailOnlyOptions:Ce,thumbnail:ye,thumbnailUrl:be,orientationOnlyOptions:Ie,orientation:Pe,rotations:ke,get rotateCanvas(){return we},get rotateCss(){return Te},rotation:Ae});const it=["xmp","icc","iptc","tiff"],nt=()=>{};async function st(e,t,i){let n=new q(t);n.chunked=!1,void 0===i&&"string"==typeof e&&(i=function(e){let t=e.toLowerCase().split(".").pop();if(function(e){return"exif"===e||"tiff"===e||"tif"===e}(t))return"tiff";if(it.includes(t))return t}(e));let s=await D(e,n);if(i){if(it.includes(i))return rt(i,s,n);g("Invalid segment type")}else{if(function(e){let t=e.getString(0,50).trim();return t.includes("<?xpacket")||t.includes("<x:")}(s))return rt("xmp",s,n);for(let[e]of T){if(!it.includes(e))continue;let t=await rt(e,s,n).catch(nt);if(t)return t}g("Unknown file format")}}async function rt(e,t,i){let n=i[e];return n.enabled=!0,n.parse=!0,T.get(e).parse(t,n)}let at=l("fs",(e=>e.promises));A.set("fs",class extends ve{async readWhole(){this.chunked=!1,this.fs=await at;let e=await this.fs.readFile(this.input);this._swapBuffer(e)}async readChunked(){this.chunked=!0,this.fs=await at,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){void 0===this.fh&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(e,t){void 0===this.fh&&await this.open(),e+t>this.size&&(t=this.size-e);var i=this.subarray(e,t,!0);return await this.fh.read(i.dataView,0,t,e),i}async close(){if(this.fh){let e=this.fh;this.fh=void 0,await e.close()}}});A.set("base64",class extends ve{constructor(...e){super(...e),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(e,t){let i,n,r=this.input;void 0===e?(e=0,i=0,n=0):(i=4*Math.floor(e/3),n=e-i/4*3),void 0===t&&(t=this.size);let o=e+t,l=i+4*Math.ceil(o/3);r=r.slice(i,l);let h=Math.min(t,this.size-e);if(a){let t=s.from(r,"base64").slice(n,n+h);return this.set(t,e,!0)}{let t=this.subarray(e,h,!0),i=atob(r),s=t.toUint8();for(let e=0;e<h;e++)s[e]=i.charCodeAt(n+e);return t}}});class ot extends se{static canHandle(e,t){return 18761===t||19789===t}extendOptions(e){let{ifd0:t,xmp:i,iptc:n,icc:s}=e;i.enabled&&t.deps.add(700),n.enabled&&t.deps.add(33723),s.enabled&&t.deps.add(34675),t.finalizeFilters()}async parse(){let{tiff:e,xmp:t,iptc:i,icc:n}=this.options;if(e.enabled||t.enabled||i.enabled||n.enabled){let e=Math.max(S(this.options),this.options.chunkSize);await this.file.ensureChunk(0,e),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(e){if(this.parsers.tiff[e]){let t=this.parsers.tiff[e];this.injectSegment(e,t)}}}c(ot,"type","tiff"),w.set("tiff",ot);let lt=l("zlib");const ht=["ihdr","iccp","text","itxt","exif"];class ut extends se{constructor(...e){super(...e),c(this,"catchError",(e=>this.errors.push(e))),c(this,"metaChunks",[]),c(this,"unknownChunks",[])}static canHandle(e,t){return 35152===t&&2303741511===e.getUint32(0)&&218765834===e.getUint32(4)}async parse(){let{file:e}=this;await this.findPngChunksInRange("聣PNG\r\n\n".length,e.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(e,t){let{file:i}=this;for(;e<t;){let t=i.getUint32(e),n=i.getUint32(e+4),s=i.getString(e+4,4).toLowerCase(),r=t+4+4+4,a={type:s,offset:e,length:r,start:e+4+4,size:t,marker:n};ht.includes(s)?this.metaChunks.push(a):this.unknownChunks.push(a),e+=r}}parseTextChunks(){let e=this.metaChunks.filter((e=>"text"===e.type));for(let t of e){let[e,i]=this.file.getString(t.start,t.size).split("\0");this.injectKeyValToIhdr(e,i)}}injectKeyValToIhdr(e,t){let i=this.parsers.ihdr;i&&i.raw.set(e,t)}findIhdr(){let e=this.metaChunks.find((e=>"ihdr"===e.type));e&&!1!==this.options.ihdr.enabled&&this.createParser("ihdr",e.chunk)}async findExif(){let e=this.metaChunks.find((e=>"exif"===e.type));e&&this.injectSegment("tiff",e.chunk)}async findXmp(){let e=this.metaChunks.filter((e=>"itxt"===e.type));for(let t of e){"XML:com.adobe.xmp"===t.chunk.getString(0,"XML:com.adobe.xmp".length)&&this.injectSegment("xmp",t.chunk)}}async findIcc(){let e=this.metaChunks.find((e=>"iccp"===e.type));if(!e)return;let{chunk:t}=e,i=t.getUint8Array(0,81),s=0;for(;s<80&&0!==i[s];)s++;let r=s+2,a=t.getString(0,s);if(this.injectKeyValToIhdr("ProfileName",a),n){let e=await lt,i=t.getUint8Array(r);i=e.inflateSync(i),this.injectSegment("icc",i)}}}c(ut,"type","png"),w.set("png",ut),U(E,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),F(E,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);let ct=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];F(E,"ifd0",ct),F(E,"exif",ct),U(B,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);class ft extends re{static canHandle(e,t){return 224===e.getUint8(t+1)&&1246120262===e.getUint32(t+4)&&0===e.getUint8(t+8)}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}c(ft,"type","jfif"),c(ft,"headerLength",9),T.set("jfif",ft),U(E,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);class dt extends re{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}}c(dt,"type","ihdr"),T.set("ihdr",dt),U(E,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),U(B,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);class pt extends re{static canHandle(e,t){return 226===e.getUint8(t+1)&&1229144927===e.getUint32(t+4)}static findPosition(e,t){let i=super.findPosition(e,t);return i.chunkNumber=e.getUint8(t+16),i.chunkCount=e.getUint8(t+17),i.multiSegment=i.chunkCount>1,i}static handleMultiSegments(e){return function(e){let t=function(e){let t=e[0].constructor,i=0;for(let t of e)i+=t.length;let n=new t(i),s=0;for(let t of e)n.set(t,s),s+=t.length;return n}(e.map((e=>e.chunk.toUint8())));return new I(t)}(e)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:e}=this;this.chunk.byteLength<84&&g("ICC header is too short");for(let[t,i]of Object.entries(gt)){t=parseInt(t,10);let n=i(this.chunk,t);"\0\0\0\0"!==n&&e.set(t,n)}}parseTags(){let e,t,i,n,s,{raw:r}=this,a=this.chunk.getUint32(128),o=132,l=this.chunk.byteLength;for(;a--;){if(e=this.chunk.getString(o,4),t=this.chunk.getUint32(o+4),i=this.chunk.getUint32(o+8),n=this.chunk.getString(t,4),t+i>l)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");s=this.parseTag(n,t,i),void 0!==s&&"\0\0\0\0"!==s&&r.set(e,s),o+=12}}parseTag(e,t,i){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,i);case"sig ":return this.parseSig(t)}if(!(t+i>this.chunk.byteLength))return this.chunk.getUint8Array(t,i)}parseDesc(e){let t=this.chunk.getUint32(e+8)-1;return m(this.chunk.getString(e+12,t))}parseText(e,t){return m(this.chunk.getString(e+8,t-8))}parseSig(e){return m(this.chunk.getString(e+8,4))}parseMluc(e){let{chunk:t}=this,i=t.getUint32(e+8),n=t.getUint32(e+12),s=e+16,r=[];for(let a=0;a<i;a++){let i=t.getString(s+0,2),a=t.getString(s+2,2),o=t.getUint32(s+4),l=t.getUint32(s+8)+e,h=m(t.getUnicodeString(l,o));r.push({lang:i,country:a,text:h}),s+=n}return 1===i?r[0].text:r}translateValue(e,t){return"string"==typeof e?t[e]||t[e.toLowerCase()]||e:t[e]||e}}c(pt,"type","icc"),c(pt,"multiSegment",!0),c(pt,"headerLength",18);const gt={4:mt,8:function(e,t){return[e.getUint8(t),e.getUint8(t+1)>>4,e.getUint8(t+1)%16].map((e=>e.toString(10))).join(".")},12:mt,16:mt,20:mt,24:function(e,t){const i=e.getUint16(t),n=e.getUint16(t+2)-1,s=e.getUint16(t+4),r=e.getUint16(t+6),a=e.getUint16(t+8),o=e.getUint16(t+10);return new Date(Date.UTC(i,n,s,r,a,o))},36:mt,40:mt,48:mt,52:mt,64:(e,t)=>e.getUint32(t),80:mt};function mt(e,t){return m(e.getString(t,4))}T.set("icc",pt),U(E,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);const St={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},Ct={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};U(B,"icc",[[4,St],[12,Ct],[40,Object.assign({},St,Ct)],[48,St],[80,St],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);class yt extends re{static canHandle(e,t,i){return 237===e.getUint8(t+1)&&"Photoshop"===e.getString(t+4,9)&&void 0!==this.containsIptc8bim(e,t,i)}static headerLength(e,t,i){let n,s=this.containsIptc8bim(e,t,i);if(void 0!==s)return n=e.getUint8(t+s+7),n%2!=0&&(n+=1),0===n&&(n=4),s+8+n}static containsIptc8bim(e,t,i){for(let n=0;n<i;n++)if(this.isIptcSegmentHead(e,t+n))return n}static isIptcSegmentHead(e,t){return 56===e.getUint8(t)&&943868237===e.getUint32(t)&&1028===e.getUint16(t+4)}parse(){let{raw:e}=this,t=this.chunk.byteLength-1,i=!1;for(let n=0;n<t;n++)if(28===this.chunk.getUint8(n)&&2===this.chunk.getUint8(n+1)){i=!0;let t=this.chunk.getUint16(n+3),s=this.chunk.getUint8(n+2),r=this.chunk.getLatin1String(n+5,t);e.set(s,this.pluralizeValue(e.get(s),r)),n+=4+t}else if(i)break;return this.translate(),this.output}pluralizeValue(e,t){return void 0!==e?e instanceof Array?(e.push(t),e):[e,t]:t}}c(yt,"type","iptc"),c(yt,"translateValues",!1),c(yt,"reviveValues",!1),T.set("iptc",yt),U(E,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),U(B,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]);export default tt;export{te as Exifr,q as Options,X as allFormatters,G as chunkedProps,U as createDictionary,F as extendDictionary,M as fetchUrlAsArrayBuffer,w as fileParsers,A as fileReaders,Se as gps,me as gpsOnlyOptions,K as inheritables,Pe as orientation,Ie as orientationOnlyOptions,V as otherSegments,ie as parse,R as readBlobAsArrayBuffer,we as rotateCanvas,Te as rotateCss,Ae as rotation,ke as rotations,T as segmentParsers,z as segments,j as segmentsAndBlocks,st as sidecar,E as tagKeys,N as tagRevivers,B as tagValues,ye as thumbnail,Ce as thumbnailOnlyOptions,be as thumbnailUrl,H as tiffBlocks,W as tiffExtractables};
node_modules\exifr\dist\full.legacy.umd.js:1:!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("exifr",["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).exifr={})}(this,(function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});var n=["prototype","__proto__","caller","arguments","length","name"];Object.getOwnPropertyNames(t).forEach((function(r){-1===n.indexOf(r)&&e[r]!==t[r]&&(e[r]=t[r])})),t&&s(e,t)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e,t,n){return(f=u()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&s(i,n.prototype),i}).apply(null,arguments)}function c(e){var t="function"==typeof Map?new Map:void 0;return(c=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return f(e,arguments,o(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),s(r,e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?l(e):t}function d(e){var t=u();return function(){var n,r=o(e);if(t){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function p(e,t,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}var g="undefined"!=typeof self?self:global,v=Object.values||function(e){var t=[];for(var n in e)t.push(e[n]);return t},y=Object.entries||function(e){var t=[];for(var n in e)t.push([n,e[n]]);return t},m=Object.assign||function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.forEach((function(t){for(var n in t)e[n]=t[n]})),e},k=Object.fromEntries||function(e){var t={};return S(e).forEach((function(e){var n=e[0],r=e[1];t[n]=r})),t},S=Array.from||function(e){if(e instanceof A){var t=[];return e.forEach((function(e,n){return t.push([n,e])})),t}return Array.prototype.slice.call(e)};function C(e){return-1!==this.indexOf(e)}Array.prototype.includes||(Array.prototype.includes=C),String.prototype.includes||(String.prototype.includes=C),String.prototype.startsWith||(String.prototype.startsWith=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.substring(t,t+e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return this.substring(t-e.length,t)===e});var P=function(e){var t=[];if(Object.defineProperties(t,{size:{get:function(){return this.length}},has:{value:function(e){return-1!==this.indexOf(e)}},add:{value:function(e){this.has(e)||this.push(e)}},delete:{value:function(e){if(this.has(e)){var t=this.indexOf(e);this.splice(t,1)}}}}),Array.isArray(e))for(var n=0;n<e.length;n++)t.add(e[n]);return t},b=function(e){return new A(e)},A=void 0!==g.Map&&void 0!==g.Map.prototype.keys?g.Map:function(){function e(n){if(t(this,e),this.clear(),n)for(var r=0;r<n.length;r++)this.set(n[r][0],n[r][1])}return r(e,[{key:"clear",value:function(){this._map={},this._keys=[]}},{key:"size",get:function(){return this._keys.length}},{key:"get",value:function(e){return this._map["map_"+e]}},{key:"set",value:function(e,t){return this._map["map_"+e]=t,this._keys.indexOf(e)<0&&this._keys.push(e),this}},{key:"has",value:function(e){return this._keys.indexOf(e)>=0}},{key:"delete",value:function(e){var t=this._keys.indexOf(e);return!(t<0)&&(delete this._map["map_"+e],this._keys.splice(t,1),!0)}},{key:"keys",value:function(){return this._keys.slice(0)}},{key:"values",value:function(){var e=this;return this._keys.map((function(t){return e.get(t)}))}},{key:"entries",value:function(){var e=this;return this._keys.map((function(t){return[t,e.get(t)]}))}},{key:"forEach",value:function(e,t){for(var n=0;n<this._keys.length;n++)e.call(t,this._map["map_"+this._keys[n]],this._keys[n],this)}}]),e}(),I=g.fetch;g.fetch||(I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,r){var i=new XMLHttpRequest;if(i.open("get",e,!0),i.responseType="arraybuffer",i.onerror=r,t.headers)for(var a in t.headers)i.setRequestHeader(a,t.headers[a]);i.onload=function(){n({status:i.status,arrayBuffer:function(){return Promise.resolve(i.response)}})},i.send(null)}))});var T="undefined"!=typeof navigator,O=T&&"undefined"==typeof HTMLImageElement,D=!("undefined"==typeof global||"undefined"==typeof process||!process.versions||!process.versions.node),w=g.Buffer,x=g.BigInt,R=!!w,M=function(e){return U(e)?void 0:e},L=function(e){return void 0!==e};function U(e){return void 0===e||(e instanceof A?0===e.size:0===v(e).filter(L).length)}function F(e){var t=new Error(e);throw delete t.stack,t}function E(e){return""===(e=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(e).trim())?void 0:e}function B(e){var t=function(e){var t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}var N=function(e){return String.fromCharCode.apply(null,e)},G="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;function j(e){return G?G.decode(e):R?Buffer.from(e).toString("utf8"):decodeURIComponent(escape(N(e)))}var V=function(){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(t(this,e),"boolean"==typeof a&&(this.le=a),Array.isArray(n)&&(n=new Uint8Array(n)),0===n)this.byteOffset=0,this.byteLength=0;else if(n instanceof ArrayBuffer){void 0===i&&(i=n.byteLength-r);var o=new DataView(n,r,i);this._swapDataView(o)}else if(n instanceof Uint8Array||n instanceof DataView||n instanceof e){void 0===i&&(i=n.byteLength-r),(r+=n.byteOffset)+i>n.byteOffset+n.byteLength&&F("Creating view outside of available memory in ArrayBuffer");var s=new DataView(n.buffer,r,i);this._swapDataView(s)}else if("number"==typeof n){var u=new DataView(new ArrayBuffer(n));this._swapDataView(u)}else F("Invalid input argument for BufferView: "+n)}return r(e,[{key:"_swapArrayBuffer",value:function(e){this._swapDataView(new DataView(e))}},{key:"_swapBuffer",value:function(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}},{key:"_swapDataView",value:function(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}},{key:"_lengthToEnd",value:function(e){return this.byteLength-e}},{key:"set",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;t instanceof DataView||t instanceof e?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer&&(t=new Uint8Array(t)),t instanceof Uint8Array||F("BufferView.set(): Invalid data argument.");var i=this.toUint8();return i.set(t,n),new r(this,n,t.byteLength)}},{key:"subarray",value:function(t,n){return new e(this,t,n=n||this._lengthToEnd(t))}},{key:"toUint8",value:function(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}},{key:"getUint8Array",value:function(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}},{key:"getString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=this.getUint8Array(e,t);return j(n)}},{key:"getLatin1String",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=this.getUint8Array(e,t);return N(n)}},{key:"getUnicodeString",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=[],r=0;r<t&&e+r<this.byteLength;r+=2)n.push(this.getUint16(e+r));return N(n)}},{key:"getInt8",value:function(e){return this.dataView.getInt8(e)}},{key:"getUint8",value:function(e){return this.dataView.getUint8(e)}},{key:"getInt16",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getInt16(e,t)}},{key:"getInt32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getInt32(e,t)}},{key:"getUint16",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getUint16(e,t)}},{key:"getUint32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getUint32(e,t)}},{key:"getFloat32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat32(e,t)}},{key:"getFloat64",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat64(e,t)}},{key:"getFloat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat32(e,t)}},{key:"getDouble",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat64(e,t)}},{key:"getUintBytes",value:function(e,t,n){switch(t){case 1:return this.getUint8(e,n);case 2:return this.getUint16(e,n);case 4:return this.getUint32(e,n);case 8:return this.getUint64&&this.getUint64(e,n)}}},{key:"getUint",value:function(e,t,n){switch(t){case 8:return this.getUint8(e,n);case 16:return this.getUint16(e,n);case 32:return this.getUint32(e,n);case 64:return this.getUint64&&this.getUint64(e,n)}}},{key:"toString",value:function(e){return this.dataView.toString(e,this.constructor.name)}},{key:"ensureChunk",value:function(){}}],[{key:"from",value:function(t,n){return t instanceof this&&t.le===n?t:new e(t,void 0,void 0,n)}}]),e}();function z(e,t){F("".concat(e," '").concat(t,"' was not loaded, try using full build of exifr."))}var H=function(e){a(i,e);var n=d(i);function i(e){var r;return t(this,i),(r=n.call(this)).kind=e,r}return r(i,[{key:"get",value:function(e,t){return this.has(e)||z(this.kind,e),t&&(e in t||function(e,t){F("Unknown ".concat(e," '").concat(t,"'."))}(this.kind,e),t[e].enabled||z(this.kind,e)),p(o(i.prototype),"get",this).call(this,e)}},{key:"keyList",value:function(){return S(this.keys())}}]),i}(c(A)),_=new H("file parser"),W=new H("segment parser"),K=new H("file reader");function X(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var Y=J((function(e,t){return X(t(e),(function(e){return new V(e)}))}));function J(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var q=J((function(e,t,n){var r=new(K.get(n))(e,t);return X(r.read(),(function(){return r}))})),Q=J((function(e,t,n,r){return K.has(n)?q(e,t,n):r?Y(e,r):(F("Parser ".concat(n," is not loaded")),X())})),Z="Invalid input argument";function $(e,t){return"string"==typeof e?ee(e,t):T&&!O&&e instanceof HTMLImageElement?ee(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new V(e):T&&e instanceof Blob?Q(e,t,"blob",ne):void F(Z)}function ee(e,t){return(n=e).startsWith("data:")||n.length>1e4?q(e,t,"base64"):D&&e.includes("://")?Q(e,t,"url",te):D?q(e,t,"fs"):T?Q(e,t,"url",te):void F(Z);var n}var te=function(e){return I(e).then((function(e){return e.arrayBuffer()}))},ne=function(e){return new Promise((function(t,n){var r=new FileReader;r.onloadend=function(){return t(r.result||new ArrayBuffer)},r.onerror=n,r.readAsArrayBuffer(e)}))};var re=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"tagKeys",get:function(){return this.allKeys||(this.allKeys=S(this.keys())),this.allKeys}},{key:"tagValues",get:function(){return this.allValues||(this.allValues=S(this.values())),this.allValues}}]),i}(c(A));function ie(e,t,n){var r=new re,i=n;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=S(i));for(var a=0;a<i.length;a++){var o=i[a],s=o[0],u=o[1];r.set(s,u)}if(Array.isArray(t)){var f=t;Array.isArray(f)||("function"==typeof f.entries&&(f=f.entries()),f=S(f));for(var c=0;c<f.length;c++){var l=f[c];e.set(l,r)}}else e.set(t,r);return r}function ae(e,t,n){var r,i=e.get(t),a=n;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=S(a));for(var o=0;o<a.length;o++)r=a[o],i.set(r[0],r[1])}var oe=b(),se=b(),ue=b(),fe=37500,ce=37510,le=700,he=33723,de=34675,pe=34665,ge=34853,ve=40965,ye=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],me=["jfif","xmp","icc","iptc","ihdr"],ke=["tiff"].concat(me),Se=["ifd0","ifd1","exif","gps","interop"],Ce=[].concat(ke,Se),Pe=["makerNote","userComment"],be=["translateKeys","translateValues","reviveValues","multiSegment"],Ae=[].concat(be,["sanitize","mergeOutput","silentErrors"]),Ie=function(){function e(){t(this,e)}return r(e,[{key:"translate",get:function(){return this.translateKeys||this.translateValues||this.reviveValues}}]),e}(),Te=function(e){a(o,e);var n=d(o);function o(e,r,a,s){var u;if(t(this,o),i(l(u=n.call(this)),"enabled",!1),i(l(u),"skip",P()),i(l(u),"pick",P()),i(l(u),"deps",P()),i(l(u),"translateKeys",!1),i(l(u),"translateValues",!1),i(l(u),"reviveValues",!1),u.key=e,u.enabled=r,u.parse=u.enabled,u.applyInheritables(s),u.canBeFiltered=Se.includes(e),u.canBeFiltered&&(u.dict=oe.get(e)),void 0!==a)if(Array.isArray(a))u.parse=u.enabled=!0,u.canBeFiltered&&a.length>0&&u.translateTagSet(a,u.pick);else if("object"==typeof a){if(u.enabled=!0,u.parse=!1!==a.parse,u.canBeFiltered){var f=a.pick,c=a.skip;f&&f.length>0&&u.translateTagSet(f,u.pick),c&&c.length>0&&u.translateTagSet(c,u.skip)}u.applyInheritables(a)}else!0===a||!1===a?u.parse=u.enabled=a:F("Invalid options argument: ".concat(a));return u}return r(o,[{key:"needed",get:function(){return this.enabled||this.deps.size>0}},{key:"applyInheritables",value:function(e){var t,n,r=be;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=S(r));for(var i=0;i<r.length;i++)void 0!==(n=e[t=r[i]])&&(this[t]=n)}},{key:"translateTagSet",value:function(e,t){if(this.dict){var n,r,i=this.dict,a=i.tagKeys,o=i.tagValues,s=e;Array.isArray(s)||("function"==typeof s.entries&&(s=s.entries()),s=S(s));for(var u=0;u<s.length;u++)"string"==typeof(n=s[u])?(-1===(r=o.indexOf(n))&&(r=a.indexOf(Number(n))),-1!==r&&t.add(Number(a[r]))):t.add(n)}else{var f=e;Array.isArray(f)||("function"==typeof f.entries&&(f=f.entries()),f=S(f));for(var c=0;c<f.length;c++){var l=f[c];t.add(l)}}}},{key:"finalizeFilters",value:function(){!this.enabled&&this.deps.size>0?(this.enabled=!0,Me(this.pick,this.deps)):this.enabled&&this.pick.size>0&&Me(this.pick,this.deps)}}]),o}(Ie),Oe={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},De=b(),we=function(e){a(i,e);var n=d(i);function i(e){var r;return t(this,i),r=n.call(this),!0===e?r.setupFromTrue():void 0===e?r.setupFromUndefined():Array.isArray(e)?r.setupFromArray(e):"object"==typeof e?r.setupFromObject(e):F("Invalid options argument ".concat(e)),void 0===r.firstChunkSize&&(r.firstChunkSize=T?r.firstChunkSizeBrowser:r.firstChunkSizeNode),r.mergeOutput&&(r.ifd1.enabled=!1),r.filterNestedSegmentTags(),r.traverseTiffDependencyTree(),r.checkLoadedPlugins(),r}return r(i,[{key:"setupFromUndefined",value:function(){var e,t=ye;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=S(t));for(var n=0;n<t.length;n++)this[e=t[n]]=Oe[e];var r=Ae;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=S(r));for(var i=0;i<r.length;i++)this[e=r[i]]=Oe[e];var a=Pe;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=S(a));for(var o=0;o<a.length;o++)this[e=a[o]]=Oe[e];var s=Ce;Array.isArray(s)||("function"==typeof s.entries&&(s=s.entries()),s=S(s));for(var u=0;u<s.length;u++)this[e=s[u]]=new Te(e,Oe[e],void 0,this)}},{key:"setupFromTrue",value:function(){var e,t=ye;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=S(t));for(var n=0;n<t.length;n++)this[e=t[n]]=Oe[e];var r=Ae;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=S(r));for(var i=0;i<r.length;i++)this[e=r[i]]=Oe[e];var a=Pe;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=S(a));for(var o=0;o<a.length;o++)this[e=a[o]]=!0;var s=Ce;Array.isArray(s)||("function"==typeof s.entries&&(s=s.entries()),s=S(s));for(var u=0;u<s.length;u++)this[e=s[u]]=new Te(e,!0,void 0,this)}},{key:"setupFromArray",value:function(e){var t,n=ye;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++)this[t=n[r]]=Oe[t];var i=Ae;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=S(i));for(var a=0;a<i.length;a++)this[t=i[a]]=Oe[t];var o=Pe;Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=S(o));for(var s=0;s<o.length;s++)this[t=o[s]]=Oe[t];var u=Ce;Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=S(u));for(var f=0;f<u.length;f++)this[t=u[f]]=new Te(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,Se)}},{key:"setupFromObject",value:function(e){var t;Se.ifd0=Se.ifd0||Se.image,Se.ifd1=Se.ifd1||Se.thumbnail,m(this,e);var n=ye;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++)this[t=n[r]]=Re(e[t],Oe[t]);var i=Ae;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=S(i));for(var a=0;a<i.length;a++)this[t=i[a]]=Re(e[t],Oe[t]);var o=Pe;Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=S(o));for(var s=0;s<o.length;s++)this[t=o[s]]=Re(e[t],Oe[t]);var u=ke;Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=S(u));for(var f=0;f<u.length;f++)this[t=u[f]]=new Te(t,Oe[t],e[t],this);var c=Se;Array.isArray(c)||("function"==typeof c.entries&&(c=c.entries()),c=S(c));for(var l=0;l<c.length;l++)this[t=c[l]]=new Te(t,Oe[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,Se,Ce),!0===e.tiff?this.batchEnableWithBool(Se,!0):!1===e.tiff?this.batchEnableWithUserValue(Se,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,Se):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,Se)}},{key:"batchEnableWithBool",value:function(e,t){var n=e;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++){this[n[r]].enabled=t}}},{key:"batchEnableWithUserValue",value:function(e,t){var n=e;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++){var i=n[r],a=t[i];this[i].enabled=!1!==a&&void 0!==a}}},{key:"setupGlobalFilters",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;if(e&&e.length){var i=r;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=S(i));for(var a=0;a<i.length;a++){var o=i[a];this[o].enabled=!1}var s=xe(e,n),u=s;Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=S(u));for(var f=0;f<u.length;f++){var c=u[f],l=c[0],h=c[1];Me(this[l].pick,h),this[l].enabled=!0}}else if(t&&t.length){var d=xe(t,n),p=d;Array.isArray(p)||("function"==typeof p.entries&&(p=p.entries()),p=S(p));for(var g=0;g<p.length;g++){var v=p[g],y=v[0],m=v[1];Me(this[y].skip,m)}}}},{key:"filterNestedSegmentTags",value:function(){var e=this.ifd0,t=this.exif,n=this.xmp,r=this.iptc,i=this.icc;this.makerNote?t.deps.add(fe):t.skip.add(fe),this.userComment?t.deps.add(ce):t.skip.add(ce),n.enabled||e.skip.add(le),r.enabled||e.skip.add(he),i.enabled||e.skip.add(de)}},{key:"traverseTiffDependencyTree",value:function(){var e=this,t=this.ifd0,n=this.exif,r=this.gps;this.interop.needed&&(n.deps.add(ve),t.deps.add(ve)),n.needed&&t.deps.add(pe),r.needed&&t.deps.add(ge),this.tiff.enabled=Se.some((function(t){return!0===e[t].enabled}))||this.makerNote||this.userComment;var i=Se;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=S(i));for(var a=0;a<i.length;a++){this[i[a]].finalizeFilters()}}},{key:"onlyTiff",get:function(){var e=this;return!me.map((function(t){return e[t].enabled})).some((function(e){return!0===e}))&&this.tiff.enabled}},{key:"checkLoadedPlugins",value:function(){var e=ke;Array.isArray(e)||("function"==typeof e.entries&&(e=e.entries()),e=S(e));for(var t=0;t<e.length;t++){var n=e[t];this[n].enabled&&!W.has(n)&&z("segment parser",n)}}}],[{key:"useCached",value:function(e){var t=De.get(e);return void 0!==t||(t=new this(e),De.set(e,t)),t}}]),i}(Ie);function xe(e,t){var n,r,i,a=[],o=t;Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=S(o));for(var s=0;s<o.length;s++){r=o[s],n=[];var u=oe.get(r);Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=S(u));for(var f=0;f<u.length;f++)i=u[f],(e.includes(i[0])||e.includes(i[1]))&&n.push(i[0]);n.length&&a.push([r,n])}return a}function Re(e,t){return void 0!==e?e:void 0!==t?t:void 0}function Me(e,t){var n=t;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++){var i=n[r];e.add(i)}}function Le(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Ue(){}function Fe(e,t){if(!t)return e&&e.then?e.then(Ue):Promise.resolve()}function Ee(e,t){var n=e();return n&&n.then?n.then(t):t(n)}i(we,"default",Oe);var Be=function(){function e(n){var r=this;t(this,e),i(this,"parsers",{}),i(this,"output",{}),i(this,"errors",[]),i(this,"pushToErrors",(function(e){return r.errors.push(e)})),this.options=we.useCached(n)}return r(e,[{key:"read",value:function(e){try{var t=this;return Le($(e,t.options),(function(e){t.file=e}))}catch(e){return Promise.reject(e)}}},{key:"setup",value:function(){if(!this.fileParser){var e=this.file,t=e.getUint16(0),n=_;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++){var i=n[r],a=i[0],o=i[1];if(o.canHandle(e,t))return this.fileParser=new o(this.options,this.file,this.parsers),e[a]=!0}this.file.close&&this.file.close(),F("Unknown file format")}}},{key:"parse",value:function(){try{var e=this,t=e.output,n=e.errors;return e.setup(),Ee((function(){return e.options.silentErrors?Le(e.executeParsers().catch(e.pushToErrors),(function(){n.push.apply(n,e.fileParser.errors)})):Fe(e.executeParsers())}),(function(){return e.file.close&&e.file.close(),e.options.silentErrors&&n.length>0&&(t.errors=n),M(t)}))}catch(e){return Promise.reject(e)}}},{key:"executeParsers",value:function(){try{var e=this,t=e.output;return Le(e.fileParser.parse(),(function(){var n=v(e.parsers).map(function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(e){return Le(e.parse(),(function(n){e.assignToOutput(t,n)}))})));return e.options.silentErrors&&(n=n.map((function(t){return t.catch(e.pushToErrors)}))),Fe(Promise.all(n))}))}catch(e){return Promise.reject(e)}}},{key:"extractThumbnail",value:function(){try{var e=this;e.setup();var t,n=e.options,r=e.file,i=W.get("tiff",n);return Ee((function(){if(!r.tiff)return function(e){var t=e();if(t&&t.then)return t.then(Ue)}((function(){if(r.jpeg)return Le(e.fileParser.getOrFindSegment("tiff"),(function(e){t=e}))}));t={start:0,type:"tiff"}}),(function(){if(void 0!==t)return Le(e.fileParser.ensureSegmentChunk(t),(function(t){return Le((e.parsers.tiff=new i(t,n,r)).extractThumbnail(),(function(e){return r.close&&r.close(),e}))}))}))}catch(e){return Promise.reject(e)}}}]),e}();var Ne=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(e,t){var n,r,i,a=new Be(t);return n=a.read(e),r=function(){return a.parse()},i?r?r(n):n:(n&&n.then||(n=Promise.resolve(n)),r?n.then(r):n)})),Ge=Object.freeze({__proto__:null,parse:Ne,Exifr:Be,fileParsers:_,segmentParsers:W,fileReaders:K,tagKeys:oe,tagValues:se,tagRevivers:ue,createDictionary:ie,extendDictionary:ae,fetchUrlAsArrayBuffer:te,readBlobAsArrayBuffer:ne,chunkedProps:ye,otherSegments:me,segments:ke,tiffBlocks:Se,segmentsAndBlocks:Ce,tiffExtractables:Pe,inheritables:be,allFormatters:Ae,Options:we});function je(){}var Ve=function(){function e(n,r,a){var o=this;t(this,e),i(this,"errors",[]),i(this,"ensureSegmentChunk",function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(e){var t,n,r,i=e.start,a=e.size||65536;return t=function(){if(o.file.chunked)return function(e){var t=e();if(t&&t.then)return t.then(je)}((function(){if(!o.file.available(i,a))return function(e){if(e&&e.then)return e.then(je)}(function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){return t=o.file.readChunk(i,a),n=function(t){e.chunk=t},r?n?n(t):t:(t&&t.then||(t=Promise.resolve(t)),n?t.then(n):t);var t,n,r}),(function(t){F("Couldn't read segment: ".concat(JSON.stringify(e),". ").concat(t.message))})));e.chunk=o.file.subarray(i,a)}));o.file.byteLength>i+a?e.chunk=o.file.subarray(i,a):void 0===e.size?e.chunk=o.file.subarray(i):F("Segment unreachable: "+JSON.stringify(e))},n=function(){return e.chunk},(r=t())&&r.then?r.then(n):n(r)}))),this.extendOptions&&this.extendOptions(n),this.options=n,this.file=r,this.parsers=a}return r(e,[{key:"injectSegment",value:function(e,t){this.options[e].enabled&&this.createParser(e,t)}},{key:"createParser",value:function(e,t){var n=new(W.get(e))(t,this.options,this.file);return this.parsers[e]=n}},{key:"createParsers",value:function(e){var t=e;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=S(t));for(var n=0;n<t.length;n++){var r=t[n],i=r.type,a=r.chunk,o=this.options[i];if(o&&o.enabled){var s=this.parsers[i];s&&s.append||s||this.createParser(i,a)}}}},{key:"readSegments",value:function(e){try{var t=e.map(this.ensureSegmentChunk);return function(e,t){if(!t)return e&&e.then?e.then(je):Promise.resolve()}(Promise.all(t))}catch(e){return Promise.reject(e)}}}]),e}(),ze=function(){function e(n){var r=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;t(this,e),i(this,"errors",[]),i(this,"raw",b()),i(this,"handleError",(function(e){if(!r.options.silentErrors)throw e;r.errors.push(e.message)})),this.chunk=this.normalizeInput(n),this.file=o,this.type=this.constructor.type,this.globalOptions=this.options=a,this.localOptions=a[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}return r(e,[{key:"normalizeInput",value:function(e){return e instanceof V?e:new V(e)}},{key:"translate",value:function(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}},{key:"output",get:function(){return this.translated?this.translated:this.raw?k(this.raw):void 0}},{key:"translateBlock",value:function(e,t){var n=ue.get(t),r=se.get(t),i=oe.get(t),a=this.options[t],o=a.reviveValues&&!!n,s=a.translateValues&&!!r,u=a.translateKeys&&!!i,f={},c=e;Array.isArray(c)||("function"==typeof c.entries&&(c=c.entries()),c=S(c));for(var l=0;l<c.length;l++){var h=c[l],d=h[0],p=h[1];o&&n.has(d)?p=n.get(d)(p):s&&r.has(d)&&(p=this.translateValue(p,r.get(d))),u&&i.has(d)&&(d=i.get(d)||d),f[d]=p}return f}},{key:"translateValue",value:function(e,t){return t[e]||t.DEFAULT||e}},{key:"assignToOutput",value:function(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}},{key:"assignObjectToOutput",value:function(e,t,n){if(this.globalOptions.mergeOutput)return m(e,n);e[t]?m(e[t],n):e[t]=n}}],[{key:"findPosition",value:function(e,t){var n=e.getUint16(t+2)+2,r="function"==typeof this.headerLength?this.headerLength(e,t,n):this.headerLength,i=t+r,a=n-r;return{offset:t,length:n,headerLength:r,start:i,size:a,end:i+a}}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new we(i({},this.type,t)),r=new this(e,n,e);return r.parse()}}]),e}();function He(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}i(ze,"headerLength",4),i(ze,"type",void 0),i(ze,"multiSegment",!1),i(ze,"canHandle",(function(){return!1}));function _e(){}function We(e,t){if(!t)return e&&e.then?e.then(_e):Promise.resolve()}function Ke(e){var t=e();if(t&&t.then)return t.then(_e)}function Xe(e,t){var n=e();return n&&n.then?n.then(t):t(n)}function Ye(e,t,n){if(!e.s){if(n instanceof Je){if(!n.s)return void(n.o=Ye.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(Ye.bind(null,e,t),Ye.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var Je=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,i=this.s;if(i){var a=1&i?t:n;if(a){try{Ye(r,1,a(this.v))}catch(e){Ye(r,2,e)}return r}return this}return this.o=function(e){try{var i=e.v;1&e.s?Ye(r,1,t?t(i):i):n?Ye(r,1,n(i)):Ye(r,2,i)}catch(e){Ye(r,2,e)}},r},e}();function qe(e){return e instanceof Je&&1&e.s}function Qe(e,t,n){for(var r;;){var i=e();if(qe(i)&&(i=i.v),!i)return a;if(i.then){r=0;break}var a=n();if(a&&a.then){if(!qe(a)){r=1;break}a=a.s}if(t){var o=t();if(o&&o.then&&!qe(o)){r=2;break}}}var s=new Je,u=Ye.bind(null,s,2);return(0===r?i.then(c):1===r?a.then(f):o.then(l)).then(void 0,u),s;function f(r){a=r;do{if(t&&(o=t())&&o.then&&!qe(o))return void o.then(l).then(void 0,u);if(!(i=e())||qe(i)&&!i.v)return void Ye(s,1,a);if(i.then)return void i.then(c).then(void 0,u);qe(a=n())&&(a=a.v)}while(!a||!a.then);a.then(f).then(void 0,u)}function c(e){e?(a=n())&&a.then?a.then(f).then(void 0,u):f(a):Ye(s,1,a)}function l(){(i=e())?i.then?i.then(c).then(void 0,u):c(i):Ye(s,1,a)}}function Ze(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function $e(e){return e>=224&&e<=239}function et(e,t,n){var r=W;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=S(r));for(var i=0;i<r.length;i++){var a=r[i],o=a[0];if(a[1].canHandle(e,t,n))return o}}var tt=function(e){a(o,e);var n=d(o);function o(){var e;t(this,o);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return i(l(e=n.call.apply(n,[this].concat(a))),"appSegments",[]),i(l(e),"jpegSegments",[]),i(l(e),"unknownSegments",[]),e}return r(o,[{key:"parse",value:function(){try{var e=this;return He(e.findAppSegments(),(function(){return He(e.readSegments(e.appSegments),(function(){e.mergeMultiSegments(),e.createParsers(e.mergedAppSegments||e.appSegments)}))}))}catch(e){return Promise.reject(e)}}},{key:"setupSegmentFinderArgs",value:function(e){var t=this;!0===e?(this.findAll=!0,this.wanted=P(W.keyList())):(e=void 0===e?W.keyList().filter((function(e){return t.options[e].enabled})):e.filter((function(e){return t.options[e].enabled&&W.has(e)})),this.findAll=!1,this.remaining=P(e),this.wanted=P(e)),this.unfinishedMultiSegment=!1}},{key:"findAppSegments",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;try{var n=this;n.setupSegmentFinderArgs(t);var r=n.file,i=n.findAll,a=n.wanted,o=n.remaining;return Xe((function(){if(!i&&n.file.chunked)return i=S(a).some((function(e){var t=W.get(e),r=n.options[e];return t.multiSegment&&r.multiSegment})),Ke((function(){if(i)return We(n.file.readWhole())}))}),(function(){var t=!1;if(e=n.findAppSegmentsInRange(e,r.byteLength),!n.options.onlyTiff)return function(){if(r.chunked){var i=!1;return Qe((function(){return!t&&o.size>0&&!i&&(!!r.canReadNextChunk||!!n.unfinishedMultiSegment)}),void 0,(function(){var a=r.nextChunkOffset,o=n.appSegments.some((function(e){return!n.file.available(e.offset||e.start,e.length||e.size)}));return Xe((function(){return e>a&&!o?He(r.readNextChunk(e),(function(e){i=!e})):He(r.readNextChunk(a),(function(e){i=!e}))}),(function(){void 0===(e=n.findAppSegmentsInRange(e,r.byteLength))&&(t=!0)}))}))}}()}))}catch(e){return Promise.reject(e)}}},{key:"findAppSegmentsInRange",value:function(e,t){t-=2;for(var n,r,i,a,o,s,u=this.file,f=this.findAll,c=this.wanted,l=this.remaining,h=this.options;e<t;e++)if(255===u.getUint8(e))if($e(n=u.getUint8(e+1))){if(r=u.getUint16(e+2),(i=et(u,e,r))&&c.has(i)&&(o=(a=W.get(i)).findPosition(u,e),s=h[i],o.type=i,this.appSegments.push(o),!f&&(a.multiSegment&&s.multiSegment?(this.unfinishedMultiSegment=o.chunkNumber<o.chunkCount,this.unfinishedMultiSegment||l.delete(i)):l.delete(i),0===l.size)))break;h.recordUnknownSegments&&((o=ze.findPosition(u,e)).marker=n,this.unknownSegments.push(o)),e+=r+1}else if(Ze(n)){if(r=u.getUint16(e+2),218===n&&!1!==h.stopAfterSos)return;h.recordJpegSegments&&this.jpegSegments.push({offset:e,length:r,marker:n}),e+=r+1}return e}},{key:"mergeMultiSegments",value:function(){var e=this;if(this.appSegments.some((function(e){return e.multiSegment}))){var t=function(e,t){for(var n,r,i,a=b(),o=0;o<e.length;o++)r=(n=e[o])[t],a.has(r)?i=a.get(r):a.set(r,i=[]),i.push(n);return S(a)}(this.appSegments,"type");this.mergedAppSegments=t.map((function(t){var n=t[0],r=t[1],i=W.get(n,e.options);return i.handleMultiSegments?{type:n,chunk:i.handleMultiSegments(r)}:r[0]}))}}},{key:"getSegment",value:function(e){return this.appSegments.find((function(t){return t.type===e}))}},{key:"getOrFindSegment",value:function(e){try{var t=this,n=t.getSegment(e);return Xe((function(){if(void 0===n)return He(t.findAppSegments(0,[e]),(function(){n=t.getSegment(e)}))}),(function(){return n}))}catch(e){return Promise.reject(e)}}}],[{key:"canHandle",value:function(e,t){return 65496===t}}]),o}(Ve);function nt(){}i(tt,"type","jpeg"),_.set("jpeg",tt);function rt(e,t){if(!t)return e&&e.then?e.then(nt):Promise.resolve()}function it(e,t){var n=e();return n&&n.then?n.then(t):t(n)}var at=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];var ot=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parse",value:function(){try{var e=this;e.parseHeader();var t=e.options;return it((function(){if(t.ifd0.enabled)return rt(e.parseIfd0Block())}),(function(){return it((function(){if(t.exif.enabled)return rt(e.safeParse("parseExifBlock"))}),(function(){return it((function(){if(t.gps.enabled)return rt(e.safeParse("parseGpsBlock"))}),(function(){return it((function(){if(t.interop.enabled)return rt(e.safeParse("parseInteropBlock"))}),(function(){return it((function(){if(t.ifd1.enabled)return rt(e.safeParse("parseThumbnailBlock"))}),(function(){return e.createOutput()}))}))}))}))}))}catch(e){return Promise.reject(e)}}},{key:"safeParse",value:function(e){var t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}},{key:"findIfd0Offset",value:function(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}},{key:"findIfd1Offset",value:function(){if(void 0===this.ifd1Offset){this.findIfd0Offset();var e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}},{key:"parseBlock",value:function(e,t){var n=b();return this[t]=n,this.parseTags(e,t,n),n}},{key:"parseIfd0Block",value:function(){try{var e=this;if(e.ifd0)return;var t=e.file;return e.findIfd0Offset(),e.ifd0Offset<8&&F("Malformed EXIF data"),!t.chunked&&e.ifd0Offset>t.byteLength&&F("IFD0 offset points to outside of file.\nthis.ifd0Offset: ".concat(e.ifd0Offset,", file.byteLength: ").concat(t.byteLength)),it((function(){if(t.tiff)return rt(t.ensureChunk(e.ifd0Offset,B(e.options)))}),(function(){var t=e.parseBlock(e.ifd0Offset,"ifd0");if(0!==t.size)return e.exifOffset=t.get(pe),e.interopOffset=t.get(ve),e.gpsOffset=t.get(ge),e.xmp=t.get(le),e.iptc=t.get(he),e.icc=t.get(de),e.options.sanitize&&(t.delete(pe),t.delete(ve),t.delete(ge),t.delete(le),t.delete(he),t.delete(de)),t}))}catch(e){return Promise.reject(e)}}},{key:"parseExifBlock",value:function(){try{var e=this;if(e.exif)return;return it((function(){if(!e.ifd0)return rt(e.parseIfd0Block())}),(function(){if(void 0!==e.exifOffset)return it((function(){if(e.file.tiff)return rt(e.file.ensureChunk(e.exifOffset,B(e.options)))}),(function(){var t=e.parseBlock(e.exifOffset,"exif");return e.interopOffset||(e.interopOffset=t.get(ve)),e.makerNote=t.get(fe),e.userComment=t.get(ce),e.options.sanitize&&(t.delete(ve),t.delete(fe),t.delete(ce)),e.unpack(t,41728),e.unpack(t,41729),t}))}))}catch(e){return Promise.reject(e)}}},{key:"unpack",value:function(e,t){var n=e.get(t);n&&1===n.length&&e.set(t,n[0])}},{key:"parseGpsBlock",value:function(){try{var e=this;if(e.gps)return;return it((function(){if(!e.ifd0)return rt(e.parseIfd0Block())}),(function(){if(void 0!==e.gpsOffset){var t=e.parseBlock(e.gpsOffset,"gps");return t&&t.has(2)&&t.has(4)&&(t.set("latitude",st.apply(void 0,t.get(2).concat([t.get(1)]))),t.set("longitude",st.apply(void 0,t.get(4).concat([t.get(3)])))),t}}))}catch(e){return Promise.reject(e)}}},{key:"parseInteropBlock",value:function(){try{var e=this;if(e.interop)return;return it((function(){if(!e.ifd0)return rt(e.parseIfd0Block())}),(function(){return it((function(){if(void 0===e.interopOffset&&!e.exif)return rt(e.parseExifBlock())}),(function(){if(void 0!==e.interopOffset)return e.parseBlock(e.interopOffset,"interop")}))}))}catch(e){return Promise.reject(e)}}},{key:"parseThumbnailBlock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{var t=this;if(t.ifd1||t.ifd1Parsed)return;if(t.options.mergeOutput&&!e)return;return t.findIfd1Offset(),t.ifd1Offset>0&&(t.parseBlock(t.ifd1Offset,"ifd1"),t.ifd1Parsed=!0),t.ifd1}catch(e){return Promise.reject(e)}}},{key:"extractThumbnail",value:function(){try{var e=this;return e.headerParsed||e.parseHeader(),it((function(){if(!e.ifd1Parsed)return rt(e.parseThumbnailBlock(!0))}),(function(){if(void 0!==e.ifd1){var t=e.ifd1.get(513),n=e.ifd1.get(514);return e.chunk.getUint8Array(t,n)}}))}catch(e){return Promise.reject(e)}}},{key:"image",get:function(){return this.ifd0}},{key:"thumbnail",get:function(){return this.ifd1}},{key:"createOutput",value:function(){var e,t,n,r={},i=Se;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=S(i));for(var a=0;a<i.length;a++)if(!U(e=this[t=i[a]]))if(n=this.canTranslate?this.translateBlock(e,t):k(e),this.options.mergeOutput){if("ifd1"===t)continue;m(r,n)}else r[t]=n;return this.makerNote&&(r.makerNote=this.makerNote),this.userComment&&(r.userComment=this.userComment),r}},{key:"assignToOutput",value:function(e,t){if(this.globalOptions.mergeOutput)m(e,t);else{var n=y(t);Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++){var i=n[r],a=i[0],o=i[1];this.assignObjectToOutput(e,a,o)}}}}],[{key:"canHandle",value:function(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}}]),i}(function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parseHeader",value:function(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}},{key:"parseTags",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b(),r=this.options[t],i=r.pick,a=r.skip,o=(i=P(i)).size>0,s=0===a.size,u=this.chunk.getUint16(e);e+=2;for(var f=0;f<u;f++){var c=this.chunk.getUint16(e);if(o){if(i.has(c)&&(n.set(c,this.parseTag(e,c,t)),i.delete(c),0===i.size))break}else!s&&a.has(c)||n.set(c,this.parseTag(e,c,t));e+=12}return n}},{key:"parseTag",value:function(e,t,n){var r=this.chunk,i=r.getUint16(e+2),a=r.getUint32(e+4),o=at[i];if(o*a<=4?e+=8:e=r.getUint32(e+8),(i<1||i>13)&&F("Invalid TIFF value type. block: ".concat(n.toUpperCase(),", tag: ").concat(t.toString(16),", type: ").concat(i,", offset ").concat(e)),e>r.byteLength&&F("Invalid TIFF value offset. block: ".concat(n.toUpperCase(),", tag: ").concat(t.toString(16),", type: ").concat(i,", offset ").concat(e," is outside of chunk size ").concat(r.byteLength)),1===i)return r.getUint8Array(e,a);if(2===i)return E(r.getString(e,a));if(7===i)return r.getUint8Array(e,a);if(1===a)return this.parseTagValue(i,e);for(var s=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(i))(a),u=o,f=0;f<a;f++)s[f]=this.parseTagValue(i,e),e+=u;return s}},{key:"parseTagValue",value:function(e,t){var n=this.chunk;switch(e){case 1:return n.getUint8(t);case 3:return n.getUint16(t);case 4:return n.getUint32(t);case 5:return n.getUint32(t)/n.getUint32(t+4);case 6:return n.getInt8(t);case 8:return n.getInt16(t);case 9:return n.getInt32(t);case 10:return n.getInt32(t)/n.getInt32(t+4);case 11:return n.getFloat(t);case 12:return n.getDouble(t);case 13:return n.getUint32(t);default:F("Invalid tiff type ".concat(e))}}}]),i}(ze));function st(e,t,n,r){var i=e+t/60+n/3600;return"S"!==r&&"W"!==r||(i*=-1),i}i(ot,"type","tiff"),i(ot,"headerLength",10),W.set("tiff",ot);var ut=Object.freeze({__proto__:null,default:Ge,Exifr:Be,fileParsers:_,segmentParsers:W,fileReaders:K,tagKeys:oe,tagValues:se,tagRevivers:ue,createDictionary:ie,extendDictionary:ae,fetchUrlAsArrayBuffer:te,readBlobAsArrayBuffer:ne,chunkedProps:ye,otherSegments:me,segments:ke,tiffBlocks:Se,segmentsAndBlocks:Ce,tiffExtractables:Pe,inheritables:be,allFormatters:Ae,Options:we,parse:Ne}),ft={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1};function ct(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var lt=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(e){var t=new Be(ht);return ct(t.read(e),(function(){return ct(t.parse(),(function(e){if(e&&e.gps){var t=e.gps;return{latitude:t.latitude,longitude:t.longitude}}}))}))})),ht=m({},ft,{firstChunkSize:4e4,gps:[1,2,3,4]});function dt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function pt(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var gt=pt((function(e){return dt(this.thumbnail(e),(function(e){if(void 0!==e){var t=new Blob([e]);return URL.createObjectURL(t)}}))})),vt=pt((function(e){var t=new Be(yt);return dt(t.read(e),(function(){return dt(t.extractThumbnail(),(function(e){return e&&R?w.from(e):e}))}))})),yt=m({},ft,{tiff:!1,ifd1:!0,mergeOutput:!1});function mt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var kt=function(t){return mt(St(t),(function(t){return m({canvas:e.rotateCanvas,css:e.rotateCss},Pt[t])}))},St=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(e){var t=new Be(Ct);return mt(t.read(e),(function(){return mt(t.parse(),(function(e){if(e&&e.ifd0)return e.ifd0[274]}))}))})),Ct=m({},ft,{firstChunkSize:4e4,ifd0:[274]}),Pt=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});if(e.rotateCanvas=!0,e.rotateCss=!0,"object"==typeof navigator){var bt=navigator.userAgent;if(bt.includes("iPad")||bt.includes("iPhone")){var At=bt.match(/OS (\d+)_(\d+)/);if(At){var It=At[1],Tt=At[2],Ot=Number(It)+.1*Number(Tt);e.rotateCanvas=Ot<13.4,e.rotateCss=!1}}else if(bt.includes("OS X 10")){var Dt=bt.match(/OS X 10[_.](\d+)/)[1];e.rotateCanvas=e.rotateCss=Number(Dt)<15}if(bt.includes("Chrome/")){var wt=bt.match(/Chrome\/(\d+)/)[1];e.rotateCanvas=e.rotateCss=Number(wt)<81}else if(bt.includes("Firefox/")){var xt=bt.match(/Firefox\/(\d+)/)[1];e.rotateCanvas=e.rotateCss=Number(xt)<77}}function Rt(){}var Mt=function(e){a(s,e);var n=d(s);function s(){var e;t(this,s);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i(l(e=n.call.apply(n,[this].concat(a))),"ranges",new Lt),0!==e.byteLength&&e.ranges.add(0,e.byteLength),e}return r(s,[{key:"_tryExtend",value:function(e,t,n){if(0===e&&0===this.byteLength&&n){var r=new DataView(n.buffer||n,n.byteOffset,n.byteLength);this._swapDataView(r)}else{var i=e+t;if(i>this.byteLength){var a=this._extend(i).dataView;this._swapDataView(a)}}}},{key:"_extend",value:function(e){var t;t=R?w.allocUnsafe(e):new Uint8Array(e);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:n}}},{key:"subarray",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t=t||this._lengthToEnd(e),n&&this._tryExtend(e,t),this.ranges.add(e,t),p(o(s.prototype),"subarray",this).call(this,e,t)}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n&&this._tryExtend(t,e.byteLength,e);var r=p(o(s.prototype),"set",this).call(this,e,t);return this.ranges.add(t,r.byteLength),r}},{key:"ensureChunk",value:function(e,t){try{var n=this;if(!n.chunked)return;if(n.ranges.available(e,t))return;return function(e,t){if(!t)return e&&e.then?e.then(Rt):Promise.resolve()}(n.readChunk(e,t))}catch(e){return Promise.reject(e)}}},{key:"available",value:function(e,t){return this.ranges.available(e,t)}}]),s}(V),Lt=function(){function e(){t(this,e),i(this,"list",[])}return r(e,[{key:"length",get:function(){return this.list.length}},{key:"add",value:function(e,t){var n=e+t,r=this.list.filter((function(t){return Ut(e,t.offset,n)||Ut(e,t.end,n)}));if(r.length>0){e=Math.min.apply(Math,[e].concat(r.map((function(e){return e.offset})))),t=(n=Math.max.apply(Math,[n].concat(r.map((function(e){return e.end})))))-e;var i=r.shift();i.offset=e,i.length=t,i.end=n,this.list=this.list.filter((function(e){return!r.includes(e)}))}else this.list.push({offset:e,length:t,end:n})}},{key:"available",value:function(e,t){var n=e+t;return this.list.some((function(t){return t.offset<=e&&n<=t.end}))}}]),e}();function Ut(e,t,n){return e<=t&&t<=n}function Ft(){}function Et(e,t){if(!t)return e&&e.then?e.then(Ft):Promise.resolve()}var Bt=function(e){a(o,e);var n=d(o);function o(e,r){var a;return t(this,o),i(l(a=n.call(this,0)),"chunksRead",0),a.input=e,a.options=r,a}return r(o,[{key:"readWhole",value:function(){try{var e=this;return e.chunked=!1,Et(e.readChunk(e.nextChunkOffset))}catch(e){return Promise.reject(e)}}},{key:"readChunked",value:function(){try{var e=this;return e.chunked=!0,Et(e.readChunk(0,e.options.firstChunkSize))}catch(e){return Promise.reject(e)}}},{key:"readNextChunk",value:function(e){try{var t=this;if(void 0===e&&(e=t.nextChunkOffset),t.fullyRead)return t.chunksRead++,!1;var n=t.options.chunkSize;return r=t.readChunk(e,n),i=function(e){return!!e&&e.byteLength===n},a?i?i(r):r:(r&&r.then||(r=Promise.resolve(r)),i?r.then(i):r)}catch(e){return Promise.reject(e)}var r,i,a}},{key:"readChunk",value:function(e,t){try{var n=this;if(n.chunksRead++,0===(t=n.safeWrapAddress(e,t)))return;return n._readChunk(e,t)}catch(e){return Promise.reject(e)}}},{key:"safeWrapAddress",value:function(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}},{key:"nextChunkOffset",get:function(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}},{key:"canReadNextChunk",get:function(){return this.chunksRead<this.options.chunkLimit}},{key:"fullyRead",get:function(){return void 0!==this.size&&this.nextChunkOffset===this.size}},{key:"read",value:function(){return this.options.chunked?this.readChunked():this.readWhole()}},{key:"close",value:function(){}}]),o}(Mt);function Nt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var Gt=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"readWhole",value:function(){try{var e=this;return e.chunked=!1,Nt(ne(e.input),(function(t){e._swapArrayBuffer(t)}))}catch(e){return Promise.reject(e)}}},{key:"readChunked",value:function(){return this.chunked=!0,this.size=this.input.size,p(o(i.prototype),"readChunked",this).call(this)}},{key:"_readChunk",value:function(e,t){try{var n=this,r=t?e+t:void 0,i=n.input.slice(e,r);return Nt(ne(i),(function(t){return n.set(t,e,!0)}))}catch(e){return Promise.reject(e)}}}]),i}(Bt);K.set("blob",Gt);var jt=Object.freeze({__proto__:null,default:ut,Exifr:Be,fileParsers:_,segmentParsers:W,fileReaders:K,tagKeys:oe,tagValues:se,tagRevivers:ue,createDictionary:ie,extendDictionary:ae,fetchUrlAsArrayBuffer:te,readBlobAsArrayBuffer:ne,chunkedProps:ye,otherSegments:me,segments:ke,tiffBlocks:Se,segmentsAndBlocks:Ce,tiffExtractables:Pe,inheritables:be,allFormatters:Ae,Options:we,parse:Ne,gps:lt,gpsOnlyOptions:ht,thumbnailUrl:gt,thumbnail:vt,thumbnailOnlyOptions:yt,rotation:kt,orientation:St,orientationOnlyOptions:Ct,rotations:Pt,get rotateCanvas(){return e.rotateCanvas},get rotateCss(){return e.rotateCss}});function Vt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var zt=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"readWhole",value:function(){try{var e=this;return e.chunked=!1,Vt(te(e.input),(function(t){t instanceof ArrayBuffer?e._swapArrayBuffer(t):t instanceof Uint8Array&&e._swapBuffer(t)}))}catch(e){return Promise.reject(e)}}},{key:"_readChunk",value:function(e,t){try{var n=this,r=t?e+t-1:void 0,i=n.options.httpHeaders||{};return(e||r)&&(i.range="bytes=".concat([e,r].join("-"))),Vt(I(n.input,{headers:i}),(function(r){return Vt(r.arrayBuffer(),(function(i){var a=i.byteLength;if(416!==r.status)return a!==t&&(n.size=e+a),n.set(i,e,!0)}))}))}catch(e){return Promise.reject(e)}}}]),i}(Bt);K.set("url",zt);function Ht(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}V.prototype.getUint64=function(e){var t=this.getUint32(e),n=this.getUint32(e+4);return t<1048575?t<<32|n:void 0!==typeof x?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),x(t)<<x(32)|x(n)):void F("Trying to read 64b value but JS can only handle 53b numbers.")};function _t(e,t,n){if(!e.s){if(n instanceof Wt){if(!n.s)return void(n.o=_t.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(_t.bind(null,e,t),_t.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var Wt=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,i=this.s;if(i){var a=1&i?t:n;if(a){try{_t(r,1,a(this.v))}catch(e){_t(r,2,e)}return r}return this}return this.o=function(e){try{var i=e.v;1&e.s?_t(r,1,t?t(i):i):n?_t(r,1,n(i)):_t(r,2,i)}catch(e){_t(r,2,e)}},r},e}();function Kt(e){return e instanceof Wt&&1&e.s}function Xt(){}function Yt(e,t){if(!t)return e&&e.then?e.then(Xt):Promise.resolve()}var Jt=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parse",value:function(){try{var e=this,t=e.file.getUint32(0),n=e.parseBoxHead(t);return r=function(e,t,n){for(var r;;){var i=e();if(Kt(i)&&(i=i.v),!i)return a;if(i.then){r=0;break}var a=n();if(a&&a.then){if(!Kt(a)){r=1;break}a=a.s}if(t){var o=t();if(o&&o.then&&!Kt(o)){r=2;break}}}var s=new Wt,u=_t.bind(null,s,2);return(0===r?i.then(c):1===r?a.then(f):o.then(l)).then(void 0,u),s;function f(r){a=r;do{if(t&&(o=t())&&o.then&&!Kt(o))return void o.then(l).then(void 0,u);if(!(i=e())||Kt(i)&&!i.v)return void _t(s,1,a);if(i.then)return void i.then(c).then(void 0,u);Kt(a=n())&&(a=a.v)}while(!a||!a.then);a.then(f).then(void 0,u)}function c(e){e?(a=n())&&a.then?a.then(f).then(void 0,u):f(a):_t(s,1,a)}function l(){(i=e())?i.then?i.then(c).then(void 0,u):c(i):_t(s,1,a)}}((function(){return"meta"!==n.kind}),void 0,(function(){return t+=n.length,Ht(e.file.ensureChunk(t,16),(function(){n=e.parseBoxHead(t)}))})),i=function(){return Ht(e.file.ensureChunk(n.offset,n.length),(function(){return e.parseBoxFullHead(n),e.parseSubBoxes(n),t=function(){return function(e){var t=e();if(t&&t.then)return t.then(Xt)}((function(){if(e.options.tiff.enabled)return Yt(e.findExif(n))}))},(r=function(){if(e.options.icc.enabled)return Yt(e.findIcc(n))}())&&r.then?r.then(t):t(r);var t,r}))},r&&r.then?r.then(i):i(r)}catch(e){return Promise.reject(e)}var r,i}},{key:"registerSegment",value:function(e,t,n){try{var r=this;return Ht(r.file.ensureChunk(t,n),(function(){var i=r.file.subarray(t,n);r.createParser(e,i)}))}catch(e){return Promise.reject(e)}}},{key:"findIcc",value:function(e){try{var t=this,n=t.findBox(e,"iprp");if(void 0===n)return;var r=t.findBox(n,"ipco");if(void 0===r)return;var i=t.findBox(r,"colr");if(void 0===i)return;return Yt(t.registerSegment("icc",i.offset+12,i.length))}catch(e){return Promise.reject(e)}}},{key:"findExif",value:function(e){try{var t=this,n=t.findBox(e,"iinf");if(void 0===n)return;var r=t.findBox(e,"iloc");if(void 0===r)return;var i=t.findExifLocIdInIinf(n),a=t.findExtentInIloc(r,i);if(void 0===a)return;var o=a[0],s=a[1];return Ht(t.file.ensureChunk(o,s),(function(){var e=4+t.file.getUint32(o);return o+=e,s-=e,Yt(t.registerSegment("tiff",o,s))}))}catch(e){return Promise.reject(e)}}},{key:"findExifLocIdInIinf",value:function(e){this.parseBoxFullHead(e);var t,n,r,i=e.start,a=this.file.getUint16(i);for(i+=2;a--;){if(t=this.parseBoxHead(i),this.parseBoxFullHead(t),n=t.start,t.version>=2&&(r=3===t.version?4:2,"Exif"===this.file.getString(n+r+2,4)))return this.file.getUintBytes(n,r);i+=t.length}}},{key:"get8bits",value:function(e){var t=this.file.getUint8(e);return[t>>4,15&t]}},{key:"findExtentInIloc",value:function(e,t){this.parseBoxFullHead(e);var n=e.start,r=this.get8bits(n++),i=r[0],a=r[1],o=this.get8bits(n++),s=o[0],u=o[1],f=2===e.version?4:2,c=1===e.version||2===e.version?2:0,l=u+i+a,h=2===e.version?4:2,d=this.file.getUintBytes(n,h);for(n+=h;d--;){var p=this.file.getUintBytes(n,f);n+=f+c+2+s;var g=this.file.getUint16(n);if(n+=2,p===t)return g>1&&console.warn("ILOC box has more than one extent but we're only processing one\nPlease create an issue at https://github.com/MikeKovarik/exifr with this file"),[this.file.getUintBytes(n+u,i),this.file.getUintBytes(n+u+i,a)];n+=g*l}}}],[{key:"canHandle",value:function(e,t){if(0!==t)return!1;var n=e.getUint16(2);if(n>50)return!1;for(var r=16,i=[];r<n;)i.push(e.getString(r,4)),r+=4;return i.includes(this.type)}}]),i}(function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parseBoxes",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=[];e<this.file.byteLength-4;){var n=this.parseBoxHead(e);if(t.push(n),0===n.length)break;e+=n.length}return t}},{key:"parseSubBoxes",value:function(e){e.boxes=this.parseBoxes(e.start)}},{key:"findBox",value:function(e,t){return void 0===e.boxes&&this.parseSubBoxes(e),e.boxes.find((function(e){return e.kind===t}))}},{key:"parseBoxHead",value:function(e){var t=this.file.getUint32(e),n=this.file.getString(e+4,4),r=e+8;return 1===t&&(t=this.file.getUint64(e+8),r+=8),{offset:e,length:t,kind:n,start:r}}},{key:"parseBoxFullHead",value:function(e){if(void 0===e.version){var t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}}]),i}(Ve)),qt=function(e){a(r,e);var n=d(r);function r(){return t(this,r),n.apply(this,arguments)}return r}(Jt);i(qt,"type","heic");var Qt=function(e){a(r,e);var n=d(r);function r(){return t(this,r),n.apply(this,arguments)}return r}(Jt);i(Qt,"type","avif"),_.set("heic",qt),_.set("avif",Qt),ie(oe,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),ie(oe,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),ie(oe,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),ie(se,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);var Zt=ie(se,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]),$t={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};Zt.set(37392,$t),Zt.set(41488,$t);var en={0:"Normal",1:"Low",2:"High"};function tn(e){return"object"==typeof e&&void 0!==e.length?e[0]:e}function nn(e){var t=S(e).slice(1);return t[1]>15&&(t=t.map((function(e){return String.fromCharCode(e)}))),"0"!==t[2]&&0!==t[2]||t.pop(),t.join(".")}function rn(e){if("string"==typeof e){var t=e.trim().split(/[-: ]/g).map(Number),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=new Date(n,r-1,i);return isNaN(a)||isNaN(o)||isNaN(s)||(u.setHours(a),u.setMinutes(o),u.setSeconds(s)),isNaN(+u)?e:u}}function an(e){if("string"==typeof e)return e;var t=[];if(0===e[1]&&0===e[e.length-1])for(var n=0;n<e.length;n+=2)t.push(on(e[n+1],e[n]));else for(var r=0;r<e.length;r+=2)t.push(on(e[r],e[r+1]));return E(String.fromCodePoint.apply(String,t))}function on(e,t){return e<<8|t}Zt.set(41992,en),Zt.set(41993,en),Zt.set(41994,en),ie(ue,["ifd0","ifd1"],[[50827,function(e){return"string"!=typeof e?j(e):e}],[306,rn],[40091,an],[40092,an],[40093,an],[40094,an],[40095,an]]),ie(ue,"exif",[[40960,nn],[36864,nn],[36867,rn],[36868,rn],[40962,tn],[40963,tn]]),ie(ue,"gps",[[0,function(e){return S(e).join(".")}],[7,function(e){return S(e).join(":")}]]);var sn="http://ns.adobe.com/",un="http://ns.adobe.com/xmp/extension/",fn=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"normalizeInput",value:function(e){return"string"==typeof e?e:V.from(e).getString()}},{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chunk;if(!this.localOptions.parse)return e;e=Pn(e);var t=dn.findAll(e,"rdf","Description");0===t.length&&t.push(new dn("rdf","Description",void 0,e));var n={},r=t;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=S(r));for(var i=0;i<r.length;i++){var a=r[i],o=a.properties;Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=S(o));for(var s=0;s<o.length;s++){var u=o[s];pn(u,yn(u.ns,n))}}return cn(n)}},{key:"assignToOutput",value:function(e,t){if(this.localOptions.parse){var n=y(t);Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++){var i=n[r],a=i[0],o=i[1];switch(a){case"tiff":this.assignObjectToOutput(e,"ifd0",o);break;case"exif":this.assignObjectToOutput(e,"exif",o);break;case"xmlns":break;default:this.assignObjectToOutput(e,a,o)}}}else e.xmp=t}}],[{key:"canHandle",value:function(e,t){return 225===e.getUint8(t+1)&&1752462448===e.getUint32(t+4)&&e.getString(t+4,sn.length)===sn}},{key:"headerLength",value:function(e,t){return e.getString(t+4,un.length)===un?79:4+"http://ns.adobe.com/xap/1.0/".length+1}},{key:"findPosition",value:function(e,t){var n=p(o(i),"findPosition",this).call(this,e,t);return n.multiSegment=n.extended=79===n.headerLength,n.multiSegment?(n.chunkCount=e.getUint8(t+72),n.chunkNumber=e.getUint8(t+76),0!==e.getUint8(t+77)&&n.chunkNumber++):(n.chunkCount=1/0,n.chunkNumber=-1),n}},{key:"handleMultiSegments",value:function(e){return e.map((function(e){return e.chunk.getString()})).join("")}}]),i}(ze);function cn(e){for(var t in e)void 0===(e[t]=M(e[t]))&&delete e[t];return M(e)}i(fn,"type","xmp"),i(fn,"multiSegment",!0),W.set("xmp",fn);var ln=function(){function e(n,r,i){t(this,e),this.ns=n,this.name=r,this.value=i}return r(e,[{key:"serialize",value:function(){return this.value}}],[{key:"findAll",value:function(t){return mn(t,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(e.unpackMatch)}},{key:"unpackMatch",value:function(t){var n=t[1],r=t[2],i=t[3].slice(1,-1);return new e(n,r,i=kn(i))}}]),e}(),hn="[\\w\\d-]+",dn=function(){function e(n,r,i,a){t(this,e),this.ns=n,this.name=r,this.attrString=i,this.innerXml=a,this.attrs=ln.findAll(i),this.children=e.findAll(a),this.value=0===this.children.length?kn(a):void 0,this.properties=[].concat(this.attrs,this.children)}return r(e,[{key:"isPrimitive",get:function(){return void 0!==this.value&&0===this.attrs.length&&0===this.children.length}},{key:"isListContainer",get:function(){return 1===this.children.length&&this.children[0].isList}},{key:"isList",get:function(){var e=this.ns,t=this.name;return"rdf"===e&&("Seq"===t||"Bag"===t||"Alt"===t)}},{key:"isListItem",get:function(){return"rdf"===this.ns&&"li"===this.name}},{key:"serialize",value:function(){if(0!==this.properties.length||void 0!==this.value){if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return vn(this.children.map(gn));if(this.isListItem&&1===this.children.length&&0===this.attrs.length)return this.children[0].serialize();var e={},t=this.properties;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=S(t));for(var n=0;n<t.length;n++){pn(t[n],e)}return void 0!==this.value&&(e.value=this.value),M(e)}}}],[{key:"findAll",value:function(t,n,r){if(void 0!==n||void 0!==r){n=n||hn,r=r||hn;var i=new RegExp("<(".concat(n,"):(").concat(r,")(#\\d+)?((\\s+?[\\w\\d-:]+=(\"[^\"]*\"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)"),"gm")}else i=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return mn(t,i).map(e.unpackMatch)}},{key:"unpackMatch",value:function(t){return new e(t[1],t[2],t[4],t[8])}}]),e}();function pn(e,t){var n=e.serialize();void 0!==n&&(t[e.name]=n)}var gn=function(e){return e.serialize()},vn=function(e){return 1===e.length?e[0]:e},yn=function(e,t){return t[e]?t[e]:t[e]={}};function mn(e,t){var n,r=[];if(!e)return r;for(;null!==(n=t.exec(e));)r.push(n);return r}function kn(e){if(!function(e){return null==e||"null"===e||"undefined"===e||""===e||""===e.trim()}(e)){var t=Number(e);if(!isNaN(t))return t;var n=e.toLowerCase();return"true"===n||"false"!==n&&e.trim()}}var Sn=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],Cn=new RegExp("(<|\\/)(".concat(Sn.join("|"),")"),"g");function Pn(e){var t={},n={},r=Sn;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=S(r));for(var i=0;i<r.length;i++){var a=r[i];t[a]=[],n[a]=0}return e.replace(Cn,(function(e,r,i){if("<"===r){var a=++n[i];return t[i].push(a),"".concat(e,"#").concat(a)}var o=t[i].pop();return"".concat(e,"#").concat(o)}))}var bn=Object.freeze({__proto__:null,default:jt,Exifr:Be,fileParsers:_,segmentParsers:W,fileReaders:K,tagKeys:oe,tagValues:se,tagRevivers:ue,createDictionary:ie,extendDictionary:ae,fetchUrlAsArrayBuffer:te,readBlobAsArrayBuffer:ne,chunkedProps:ye,otherSegments:me,segments:ke,tiffBlocks:Se,segmentsAndBlocks:Ce,tiffExtractables:Pe,inheritables:be,allFormatters:Ae,Options:we,parse:Ne,gps:lt,gpsOnlyOptions:ht,thumbnailUrl:gt,thumbnail:vt,thumbnailOnlyOptions:yt,rotation:kt,orientation:St,orientationOnlyOptions:Ct,rotations:Pt,get rotateCanvas(){return e.rotateCanvas},get rotateCss(){return e.rotateCss}});function An(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var In=Rn((function(e,t,n){var r=n[e];return r.enabled=!0,r.parse=!0,W.get(e).parse(t,r)})),Tn="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function On(e,t,n){if(!e.s){if(n instanceof Dn){if(!n.s)return void(n.o=On.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(On.bind(null,e,t),On.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var Dn=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,i=this.s;if(i){var a=1&i?t:n;if(a){try{On(r,1,a(this.v))}catch(e){On(r,2,e)}return r}return this}return this.o=function(e){try{var i=e.v;1&e.s?On(r,1,t?t(i):i):n?On(r,1,n(i)):On(r,2,i)}catch(e){On(r,2,e)}},r},e}();function wn(e){return e instanceof Dn&&1&e.s}function xn(e,t,n){if("function"==typeof e[Tn]){var r,i,a,o=e[Tn]();if(function e(s){try{for(;!((r=o.next()).done||n&&n());)if((s=t(r.value))&&s.then){if(!wn(s))return void s.then(e,a||(a=On.bind(null,i=new Dn,2)));s=s.v}i?On(i,1,s):i=s}catch(e){On(i||(i=new Dn),2,e)}}(),o.return){var s=function(e){try{r.done||o.return()}catch(e){}return e};if(i&&i.then)return i.then(s,(function(e){throw s(e)}));s()}return i}if(!("length"in e))throw new TypeError("Object is not iterable");for(var u=[],f=0;f<e.length;f++)u.push(e[f]);return function(e,t,n){var r,i,a=-1;return function o(s){try{for(;++a<e.length&&(!n||!n());)if((s=t(a))&&s.then){if(!wn(s))return void s.then(o,i||(i=On.bind(null,r=new Dn,2)));s=s.v}r?On(r,1,s):r=s}catch(e){On(r||(r=new Dn),2,e)}}(),r}(u,(function(e){return t(u[e])}),n)}function Rn(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var Mn=Rn((function(e,t,n){var r=new we(t);return r.chunked=!1,void 0===n&&"string"==typeof e&&(n=function(e){var t=e.toLowerCase().split(".").pop();if(function(e){return"exif"===e||"tiff"===e||"tif"===e}(t))return"tiff";if(Ln.includes(t))return t}(e)),An($(e,r),(function(e){var t,i,a=!1;return n?Ln.includes(n)?In(n,e,r):void F("Invalid segment type"):function(e){var t=e.getString(0,50).trim();return t.includes("<?xpacket")||t.includes("<x:")}(e)?In("xmp",e,r):(t=xn(W,(function(t){var n=t[0];if(Ln.includes(n))return An(In(n,e,r).catch(Un),(function(e){if(e)return a=!0,e}))}),(function(){return a})),i=function(e){if(a)return e;F("Unknown file format")},t&&t.then?t.then(i):i(t))}))})),Ln=["xmp","icc","iptc","tiff"],Un=function(){};var Fn=function(e){a(i,e);var n=d(i);function i(){var e;t(this,i);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=n.call.apply(n,[this].concat(a))).input=e.input.replace(/^data:([^;]+);base64,/gim,""),e.size=e.input.length/4*3,e.input.endsWith("==")?e.size-=2:e.input.endsWith("=")&&(e.size-=1),e}return r(i,[{key:"_readChunk",value:function(e,t){try{var n,r,i=this,a=i.input;void 0===e?(e=0,n=0,r=0):r=e-(n=4*Math.floor(e/3))/4*3,void 0===t&&(t=i.size);var o=e+t,s=n+4*Math.ceil(o/3);a=a.slice(n,s);var u=Math.min(t,i.size-e);if(R){var f=w.from(a,"base64").slice(r,r+u);return i.set(f,e,!0)}for(var c=i.subarray(e,u,!0),l=atob(a),h=c.toUint8(),d=0;d<u;d++)h[d]=l.charCodeAt(r+d);return c}catch(e){return Promise.reject(e)}}}]),i}(Bt);function En(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Bn(){}K.set("base64",Fn);var Nn=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"extendOptions",value:function(e){var t=e.ifd0,n=e.xmp,r=e.iptc,i=e.icc;n.enabled&&t.deps.add(le),r.enabled&&t.deps.add(he),i.enabled&&t.deps.add(de),t.finalizeFilters()}},{key:"parse",value:function(){try{var e=this,t=e.options,n=t.tiff,r=t.xmp,i=t.iptc,a=t.icc;return function(e){var t=e();if(t&&t.then)return t.then(Bn)}((function(){if(n.enabled||r.enabled||i.enabled||a.enabled){var t=Math.max(B(e.options),e.options.chunkSize);return En(e.file.ensureChunk(0,t),(function(){return e.createParser("tiff",e.file),e.parsers.tiff.parseHeader(),En(e.parsers.tiff.parseIfd0Block(),(function(){e.adaptTiffPropAsSegment("xmp"),e.adaptTiffPropAsSegment("iptc"),e.adaptTiffPropAsSegment("icc")}))}))}}))}catch(e){return Promise.reject(e)}}},{key:"adaptTiffPropAsSegment",value:function(e){if(this.parsers.tiff[e]){var t=this.parsers.tiff[e];this.injectSegment(e,t)}}}],[{key:"canHandle",value:function(e,t){return 18761===t||19789===t}}]),i}(Ve);function Gn(){}i(Nn,"type","tiff"),_.set("tiff",Nn);function jn(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var Vn="XML:com.adobe.xmp";var zn="ihdr",Hn="iccp",_n="text",Wn="itxt",Kn=[zn,Hn,_n,Wn,"exif"],Xn=function(e){a(o,e);var n=d(o);function o(){var e;t(this,o);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return i(l(e=n.call.apply(n,[this].concat(a))),"catchError",(function(t){return e.errors.push(t)})),i(l(e),"metaChunks",[]),i(l(e),"unknownChunks",[]),e}return r(o,[{key:"parse",value:function(){try{var e=this,t=e.file;return jn(e.findPngChunksInRange("聣PNG\r\n\n".length,t.byteLength),(function(){return jn(e.readSegments(e.metaChunks),(function(){return e.findIhdr(),e.parseTextChunks(),jn(e.findExif().catch(e.catchError),(function(){return jn(e.findXmp().catch(e.catchError),(function(){return function(e,t){if(!t)return e&&e.then?e.then(Gn):Promise.resolve()}(e.findIcc().catch(e.catchError))}))}))}))}))}catch(e){return Promise.reject(e)}}},{key:"findPngChunksInRange",value:function(e,t){try{for(var n=this,r=n.file;e<t;){var i=r.getUint32(e),a=r.getUint32(e+4),o=r.getString(e+4,4).toLowerCase(),s=i+4+4+4,u={type:o,offset:e,length:s,start:e+4+4,size:i,marker:a};Kn.includes(o)?n.metaChunks.push(u):n.unknownChunks.push(u),e+=s}return jn()}catch(e){return Promise.reject(e)}}},{key:"parseTextChunks",value:function(){var e=this.metaChunks.filter((function(e){return e.type===_n}));Array.isArray(e)||("function"==typeof e.entries&&(e=e.entries()),e=S(e));for(var t=0;t<e.length;t++){var n=e[t],r=this.file.getString(n.start,n.size).split("\0"),i=r[0],a=r[1];this.injectKeyValToIhdr(i,a)}}},{key:"injectKeyValToIhdr",value:function(e,t){var n=this.parsers.ihdr;n&&n.raw.set(e,t)}},{key:"findIhdr",value:function(){var e=this.metaChunks.find((function(e){return e.type===zn}));e&&!1!==this.options.ihdr.enabled&&this.createParser(zn,e.chunk)}},{key:"findExif",value:function(){try{var e=this.metaChunks.find((function(e){return"exif"===e.type}));if(!e)return;return this.injectSegment("tiff",e.chunk),jn()}catch(e){return Promise.reject(e)}}},{key:"findXmp",value:function(){try{var e=this.metaChunks.filter((function(e){return e.type===Wn}));Array.isArray(e)||("function"==typeof e.entries&&(e=e.entries()),e=S(e));for(var t=0;t<e.length;t++){var n=e[t];n.chunk.getString(0,Vn.length)===Vn&&this.injectSegment("xmp",n.chunk)}return jn()}catch(e){return Promise.reject(e)}}},{key:"findIcc",value:function(){try{var e=this,t=e.metaChunks.find((function(e){return e.type===Hn}));if(!t)return;for(var n=t.chunk,r=n.getUint8Array(0,81),i=0;i<80&&0!==r[i];)i++;var a=i+2,o=n.getString(0,i);return e.injectKeyValToIhdr("ProfileName",o),function(e){var t=e();if(t&&t.then)return t.then(Gn)}((function(){if(D)return jn(undefined,(function(t){var r=n.getUint8Array(a);r=t.inflateSync(r),e.injectSegment("icc",r)}))}))}catch(e){return Promise.reject(e)}}}],[{key:"canHandle",value:function(e,t){return 35152===t&&2303741511===e.getUint32(0)&&218765834===e.getUint32(4)}}]),o}(Ve);i(Xn,"type","png"),_.set("png",Xn),ie(oe,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),ae(oe,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);var Yn=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];ae(oe,"ifd0",Yn),ae(oe,"exif",Yn),ie(se,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);var Jn=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parse",value:function(){return this.parseTags(),this.translate(),this.output}},{key:"parseTags",value:function(){this.raw=b([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}],[{key:"canHandle",value:function(e,t){return 224===e.getUint8(t+1)&&1246120262===e.getUint32(t+4)&&0===e.getUint8(t+8)}}]),i}(ze);i(Jn,"type","jfif"),i(Jn,"headerLength",9),W.set("jfif",Jn),ie(oe,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);var qn=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parse",value:function(){return this.parseTags(),this.translate(),this.output}},{key:"parseTags",value:function(){this.raw=b([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)]].concat(S(this.raw)))}}]),i}(ze);i(qn,"type","ihdr"),W.set("ihdr",qn),ie(oe,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),ie(se,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);var Qn="\0\0\0\0",Zn=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parse",value:function(){return this.raw=b(),this.parseHeader(),this.parseTags(),this.translate(),this.output}},{key:"parseHeader",value:function(){var e=this.raw;this.chunk.byteLength<84&&F("ICC header is too short");var t=y($n);Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=S(t));for(var n=0;n<t.length;n++){var r=t[n],i=r[0],a=r[1];i=parseInt(i,10);var o=a(this.chunk,i);o!==Qn&&e.set(i,o)}}},{key:"parseTags",value:function(){for(var e,t,n,r,i,a=this.raw,o=this.chunk.getUint32(128),s=132,u=this.chunk.byteLength;o--;){if(e=this.chunk.getString(s,4),t=this.chunk.getUint32(s+4),n=this.chunk.getUint32(s+8),r=this.chunk.getString(t,4),t+n>u)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");void 0!==(i=this.parseTag(r,t,n))&&i!==Qn&&a.set(e,i),s+=12}}},{key:"parseTag",value:function(e,t,n){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,n);case"sig ":return this.parseSig(t)}if(!(t+n>this.chunk.byteLength))return this.chunk.getUint8Array(t,n)}},{key:"parseDesc",value:function(e){var t=this.chunk.getUint32(e+8)-1;return E(this.chunk.getString(e+12,t))}},{key:"parseText",value:function(e,t){return E(this.chunk.getString(e+8,t-8))}},{key:"parseSig",value:function(e){return E(this.chunk.getString(e+8,4))}},{key:"parseMluc",value:function(e){for(var t=this.chunk,n=t.getUint32(e+8),r=t.getUint32(e+12),i=e+16,a=[],o=0;o<n;o++){var s=t.getString(i+0,2),u=t.getString(i+2,2),f=t.getUint32(i+4),c=t.getUint32(i+8)+e,l=E(t.getUnicodeString(c,f));a.push({lang:s,country:u,text:l}),i+=r}return 1===n?a[0].text:a}},{key:"translateValue",value:function(e,t){return"string"==typeof e?t[e]||t[e.toLowerCase()]||e:t[e]||e}}],[{key:"canHandle",value:function(e,t){return 226===e.getUint8(t+1)&&1229144927===e.getUint32(t+4)}},{key:"findPosition",value:function(e,t){var n=p(o(i),"findPosition",this).call(this,e,t);return n.chunkNumber=e.getUint8(t+16),n.chunkCount=e.getUint8(t+17),n.multiSegment=n.chunkCount>1,n}},{key:"handleMultiSegments",value:function(e){return t=function(e){var t=e[0].constructor,n=0,r=e;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=S(r));for(var i=0;i<r.length;i++)n+=r[i].length;var a=new t(n),o=0,s=e;Array.isArray(s)||("function"==typeof s.entries&&(s=s.entries()),s=S(s));for(var u=0;u<s.length;u++){var f=s[u];a.set(f,o),o+=f.length}return a}(e.map((function(e){return e.chunk.toUint8()}))),new V(t);var t}}]),i}(ze);i(Zn,"type","icc"),i(Zn,"multiSegment",!0),i(Zn,"headerLength",18);var $n={4:er,8:function(e,t){return[e.getUint8(t),e.getUint8(t+1)>>4,e.getUint8(t+1)%16].map((function(e){return e.toString(10)})).join(".")},12:er,16:er,20:er,24:function(e,t){var n=e.getUint16(t),r=e.getUint16(t+2)-1,i=e.getUint16(t+4),a=e.getUint16(t+6),o=e.getUint16(t+8),s=e.getUint16(t+10);return new Date(Date.UTC(n,r,i,a,o,s))},36:er,40:er,48:er,52:er,64:function(e,t){return e.getUint32(t)},80:er};function er(e,t){return E(e.getString(t,4))}W.set("icc",Zn),ie(oe,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);var tr={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},nr={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};ie(se,"icc",[[4,tr],[12,nr],[40,m({},tr,nr)],[48,tr],[80,tr],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);var rr=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parse",value:function(){for(var e=this.raw,t=this.chunk.byteLength-1,n=!1,r=0;r<t;r++)if(28===this.chunk.getUint8(r)&&2===this.chunk.getUint8(r+1)){n=!0;var i=this.chunk.getUint16(r+3),a=this.chunk.getUint8(r+2),o=this.chunk.getLatin1String(r+5,i);e.set(a,this.pluralizeValue(e.get(a),o)),r+=4+i}else if(n)break;return this.translate(),this.output}},{key:"pluralizeValue",value:function(e,t){return void 0!==e?e instanceof Array?(e.push(t),e):[e,t]:t}}],[{key:"canHandle",value:function(e,t,n){return 237===e.getUint8(t+1)&&"Photoshop"===e.getString(t+4,9)&&void 0!==this.containsIptc8bim(e,t,n)}},{key:"headerLength",value:function(e,t,n){var r,i=this.containsIptc8bim(e,t,n);if(void 0!==i)return(r=e.getUint8(t+i+7))%2!=0&&(r+=1),0===r&&(r=4),i+8+r}},{key:"containsIptc8bim",value:function(e,t,n){for(var r=0;r<n;r++)if(this.isIptcSegmentHead(e,t+r))return r}},{key:"isIptcSegmentHead",value:function(e,t){return 56===e.getUint8(t)&&943868237===e.getUint32(t)&&1028===e.getUint16(t+4)}}]),i}(ze);i(rr,"type","iptc"),i(rr,"translateValues",!1),i(rr,"reviveValues",!1),W.set("iptc",rr),ie(oe,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),ie(se,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]),e.Exifr=Be,e.Options=we,e.allFormatters=Ae,e.chunkedProps=ye,e.createDictionary=ie,e.default=bn,e.extendDictionary=ae,e.fetchUrlAsArrayBuffer=te,e.fileParsers=_,e.fileReaders=K,e.gps=lt,e.gpsOnlyOptions=ht,e.inheritables=be,e.orientation=St,e.orientationOnlyOptions=Ct,e.otherSegments=me,e.parse=Ne,e.readBlobAsArrayBuffer=ne,e.rotation=kt,e.rotations=Pt,e.segmentParsers=W,e.segments=ke,e.segmentsAndBlocks=Ce,e.sidecar=Mn,e.tagKeys=oe,e.tagRevivers=ue,e.tagValues=se,e.thumbnail=vt,e.thumbnailOnlyOptions=yt,e.thumbnailUrl=gt,e.tiffBlocks=Se,e.tiffExtractables=Pe,Object.defineProperty(e,"__esModule",{value:!0})}));
node_modules\exifr\dist\full.umd.js:1:!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("exifr",["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).exifr={})}(this,(function(e){"use strict";var t="undefined"!=typeof self?self:global;const i="undefined"!=typeof navigator,n=i&&"undefined"==typeof HTMLImageElement,s=!("undefined"==typeof global||"undefined"==typeof process||!process.versions||!process.versions.node),r=t.Buffer,a=t.BigInt,o=!!r,l=e=>e;function h(e,t=l){if(s)try{return"function"==typeof require?Promise.resolve(t(require(e))):import(/* webpackIgnore: true */ e).then(t)}catch(t){console.warn(`Couldn't load ${e}`)}}let u=t.fetch;const c=e=>u=e;if(!t.fetch){const e=h("http",(e=>e)),t=h("https",(e=>e)),i=(n,{headers:s}={})=>new Promise((async(r,a)=>{let{port:o,hostname:l,pathname:h,protocol:u,search:c}=new URL(n);const f={method:"GET",hostname:l,path:encodeURI(h)+c,headers:s};""!==o&&(f.port=Number(o));const d=("https:"===u?await t:await e).request(f,(e=>{if(301===e.statusCode||302===e.statusCode){let t=new URL(e.headers.location,n).toString();return i(t,{headers:s}).then(r).catch(a)}r({status:e.statusCode,arrayBuffer:()=>new Promise((t=>{let i=[];e.on("data",(e=>i.push(e))),e.on("end",(()=>t(Buffer.concat(i))))}))})}));d.on("error",a),d.end()}));c(i)}function f(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const d=e=>g(e)?void 0:e,p=e=>void 0!==e;function g(e){return void 0===e||(e instanceof Map?0===e.size:0===Object.values(e).filter(p).length)}function m(e){let t=new Error(e);throw delete t.stack,t}function S(e){return""===(e=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(e).trim())?void 0:e}function C(e){let t=function(e){let t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}const y=e=>String.fromCharCode.apply(null,e),b="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;function P(e){return b?b.decode(e):o?Buffer.from(e).toString("utf8"):decodeURIComponent(escape(y(e)))}class I{static from(e,t){return e instanceof this&&e.le===t?e:new I(e,void 0,void 0,t)}constructor(e,t=0,i,n){if("boolean"==typeof n&&(this.le=n),Array.isArray(e)&&(e=new Uint8Array(e)),0===e)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){void 0===i&&(i=e.byteLength-t);let n=new DataView(e,t,i);this._swapDataView(n)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof I){void 0===i&&(i=e.byteLength-t),(t+=e.byteOffset)+i>e.byteOffset+e.byteLength&&m("Creating view outside of available memory in ArrayBuffer");let n=new DataView(e.buffer,t,i);this._swapDataView(n)}else if("number"==typeof e){let t=new DataView(new ArrayBuffer(e));this._swapDataView(t)}else m("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,i=I){return e instanceof DataView||e instanceof I?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||m("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new i(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new I(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return P(this.getUint8Array(e,t))}getLatin1String(e=0,t=this.byteLength){let i=this.getUint8Array(e,t);return y(i)}getUnicodeString(e=0,t=this.byteLength){const i=[];for(let n=0;n<t&&e+n<this.byteLength;n+=2)i.push(this.getUint16(e+n));return y(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,i){switch(t){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,t,i){switch(t){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function k(e,t){m(`${e} '${t}' was not loaded, try using full build of exifr.`)}class w extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||k(this.kind,e),t&&(e in t||function(e,t){m(`Unknown ${e} '${t}'.`)}(this.kind,e),t[e].enabled||k(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var T=new w("file parser"),A=new w("segment parser"),D=new w("file reader");const O="Invalid input argument";function x(e,t){return"string"==typeof e?v(e,t):i&&!n&&e instanceof HTMLImageElement?v(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new I(e):i&&e instanceof Blob?M(e,t,"blob",U):void m(O)}function v(e,t){return(n=e).startsWith("data:")||n.length>1e4?R(e,t,"base64"):s&&e.includes("://")?M(e,t,"url",L):s?R(e,t,"fs"):i?M(e,t,"url",L):void m(O);var n}async function M(e,t,i,n){return D.has(i)?R(e,t,i):n?async function(e,t){let i=await t(e);return new I(i)}(e,n):void m(`Parser ${i} is not loaded`)}async function R(e,t,i){let n=new(D.get(i))(e,t);return await n.read(),n}const L=e=>u(e).then((e=>e.arrayBuffer())),U=e=>new Promise(((t,i)=>{let n=new FileReader;n.onloadend=()=>t(n.result||new ArrayBuffer),n.onerror=i,n.readAsArrayBuffer(e)}));class F extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function B(e,t,i){let n=new F;for(let[e,t]of i)n.set(e,t);if(Array.isArray(t))for(let i of t)e.set(i,n);else e.set(t,n);return n}function E(e,t,i){let n,s=e.get(t);for(n of i)s.set(n[0],n[1])}const N=new Map,G=new Map,V=new Map,z=37500,H=37510,j=700,W=33723,K=34675,X=34665,_=34853,Y=40965,$=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],J=["jfif","xmp","icc","iptc","ihdr"],q=["tiff",...J],Q=["ifd0","ifd1","exif","gps","interop"],Z=[...q,...Q],ee=["makerNote","userComment"],te=["translateKeys","translateValues","reviveValues","multiSegment"],ie=[...te,"sanitize","mergeOutput","silentErrors"];class ne{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class se extends ne{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,i,n){if(super(),f(this,"enabled",!1),f(this,"skip",new Set),f(this,"pick",new Set),f(this,"deps",new Set),f(this,"translateKeys",!1),f(this,"translateValues",!1),f(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(n),this.canBeFiltered=Q.includes(e),this.canBeFiltered&&(this.dict=N.get(e)),void 0!==i)if(Array.isArray(i))this.parse=this.enabled=!0,this.canBeFiltered&&i.length>0&&this.translateTagSet(i,this.pick);else if("object"==typeof i){if(this.enabled=!0,this.parse=!1!==i.parse,this.canBeFiltered){let{pick:e,skip:t}=i;e&&e.length>0&&this.translateTagSet(e,this.pick),t&&t.length>0&&this.translateTagSet(t,this.skip)}this.applyInheritables(i)}else!0===i||!1===i?this.parse=this.enabled=i:m(`Invalid options argument: ${i}`)}applyInheritables(e){let t,i;for(t of te)i=e[t],void 0!==i&&(this[t]=i)}translateTagSet(e,t){if(this.dict){let i,n,{tagKeys:s,tagValues:r}=this.dict;for(i of e)"string"==typeof i?(n=r.indexOf(i),-1===n&&(n=s.indexOf(Number(i))),-1!==n&&t.add(Number(s[n]))):t.add(i)}else for(let i of e)t.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,ue(this.pick,this.deps)):this.enabled&&this.pick.size>0&&ue(this.pick,this.deps)}}var re={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},ae=new Map;class oe extends ne{static useCached(e){let t=ae.get(e);return void 0!==t||(t=new this(e),ae.set(e,t)),t}constructor(e){super(),!0===e?this.setupFromTrue():void 0===e?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):"object"==typeof e?this.setupFromObject(e):m(`Invalid options argument ${e}`),void 0===this.firstChunkSize&&(this.firstChunkSize=i?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of $)this[e]=re[e];for(e of ie)this[e]=re[e];for(e of ee)this[e]=re[e];for(e of Z)this[e]=new se(e,re[e],void 0,this)}setupFromTrue(){let e;for(e of $)this[e]=re[e];for(e of ie)this[e]=re[e];for(e of ee)this[e]=!0;for(e of Z)this[e]=new se(e,!0,void 0,this)}setupFromArray(e){let t;for(t of $)this[t]=re[t];for(t of ie)this[t]=re[t];for(t of ee)this[t]=re[t];for(t of Z)this[t]=new se(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,Q)}setupFromObject(e){let t;for(t of(Q.ifd0=Q.ifd0||Q.image,Q.ifd1=Q.ifd1||Q.thumbnail,Object.assign(this,e),$))this[t]=he(e[t],re[t]);for(t of ie)this[t]=he(e[t],re[t]);for(t of ee)this[t]=he(e[t],re[t]);for(t of q)this[t]=new se(t,re[t],e[t],this);for(t of Q)this[t]=new se(t,re[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,Q,Z),!0===e.tiff?this.batchEnableWithBool(Q,!0):!1===e.tiff?this.batchEnableWithUserValue(Q,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,Q):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,Q)}batchEnableWithBool(e,t){for(let i of e)this[i].enabled=t}batchEnableWithUserValue(e,t){for(let i of e){let e=t[i];this[i].enabled=!1!==e&&void 0!==e}}setupGlobalFilters(e,t,i,n=i){if(e&&e.length){for(let e of n)this[e].enabled=!1;let t=le(e,i);for(let[e,i]of t)ue(this[e].pick,i),this[e].enabled=!0}else if(t&&t.length){let e=le(t,i);for(let[t,i]of e)ue(this[t].skip,i)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:i,iptc:n,icc:s}=this;this.makerNote?t.deps.add(z):t.skip.add(z),this.userComment?t.deps.add(H):t.skip.add(H),i.enabled||e.skip.add(j),n.enabled||e.skip.add(W),s.enabled||e.skip.add(K)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:i,interop:n}=this;n.needed&&(t.deps.add(Y),e.deps.add(Y)),t.needed&&e.deps.add(X),i.needed&&e.deps.add(_),this.tiff.enabled=Q.some((e=>!0===this[e].enabled))||this.makerNote||this.userComment;for(let e of Q)this[e].finalizeFilters()}get onlyTiff(){return!J.map((e=>this[e].enabled)).some((e=>!0===e))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of q)this[e].enabled&&!A.has(e)&&k("segment parser",e)}}function le(e,t){let i,n,s,r,a=[];for(s of t){for(r of(i=N.get(s),n=[],i))(e.includes(r[0])||e.includes(r[1]))&&n.push(r[0]);n.length&&a.push([s,n])}return a}function he(e,t){return void 0!==e?e:void 0!==t?t:void 0}function ue(e,t){for(let i of t)e.add(i)}f(oe,"default",re);class ce{constructor(e){f(this,"parsers",{}),f(this,"output",{}),f(this,"errors",[]),f(this,"pushToErrors",(e=>this.errors.push(e))),this.options=oe.useCached(e)}async read(e){this.file=await x(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[i,n]of T)if(n.canHandle(e,t))return this.fileParser=new n(this.options,this.file,this.parsers),e[i]=!0;this.file.close&&this.file.close(),m("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),d(e)}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map((async t=>{let i=await t.parse();t.assignToOutput(e,i)}));this.options.silentErrors&&(t=t.map((e=>e.catch(this.pushToErrors)))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,i=A.get("tiff",e);var n;if(t.tiff?n={start:0,type:"tiff"}:t.jpeg&&(n=await this.fileParser.getOrFindSegment("tiff")),void 0===n)return;let s=await this.fileParser.ensureSegmentChunk(n),r=this.parsers.tiff=new i(s,e,t),a=await r.extractThumbnail();return t.close&&t.close(),a}}async function fe(e,t){let i=new ce(t);return await i.read(e),i.parse()}var de=Object.freeze({__proto__:null,parse:fe,Exifr:ce,fileParsers:T,segmentParsers:A,fileReaders:D,tagKeys:N,tagValues:G,tagRevivers:V,createDictionary:B,extendDictionary:E,fetchUrlAsArrayBuffer:L,readBlobAsArrayBuffer:U,chunkedProps:$,otherSegments:J,segments:q,tiffBlocks:Q,segmentsAndBlocks:Z,tiffExtractables:ee,inheritables:te,allFormatters:ie,Options:oe});class pe{constructor(e,t,i){f(this,"errors",[]),f(this,"ensureSegmentChunk",(async e=>{let t=e.start,i=e.size||65536;if(this.file.chunked)if(this.file.available(t,i))e.chunk=this.file.subarray(t,i);else try{e.chunk=await this.file.readChunk(t,i)}catch(t){m(`Couldn't read segment: ${JSON.stringify(e)}. ${t.message}`)}else this.file.byteLength>t+i?e.chunk=this.file.subarray(t,i):void 0===e.size?e.chunk=this.file.subarray(t):m("Segment unreachable: "+JSON.stringify(e));return e.chunk})),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=i}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let i=new(A.get(e))(t,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let t of e){let{type:e,chunk:i}=t,n=this.options[e];if(n&&n.enabled){let t=this.parsers[e];t&&t.append||t||this.createParser(e,i)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}class ge{static findPosition(e,t){let i=e.getUint16(t+2)+2,n="function"==typeof this.headerLength?this.headerLength(e,t,i):this.headerLength,s=t+n,r=i-n;return{offset:t,length:i,headerLength:n,start:s,size:r,end:s+r}}static parse(e,t={}){return new this(e,new oe({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof I?e:new I(e)}constructor(e,t={},i){f(this,"errors",[]),f(this,"raw",new Map),f(this,"handleError",(e=>{if(!this.options.silentErrors)throw e;this.errors.push(e.message)})),this.chunk=this.normalizeInput(e),this.file=i,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let i=V.get(t),n=G.get(t),s=N.get(t),r=this.options[t],a=r.reviveValues&&!!i,o=r.translateValues&&!!n,l=r.translateKeys&&!!s,h={};for(let[t,r]of e)a&&i.has(t)?r=i.get(t)(r):o&&n.has(t)&&(r=this.translateValue(r,n.get(t))),l&&s.has(t)&&(t=s.get(t)||t),h[t]=r;return h}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[t]?Object.assign(e[t],i):e[t]=i}}f(ge,"headerLength",4),f(ge,"type",void 0),f(ge,"multiSegment",!1),f(ge,"canHandle",(()=>!1));function me(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function Se(e){return e>=224&&e<=239}function Ce(e,t,i){for(let[n,s]of A)if(s.canHandle(e,t,i))return n}class ye extends pe{constructor(...e){super(...e),f(this,"appSegments",[]),f(this,"jpegSegments",[]),f(this,"unknownSegments",[])}static canHandle(e,t){return 65496===t}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){!0===e?(this.findAll=!0,this.wanted=new Set(A.keyList())):(e=void 0===e?A.keyList().filter((e=>this.options[e].enabled)):e.filter((e=>this.options[e].enabled&&A.has(e))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:i,findAll:n,wanted:s,remaining:r}=this;if(!n&&this.file.chunked&&(n=Array.from(s).some((e=>{let t=A.get(e),i=this.options[e];return t.multiSegment&&i.multiSegment})),n&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let t=!1;for(;r.size>0&&!t&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:n}=i,s=this.appSegments.some((e=>!this.file.available(e.offset||e.start,e.length||e.size)));if(t=e>n&&!s?!await i.readNextChunk(e):!await i.readNextChunk(n),void 0===(e=this.findAppSegmentsInRange(e,i.byteLength)))return}}}findAppSegmentsInRange(e,t){t-=2;let i,n,s,r,a,o,{file:l,findAll:h,wanted:u,remaining:c,options:f}=this;for(;e<t;e++)if(255===l.getUint8(e))if(i=l.getUint8(e+1),Se(i)){if(n=l.getUint16(e+2),s=Ce(l,e,n),s&&u.has(s)&&(r=A.get(s),a=r.findPosition(l,e),o=f[s],a.type=s,this.appSegments.push(a),!h&&(r.multiSegment&&o.multiSegment?(this.unfinishedMultiSegment=a.chunkNumber<a.chunkCount,this.unfinishedMultiSegment||c.delete(s)):c.delete(s),0===c.size)))break;f.recordUnknownSegments&&(a=ge.findPosition(l,e),a.marker=i,this.unknownSegments.push(a)),e+=n+1}else if(me(i)){if(n=l.getUint16(e+2),218===i&&!1!==f.stopAfterSos)return;f.recordJpegSegments&&this.jpegSegments.push({offset:e,length:n,marker:i}),e+=n+1}return e}mergeMultiSegments(){if(!this.appSegments.some((e=>e.multiSegment)))return;let e=function(e,t){let i,n,s,r=new Map;for(let a=0;a<e.length;a++)i=e[a],n=i[t],r.has(n)?s=r.get(n):r.set(n,s=[]),s.push(i);return Array.from(r)}(this.appSegments,"type");this.mergedAppSegments=e.map((([e,t])=>{let i=A.get(e,this.options);if(i.handleMultiSegments){return{type:e,chunk:i.handleMultiSegments(t)}}return t[0]}))}getSegment(e){return this.appSegments.find((t=>t.type===e))}async getOrFindSegment(e){let t=this.getSegment(e);return void 0===t&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}f(ye,"type","jpeg"),T.set("jpeg",ye);const be=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class Pe extends ge{parseHeader(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,i=new Map){let{pick:n,skip:s}=this.options[t];n=new Set(n);let r=n.size>0,a=0===s.size,o=this.chunk.getUint16(e);e+=2;for(let l=0;l<o;l++){let o=this.chunk.getUint16(e);if(r){if(n.has(o)&&(i.set(o,this.parseTag(e,o,t)),n.delete(o),0===n.size))break}else!a&&s.has(o)||i.set(o,this.parseTag(e,o,t));e+=12}return i}parseTag(e,t,i){let{chunk:n}=this,s=n.getUint16(e+2),r=n.getUint32(e+4),a=be[s];if(a*r<=4?e+=8:e=n.getUint32(e+8),(s<1||s>13)&&m(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e}`),e>n.byteLength&&m(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e} is outside of chunk size ${n.byteLength}`),1===s)return n.getUint8Array(e,r);if(2===s)return S(n.getString(e,r));if(7===s)return n.getUint8Array(e,r);if(1===r)return this.parseTagValue(s,e);{let t=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(s))(r),i=a;for(let n=0;n<r;n++)t[n]=this.parseTagValue(s,e),e+=i;return t}}parseTagValue(e,t){let{chunk:i}=this;switch(e){case 1:return i.getUint8(t);case 3:return i.getUint16(t);case 4:return i.getUint32(t);case 5:return i.getUint32(t)/i.getUint32(t+4);case 6:return i.getInt8(t);case 8:return i.getInt16(t);case 9:return i.getInt32(t);case 10:return i.getInt32(t)/i.getInt32(t+4);case 11:return i.getFloat(t);case 12:return i.getDouble(t);case 13:return i.getUint32(t);default:m(`Invalid tiff type ${e}`)}}}class Ie extends Pe{static canHandle(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}findIfd0Offset(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(void 0===this.ifd1Offset){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let i=new Map;return this[t]=i,this.parseTags(e,t,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&m("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&m(`IFD0 offset points to outside of file.\nthis.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,C(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return 0!==t.size?(this.exifOffset=t.get(X),this.interopOffset=t.get(Y),this.gpsOffset=t.get(_),this.xmp=t.get(j),this.iptc=t.get(W),this.icc=t.get(K),this.options.sanitize&&(t.delete(X),t.delete(Y),t.delete(_),t.delete(j),t.delete(W),t.delete(K)),t):void 0}async parseExifBlock(){if(this.exif)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.exifOffset)return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,C(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(Y)),this.makerNote=e.get(z),this.userComment=e.get(H),this.options.sanitize&&(e.delete(Y),e.delete(z),e.delete(H)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let i=e.get(t);i&&1===i.length&&e.set(t,i[0])}async parseGpsBlock(){if(this.gps)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.gpsOffset)return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",ke(...e.get(2),e.get(1))),e.set("longitude",ke(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),void 0!==this.interopOffset||this.exif||await this.parseExifBlock(),void 0!==this.interopOffset))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),void 0===this.ifd1)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,i,n={};for(t of Q)if(e=this[t],!g(e))if(i=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if("ifd1"===t)continue;Object.assign(n,i)}else n[t]=i;return this.makerNote&&(n.makerNote=this.makerNote),this.userComment&&(n.userComment=this.userComment),n}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[i,n]of Object.entries(t))this.assignObjectToOutput(e,i,n)}}function ke(e,t,i,n){var s=e+t/60+i/3600;return"S"!==n&&"W"!==n||(s*=-1),s}f(Ie,"type","tiff"),f(Ie,"headerLength",10),A.set("tiff",Ie);var we=Object.freeze({__proto__:null,default:de,Exifr:ce,fileParsers:T,segmentParsers:A,fileReaders:D,tagKeys:N,tagValues:G,tagRevivers:V,createDictionary:B,extendDictionary:E,fetchUrlAsArrayBuffer:L,readBlobAsArrayBuffer:U,chunkedProps:$,otherSegments:J,segments:q,tiffBlocks:Q,segmentsAndBlocks:Z,tiffExtractables:ee,inheritables:te,allFormatters:ie,Options:oe,parse:fe});const Te={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},Ae=Object.assign({},Te,{firstChunkSize:4e4,gps:[1,2,3,4]});async function De(e){let t=new ce(Ae);await t.read(e);let i=await t.parse();if(i&&i.gps){let{latitude:e,longitude:t}=i.gps;return{latitude:e,longitude:t}}}const Oe=Object.assign({},Te,{tiff:!1,ifd1:!0,mergeOutput:!1});async function xe(e){let t=new ce(Oe);await t.read(e);let i=await t.extractThumbnail();return i&&o?r.from(i):i}async function ve(e){let t=await this.thumbnail(e);if(void 0!==t){let e=new Blob([t]);return URL.createObjectURL(e)}}const Me=Object.assign({},Te,{firstChunkSize:4e4,ifd0:[274]});async function Re(e){let t=new ce(Me);await t.read(e);let i=await t.parse();if(i&&i.ifd0)return i.ifd0[274]}const Le=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});if(e.rotateCanvas=!0,e.rotateCss=!0,"object"==typeof navigator){let t=navigator.userAgent;if(t.includes("iPad")||t.includes("iPhone")){let i=t.match(/OS (\d+)_(\d+)/);if(i){let[,t,n]=i,s=Number(t)+.1*Number(n);e.rotateCanvas=s<13.4,e.rotateCss=!1}}else if(t.includes("OS X 10")){let[,i]=t.match(/OS X 10[_.](\d+)/);e.rotateCanvas=e.rotateCss=Number(i)<15}if(t.includes("Chrome/")){let[,i]=t.match(/Chrome\/(\d+)/);e.rotateCanvas=e.rotateCss=Number(i)<81}else if(t.includes("Firefox/")){let[,i]=t.match(/Firefox\/(\d+)/);e.rotateCanvas=e.rotateCss=Number(i)<77}}async function Ue(t){let i=await Re(t);return Object.assign({canvas:e.rotateCanvas,css:e.rotateCss},Le[i])}class Fe extends I{constructor(...e){super(...e),f(this,"ranges",new Be),0!==this.byteLength&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,i){if(0===e&&0===this.byteLength&&i){let e=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(e)}else{let i=e+t;if(i>this.byteLength){let{dataView:e}=this._extend(i);this._swapDataView(e)}}}_extend(e){let t;t=o?r.allocUnsafe(e):new Uint8Array(e);let i=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:i}}subarray(e,t,i=!1){return t=t||this._lengthToEnd(e),i&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,i=!1){i&&this._tryExtend(t,e.byteLength,e);let n=super.set(e,t);return this.ranges.add(t,n.byteLength),n}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class Be{constructor(){f(this,"list",[])}get length(){return this.list.length}add(e,t,i=0){let n=e+t,s=this.list.filter((t=>Ee(e,t.offset,n)||Ee(e,t.end,n)));if(s.length>0){e=Math.min(e,...s.map((e=>e.offset))),n=Math.max(n,...s.map((e=>e.end))),t=n-e;let i=s.shift();i.offset=e,i.length=t,i.end=n,this.list=this.list.filter((e=>!s.includes(e)))}else this.list.push({offset:e,length:t,end:n})}available(e,t){let i=e+t;return this.list.some((t=>t.offset<=e&&i<=t.end))}}function Ee(e,t,i){return e<=t&&t<=i}class Ne extends Fe{constructor(e,t){super(0),f(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,i=await this.readChunk(e,t);return!!i&&i.byteLength===t}async readChunk(e,t){if(this.chunksRead++,0!==(t=this.safeWrapAddress(e,t)))return this._readChunk(e,t)}safeWrapAddress(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return void 0!==this.size&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}D.set("blob",class extends Ne{async readWhole(){this.chunked=!1;let e=await U(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let i=t?e+t:void 0,n=this.input.slice(e,i),s=await U(n);return this.set(s,e,!0)}});var Ge=Object.freeze({__proto__:null,default:we,Exifr:ce,fileParsers:T,segmentParsers:A,fileReaders:D,tagKeys:N,tagValues:G,tagRevivers:V,createDictionary:B,extendDictionary:E,fetchUrlAsArrayBuffer:L,readBlobAsArrayBuffer:U,chunkedProps:$,otherSegments:J,segments:q,tiffBlocks:Q,segmentsAndBlocks:Z,tiffExtractables:ee,inheritables:te,allFormatters:ie,Options:oe,parse:fe,gpsOnlyOptions:Ae,gps:De,thumbnailOnlyOptions:Oe,thumbnail:xe,thumbnailUrl:ve,orientationOnlyOptions:Me,orientation:Re,rotations:Le,get rotateCanvas(){return e.rotateCanvas},get rotateCss(){return e.rotateCss},rotation:Ue});D.set("url",class extends Ne{async readWhole(){this.chunked=!1;let e=await L(this.input);e instanceof ArrayBuffer?this._swapArrayBuffer(e):e instanceof Uint8Array&&this._swapBuffer(e)}async _readChunk(e,t){let i=t?e+t-1:void 0,n=this.options.httpHeaders||{};(e||i)&&(n.range=`bytes=${[e,i].join("-")}`);let s=await u(this.input,{headers:n}),r=await s.arrayBuffer(),a=r.byteLength;if(416!==s.status)return a!==t&&(this.size=e+a),this.set(r,e,!0)}});I.prototype.getUint64=function(e){let t=this.getUint32(e),i=this.getUint32(e+4);return t<1048575?t<<32|i:void 0!==typeof a?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),a(t)<<a(32)|a(i)):void m("Trying to read 64b value but JS can only handle 53b numbers.")};class Ve extends pe{parseBoxes(e=0){let t=[];for(;e<this.file.byteLength-4;){let i=this.parseBoxHead(e);if(t.push(i),0===i.length)break;e+=i.length}return t}parseSubBoxes(e){e.boxes=this.parseBoxes(e.start)}findBox(e,t){return void 0===e.boxes&&this.parseSubBoxes(e),e.boxes.find((e=>e.kind===t))}parseBoxHead(e){let t=this.file.getUint32(e),i=this.file.getString(e+4,4),n=e+8;return 1===t&&(t=this.file.getUint64(e+8),n+=8),{offset:e,length:t,kind:i,start:n}}parseBoxFullHead(e){if(void 0!==e.version)return;let t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}class ze extends Ve{static canHandle(e,t){if(0!==t)return!1;let i=e.getUint16(2);if(i>50)return!1;let n=16,s=[];for(;n<i;)s.push(e.getString(n,4)),n+=4;return s.includes(this.type)}async parse(){let e=this.file.getUint32(0),t=this.parseBoxHead(e);for(;"meta"!==t.kind;)e+=t.length,await this.file.ensureChunk(e,16),t=this.parseBoxHead(e);await this.file.ensureChunk(t.offset,t.length),this.parseBoxFullHead(t),this.parseSubBoxes(t),this.options.icc.enabled&&await this.findIcc(t),this.options.tiff.enabled&&await this.findExif(t)}async registerSegment(e,t,i){await this.file.ensureChunk(t,i);let n=this.file.subarray(t,i);this.createParser(e,n)}async findIcc(e){let t=this.findBox(e,"iprp");if(void 0===t)return;let i=this.findBox(t,"ipco");if(void 0===i)return;let n=this.findBox(i,"colr");void 0!==n&&await this.registerSegment("icc",n.offset+12,n.length)}async findExif(e){let t=this.findBox(e,"iinf");if(void 0===t)return;let i=this.findBox(e,"iloc");if(void 0===i)return;let n=this.findExifLocIdInIinf(t),s=this.findExtentInIloc(i,n);if(void 0===s)return;let[r,a]=s;await this.file.ensureChunk(r,a);let o=4+this.file.getUint32(r);r+=o,a-=o,await this.registerSegment("tiff",r,a)}findExifLocIdInIinf(e){this.parseBoxFullHead(e);let t,i,n,s,r=e.start,a=this.file.getUint16(r);for(r+=2;a--;){if(t=this.parseBoxHead(r),this.parseBoxFullHead(t),i=t.start,t.version>=2&&(n=3===t.version?4:2,s=this.file.getString(i+n+2,4),"Exif"===s))return this.file.getUintBytes(i,n);r+=t.length}}get8bits(e){let t=this.file.getUint8(e);return[t>>4,15&t]}findExtentInIloc(e,t){this.parseBoxFullHead(e);let i=e.start,[n,s]=this.get8bits(i++),[r,a]=this.get8bits(i++),o=2===e.version?4:2,l=1===e.version||2===e.version?2:0,h=a+n+s,u=2===e.version?4:2,c=this.file.getUintBytes(i,u);for(i+=u;c--;){let e=this.file.getUintBytes(i,o);i+=o+l+2+r;let u=this.file.getUint16(i);if(i+=2,e===t)return u>1&&console.warn("ILOC box has more than one extent but we're only processing one\nPlease create an issue at https://github.com/MikeKovarik/exifr with this file"),[this.file.getUintBytes(i+a,n),this.file.getUintBytes(i+a+n,s)];i+=u*h}}}class He extends ze{}f(He,"type","heic");class je extends ze{}f(je,"type","avif"),T.set("heic",He),T.set("avif",je),B(N,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),B(N,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),B(N,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),B(G,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let We=B(G,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const Ke={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};We.set(37392,Ke),We.set(41488,Ke);const Xe={0:"Normal",1:"Low",2:"High"};function _e(e){return"object"==typeof e&&void 0!==e.length?e[0]:e}function Ye(e){let t=Array.from(e).slice(1);return t[1]>15&&(t=t.map((e=>String.fromCharCode(e)))),"0"!==t[2]&&0!==t[2]||t.pop(),t.join(".")}function $e(e){if("string"==typeof e){var[t,i,n,s,r,a]=e.trim().split(/[-: ]/g).map(Number),o=new Date(t,i-1,n);return Number.isNaN(s)||Number.isNaN(r)||Number.isNaN(a)||(o.setHours(s),o.setMinutes(r),o.setSeconds(a)),Number.isNaN(+o)?e:o}}function Je(e){if("string"==typeof e)return e;let t=[];if(0===e[1]&&0===e[e.length-1])for(let i=0;i<e.length;i+=2)t.push(qe(e[i+1],e[i]));else for(let i=0;i<e.length;i+=2)t.push(qe(e[i],e[i+1]));return S(String.fromCodePoint(...t))}function qe(e,t){return e<<8|t}We.set(41992,Xe),We.set(41993,Xe),We.set(41994,Xe),B(V,["ifd0","ifd1"],[[50827,function(e){return"string"!=typeof e?P(e):e}],[306,$e],[40091,Je],[40092,Je],[40093,Je],[40094,Je],[40095,Je]]),B(V,"exif",[[40960,Ye],[36864,Ye],[36867,$e],[36868,$e],[40962,_e],[40963,_e]]),B(V,"gps",[[0,e=>Array.from(e).join(".")],[7,e=>Array.from(e).join(":")]]);const Qe="http://ns.adobe.com/",Ze="http://ns.adobe.com/xmp/extension/";class et extends ge{static canHandle(e,t){return 225===e.getUint8(t+1)&&1752462448===e.getUint32(t+4)&&e.getString(t+4,Qe.length)===Qe}static headerLength(e,t){return e.getString(t+4,Ze.length)===Ze?79:4+"http://ns.adobe.com/xap/1.0/".length+1}static findPosition(e,t){let i=super.findPosition(e,t);return i.multiSegment=i.extended=79===i.headerLength,i.multiSegment?(i.chunkCount=e.getUint8(t+72),i.chunkNumber=e.getUint8(t+76),0!==e.getUint8(t+77)&&i.chunkNumber++):(i.chunkCount=1/0,i.chunkNumber=-1),i}static handleMultiSegments(e){return e.map((e=>e.chunk.getString())).join("")}normalizeInput(e){return"string"==typeof e?e:I.from(e).getString()}parse(e=this.chunk){if(!this.localOptions.parse)return e;e=function(e){let t={},i={};for(let e of ut)t[e]=[],i[e]=0;return e.replace(ct,((e,n,s)=>{if("<"===n){let n=++i[s];return t[s].push(n),`${e}#${n}`}return`${e}#${t[s].pop()}`}))}(e);let t=nt.findAll(e,"rdf","Description");0===t.length&&t.push(new nt("rdf","Description",void 0,e));let i,n={};for(let e of t)for(let t of e.properties)i=ot(t.ns,n),st(t,i);return function(e){let t;for(let i in e)t=e[i]=d(e[i]),void 0===t&&delete e[i];return d(e)}(n)}assignToOutput(e,t){if(this.localOptions.parse)for(let[i,n]of Object.entries(t))switch(i){case"tiff":this.assignObjectToOutput(e,"ifd0",n);break;case"exif":this.assignObjectToOutput(e,"exif",n);break;case"xmlns":break;default:this.assignObjectToOutput(e,i,n)}else e.xmp=t}}f(et,"type","xmp"),f(et,"multiSegment",!0),A.set("xmp",et);class tt{static findAll(e){return lt(e,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(tt.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[3].slice(1,-1);return n=ht(n),new tt(t,i,n)}constructor(e,t,i){this.ns=e,this.name=t,this.value=i}serialize(){return this.value}}const it="[\\w\\d-]+";class nt{static findAll(e,t,i){if(void 0!==t||void 0!==i){t=t||it,i=i||it;var n=new RegExp(`<(${t}):(${i})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else n=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return lt(e,n).map(nt.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[4],s=e[8];return new nt(t,i,n,s)}constructor(e,t,i,n){this.ns=e,this.name=t,this.attrString=i,this.innerXml=n,this.attrs=tt.findAll(i),this.children=nt.findAll(n),this.value=0===this.children.length?ht(n):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return void 0!==this.value&&0===this.attrs.length&&0===this.children.length}get isListContainer(){return 1===this.children.length&&this.children[0].isList}get isList(){let{ns:e,name:t}=this;return"rdf"===e&&("Seq"===t||"Bag"===t||"Alt"===t)}get isListItem(){return"rdf"===this.ns&&"li"===this.name}serialize(){if(0===this.properties.length&&void 0===this.value)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return at(this.children.map(rt));if(this.isListItem&&1===this.children.length&&0===this.attrs.length)return this.children[0].serialize();let e={};for(let t of this.properties)st(t,e);return void 0!==this.value&&(e.value=this.value),d(e)}}function st(e,t){let i=e.serialize();void 0!==i&&(t[e.name]=i)}var rt=e=>e.serialize(),at=e=>1===e.length?e[0]:e,ot=(e,t)=>t[e]?t[e]:t[e]={};function lt(e,t){let i,n=[];if(!e)return n;for(;null!==(i=t.exec(e));)n.push(i);return n}function ht(e){if(function(e){return null==e||"null"===e||"undefined"===e||""===e||""===e.trim()}(e))return;let t=Number(e);if(!Number.isNaN(t))return t;let i=e.toLowerCase();return"true"===i||"false"!==i&&e.trim()}const ut=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],ct=new RegExp(`(<|\\/)(${ut.join("|")})`,"g");var ft=Object.freeze({__proto__:null,default:Ge,Exifr:ce,fileParsers:T,segmentParsers:A,fileReaders:D,tagKeys:N,tagValues:G,tagRevivers:V,createDictionary:B,extendDictionary:E,fetchUrlAsArrayBuffer:L,readBlobAsArrayBuffer:U,chunkedProps:$,otherSegments:J,segments:q,tiffBlocks:Q,segmentsAndBlocks:Z,tiffExtractables:ee,inheritables:te,allFormatters:ie,Options:oe,parse:fe,gpsOnlyOptions:Ae,gps:De,thumbnailOnlyOptions:Oe,thumbnail:xe,thumbnailUrl:ve,orientationOnlyOptions:Me,orientation:Re,rotations:Le,get rotateCanvas(){return e.rotateCanvas},get rotateCss(){return e.rotateCss},rotation:Ue});const dt=["xmp","icc","iptc","tiff"],pt=()=>{};async function gt(e,t,i){let n=i[e];return n.enabled=!0,n.parse=!0,A.get(e).parse(t,n)}let mt=h("fs",(e=>e.promises));D.set("fs",class extends Ne{async readWhole(){this.chunked=!1,this.fs=await mt;let e=await this.fs.readFile(this.input);this._swapBuffer(e)}async readChunked(){this.chunked=!0,this.fs=await mt,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){void 0===this.fh&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(e,t){void 0===this.fh&&await this.open(),e+t>this.size&&(t=this.size-e);var i=this.subarray(e,t,!0);return await this.fh.read(i.dataView,0,t,e),i}async close(){if(this.fh){let e=this.fh;this.fh=void 0,await e.close()}}});D.set("base64",class extends Ne{constructor(...e){super(...e),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(e,t){let i,n,s=this.input;void 0===e?(e=0,i=0,n=0):(i=4*Math.floor(e/3),n=e-i/4*3),void 0===t&&(t=this.size);let a=e+t,l=i+4*Math.ceil(a/3);s=s.slice(i,l);let h=Math.min(t,this.size-e);if(o){let t=r.from(s,"base64").slice(n,n+h);return this.set(t,e,!0)}{let t=this.subarray(e,h,!0),i=atob(s),r=t.toUint8();for(let e=0;e<h;e++)r[e]=i.charCodeAt(n+e);return t}}});class St extends pe{static canHandle(e,t){return 18761===t||19789===t}extendOptions(e){let{ifd0:t,xmp:i,iptc:n,icc:s}=e;i.enabled&&t.deps.add(j),n.enabled&&t.deps.add(W),s.enabled&&t.deps.add(K),t.finalizeFilters()}async parse(){let{tiff:e,xmp:t,iptc:i,icc:n}=this.options;if(e.enabled||t.enabled||i.enabled||n.enabled){let e=Math.max(C(this.options),this.options.chunkSize);await this.file.ensureChunk(0,e),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(e){if(this.parsers.tiff[e]){let t=this.parsers.tiff[e];this.injectSegment(e,t)}}}f(St,"type","tiff"),T.set("tiff",St);let Ct=h("zlib");const yt="XML:com.adobe.xmp",bt="ihdr",Pt="iccp",It="text",kt="itxt",wt=[bt,Pt,It,kt,"exif"];class Tt extends pe{constructor(...e){super(...e),f(this,"catchError",(e=>this.errors.push(e))),f(this,"metaChunks",[]),f(this,"unknownChunks",[])}static canHandle(e,t){return 35152===t&&2303741511===e.getUint32(0)&&218765834===e.getUint32(4)}async parse(){let{file:e}=this;await this.findPngChunksInRange("聣PNG\r\n\n".length,e.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(e,t){let{file:i}=this;for(;e<t;){let t=i.getUint32(e),n=i.getUint32(e+4),s=i.getString(e+4,4).toLowerCase(),r=t+4+4+4,a={type:s,offset:e,length:r,start:e+4+4,size:t,marker:n};wt.includes(s)?this.metaChunks.push(a):this.unknownChunks.push(a),e+=r}}parseTextChunks(){let e=this.metaChunks.filter((e=>e.type===It));for(let t of e){let[e,i]=this.file.getString(t.start,t.size).split("\0");this.injectKeyValToIhdr(e,i)}}injectKeyValToIhdr(e,t){let i=this.parsers.ihdr;i&&i.raw.set(e,t)}findIhdr(){let e=this.metaChunks.find((e=>e.type===bt));e&&!1!==this.options.ihdr.enabled&&this.createParser(bt,e.chunk)}async findExif(){let e=this.metaChunks.find((e=>"exif"===e.type));e&&this.injectSegment("tiff",e.chunk)}async findXmp(){let e=this.metaChunks.filter((e=>e.type===kt));for(let t of e){t.chunk.getString(0,yt.length)===yt&&this.injectSegment("xmp",t.chunk)}}async findIcc(){let e=this.metaChunks.find((e=>e.type===Pt));if(!e)return;let{chunk:t}=e,i=t.getUint8Array(0,81),n=0;for(;n<80&&0!==i[n];)n++;let r=n+2,a=t.getString(0,n);if(this.injectKeyValToIhdr("ProfileName",a),s){let e=await Ct,i=t.getUint8Array(r);i=e.inflateSync(i),this.injectSegment("icc",i)}}}f(Tt,"type","png"),T.set("png",Tt),B(N,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),E(N,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);let At=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];E(N,"ifd0",At),E(N,"exif",At),B(G,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);class Dt extends ge{static canHandle(e,t){return 224===e.getUint8(t+1)&&1246120262===e.getUint32(t+4)&&0===e.getUint8(t+8)}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}f(Dt,"type","jfif"),f(Dt,"headerLength",9),A.set("jfif",Dt),B(N,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);class Ot extends ge{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}}f(Ot,"type","ihdr"),A.set("ihdr",Ot),B(N,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),B(G,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);const xt="\0\0\0\0";class vt extends ge{static canHandle(e,t){return 226===e.getUint8(t+1)&&1229144927===e.getUint32(t+4)}static findPosition(e,t){let i=super.findPosition(e,t);return i.chunkNumber=e.getUint8(t+16),i.chunkCount=e.getUint8(t+17),i.multiSegment=i.chunkCount>1,i}static handleMultiSegments(e){return function(e){let t=function(e){let t=e[0].constructor,i=0;for(let t of e)i+=t.length;let n=new t(i),s=0;for(let t of e)n.set(t,s),s+=t.length;return n}(e.map((e=>e.chunk.toUint8())));return new I(t)}(e)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:e}=this;this.chunk.byteLength<84&&m("ICC header is too short");for(let[t,i]of Object.entries(Mt)){t=parseInt(t,10);let n=i(this.chunk,t);n!==xt&&e.set(t,n)}}parseTags(){let e,t,i,n,s,{raw:r}=this,a=this.chunk.getUint32(128),o=132,l=this.chunk.byteLength;for(;a--;){if(e=this.chunk.getString(o,4),t=this.chunk.getUint32(o+4),i=this.chunk.getUint32(o+8),n=this.chunk.getString(t,4),t+i>l)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");s=this.parseTag(n,t,i),void 0!==s&&s!==xt&&r.set(e,s),o+=12}}parseTag(e,t,i){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,i);case"sig ":return this.parseSig(t)}if(!(t+i>this.chunk.byteLength))return this.chunk.getUint8Array(t,i)}parseDesc(e){let t=this.chunk.getUint32(e+8)-1;return S(this.chunk.getString(e+12,t))}parseText(e,t){return S(this.chunk.getString(e+8,t-8))}parseSig(e){return S(this.chunk.getString(e+8,4))}parseMluc(e){let{chunk:t}=this,i=t.getUint32(e+8),n=t.getUint32(e+12),s=e+16,r=[];for(let a=0;a<i;a++){let i=t.getString(s+0,2),a=t.getString(s+2,2),o=t.getUint32(s+4),l=t.getUint32(s+8)+e,h=S(t.getUnicodeString(l,o));r.push({lang:i,country:a,text:h}),s+=n}return 1===i?r[0].text:r}translateValue(e,t){return"string"==typeof e?t[e]||t[e.toLowerCase()]||e:t[e]||e}}f(vt,"type","icc"),f(vt,"multiSegment",!0),f(vt,"headerLength",18);const Mt={4:Rt,8:function(e,t){return[e.getUint8(t),e.getUint8(t+1)>>4,e.getUint8(t+1)%16].map((e=>e.toString(10))).join(".")},12:Rt,16:Rt,20:Rt,24:function(e,t){const i=e.getUint16(t),n=e.getUint16(t+2)-1,s=e.getUint16(t+4),r=e.getUint16(t+6),a=e.getUint16(t+8),o=e.getUint16(t+10);return new Date(Date.UTC(i,n,s,r,a,o))},36:Rt,40:Rt,48:Rt,52:Rt,64:(e,t)=>e.getUint32(t),80:Rt};function Rt(e,t){return S(e.getString(t,4))}A.set("icc",vt),B(N,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);const Lt={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},Ut={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};B(G,"icc",[[4,Lt],[12,Ut],[40,Object.assign({},Lt,Ut)],[48,Lt],[80,Lt],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);class Ft extends ge{static canHandle(e,t,i){return 237===e.getUint8(t+1)&&"Photoshop"===e.getString(t+4,9)&&void 0!==this.containsIptc8bim(e,t,i)}static headerLength(e,t,i){let n,s=this.containsIptc8bim(e,t,i);if(void 0!==s)return n=e.getUint8(t+s+7),n%2!=0&&(n+=1),0===n&&(n=4),s+8+n}static containsIptc8bim(e,t,i){for(let n=0;n<i;n++)if(this.isIptcSegmentHead(e,t+n))return n}static isIptcSegmentHead(e,t){return 56===e.getUint8(t)&&943868237===e.getUint32(t)&&1028===e.getUint16(t+4)}parse(){let{raw:e}=this,t=this.chunk.byteLength-1,i=!1;for(let n=0;n<t;n++)if(28===this.chunk.getUint8(n)&&2===this.chunk.getUint8(n+1)){i=!0;let t=this.chunk.getUint16(n+3),s=this.chunk.getUint8(n+2),r=this.chunk.getLatin1String(n+5,t);e.set(s,this.pluralizeValue(e.get(s),r)),n+=4+t}else if(i)break;return this.translate(),this.output}pluralizeValue(e,t){return void 0!==e?e instanceof Array?(e.push(t),e):[e,t]:t}}f(Ft,"type","iptc"),f(Ft,"translateValues",!1),f(Ft,"reviveValues",!1),A.set("iptc",Ft),B(N,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),B(G,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]),e.Exifr=ce,e.Options=oe,e.allFormatters=ie,e.chunkedProps=$,e.createDictionary=B,e.default=ft,e.extendDictionary=E,e.fetchUrlAsArrayBuffer=L,e.fileParsers=T,e.fileReaders=D,e.gps=De,e.gpsOnlyOptions=Ae,e.inheritables=te,e.orientation=Re,e.orientationOnlyOptions=Me,e.otherSegments=J,e.parse=fe,e.readBlobAsArrayBuffer=U,e.rotation=Ue,e.rotations=Le,e.segmentParsers=A,e.segments=q,e.segmentsAndBlocks=Z,e.sidecar=async function(e,t,i){let n=new oe(t);n.chunked=!1,void 0===i&&"string"==typeof e&&(i=function(e){let t=e.toLowerCase().split(".").pop();if(function(e){return"exif"===e||"tiff"===e||"tif"===e}(t))return"tiff";if(dt.includes(t))return t}(e));let s=await x(e,n);if(i){if(dt.includes(i))return gt(i,s,n);m("Invalid segment type")}else{if(function(e){let t=e.getString(0,50).trim();return t.includes("<?xpacket")||t.includes("<x:")}(s))return gt("xmp",s,n);for(let[e]of A){if(!dt.includes(e))continue;let t=await gt(e,s,n).catch(pt);if(t)return t}m("Unknown file format")}},e.tagKeys=N,e.tagRevivers=V,e.tagValues=G,e.thumbnail=xe,e.thumbnailOnlyOptions=Oe,e.thumbnailUrl=ve,e.tiffBlocks=Q,e.tiffExtractables=ee,Object.defineProperty(e,"__esModule",{value:!0})}));
node_modules\node-cron\dist\cjs\logger.js:14:    const prefix = `[${timestamp}] [PID: ${process.pid}] ${GREEN}[NODE-CRON]${GREEN} ${color}[${level}]${RESET}`;
node_modules\node-cron\dist\cjs\node-cron.js:6:exports.nodeCron = exports.getTask = exports.getTasks = void 0;
node_modules\node-cron\dist\cjs\node-cron.js:63:exports.nodeCron = {
node_modules\node-cron\dist\cjs\node-cron.js:70:exports.default = exports.nodeCron;
node_modules\node-cron\dist\cjs\node-cron.js:71://# sourceMappingURL=node-cron.js.mapnode_modules\node-cron\dist\cjs\scheduler\runner.js:106:                    logger_1.default.warn(`missed execution at ${expectedNextExecution}! Possible blocking IO or high CPU user at the same process used by node-cron.`);
node_modules\node-cron\dist\cjs\tasks\background-scheduled-task\background-scheduled-task.js:21:    cronExpression;
node_modules\node-cron\dist\cjs\tasks\background-scheduled-task\background-scheduled-task.js:26:    constructor(cronExpression, taskPath, options) {
node_modules\node-cron\dist\cjs\tasks\background-scheduled-task\background-scheduled-task.js:27:        this.cronExpression = cronExpression;
node_modules\node-cron\dist\cjs\tasks\background-scheduled-task\background-scheduled-task.js:47:            const timeMatcher = new time_matcher_1.TimeMatcher(this.cronExpression, this.options?.timezone);
node_modules\node-cron\dist\cjs\tasks\background-scheduled-task\background-scheduled-task.js:68:                        const erro = new Error(`node-cron daemon exited with code ${code || signal}`);
node_modules\node-cron\dist\cjs\tasks\background-scheduled-task\background-scheduled-task.js:99:                    cron: this.cronExpression,
node_modules\node-cron\dist\cjs\tasks\background-scheduled-task\daemon.js:52:    const task = new inline_scheduled_task_1.InlineScheduledTask(message.cron, script.task, message.options);
node_modules\node-cron\dist\cjs\tasks\inline-scheduled-task.js:18:    cronExpression;
node_modules\node-cron\dist\cjs\tasks\inline-scheduled-task.js:25:    constructor(cronExpression, taskFn, options) {
node_modules\node-cron\dist\cjs\tasks\inline-scheduled-task.js:27:        this.cronExpression = cronExpression;
node_modules\node-cron\dist\cjs\tasks\inline-scheduled-task.js:31:        this.timeMatcher = new time_matcher_1.TimeMatcher(cronExpression, options?.timezone);
node_modules\node-cron\dist\cjs\time\matcher-walker.js:12:    cronExpression;
node_modules\node-cron\dist\cjs\time\matcher-walker.js:18:    constructor(cronExpression, baseDate, timezone) {
node_modules\node-cron\dist\cjs\time\matcher-walker.js:19:        this.cronExpression = cronExpression;
node_modules\node-cron\dist\cjs\time\matcher-walker.js:21:        this.timeMatcher = new time_matcher_1.TimeMatcher(cronExpression, timezone);
node_modules\node-cron\dist\cjs\time\matcher-walker.js:23:        this.expressions = (0, convertion_1.default)(cronExpression);
node_modules\node-cron\dist\esm\logger.js:14:    const prefix = `[${timestamp}] [PID: ${process.pid}] ${GREEN}[NODE-CRON]${GREEN} ${color}[${level}]${RESET}`;
node_modules\node-cron\dist\esm\node-cron.js:6:exports.nodeCron = exports.getTask = exports.getTasks = void 0;
node_modules\node-cron\dist\esm\node-cron.js:63:exports.nodeCron = {
node_modules\node-cron\dist\esm\node-cron.js:70:exports.default = exports.nodeCron;
node_modules\node-cron\dist\esm\node-cron.js:71://# sourceMappingURL=node-cron.js.mapnode_modules\node-cron\dist\esm\scheduler\runner.js:106:                    logger_1.default.warn(`missed execution at ${expectedNextExecution}! Possible blocking IO or high CPU user at the same process used by node-cron.`);
node_modules\node-cron\dist\esm\tasks\background-scheduled-task\background-scheduled-task.js:21:    cronExpression;
node_modules\node-cron\dist\esm\tasks\background-scheduled-task\background-scheduled-task.js:26:    constructor(cronExpression, taskPath, options) {
node_modules\node-cron\dist\esm\tasks\background-scheduled-task\background-scheduled-task.js:27:        this.cronExpression = cronExpression;
node_modules\node-cron\dist\esm\tasks\background-scheduled-task\background-scheduled-task.js:47:            const timeMatcher = new time_matcher_1.TimeMatcher(this.cronExpression, this.options?.timezone);
node_modules\node-cron\dist\esm\tasks\background-scheduled-task\background-scheduled-task.js:68:                        const erro = new Error(`node-cron daemon exited with code ${code || signal}`);
node_modules\node-cron\dist\esm\tasks\background-scheduled-task\background-scheduled-task.js:99:                    cron: this.cronExpression,
node_modules\node-cron\dist\esm\tasks\background-scheduled-task\daemon.js:19:    const task = new inline_scheduled_task_1.InlineScheduledTask(message.cron, script.task, message.options);
node_modules\node-cron\dist\esm\tasks\inline-scheduled-task.js:18:    cronExpression;
node_modules\node-cron\dist\esm\tasks\inline-scheduled-task.js:25:    constructor(cronExpression, taskFn, options) {
node_modules\node-cron\dist\esm\tasks\inline-scheduled-task.js:27:        this.cronExpression = cronExpression;
node_modules\node-cron\dist\esm\tasks\inline-scheduled-task.js:31:        this.timeMatcher = new time_matcher_1.TimeMatcher(cronExpression, options?.timezone);
node_modules\node-cron\dist\esm\time\matcher-walker.js:12:    cronExpression;
node_modules\node-cron\dist\esm\time\matcher-walker.js:18:    constructor(cronExpression, baseDate, timezone) {
node_modules\node-cron\dist\esm\time\matcher-walker.js:19:        this.cronExpression = cronExpression;
node_modules\node-cron\dist\esm\time\matcher-walker.js:21:        this.timeMatcher = new time_matcher_1.TimeMatcher(cronExpression, timezone);
node_modules\node-cron\dist\esm\time\matcher-walker.js:23:        this.expressions = (0, convertion_1.default)(cronExpression);
node_modules\node-schedule\lib\Invocation.js:4:const CronDate = require('cron-parser/lib/date')
node_modules\node-schedule\lib\Invocation.js:57:  NOTE: Cron months are 1-based, but RecurrenceRule months are 0-based.
node_modules\node-schedule\lib\Invocation.js:128:  base = ((base instanceof CronDate) || (base instanceof Date)) ? base : (new Date());
node_modules\node-schedule\lib\Invocation.js:137:  const now = new CronDate(Date.now(), this.tz);
node_modules\node-schedule\lib\Invocation.js:145:  let next = new CronDate(base.getTime(), this.tz);
node_modules\node-schedule\lib\Invocation.js:235:  const date = invocation.fireDate instanceof CronDate ? invocation.fireDate.toDate() : invocation.fireDate;
node_modules\node-schedule\lib\Invocation.js:268:        const result = job.invoke(cinv.fireDate instanceof CronDate ? cinv.fireDate.toDate() : cinv.fireDate);
node_modules\node-schedule\lib\Invocation.js:322:  prevDate = (prevDate instanceof CronDate) ? prevDate : new CronDate();
node_modules\node-schedule\lib\Invocation.js:329:  if ((endDate instanceof CronDate) && date.getTime() > endDate.getTime()) {
node_modules\node-schedule\lib\Job.js:4:const cronParser = require('cron-parser')
node_modules\node-schedule\lib\Job.js:5:const CronDate = require('cron-parser/lib/date')
node_modules\node-schedule\lib\Job.js:201:      start = new CronDate(start, tz);
node_modules\node-schedule\lib\Job.js:212:      end = new CronDate(end, tz);
node_modules\node-schedule\lib\Job.js:217:    const res = cronParser.parseExpression(spec, {currentDate: start, tz: tz});
node_modules\node-schedule\lib\Job.js:229:      spec = new CronDate(spec);
node_modules\node-schedule\lib\schedule.js:5:  A cron-like and not-cron-like job scheduler for Node.
node_modules\node-schedule\lib\schedule.js:13:  schedule(date || recurrenceRule || cronstring)
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:15:    async UpdateCronJob(req, cb) {
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:16:        return this.request("UpdateCronJob", req, cb);
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:78:    async AbortCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:79:        return this.request("AbortCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:84:    async RestartCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:85:        return this.request("RestartCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:117:    async DeleteCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:118:        return this.request("DeleteCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:120:    async DescribeCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:121:        return this.request("DescribeCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:147:    async CreateCronJob(req, cb) {
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:148:        return this.request("CreateCronJob", req, cb);
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:51:    async UpdateCronJob(req, cb) {
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:52:        return this.request("UpdateCronJob", req, cb);
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:177:    async AbortCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:178:        return this.request("AbortCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:189:    async RestartCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:190:        return this.request("RestartCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:255:    async DeleteCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:256:        return this.request("DeleteCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:261:    async DescribeCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:262:        return this.request("DescribeCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:315:    async CreateCronJob(req, cb) {
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:316:        return this.request("CreateCronJob", req, cb);
tasks\autoSettlement.js:12: * - 鍙€氳繃 node-cron 鎴?pm2 瀹氭椂璋冨害
FINDSTR: 写入错误


D:\housekeeping-platform\backend>findstr /s /i /n "setInterval" *.js
app.js:432:        setInterval(async () => {
jobs\acceptanceReminder.js:102:  setInterval(() => {
node_modules\basic-ftp\dist\ProgressTracker.js:60:    const id = setInterval(updateFunc, intervalMs);
node_modules\bull\lib\job.js:535:      const interval = setInterval(() => {
node_modules\bull\lib\queue.js:1091:    this.moveUnlockedJobsToWaitInterval = setInterval(
node_modules\echarts\dist\echarts.common.js:28128:          // In WeChat embedded browser, `requestAnimationFrame` and `setInterval`
node_modules\echarts\dist\echarts.common.js:32255:      IntervalScale.prototype.setInterval = function (interval) {
node_modules\echarts\dist\echarts.common.js:33853:        scale.setInterval && scale.setInterval(interval);
node_modules\echarts\dist\echarts.common.js:45640:      // NOTE: Must in setExtent -> setInterval -> setNiceExtent order.
node_modules\echarts\dist\echarts.common.js:45642:      intervalScaleProto.setInterval.call(scale, interval);
node_modules\echarts\dist\echarts.common.js:58508:        // Notice: this._resetInterval() should not be executed when payload.type
node_modules\echarts\dist\echarts.common.js:58532:        this._resetInterval();
node_modules\echarts\dist\echarts.common.js:58940:      SliderZoomView.prototype._resetInterval = function () {
node_modules\echarts\dist\echarts.common.min.js:45:var qr={},Kr={};var $r,Qr=function(){function t(t,e,n){var i=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,n=n||{},this.dom=e,this.id=t;var o=new hn,a=n.renderer||"canvas";qr[a]||(a=H(qr)[0]),n.useDirtyRect=null!=n.useDirtyRect&&n.useDirtyRect;var s=new qr[a](e,o,n,t),l=n.ssr||s.ssrOnly;this.storage=o,this.painter=s;var u,h=r.node||r.worker||l?null:new ur(s.getViewportRoot(),s.root),c=n.useCoarsePointer;(null==c||"auto"===c?r.touchEventsSupported:!!c)&&(u=rt(n.pointerSize,44)),this.handler=new Ke(o,s,h,s.root,u),this.animation=new Yi({stage:{update:l?null:function(){return i._flush(!0)}}}),l||this.animation.start()}return t.prototype.add=function(t){!this._disposed&&t&&(this.storage.addRoot(t),t.addSelfToZr(this),this.refresh())},t.prototype.remove=function(t){!this._disposed&&t&&(this.storage.delRoot(t),t.removeSelfFromZr(this),this.refresh())},t.prototype.configLayer=function(t,e){this._disposed||(this.painter.configLayer&&this.painter.configLayer(t,e),this.refresh())},t.prototype.setBackgroundColor=function(t){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(t),this.refresh(),this._backgroundColor=t,this._darkMode=function(t){if(!t)return!1;if("string"==typeof t)return ui(t,1)<.4;if(t.colorStops){for(var e=t.colorStops,n=0,i=e.length,r=0;r<i;r++)n+=ui(e[r].color,1);return(n/=i)<.4}return!1}(t))},t.prototype.getBackgroundColor=function(){return this._backgroundColor},t.prototype.setDarkMode=function(t){this._darkMode=t},t.prototype.isDarkMode=function(){return this._darkMode},t.prototype.refreshImmediately=function(t){this._disposed||(t||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},t.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},t.prototype.flush=function(){this._disposed||this._flush(!1)},t.prototype._flush=function(t){var e,n=Gi();this._needsRefresh&&(e=!0,this.refreshImmediately(t)),this._needsRefreshHover&&(e=!0,this.refreshHoverImmediately());var i=Gi();e?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:i-n})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},t.prototype.setSleepAfterStill=function(t){this._sleepAfterStill=t},t.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},t.prototype.refreshHover=function(){this._needsRefreshHover=!0},t.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&"canvas"===this.painter.getType()&&this.painter.refreshHover())},t.prototype.resize=function(t){this._disposed||(t=t||{},this.painter.resize(t.width,t.height),this.handler.resize())},t.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},t.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},t.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},t.prototype.setCursorStyle=function(t){this._disposed||this.handler.setCursorStyle(t)},t.prototype.findHover=function(t,e){if(!this._disposed)return this.handler.findHover(t,e)},t.prototype.on=function(t,e,n){return this._disposed||this.handler.on(t,e,n),this},t.prototype.off=function(t,e){this._disposed||this.handler.off(t,e)},t.prototype.trigger=function(t,e){this._disposed||this.handler.trigger(t,e)},t.prototype.clear=function(){if(!this._disposed){for(var t=this.storage.getRoots(),e=0;e<t.length;e++)t[e]instanceof jr&&t[e].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},t.prototype.dispose=function(){var t;this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,t=this.id,delete Kr[t])},t}();function Jr(t,e){var n=new Qr(M(),t,e);return Kr[n.id]=n,n}function to(t,e){qr[t]=e}function eo(t){if("function"==typeof $r)return $r(t)}function no(t){$r=t}var io=Object.freeze({__proto__:null,init:Jr,dispose:function(t){t.dispose()},disposeAll:function(){for(var t in Kr)Kr.hasOwnProperty(t)&&Kr[t].dispose();Kr={}},getInstance:function(t){return Kr[t]},registerPainter:to,getElementSSRData:eo,registerSSRDataGetter:no,version:"6.0.0"}),ro=1e-4;var oo=Math.min,ao=Math.max,so=Math.abs;function lo(t,e,n,i){var r=e[0],o=e[1],a=n[0],s=n[1],l=o-r,u=s-a;if(0===l)return 0===u?a:(a+s)/2;if(i)if(l>0){if(t<=r)return a;if(t>=o)return s}else{if(t>=r)return a;if(t<=o)return s}else{if(t===r)return a;if(t===o)return s}return(t-r)/l*u+a}var uo=function(t,e,n){switch(t){case"center":case"middle":t="50%";break;case"left":case"top":t="0%";break;case"right":case"bottom":t="100%"}return ho(t,e,n)};function ho(t,e,n){return Y(t)?(i=t,i.replace(/^\s+|\s+$/g,"")).match(/%$/)?parseFloat(t)/100*e+(n||0):parseFloat(t):null==t?NaN:+t;var i}function co(t,e,n){return null==e&&(e=10),e=Math.min(Math.max(0,e),20),t=(+t).toFixed(e),n?t:+t}function po(t){return t.sort((function(t,e){return t-e})),t}function fo(t){if(t=+t,isNaN(t))return 0;if(t>1e-14)for(var e=1,n=0;n<15;n++,e*=10)if(Math.round(t*e)/e===t)return n;return go(t)}function go(t){var e=t.toString().toLowerCase(),n=e.indexOf("e"),i=n>0?+e.slice(n+1):0,r=n>0?n:e.length,o=e.indexOf("."),a=o<0?0:r-1-o;return Math.max(0,a-i)}function vo(t,e){var n=Math.log,i=Math.LN10,r=Math.floor(n(t[1]-t[0])/i),o=Math.round(n(so(e[1]-e[0]))/i),a=Math.min(Math.max(-r+o,0),20);return isFinite(a)?a:20}function yo(t,e){var n=E(t,(function(t,e){return t+(isNaN(e)?0:e)}),0);if(0===n)return[];for(var i=Math.pow(10,e),r=z(t,(function(t){return(isNaN(t)?0:t)/n*i*100})),o=100*i,a=z(r,(function(t){return Math.floor(t)})),s=E(a,(function(t,e){return t+e}),0),l=z(r,(function(t,e){return t-a[e]}));s<o;){for(var u=Number.NEGATIVE_INFINITY,h=null,c=0,p=l.length;c<p;++c)l[c]>u&&(u=l[c],h=c);++a[h],l[h]=0,++s}return z(a,(function(t){return t/i}))}function mo(t,e){var n=Math.max(fo(t),fo(e)),i=t+e;return n>20?i:co(i,n)}function _o(t){var e=2*Math.PI;return(t%e+e)%e}function xo(t){return t>-1e-4&&t<ro}var bo=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function wo(t){if(t instanceof Date)return t;if(Y(t)){var e=bo.exec(t);if(!e)return new Date(NaN);if(e[8]){var n=+e[4]||0;return"Z"!==e[8].toUpperCase()&&(n-=+e[8].slice(0,3)),new Date(Date.UTC(+e[1],+(e[2]||1)-1,+e[3]||1,n,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0))}return new Date(+e[1],+(e[2]||1)-1,+e[3]||1,+e[4]||0,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0)}return null==t?new Date(NaN):new Date(Math.round(t))}function So(t){return Math.pow(10,Mo(t))}function Mo(t){if(0===t)return 0;var e=Math.floor(Math.log(t)/Math.LN10);return t/Math.pow(10,e)>=10&&e++,e}function To(t,e){var n=Mo(t),i=Math.pow(10,n),r=t/i;return t=(e?r<1.5?1:r<2.5?2:r<4?3:r<7?5:10:r<1?1:r<2?2:r<3?3:r<5?5:10)*i,n>=-20?+t.toFixed(n<0?-n:0):t}function ko(t){var e=parseFloat(t);return e==t&&(0!==e||!Y(t)||t.indexOf("x")<=0)?e:NaN}function Co(t){return!isNaN(ko(t))}function Io(){return Math.round(9*Math.random())}function Do(t,e){return 0===e?t:Do(e,t%e)}function Ao(t,e){return null==t?e:null==e?t:t*e/Do(t,e)}var Po={},Lo="undefined"!=typeof console&&console.warn&&console.log;function Oo(t,e,n){if(Lo){if(n){if(Po[e])return;Po[e]=!0}console[t]("[ECharts] "+e)}}function Ro(t,e){Oo("error",t,e)}function No(t){0}function Bo(t){throw new Error(t)}function zo(t,e,n){return(e-t)*n+t}var Eo="series\0",Vo="\0_ec_\0";function Fo(t){return t instanceof Array?t:null==t?[]:[t]}function Ho(t,e,n){if(t){t[e]=t[e]||{},t.emphasis=t.emphasis||{},t.emphasis[e]=t.emphasis[e]||{};for(var i=0,r=n.length;i<r;i++){var o=n[i];!t.emphasis[e].hasOwnProperty(o)&&t[e].hasOwnProperty(o)&&(t.emphasis[e][o]=t[e][o])}}}var Wo=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function Go(t){return!q(t)||U(t)||t instanceof Date?t:t.value}function Uo(t){return q(t)&&!(t instanceof Array)}function Zo(t,e,n){var i="normalMerge"===n,r="replaceMerge"===n,o="replaceAll"===n;t=t||[],e=(e||[]).slice();var a=vt();B(e,(function(t,n){q(t)||(e[n]=null)}));var s,l,u=function(t,e,n){var i=[];if("replaceAll"===n)return i;for(var r=0;r<t.length;r++){var o=t[r];o&&null!=o.id&&e.set(o.id,r),i.push({existing:"replaceMerge"===n||Ko(o)?null:o,newOption:null,keyInfo:null,brandNew:null})}return i}(t,a,n);return(i||r)&&function(t,e,n,i){B(i,(function(r,o){if(r&&null!=r.id){var a=Xo(r.id),s=n.get(a);if(null!=s){var l=t[s];lt(!l.newOption,'Duplicated option on id "'+a+'".'),l.newOption=r,l.existing=e[s],i[o]=null}}}))}(u,t,a,e),i&&function(t,e){B(e,(function(n,i){if(n&&null!=n.name)for(var r=0;r<t.length;r++){var o=t[r].existing;if(!t[r].newOption&&o&&(null==o.id||null==n.id)&&!Ko(n)&&!Ko(o)&&Yo("name",o,n))return t[r].newOption=n,void(e[i]=null)}}))}(u,e),i||r?function(t,e,n){B(e,(function(e){if(e){for(var i,r=0;(i=t[r])&&(i.newOption||Ko(i.existing)||i.existing&&null!=e.id&&!Yo("id",e,i.existing));)r++;i?(i.newOption=e,i.brandNew=n):t.push({newOption:e,brandNew:n,existing:null,keyInfo:null}),r++}}))}(u,e,r):o&&function(t,e){B(e,(function(e){t.push({newOption:e,brandNew:!0,existing:null,keyInfo:null})}))}(u,e),s=u,l=vt(),B(s,(function(t){var e=t.existing;e&&l.set(e.id,t)})),B(s,(function(t){var e=t.newOption;lt(!e||null==e.id||!l.get(e.id)||l.get(e.id)===t,"id duplicates: "+(e&&e.id)),e&&null!=e.id&&l.set(e.id,t),!t.keyInfo&&(t.keyInfo={})})),B(s,(function(t,e){var n=t.existing,i=t.newOption,r=t.keyInfo;if(q(i)){if(r.name=null!=i.name?Xo(i.name):n?n.name:Eo+e,n)r.id=Xo(n.id);else if(null!=i.id)r.id=Xo(i.id);else{var o=0;do{r.id="\0"+r.name+"\0"+o++}while(l.get(r.id))}l.set(r.id,t)}})),u}function Yo(t,e,n){var i=jo(e[t],null),r=jo(n[t],null);return null!=i&&null!=r&&i===r}function Xo(t){return jo(t,"")}function jo(t,e){return null==t?e:Y(t)?t:j(t)||X(t)?t+"":e}function qo(t){var e=t.name;return!(!e||!e.indexOf(Eo))}function Ko(t){return t&&null!=t.id&&0===Xo(t.id).indexOf(Vo)}function $o(t,e){return null!=e.dataIndexInside?e.dataIndexInside:null!=e.dataIndex?U(e.dataIndex)?z(e.dataIndex,(function(e){return t.indexOfRawIndex(e)})):t.indexOfRawIndex(e.dataIndex):null!=e.name?U(e.name)?z(e.name,(function(e){return t.indexOfName(e)})):t.indexOfName(e.name):void 0}function Qo(){var t="__ec_inner_"+Jo++;return function(e){return e[t]||(e[t]={})}}var Jo=Io();function ta(t,e,n){var i=ea(e,n),r=i.mainTypeSpecified,o=i.queryOptionMap,a=i.others,s=n?n.defaultMainType:null;return!r&&s&&o.set(s,{}),o.each((function(e,i){var r=ra(t,i,e,{useDefault:s===i,enableAll:!n||null==n.enableAll||n.enableAll,enableNone:!n||null==n.enableNone||n.enableNone});a[i+"Models"]=r.models,a[i+"Model"]=r.models[0]})),a}function ea(t,e){var n;if(Y(t)){var i={};i[t+"Index"]=0,n=i}else n=t;var r=vt(),o={},a=!1;return B(n,(function(t,n){if("dataIndex"!==n&&"dataIndexInside"!==n){var i=n.match(/^(\w+)(Index|Id|Name)$/)||[],s=i[1],l=(i[2]||"").toLowerCase();if(s&&l&&!(e&&e.includeMainTypes&&L(e.includeMainTypes,s)<0))a=a||!!s,(r.get(s)||r.set(s,{}))[l]=t}else o[n]=t})),{mainTypeSpecified:a,queryOptionMap:r,others:o}}var na={useDefault:!0,enableAll:!1,enableNone:!1},ia={useDefault:!1,enableAll:!0,enableNone:!0};function ra(t,e,n,i){i=i||na;var r=n.index,o=n.id,a=n.name,s={models:null,specified:null!=r||null!=o||null!=a};if(!s.specified){var l=void 0;return s.models=i.useDefault&&(l=t.getComponent(e))?[l]:[],s}if("none"===r||!1===r){if(i.enableNone)return s.models=[],s;r=-1}return"all"===r&&(r=i.enableAll?o=a=null:-1),s.models=t.queryComponents({mainType:e,index:r,id:o,name:a}),s}function oa(t,e,n){t.setAttribute?t.setAttribute(e,n):t[e]=n}var aa="___EC__COMPONENT__CONTAINER___",sa="___EC__EXTENDED_CLASS___";function la(t){var e={main:"",sub:""};if(t){var n=t.split(".");e.main=n[0]||"",e.sub=n[1]||""}return e}function ua(t,e){t.$constructor=t,t.extend=function(t){var e,i,r=this;return Z(i=r)&&/^class\s/.test(Function.prototype.toString.call(i))?e=function(t){function e(){return t.apply(this,arguments)||this}return n(e,t),e}(r):(e=function(){(t.$constructor||r).apply(this,arguments)},O(e,this)),D(e.prototype,t),e[sa]=!0,e.extend=this.extend,e.superCall=pa,e.superApply=da,e.superClass=r,e}}function ha(t,e){t.extend=e.extend}var ca=Math.round(10*Math.random());function pa(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return this.superClass.prototype[e].apply(t,n)}function da(t,e,n){return this.superClass.prototype[e].apply(t,n)}function fa(t){var e={};t.registerClass=function(t){var n,i=t.type||t.prototype.type;if(i){lt(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(n=i),'componentType "'+n+'" illegal'),t.prototype.type=i;var r=la(i);if(r.sub){if(r.sub!==aa){var o=function(t){var n=e[t.main];n&&n[aa]||((n=e[t.main]={})[aa]=!0);return n}(r);o[r.sub]=t}}else e[r.main]=t}return t},t.getClass=function(t,n,i){var r=e[t];if(r&&r[aa]&&(r=n?r[n]:null),i&&!r)throw new Error(n?"Component "+t+"."+(n||"")+" is used but not imported.":t+".type should be specified.");return r},t.getClassesByMainType=function(t){var n=la(t),i=[],r=e[n.main];return r&&r[aa]?B(r,(function(t,e){e!==aa&&i.push(t)})):i.push(r),i},t.hasClass=function(t){var n=la(t);return!!e[n.main]},t.getAllClassMainTypes=function(){var t=[];return B(e,(function(e,n){t.push(n)})),t},t.hasSubTypes=function(t){var n=la(t),i=e[n.main];return i&&i[aa]}}function ga(t,e){for(var n=0;n<t.length;n++)t[n][1]||(t[n][1]=t[n][0]);return e=e||!1,function(n,i,r){for(var o={},a=0;a<t.length;a++){var s=t[a][1];if(!(i&&L(i,s)>=0||r&&L(r,s)<0)){var l=n.getShallow(s,e);null!=l&&(o[t[a][0]]=l)}}return o}}var va=ga([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]]),ya=function(){function t(){}return t.prototype.getAreaStyle=function(t,e){return va(this,t,e)},t}(),ma=new Fn(50);function _a(t){if("string"==typeof t){var e=ma.get(t);return e&&e.image}return t}function xa(t,e,n,i,r){if(t){if("string"==typeof t){if(e&&e.__zrImageSrc===t||!n)return e;var o=ma.get(t),a={hostEl:n,cb:i,cbPayload:r};return o?!wa(e=o.image)&&o.pending.push(a):((e=h.loadImage(t,ba,ba)).__zrImageSrc=t,ma.put(t,e.__cachedImgObj={image:e,pending:[a]})),e}return t}return e}function ba(){var t=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var e=0;e<t.pending.length;e++){var n=t.pending[e],i=n.cb;i&&i(this,n.cbPayload),n.hostEl.dirty()}t.pending.length=0}function wa(t){return t&&t.width&&t.height}var Sa=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function Ma(t,e,n,i,r,o){if(!n)return t.text="",void(t.isTruncated=!1);var a=(e+"").split("\n");o=Ta(n,i,r,o);for(var s=!1,l={},u=0,h=a.length;u<h;u++)ka(l,a[u],o),a[u]=l.textLine,s=s||l.isTruncated;t.text=a.join("\n"),t.isTruncated=s}function Ta(t,e,n,i){var r=D({},i=i||{});n=rt(n,"..."),r.maxIterations=rt(i.maxIterations,2);var o=r.minChar=rt(i.minChar,0),a=r.fontMeasureInfo=Tr(e),s=a.asciiCharWidth;r.placeholder=rt(i.placeholder,"");for(var l=t=Math.max(0,t-1),u=0;u<o&&l>=s;u++)l-=s;var h=Dr(a,n);return h>l&&(n="",h=0),l=t-h,r.ellipsis=n,r.ellipsisWidth=h,r.contentWidth=l,r.containerWidth=t,r}function ka(t,e,n){var i=n.containerWidth,r=n.contentWidth,o=n.fontMeasureInfo;if(!i)return t.textLine="",void(t.isTruncated=!1);var a=Dr(o,e);if(a<=i)return t.textLine=e,void(t.isTruncated=!1);for(var s=0;;s++){if(a<=r||s>=n.maxIterations){e+=n.ellipsis;break}var l=0===s?Ca(e,r,o):a>0?Math.floor(e.length*r/a):0;a=Dr(o,e=e.substr(0,l))}""===e&&(e=n.placeholder),t.textLine=e,t.isTruncated=!0}function Ca(t,e,n){for(var i=0,r=0,o=t.length;r<o&&i<e;r++)i+=Ir(n,t.charCodeAt(r));return r}var Ia=function(){},Da=function(t){this.tokens=[],t&&(this.tokens=t)},Aa=function(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[],this.isTruncated=!1};function Pa(t,e,n,i,r){var o,a,s=""===e,l=r&&n.rich[r]||{},u=t.lines,h=l.font||n.font,c=!1;if(i){var p=l.padding,d=p?p[1]+p[3]:0;if(null!=l.width&&"auto"!==l.width){var f=Nr(l.width,i.width)+d;u.length>0&&f+i.accumWidth>i.width&&(o=e.split("\n"),c=!0),i.accumWidth=f}else{var g=Ra(e,h,i.width,i.breakAll,i.accumWidth);i.accumWidth=g.accumWidth+d,a=g.linesWidths,o=g.lines}}o||(o=e.split("\n"));for(var v=Tr(h),y=0;y<o.length;y++){var m=o[y],_=new Ia;if(_.styleName=r,_.text=m,_.isLineHolder=!m&&!s,"number"==typeof l.width?_.width=l.width:_.width=a?a[y]:Dr(v,m),y||c)u.push(new Da([_]));else{var x=(u[u.length-1]||(u[0]=new Da)).tokens,b=x.length;1===b&&x[0].isLineHolder?x[0]=_:(m||!b||s)&&x.push(_)}}}var La=E(",&?/;] ".split(""),(function(t,e){return t[e]=!0,t}),{});function Oa(t){return!function(t){var e=t.charCodeAt(0);return e>=32&&e<=591||e>=880&&e<=4351||e>=4608&&e<=5119||e>=7680&&e<=8303}(t)||!!La[t]}function Ra(t,e,n,i,r){for(var o=[],a=[],s="",l="",u=0,h=0,c=Tr(e),p=0;p<t.length;p++){var d=t.charAt(p);if("\n"!==d){var f=Ir(c,d.charCodeAt(0)),g=!i&&!Oa(d);(o.length?h+f>n:r+h+f>n)?h?(s||l)&&(g?(s||(s=l,l="",h=u=0),o.push(s),a.push(h-u),l+=d,s="",h=u+=f):(l&&(s+=l,l="",u=0),o.push(s),a.push(h),s=d,h=f)):g?(o.push(l),a.push(u),l=d,u=f):(o.push(d),a.push(f)):(h+=f,g?(l+=d,u+=f):(l&&(s+=l,l="",u=0),s+=d))}else l&&(s+=l,h+=u),o.push(s),a.push(h),s="",l="",u=0,h=0}return l&&(s+=l),s&&(o.push(s),a.push(h)),1===o.length&&(h+=r),{accumWidth:h,lines:o,linesWidths:a}}function Na(t,e,n,i,r,o){if(t.baseX=n,t.baseY=i,t.outerWidth=t.outerHeight=null,e){var a=2*e.width,s=2*e.height;Ve.set(Ba,Lr(n,a,r),Or(i,s,o),a,s),Ve.intersect(e,Ba,null,za);var l=za.outIntersectRect;t.outerWidth=l.width,t.outerHeight=l.height,t.baseX=Lr(l.x,l.width,r,!0),t.baseY=Or(l.y,l.height,o,!0)}}var Ba=new Ve(0,0,0,0),za={outIntersectRect:{},clamp:!0};function Ea(t){return null!=t?t+="":t=""}function Va(t,e,n,i){var r=new Ve(Lr(t.x||0,e,t.textAlign),Or(t.y||0,n,t.textBaseline),e,n),o=null!=i?i:Fa(t)?t.lineWidth:0;return o>0&&(r.x-=o/2,r.y-=o/2,r.width+=o,r.height+=o),r}function Fa(t){var e=t.stroke;return null!=e&&"none"!==e&&t.lineWidth>0}var Ha="__zr_style_"+Math.round(10*Math.random()),Wa={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},Ga={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};Wa[Ha]=!0;var Ua=["z","z2","invisible"],Za=["invisible"],Ya=function(t){function e(e){return t.call(this,e)||this}var i;return n(e,t),e.prototype._init=function(e){for(var n=H(e),i=0;i<n.length;i++){var r=n[i];"style"===r?this.useStyle(e[r]):t.prototype.attrKV.call(this,r,e[r])}this.style||this.useStyle({})},e.prototype.beforeBrush=function(){},e.prototype.afterBrush=function(){},e.prototype.innerBeforeBrush=function(){},e.prototype.innerAfterBrush=function(){},e.prototype.shouldBePainted=function(t,e,n,i){var r=this.transform;if(this.ignore||this.invisible||0===this.style.opacity||this.culling&&function(t,e,n){Xa.copy(t.getBoundingRect()),t.transform&&Xa.applyTransform(t.transform);return ja.width=e,ja.height=n,!Xa.intersect(ja)}(this,t,e)||r&&!r[0]&&!r[3])return!1;if(n&&this.__clipPaths&&this.__clipPaths.length)for(var o=0;o<this.__clipPaths.length;++o)if(this.__clipPaths[o].isZeroArea())return!1;if(i&&this.parent)for(var a=this.parent;a;){if(a.ignore)return!1;a=a.parent}return!0},e.prototype.contain=function(t,e){return this.rectContain(t,e)},e.prototype.traverse=function(t,e){t.call(e,this)},e.prototype.rectContain=function(t,e){var n=this.transformCoordToLocal(t,e);return this.getBoundingRect().contain(n[0],n[1])},e.prototype.getPaintRect=function(){var t=this._paintRect;if(!this._paintRect||this.__dirty){var e=this.transform,n=this.getBoundingRect(),i=this.style,r=i.shadowBlur||0,o=i.shadowOffsetX||0,a=i.shadowOffsetY||0;t=this._paintRect||(this._paintRect=new Ve(0,0,0,0)),e?Ve.applyTransform(t,n,e):t.copy(n),(r||o||a)&&(t.width+=2*r+Math.abs(o),t.height+=2*r+Math.abs(a),t.x=Math.min(t.x,t.x+o-r),t.y=Math.min(t.y,t.y+a-r));var s=this.dirtyRectTolerance;t.isZero()||(t.x=Math.floor(t.x-s),t.y=Math.floor(t.y-s),t.width=Math.ceil(t.width+1+2*s),t.height=Math.ceil(t.height+1+2*s))}return t},e.prototype.setPrevPaintRect=function(t){t?(this._prevPaintRect=this._prevPaintRect||new Ve(0,0,0,0),this._prevPaintRect.copy(t)):this._prevPaintRect=null},e.prototype.getPrevPaintRect=function(){return this._prevPaintRect},e.prototype.animateStyle=function(t){return this.animate("style",t)},e.prototype.updateDuringAnimation=function(t){"style"===t?this.dirtyStyle():this.markRedraw()},e.prototype.attrKV=function(e,n){"style"!==e?t.prototype.attrKV.call(this,e,n):this.style?this.setStyle(n):this.useStyle(n)},e.prototype.setStyle=function(t,e){return"string"==typeof t?this.style[t]=e:D(this.style,t),this.dirtyStyle(),this},e.prototype.dirtyStyle=function(t){t||this.markRedraw(),this.__dirty|=2,this._rect&&(this._rect=null)},e.prototype.dirty=function(){this.dirtyStyle()},e.prototype.styleChanged=function(){return!!(2&this.__dirty)},e.prototype.styleUpdated=function(){this.__dirty&=-3},e.prototype.createStyle=function(t){return mt(Wa,t)},e.prototype.useStyle=function(t){t[Ha]||(t=this.createStyle(t)),this.__inHover?this.__hoverStyle=t:this.style=t,this.dirtyStyle()},e.prototype.isStyleObject=function(t){return t[Ha]},e.prototype._innerSaveToNormal=function(e){t.prototype._innerSaveToNormal.call(this,e);var n=this._normalState;e.style&&!n.style&&(n.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(e,n,Ua)},e.prototype._applyStateObj=function(e,n,i,r,o,a){t.prototype._applyStateObj.call(this,e,n,i,r,o,a);var s,l=!(n&&r);if(n&&n.style?o?r?s=n.style:(s=this._mergeStyle(this.createStyle(),i.style),this._mergeStyle(s,n.style)):(s=this._mergeStyle(this.createStyle(),r?this.style:i.style),this._mergeStyle(s,n.style)):l&&(s=i.style),s)if(o){var u=this.style;if(this.style=this.createStyle(l?{}:u),l)for(var h=H(u),c=0;c<h.length;c++){(d=h[c])in s&&(s[d]=s[d],this.style[d]=u[d])}var p=H(s);for(c=0;c<p.length;c++){var d=p[c];this.style[d]=this.style[d]}this._transitionState(e,{style:s},a,this.getAnimationStyleProps())}else this.useStyle(s);var f=this.__inHover?Za:Ua;for(c=0;c<f.length;c++){d=f[c];n&&null!=n[d]?this[d]=n[d]:l&&null!=i[d]&&(this[d]=i[d])}},e.prototype._mergeStates=function(e){for(var n,i=t.prototype._mergeStates.call(this,e),r=0;r<e.length;r++){var o=e[r];o.style&&(n=n||{},this._mergeStyle(n,o.style))}return n&&(i.style=n),i},e.prototype._mergeStyle=function(t,e){return D(t,e),t},e.prototype.getAnimationStyleProps=function(){return Ga},e.initDefaultProps=((i=e.prototype).type="displayable",i.invisible=!1,i.z=0,i.z2=0,i.zlevel=0,i.culling=!1,i.cursor="pointer",i.rectHover=!1,i.incremental=!1,i._rect=null,i.dirtyRectTolerance=0,void(i.__dirty=3)),e}(Gr),Xa=new Ve(0,0,0,0),ja=new Ve(0,0,0,0);var qa=Math.min,Ka=Math.max,$a=Math.sin,Qa=Math.cos,Ja=2*Math.PI,ts=Tt(),es=Tt(),ns=Tt();function is(t,e,n,i,r,o){r[0]=qa(t,n),r[1]=qa(e,i),o[0]=Ka(t,n),o[1]=Ka(e,i)}var rs=[],os=[];function as(t,e,n,i,r,o,a,s,l,u){var h=Cn,c=Mn,p=h(t,n,r,a,rs);l[0]=1/0,l[1]=1/0,u[0]=-1/0,u[1]=-1/0;for(var d=0;d<p;d++){var f=c(t,n,r,a,rs[d]);l[0]=qa(f,l[0]),u[0]=Ka(f,u[0])}p=h(e,i,o,s,os);for(d=0;d<p;d++){var g=c(e,i,o,s,os[d]);l[1]=qa(g,l[1]),u[1]=Ka(g,u[1])}l[0]=qa(t,l[0]),u[0]=Ka(t,u[0]),l[0]=qa(a,l[0]),u[0]=Ka(a,u[0]),l[1]=qa(e,l[1]),u[1]=Ka(e,u[1]),l[1]=qa(s,l[1]),u[1]=Ka(s,u[1])}function ss(t,e,n,i,r,o,a,s){var l=Ln,u=An,h=Ka(qa(l(t,n,r),1),0),c=Ka(qa(l(e,i,o),1),0),p=u(t,n,r,h),d=u(e,i,o,c);a[0]=qa(t,r,p),a[1]=qa(e,o,d),s[0]=Ka(t,r,p),s[1]=Ka(e,o,d)}function ls(t,e,n,i,r,o,a,s,l){var u=Ht,h=Wt,c=Math.abs(r-o);if(c%Ja<1e-4&&c>1e-4)return s[0]=t-n,s[1]=e-i,l[0]=t+n,void(l[1]=e+i);if(ts[0]=Qa(r)*n+t,ts[1]=$a(r)*i+e,es[0]=Qa(o)*n+t,es[1]=$a(o)*i+e,u(s,ts,es),h(l,ts,es),(r%=Ja)<0&&(r+=Ja),(o%=Ja)<0&&(o+=Ja),r>o&&!a?o+=Ja:r<o&&a&&(r+=Ja),a){var p=o;o=r,r=p}for(var d=0;d<o;d+=Math.PI/2)d>r&&(ns[0]=Qa(d)*n+t,ns[1]=$a(d)*i+e,u(s,ns,s),h(l,ns,l))}var us={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},hs=[],cs=[],ps=[],ds=[],fs=[],gs=[],vs=Math.min,ys=Math.max,ms=Math.cos,_s=Math.sin,xs=Math.abs,bs=Math.PI,ws=2*bs,Ss="undefined"!=typeof Float32Array,Ms=[];function Ts(t){return Math.round(t/bs*1e8)/1e8%2*bs}function ks(t,e){var n=Ts(t[0]);n<0&&(n+=ws);var i=n-t[0],r=t[1];r+=i,!e&&r-n>=ws?r=n+ws:e&&n-r>=ws?r=n-ws:!e&&n>r?r=n+(ws-Ts(n-r)):e&&n<r&&(r=n-(ws-Ts(r-n))),t[0]=n,t[1]=r}var Cs=function(){function t(t){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,t&&(this._saveData=!1),this._saveData&&(this.data=[])}var e;return t.prototype.increaseVersion=function(){this._version++},t.prototype.getVersion=function(){return this._version},t.prototype.setScale=function(t,e,n){(n=n||0)>0&&(this._ux=xs(n/cr/t)||0,this._uy=xs(n/cr/e)||0)},t.prototype.setDPR=function(t){this.dpr=t},t.prototype.setContext=function(t){this._ctx=t},t.prototype.getContext=function(){return this._ctx},t.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},t.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},t.prototype.moveTo=function(t,e){return this._drawPendingPt(),this.addData(us.M,t,e),this._ctx&&this._ctx.moveTo(t,e),this._x0=t,this._y0=e,this._xi=t,this._yi=e,this},t.prototype.lineTo=function(t,e){var n=xs(t-this._xi),i=xs(e-this._yi),r=n>this._ux||i>this._uy;if(this.addData(us.L,t,e),this._ctx&&r&&this._ctx.lineTo(t,e),r)this._xi=t,this._yi=e,this._pendingPtDist=0;else{var o=n*n+i*i;o>this._pendingPtDist&&(this._pendingPtX=t,this._pendingPtY=e,this._pendingPtDist=o)}return this},t.prototype.bezierCurveTo=function(t,e,n,i,r,o){return this._drawPendingPt(),this.addData(us.C,t,e,n,i,r,o),this._ctx&&this._ctx.bezierCurveTo(t,e,n,i,r,o),this._xi=r,this._yi=o,this},t.prototype.quadraticCurveTo=function(t,e,n,i){return this._drawPendingPt(),this.addData(us.Q,t,e,n,i),this._ctx&&this._ctx.quadraticCurveTo(t,e,n,i),this._xi=n,this._yi=i,this},t.prototype.arc=function(t,e,n,i,r,o){this._drawPendingPt(),Ms[0]=i,Ms[1]=r,ks(Ms,o),i=Ms[0];var a=(r=Ms[1])-i;return this.addData(us.A,t,e,n,n,i,a,0,o?0:1),this._ctx&&this._ctx.arc(t,e,n,i,r,o),this._xi=ms(r)*n+t,this._yi=_s(r)*n+e,this},t.prototype.arcTo=function(t,e,n,i,r){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(t,e,n,i,r),this},t.prototype.rect=function(t,e,n,i){return this._drawPendingPt(),this._ctx&&this._ctx.rect(t,e,n,i),this.addData(us.R,t,e,n,i),this},t.prototype.closePath=function(){this._drawPendingPt(),this.addData(us.Z);var t=this._ctx,e=this._x0,n=this._y0;return t&&t.closePath(),this._xi=e,this._yi=n,this},t.prototype.fill=function(t){t&&t.fill(),this.toStatic()},t.prototype.stroke=function(t){t&&t.stroke(),this.toStatic()},t.prototype.len=function(){return this._len},t.prototype.setData=function(t){if(this._saveData){var e=t.length;this.data&&this.data.length===e||!Ss||(this.data=new Float32Array(e));for(var n=0;n<e;n++)this.data[n]=t[n];this._len=e}},t.prototype.appendPath=function(t){if(this._saveData){t instanceof Array||(t=[t]);for(var e=t.length,n=0,i=this._len,r=0;r<e;r++)n+=t[r].len();var o=this.data;if(Ss&&(o instanceof Float32Array||!o)&&(this.data=new Float32Array(i+n),i>0&&o))for(var a=0;a<i;a++)this.data[a]=o[a];for(r=0;r<e;r++){var s=t[r].data;for(a=0;a<s.length;a++)this.data[i++]=s[a]}this._len=i}},t.prototype.addData=function(t,e,n,i,r,o,a,s,l){if(this._saveData){var u=this.data;this._len+arguments.length>u.length&&(this._expandData(),u=this.data);for(var h=0;h<arguments.length;h++)u[this._len++]=arguments[h]}},t.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},t.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this._len;e++)t[e]=this.data[e];this.data=t}},t.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var t=this.data;t instanceof Array&&(t.length=this._len,Ss&&this._len>11&&(this.data=new Float32Array(t)))}},t.prototype.getBoundingRect=function(){ps[0]=ps[1]=fs[0]=fs[1]=Number.MAX_VALUE,ds[0]=ds[1]=gs[0]=gs[1]=-Number.MAX_VALUE;var t,e=this.data,n=0,i=0,r=0,o=0;for(t=0;t<this._len;){var a=e[t++],s=1===t;switch(s&&(r=n=e[t],o=i=e[t+1]),a){case us.M:n=r=e[t++],i=o=e[t++],fs[0]=r,fs[1]=o,gs[0]=r,gs[1]=o;break;case us.L:is(n,i,e[t],e[t+1],fs,gs),n=e[t++],i=e[t++];break;case us.C:as(n,i,e[t++],e[t++],e[t++],e[t++],e[t],e[t+1],fs,gs),n=e[t++],i=e[t++];break;case us.Q:ss(n,i,e[t++],e[t++],e[t],e[t+1],fs,gs),n=e[t++],i=e[t++];break;case us.A:var l=e[t++],u=e[t++],h=e[t++],c=e[t++],p=e[t++],d=e[t++]+p;t+=1;var f=!e[t++];s&&(r=ms(p)*h+l,o=_s(p)*c+u),ls(l,u,h,c,p,d,f,fs,gs),n=ms(d)*h+l,i=_s(d)*c+u;break;case us.R:is(r=n=e[t++],o=i=e[t++],r+e[t++],o+e[t++],fs,gs);break;case us.Z:n=r,i=o}Ht(ps,ps,fs),Wt(ds,ds,gs)}return 0===t&&(ps[0]=ps[1]=ds[0]=ds[1]=0),new Ve(ps[0],ps[1],ds[0]-ps[0],ds[1]-ps[1])},t.prototype._calculateLength=function(){var t=this.data,e=this._len,n=this._ux,i=this._uy,r=0,o=0,a=0,s=0;this._pathSegLen||(this._pathSegLen=[]);for(var l=this._pathSegLen,u=0,h=0,c=0;c<e;){var p=t[c++],d=1===c;d&&(a=r=t[c],s=o=t[c+1]);var f=-1;switch(p){case us.M:r=a=t[c++],o=s=t[c++];break;case us.L:var g=t[c++],v=(_=t[c++])-o;(xs(D=g-r)>n||xs(v)>i||c===e-1)&&(f=Math.sqrt(D*D+v*v),r=g,o=_);break;case us.C:var y=t[c++],m=t[c++],_=(g=t[c++],t[c++]),x=t[c++],b=t[c++];f=Dn(r,o,y,m,g,_,x,b,10),r=x,o=b;break;case us.Q:f=Rn(r,o,y=t[c++],m=t[c++],g=t[c++],_=t[c++],10),r=g,o=_;break;case us.A:var w=t[c++],S=t[c++],M=t[c++],T=t[c++],k=t[c++],C=t[c++],I=C+k;c+=1,d&&(a=ms(k)*M+w,s=_s(k)*T+S),f=ys(M,T)*vs(ws,Math.abs(C)),r=ms(I)*M+w,o=_s(I)*T+S;break;case us.R:a=r=t[c++],s=o=t[c++],f=2*t[c++]+2*t[c++];break;case us.Z:var D=a-r;v=s-o;f=Math.sqrt(D*D+v*v),r=a,o=s}f>=0&&(l[h++]=f,u+=f)}return this._pathLen=u,u},t.prototype.rebuildPath=function(t,e){var n,i,r,o,a,s,l,u,h,c,p=this.data,d=this._ux,f=this._uy,g=this._len,v=e<1,y=0,m=0,_=0;if(!v||(this._pathSegLen||this._calculateLength(),l=this._pathSegLen,u=e*this._pathLen))t:for(var x=0;x<g;){var b=p[x++],w=1===x;switch(w&&(n=r=p[x],i=o=p[x+1]),b!==us.L&&_>0&&(t.lineTo(h,c),_=0),b){case us.M:n=r=p[x++],i=o=p[x++],t.moveTo(r,o);break;case us.L:a=p[x++],s=p[x++];var S=xs(a-r),M=xs(s-o);if(S>d||M>f){if(v){if(y+(j=l[m++])>u){var T=(u-y)/j;t.lineTo(r*(1-T)+a*T,o*(1-T)+s*T);break t}y+=j}t.lineTo(a,s),r=a,o=s,_=0}else{var k=S*S+M*M;k>_&&(h=a,c=s,_=k)}break;case us.C:var C=p[x++],I=p[x++],D=p[x++],A=p[x++],P=p[x++],L=p[x++];if(v){if(y+(j=l[m++])>u){In(r,C,D,P,T=(u-y)/j,hs),In(o,I,A,L,T,cs),t.bezierCurveTo(hs[1],cs[1],hs[2],cs[2],hs[3],cs[3]);break t}y+=j}t.bezierCurveTo(C,I,D,A,P,L),r=P,o=L;break;case us.Q:C=p[x++],I=p[x++],D=p[x++],A=p[x++];if(v){if(y+(j=l[m++])>u){On(r,C,D,T=(u-y)/j,hs),On(o,I,A,T,cs),t.quadraticCurveTo(hs[1],cs[1],hs[2],cs[2]);break t}y+=j}t.quadraticCurveTo(C,I,D,A),r=D,o=A;break;case us.A:var O=p[x++],R=p[x++],N=p[x++],B=p[x++],z=p[x++],E=p[x++],V=p[x++],F=!p[x++],H=N>B?N:B,W=xs(N-B)>.001,G=z+E,U=!1;if(v)y+(j=l[m++])>u&&(G=z+E*(u-y)/j,U=!0),y+=j;if(W&&t.ellipse?t.ellipse(O,R,N,B,V,z,G,F):t.arc(O,R,H,z,G,F),U)break t;w&&(n=ms(z)*N+O,i=_s(z)*B+R),r=ms(G)*N+O,o=_s(G)*B+R;break;case us.R:n=r=p[x],i=o=p[x+1],a=p[x++],s=p[x++];var Z=p[x++],Y=p[x++];if(v){if(y+(j=l[m++])>u){var X=u-y;t.moveTo(a,s),t.lineTo(a+vs(X,Z),s),(X-=Z)>0&&t.lineTo(a+Z,s+vs(X,Y)),(X-=Y)>0&&t.lineTo(a+ys(Z-X,0),s+Y),(X-=Z)>0&&t.lineTo(a,s+ys(Y-X,0));break t}y+=j}t.rect(a,s,Z,Y);break;case us.Z:if(v){var j;if(y+(j=l[m++])>u){T=(u-y)/j;t.lineTo(r*(1-T)+n*T,o*(1-T)+i*T);break t}y+=j}t.closePath(),r=n,o=i}}},t.prototype.clone=function(){var e=new t,n=this.data;return e.data=n.slice?n.slice():Array.prototype.slice.call(n),e._len=this._len,e},t.prototype.canSave=function(){return!!this._saveData},t.CMD=us,t.initDefaultProps=((e=t.prototype)._saveData=!0,e._ux=0,e._uy=0,e._pendingPtDist=0,void(e._version=0)),t}();function Is(t,e,n,i,r,o,a){if(0===r)return!1;var s=r,l=0;if(a>e+s&&a>i+s||a<e-s&&a<i-s||o>t+s&&o>n+s||o<t-s&&o<n-s)return!1;if(t===n)return Math.abs(o-t)<=s/2;var u=(l=(e-i)/(t-n))*o-a+(t*i-n*e)/(t-n);return u*u/(l*l+1)<=s/2*s/2}function Ds(t,e,n,i,r,o,a,s,l,u,h){if(0===l)return!1;var c=l;if(h>e+c&&h>i+c&&h>o+c&&h>s+c||h<e-c&&h<i-c&&h<o-c&&h<s-c||u>t+c&&u>n+c&&u>r+c&&u>a+c||u<t-c&&u<n-c&&u<r-c&&u<a-c)return!1;var p=function(t,e,n,i,r,o,a,s,l,u,h){var c,p,d,f,g,v=.005,y=1/0;_n[0]=l,_n[1]=u;for(var m=0;m<1;m+=.05)xn[0]=Mn(t,n,r,a,m),xn[1]=Mn(e,i,o,s,m),(f=Et(_n,xn))<y&&(c=m,y=f);y=1/0;for(var _=0;_<32&&!(v<vn);_++)p=c-v,d=c+v,xn[0]=Mn(t,n,r,a,p),xn[1]=Mn(e,i,o,s,p),f=Et(xn,_n),p>=0&&f<y?(c=p,y=f):(bn[0]=Mn(t,n,r,a,d),bn[1]=Mn(e,i,o,s,d),g=Et(bn,_n),d<=1&&g<y?(c=d,y=g):v*=.5);return h&&(h[0]=Mn(t,n,r,a,c),h[1]=Mn(e,i,o,s,c)),fn(y)}(t,e,n,i,r,o,a,s,u,h,null);return p<=c/2}function As(t,e,n,i,r,o,a,s,l){if(0===a)return!1;var u=a;if(l>e+u&&l>i+u&&l>o+u||l<e-u&&l<i-u&&l<o-u||s>t+u&&s>n+u&&s>r+u||s<t-u&&s<n-u&&s<r-u)return!1;var h=function(t,e,n,i,r,o,a,s,l){var u,h=.005,c=1/0;_n[0]=a,_n[1]=s;for(var p=0;p<1;p+=.05)xn[0]=An(t,n,r,p),xn[1]=An(e,i,o,p),(v=Et(_n,xn))<c&&(u=p,c=v);c=1/0;for(var d=0;d<32&&!(h<vn);d++){var f=u-h,g=u+h;xn[0]=An(t,n,r,f),xn[1]=An(e,i,o,f);var v=Et(xn,_n);if(f>=0&&v<c)u=f,c=v;else{bn[0]=An(t,n,r,g),bn[1]=An(e,i,o,g);var y=Et(bn,_n);g<=1&&y<c?(u=g,c=y):h*=.5}}return l&&(l[0]=An(t,n,r,u),l[1]=An(e,i,o,u)),fn(c)}(t,e,n,i,r,o,s,l,null);return h<=u/2}var Ps=2*Math.PI;function Ls(t){return(t%=Ps)<0&&(t+=Ps),t}var Os=2*Math.PI;function Rs(t,e,n,i,r,o,a,s,l){if(0===a)return!1;var u=a;s-=t,l-=e;var h=Math.sqrt(s*s+l*l);if(h-u>n||h+u<n)return!1;if(Math.abs(i-r)%Os<1e-4)return!0;if(o){var c=i;i=Ls(r),r=Ls(c)}else i=Ls(i),r=Ls(r);i>r&&(r+=Os);var p=Math.atan2(l,s);return p<0&&(p+=Os),p>=i&&p<=r||p+Os>=i&&p+Os<=r}function Ns(t,e,n,i,r,o){if(o>e&&o>i||o<e&&o<i)return 0;if(i===e)return 0;var a=(o-e)/(i-e),s=i<e?1:-1;1!==a&&0!==a||(s=i<e?.5:-.5);var l=a*(n-t)+t;return l===r?1/0:l>r?s:0}var Bs=Cs.CMD,zs=2*Math.PI;var Es=[-1,-1,-1],Vs=[-1,-1];function Fs(t,e,n,i,r,o,a,s,l,u){if(u>e&&u>i&&u>o&&u>s||u<e&&u<i&&u<o&&u<s)return 0;var h,c=kn(e,i,o,s,u,Es);if(0===c)return 0;for(var p=0,d=-1,f=void 0,g=void 0,v=0;v<c;v++){var y=Es[v],m=0===y||1===y?.5:1;Mn(t,n,r,a,y)<l||(d<0&&(d=Cn(e,i,o,s,Vs),Vs[1]<Vs[0]&&d>1&&(h=void 0,h=Vs[0],Vs[0]=Vs[1],Vs[1]=h),f=Mn(e,i,o,s,Vs[0]),d>1&&(g=Mn(e,i,o,s,Vs[1]))),2===d?y<Vs[0]?p+=f<e?m:-m:y<Vs[1]?p+=g<f?m:-m:p+=s<g?m:-m:y<Vs[0]?p+=f<e?m:-m:p+=s<f?m:-m)}return p}function Hs(t,e,n,i,r,o,a,s){if(s>e&&s>i&&s>o||s<e&&s<i&&s<o)return 0;var l=function(t,e,n,i,r){var o=t-2*e+n,a=2*(e-t),s=t-i,l=0;if(wn(o))Sn(a)&&(h=-s/a)>=0&&h<=1&&(r[l++]=h);else{var u=a*a-4*o*s;if(wn(u))(h=-a/(2*o))>=0&&h<=1&&(r[l++]=h);else if(u>0){var h,c=fn(u),p=(-a-c)/(2*o);(h=(-a+c)/(2*o))>=0&&h<=1&&(r[l++]=h),p>=0&&p<=1&&(r[l++]=p)}}return l}(e,i,o,s,Es);if(0===l)return 0;var u=Ln(e,i,o);if(u>=0&&u<=1){for(var h=0,c=An(e,i,o,u),p=0;p<l;p++){var d=0===Es[p]||1===Es[p]?.5:1;An(t,n,r,Es[p])<a||(Es[p]<u?h+=c<e?d:-d:h+=o<c?d:-d)}return h}d=0===Es[0]||1===Es[0]?.5:1;return An(t,n,r,Es[0])<a?0:o<e?d:-d}function Ws(t,e,n,i,r,o,a,s){if((s-=e)>n||s<-n)return 0;var l=Math.sqrt(n*n-s*s);Es[0]=-l,Es[1]=l;var u=Math.abs(i-r);if(u<1e-4)return 0;if(u>=zs-1e-4){i=0,r=zs;var h=o?1:-1;return a>=Es[0]+t&&a<=Es[1]+t?h:0}if(i>r){var c=i;i=r,r=c}i<0&&(i+=zs,r+=zs);for(var p=0,d=0;d<2;d++){var f=Es[d];if(f+t>a){var g=Math.atan2(s,f);h=o?1:-1;g<0&&(g=zs+g),(g>=i&&g<=r||g+zs>=i&&g+zs<=r)&&(g>Math.PI/2&&g<1.5*Math.PI&&(h=-h),p+=h)}}return p}function Gs(t,e,n,i,r){for(var o,a,s,l,u=t.data,h=t.len(),c=0,p=0,d=0,f=0,g=0,v=0;v<h;){var y=u[v++],m=1===v;switch(y===Bs.M&&v>1&&(n||(c+=Ns(p,d,f,g,i,r))),m&&(f=p=u[v],g=d=u[v+1]),y){case Bs.M:p=f=u[v++],d=g=u[v++];break;case Bs.L:if(n){if(Is(p,d,u[v],u[v+1],e,i,r))return!0}else c+=Ns(p,d,u[v],u[v+1],i,r)||0;p=u[v++],d=u[v++];break;case Bs.C:if(n){if(Ds(p,d,u[v++],u[v++],u[v++],u[v++],u[v],u[v+1],e,i,r))return!0}else c+=Fs(p,d,u[v++],u[v++],u[v++],u[v++],u[v],u[v+1],i,r)||0;p=u[v++],d=u[v++];break;case Bs.Q:if(n){if(As(p,d,u[v++],u[v++],u[v],u[v+1],e,i,r))return!0}else c+=Hs(p,d,u[v++],u[v++],u[v],u[v+1],i,r)||0;p=u[v++],d=u[v++];break;case Bs.A:var _=u[v++],x=u[v++],b=u[v++],w=u[v++],S=u[v++],M=u[v++];v+=1;var T=!!(1-u[v++]);o=Math.cos(S)*b+_,a=Math.sin(S)*w+x,m?(f=o,g=a):c+=Ns(p,d,o,a,i,r);var k=(i-_)*w/b+_;if(n){if(Rs(_,x,w,S,S+M,T,e,k,r))return!0}else c+=Ws(_,x,w,S,S+M,T,k,r);p=Math.cos(S+M)*b+_,d=Math.sin(S+M)*w+x;break;case Bs.R:if(f=p=u[v++],g=d=u[v++],o=f+u[v++],a=g+u[v++],n){if(Is(f,g,o,g,e,i,r)||Is(o,g,o,a,e,i,r)||Is(o,a,f,a,e,i,r)||Is(f,a,f,g,e,i,r))return!0}else c+=Ns(o,g,o,a,i,r),c+=Ns(f,a,f,g,i,r);break;case Bs.Z:if(n){if(Is(p,d,f,g,e,i,r))return!0}else c+=Ns(p,d,f,g,i,r);p=f,d=g}}return n||(s=d,l=g,Math.abs(s-l)<1e-4)||(c+=Ns(p,d,f,g,i,r)||0),0!==c}var Us=A({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},Wa),Zs={style:A({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},Ga.style)},Ys=Sr.concat(["invisible","culling","z","z2","zlevel","parent"]),Xs=function(t){function e(e){return t.call(this,e)||this}var i;return n(e,t),e.prototype.update=function(){var n=this;t.prototype.update.call(this);var i=this.style;if(i.decal){var r=this._decalEl=this._decalEl||new e;r.buildPath===e.prototype.buildPath&&(r.buildPath=function(t){n.buildPath(t,n.shape)}),r.silent=!0;var o=r.style;for(var a in i)o[a]!==i[a]&&(o[a]=i[a]);o.fill=i.fill?i.decal:null,o.decal=null,o.shadowColor=null,i.strokeFirst&&(o.stroke=null);for(var s=0;s<Ys.length;++s)r[Ys[s]]=this[Ys[s]];r.__dirty|=1}else this._decalEl&&(this._decalEl=null)},e.prototype.getDecalElement=function(){return this._decalEl},e.prototype._init=function(e){var n=H(e);this.shape=this.getDefaultShape();var i=this.getDefaultStyle();i&&this.useStyle(i);for(var r=0;r<n.length;r++){var o=n[r],a=e[o];"style"===o?this.style?D(this.style,a):this.useStyle(a):"shape"===o?D(this.shape,a):t.prototype.attrKV.call(this,o,a)}this.style||this.useStyle({})},e.prototype.getDefaultStyle=function(){return null},e.prototype.getDefaultShape=function(){return{}},e.prototype.canBeInsideText=function(){return this.hasFill()},e.prototype.getInsideTextFill=function(){var t=this.style.fill;if("none"!==t){if(Y(t)){var e=ui(t,0);return e>.5?pr:e>.2?"#eee":dr}if(t)return dr}return pr},e.prototype.getInsideTextStroke=function(t){var e=this.style.fill;if(Y(e)){var n=this.__zr;if(!(!n||!n.isDarkMode())===ui(t,0)<.4)return e}},e.prototype.buildPath=function(t,e,n){},e.prototype.pathUpdated=function(){this.__dirty&=-5},e.prototype.getUpdatedPathProxy=function(t){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,t),this.path},e.prototype.createPathProxy=function(){this.path=new Cs(!1)},e.prototype.hasStroke=function(){var t=this.style,e=t.stroke;return!(null==e||"none"===e||!(t.lineWidth>0))},e.prototype.hasFill=function(){var t=this.style.fill;return null!=t&&"none"!==t},e.prototype.getBoundingRect=function(){var t=this._rect,e=this.style,n=!t;if(n){var i=!1;this.path||(i=!0,this.createPathProxy());var r=this.path;(i||4&this.__dirty)&&(r.beginPath(),this.buildPath(r,this.shape,!1),this.pathUpdated()),t=r.getBoundingRect()}if(this._rect=t,this.hasStroke()&&this.path&&this.path.len()>0){var o=this._rectStroke||(this._rectStroke=t.clone());if(this.__dirty||n){o.copy(t);var a=e.strokeNoScale?this.getLineScale():1,s=e.lineWidth;if(!this.hasFill()){var l=this.strokeContainThreshold;s=Math.max(s,null==l?4:l)}a>1e-10&&(o.width+=s/a,o.height+=s/a,o.x-=s/a/2,o.y-=s/a/2)}return o}return t},e.prototype.contain=function(t,e){var n=this.transformCoordToLocal(t,e),i=this.getBoundingRect(),r=this.style;if(t=n[0],e=n[1],i.contain(t,e)){var o=this.path;if(this.hasStroke()){var a=r.lineWidth,s=r.strokeNoScale?this.getLineScale():1;if(s>1e-10&&(this.hasFill()||(a=Math.max(a,this.strokeContainThreshold)),function(t,e,n,i){return Gs(t,e,!0,n,i)}(o,a/s,t,e)))return!0}if(this.hasFill())return function(t,e,n){return Gs(t,0,!1,e,n)}(o,t,e)}return!1},e.prototype.dirtyShape=function(){this.__dirty|=4,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},e.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},e.prototype.animateShape=function(t){return this.animate("shape",t)},e.prototype.updateDuringAnimation=function(t){"style"===t?this.dirtyStyle():"shape"===t?this.dirtyShape():this.markRedraw()},e.prototype.attrKV=function(e,n){"shape"===e?this.setShape(n):t.prototype.attrKV.call(this,e,n)},e.prototype.setShape=function(t,e){var n=this.shape;return n||(n=this.shape={}),"string"==typeof t?n[t]=e:D(n,t),this.dirtyShape(),this},e.prototype.shapeChanged=function(){return!!(4&this.__dirty)},e.prototype.createStyle=function(t){return mt(Us,t)},e.prototype._innerSaveToNormal=function(e){t.prototype._innerSaveToNormal.call(this,e);var n=this._normalState;e.shape&&!n.shape&&(n.shape=D({},this.shape))},e.prototype._applyStateObj=function(e,n,i,r,o,a){t.prototype._applyStateObj.call(this,e,n,i,r,o,a);var s,l=!(n&&r);if(n&&n.shape?o?r?s=n.shape:(s=D({},i.shape),D(s,n.shape)):(s=D({},r?this.shape:i.shape),D(s,n.shape)):l&&(s=i.shape),s)if(o){this.shape=D({},this.shape);for(var u={},h=H(s),c=0;c<h.length;c++){var p=h[c];"object"==typeof s[p]?this.shape[p]=s[p]:u[p]=s[p]}this._transitionState(e,{shape:u},a)}else this.shape=s,this.dirtyShape()},e.prototype._mergeStates=function(e){for(var n,i=t.prototype._mergeStates.call(this,e),r=0;r<e.length;r++){var o=e[r];o.shape&&(n=n||{},this._mergeStyle(n,o.shape))}return n&&(i.shape=n),i},e.prototype.getAnimationStyleProps=function(){return Zs},e.prototype.isZeroArea=function(){return!1},e.extend=function(t){var i=function(e){function i(n){var i=e.call(this,n)||this;return t.init&&t.init.call(i,n),i}return n(i,e),i.prototype.getDefaultStyle=function(){return k(t.style)},i.prototype.getDefaultShape=function(){return k(t.shape)},i}(e);for(var r in t)"function"==typeof t[r]&&(i.prototype[r]=t[r]);return i},e.initDefaultProps=((i=e.prototype).type="path",i.strokeContainThreshold=5,i.segmentIgnoreThreshold=0,i.subPixelOptimize=!1,i.autoBatch=!1,void(i.__dirty=7)),e}(Ya),js=A({strokeFirst:!0,font:a,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},Us),qs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.hasStroke=function(){return Fa(this.style)},e.prototype.hasFill=function(){var t=this.style.fill;return null!=t&&"none"!==t},e.prototype.createStyle=function(t){return mt(js,t)},e.prototype.setBoundingRect=function(t){this._rect=t},e.prototype.getBoundingRect=function(){var t,e,n;return this._rect||(this._rect=(t=this.style,e=Ea(t.text),n=t.font,Va(t,Dr(Tr(n),e),Rr(n),null))),this._rect},e.initDefaultProps=void(e.prototype.dirtyRectTolerance=10),e}(Ya);qs.prototype.type="tspan";var Ks=A({x:0,y:0},Wa),$s={style:A({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},Ga.style)};var Qs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.createStyle=function(t){return mt(Ks,t)},e.prototype._getSize=function(t){var e=this.style,n=e[t];if(null!=n)return n;var i,r=(i=e.image)&&"string"!=typeof i&&i.width&&i.height?e.image:this.__image;if(!r)return 0;var o="width"===t?"height":"width",a=e[o];return null==a?r[t]:r[t]/r[o]*a},e.prototype.getWidth=function(){return this._getSize("width")},e.prototype.getHeight=function(){return this._getSize("height")},e.prototype.getAnimationStyleProps=function(){return $s},e.prototype.getBoundingRect=function(){var t=this.style;return this._rect||(this._rect=new Ve(t.x||0,t.y||0,this.getWidth(),this.getHeight())),this._rect},e}(Ya);Qs.prototype.type="image";var Js=Math.round;function tl(t,e,n){if(e){var i=e.x1,r=e.x2,o=e.y1,a=e.y2;t.x1=i,t.x2=r,t.y1=o,t.y2=a;var s=n&&n.lineWidth;return s?(Js(2*i)===Js(2*r)&&(t.x1=t.x2=nl(i,s,!0)),Js(2*o)===Js(2*a)&&(t.y1=t.y2=nl(o,s,!0)),t):t}}function el(t,e,n){if(e){var i=e.x,r=e.y,o=e.width,a=e.height;t.x=i,t.y=r,t.width=o,t.height=a;var s=n&&n.lineWidth;return s?(t.x=nl(i,s,!0),t.y=nl(r,s,!0),t.width=Math.max(nl(i+o,s,!1)-t.x,0===o?0:1),t.height=Math.max(nl(r+a,s,!1)-t.y,0===a?0:1),t):t}}function nl(t,e,n){if(!e)return t;var i=Js(2*t);return(i+Js(e))%2==0?i/2:(i+(n?1:-1))/2}var il=function(){this.x=0,this.y=0,this.width=0,this.height=0},rl={},ol=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultShape=function(){return new il},e.prototype.buildPath=function(t,e){var n,i,r,o;if(this.subPixelOptimize){var a=el(rl,e,this.style);n=a.x,i=a.y,r=a.width,o=a.height,a.r=e.r,e=a}else n=e.x,i=e.y,r=e.width,o=e.height;e.r?function(t,e){var n,i,r,o,a,s=e.x,l=e.y,u=e.width,h=e.height,c=e.r;u<0&&(s+=u,u=-u),h<0&&(l+=h,h=-h),"number"==typeof c?n=i=r=o=c:c instanceof Array?1===c.length?n=i=r=o=c[0]:2===c.length?(n=r=c[0],i=o=c[1]):3===c.length?(n=c[0],i=o=c[1],r=c[2]):(n=c[0],i=c[1],r=c[2],o=c[3]):n=i=r=o=0,n+i>u&&(n*=u/(a=n+i),i*=u/a),r+o>u&&(r*=u/(a=r+o),o*=u/a),i+r>h&&(i*=h/(a=i+r),r*=h/a),n+o>h&&(n*=h/(a=n+o),o*=h/a),t.moveTo(s+n,l),t.lineTo(s+u-i,l),0!==i&&t.arc(s+u-i,l+i,i,-Math.PI/2,0),t.lineTo(s+u,l+h-r),0!==r&&t.arc(s+u-r,l+h-r,r,0,Math.PI/2),t.lineTo(s+o,l+h),0!==o&&t.arc(s+o,l+h-o,o,Math.PI/2,Math.PI),t.lineTo(s,l+n),0!==n&&t.arc(s+n,l+n,n,Math.PI,1.5*Math.PI)}(t,e):t.rect(n,i,r,o)},e.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},e}(Xs);ol.prototype.type="rect";var al={fill:"#000"},sl={},ll={style:A({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},Ga.style)},ul=function(t){function e(e){var n=t.call(this)||this;return n.type="text",n._children=[],n._defaultStyle=al,n.attr(e),n}return n(e,t),e.prototype.childrenRef=function(){return this._children},e.prototype.update=function(){t.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var e=0;e<this._children.length;e++){var n=this._children[e];n.zlevel=this.zlevel,n.z=this.z,n.z2=this.z2,n.culling=this.culling,n.cursor=this.cursor,n.invisible=this.invisible}},e.prototype.updateTransform=function(){var e=this.innerTransformable;e?(e.updateTransform(),e.transform&&(this.transform=e.transform)):t.prototype.updateTransform.call(this)},e.prototype.getLocalTransform=function(e){var n=this.innerTransformable;return n?n.getLocalTransform(e):t.prototype.getLocalTransform.call(this,e)},e.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),t.prototype.getComputedTransform.call(this)},e.prototype._updateSubTexts=function(){var t;this._childCursor=0,vl(t=this.style),B(t.rich,vl),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},e.prototype.addSelfToZr=function(e){t.prototype.addSelfToZr.call(this,e);for(var n=0;n<this._children.length;n++)this._children[n].__zr=e},e.prototype.removeSelfFromZr=function(e){t.prototype.removeSelfFromZr.call(this,e);for(var n=0;n<this._children.length;n++)this._children[n].__zr=null},e.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var t=new Ve(0,0,0,0),e=this._children,n=[],i=null,r=0;r<e.length;r++){var o=e[r],a=o.getBoundingRect(),s=o.getLocalTransform(n);s?(t.copy(a),t.applyTransform(s),(i=i||t.clone()).union(t)):(i=i||a.clone()).union(a)}this._rect=i||t}return this._rect},e.prototype.setDefaultTextStyle=function(t){this._defaultStyle=t||al},e.prototype.setTextContent=function(t){0},e.prototype._mergeStyle=function(t,e){if(!e)return t;var n=e.rich,i=t.rich||n&&{};return D(t,e),n&&i?(this._mergeRich(i,n),t.rich=i):i&&(t.rich=i),t},e.prototype._mergeRich=function(t,e){for(var n=H(e),i=0;i<n.length;i++){var r=n[i];t[r]=t[r]||{},D(t[r],e[r])}},e.prototype.getAnimationStyleProps=function(){return ll},e.prototype._getOrCreateChild=function(t){var e=this._children[this._childCursor];return e&&e instanceof t||(e=new t),this._children[this._childCursor++]=e,e.__zr=this.__zr,e.parent=this,e},e.prototype._updatePlainTexts=function(){var t=this.style,e=t.font||a,n=t.padding,i=this._defaultStyle,r=t.x||0,o=t.y||0,s=t.align||i.align||"left",l=t.verticalAlign||i.verticalAlign||"top";Na(sl,i.overflowRect,r,o,s,l),r=sl.baseX,o=sl.baseY;var u=function(t,e,n,i){var r=Ea(t),o=e.overflow,a=e.padding,s=a?a[1]+a[3]:0,l=a?a[0]+a[2]:0,u=e.font,h="truncate"===o,c=Rr(u),p=rt(e.lineHeight,c),d="truncate"===e.lineOverflow,f=!1,g=e.width;null==g&&null!=n&&(g=n-s);var v,y=e.height;null==y&&null!=i&&(y=i-l);var m=(v=null==g||"break"!==o&&"breakAll"!==o?r?r.split("\n"):[]:r?Ra(r,e.font,g,"breakAll"===o,0).lines:[]).length*p;if(null==y&&(y=m),m>y&&d){var _=Math.floor(y/p);f=f||v.length>_,m=(v=v.slice(0,_)).length*p}if(r&&h&&null!=g)for(var x=Ta(g,u,e.ellipsis,{minChar:e.truncateMinChar,placeholder:e.placeholder}),b={},w=0;w<v.length;w++)ka(b,v[w],x),v[w]=b.textLine,f=f||b.isTruncated;var S=y,M=0,T=Tr(u);for(w=0;w<v.length;w++)M=Math.max(Dr(T,v[w]),M);null==g&&(g=M);var k=g;return{lines:v,height:y,outerWidth:k+=s,outerHeight:S+=l,lineHeight:p,calculatedLineHeight:c,contentWidth:M,contentHeight:m,width:g,isTruncated:f}}(xl(t),t,sl.outerWidth,sl.outerHeight),h=bl(t),c=!!t.backgroundColor,p=u.outerHeight,d=u.outerWidth,f=u.lines,g=u.lineHeight;this.isTruncated=!!u.isTruncated;var v=r,y=Or(o,u.contentHeight,l);if(h||n){var m=Lr(r,d,s),_=Or(o,p,l);h&&this._renderBackground(t,t,m,_,d,p)}y+=g/2,n&&(v=_l(r,s,n),"top"===l?y+=n[0]:"bottom"===l&&(y-=n[2]));for(var x=0,b=!1,w=!1,S=(ml("fill"in t?t.fill:(w=!0,i.fill))),M=(yl("stroke"in t?t.stroke:c||i.autoStroke&&!w?null:(x=2,b=!0,i.stroke))),T=t.textShadowBlur>0,k=0;k<f.length;k++){var C=this._getOrCreateChild(qs),I=C.createStyle();C.useStyle(I),I.text=f[k],I.x=v,I.y=y,s&&(I.textAlign=s),I.textBaseline="middle",I.opacity=t.opacity,I.strokeFirst=!0,T&&(I.shadowBlur=t.textShadowBlur||0,I.shadowColor=t.textShadowColor||"transparent",I.shadowOffsetX=t.textShadowOffsetX||0,I.shadowOffsetY=t.textShadowOffsetY||0),I.stroke=M,I.fill=S,M&&(I.lineWidth=t.lineWidth||x,I.lineDash=t.lineDash,I.lineDashOffset=t.lineDashOffset||0),I.font=e,fl(I,t),y+=g,C.setBoundingRect(Va(I,u.contentWidth,u.calculatedLineHeight,b?0:null))}},e.prototype._updateRichTexts=function(){var t=this.style,e=this._defaultStyle,n=t.align||e.align,i=t.verticalAlign||e.verticalAlign,r=t.x||0,o=t.y||0;Na(sl,e.overflowRect,r,o,n,i),r=sl.baseX,o=sl.baseY;var a=function(t,e,n,i,r){var o=new Aa,a=Ea(t);if(!a)return o;var s=e.padding,l=s?s[1]+s[3]:0,u=s?s[0]+s[2]:0,h=e.width;null==h&&null!=n&&(h=n-l);var c=e.height;null==c&&null!=i&&(c=i-u);for(var p,d=e.overflow,f="break"!==d&&"breakAll"!==d||null==h?null:{width:h,accumWidth:0,breakAll:"breakAll"===d},g=Sa.lastIndex=0;null!=(p=Sa.exec(a));){var v=p.index;v>g&&Pa(o,a.substring(g,v),e,f),Pa(o,p[2],e,f,p[1]),g=Sa.lastIndex}g<a.length&&Pa(o,a.substring(g,a.length),e,f);var y=[],m=0,_=0,x="truncate"===d,b="truncate"===e.lineOverflow,w={};function S(t,e,n){t.width=e,t.lineHeight=n,m+=n,_=Math.max(_,e)}t:for(var M=0;M<o.lines.length;M++){for(var T=o.lines[M],k=0,C=0,I=0;I<T.tokens.length;I++){var D=(F=T.tokens[I]).styleName&&e.rich[F.styleName]||{},A=F.textPadding=D.padding,P=A?A[1]+A[3]:0,L=F.font=D.font||e.font;F.contentHeight=Rr(L);var O=rt(D.height,F.contentHeight);if(F.innerHeight=O,A&&(O+=A[0]+A[2]),F.height=O,F.lineHeight=ot(D.lineHeight,e.lineHeight,O),F.align=D&&D.align||r,F.verticalAlign=D&&D.verticalAlign||"middle",b&&null!=c&&m+F.lineHeight>c){var R=o.lines.length;I>0?(T.tokens=T.tokens.slice(0,I),S(T,C,k),o.lines=o.lines.slice(0,M+1)):o.lines=o.lines.slice(0,M),o.isTruncated=o.isTruncated||o.lines.length<R;break t}var N=D.width,B=null==N||"auto"===N;if("string"==typeof N&&"%"===N.charAt(N.length-1))F.percentWidth=N,y.push(F),F.contentWidth=Dr(Tr(L),F.text);else{if(B){var z=D.backgroundColor,E=z&&z.image;E&&wa(E=_a(E))&&(F.width=Math.max(F.width,E.width*O/E.height))}var V=x&&null!=h?h-C:null;null!=V&&V<F.width?!B||V<P?(F.text="",F.width=F.contentWidth=0):(Ma(w,F.text,V-P,L,e.ellipsis,{minChar:e.truncateMinChar}),F.text=w.text,o.isTruncated=o.isTruncated||w.isTruncated,F.width=F.contentWidth=Dr(Tr(L),F.text)):F.contentWidth=Dr(Tr(L),F.text)}F.width+=P,C+=F.width,D&&(k=Math.max(k,F.lineHeight))}S(T,C,k)}for(o.outerWidth=o.width=rt(h,_),o.outerHeight=o.height=rt(c,m),o.contentHeight=m,o.contentWidth=_,o.outerWidth+=l,o.outerHeight+=u,M=0;M<y.length;M++){var F,H=(F=y[M]).percentWidth;F.width=parseInt(H,10)/100*o.width}return o}(xl(t),t,sl.outerWidth,sl.outerHeight,n),s=a.width,l=a.outerWidth,u=a.outerHeight,h=t.padding;this.isTruncated=!!a.isTruncated;var c=Lr(r,l,n),p=Or(o,u,i),d=c,f=p;h&&(d+=h[3],f+=h[0]);var g=d+s;bl(t)&&this._renderBackground(t,t,c,p,l,u);for(var v=!!t.backgroundColor,y=0;y<a.lines.length;y++){for(var m=a.lines[y],_=m.tokens,x=_.length,b=m.lineHeight,w=m.width,S=0,M=d,T=g,k=x-1,C=void 0;S<x&&(!(C=_[S]).align||"left"===C.align);)this._placeToken(C,t,b,f,M,"left",v),w-=C.width,M+=C.width,S++;for(;k>=0&&"right"===(C=_[k]).align;)this._placeToken(C,t,b,f,T,"right",v),w-=C.width,T-=C.width,k--;for(M+=(s-(M-d)-(g-T)-w)/2;S<=k;)C=_[S],this._placeToken(C,t,b,f,M+C.width/2,"center",v),M+=C.width,S++;f+=b}},e.prototype._placeToken=function(t,e,n,i,r,o,s){var l=e.rich[t.styleName]||{};l.text=t.text;var u=t.verticalAlign,h=i+n/2;"top"===u?h=i+t.height/2:"bottom"===u&&(h=i+n-t.height/2),!t.isLineHolder&&bl(l)&&this._renderBackground(l,e,"right"===o?r-t.width:"center"===o?r-t.width/2:r,h-t.height/2,t.width,t.height);var c=!!l.backgroundColor,p=t.textPadding;p&&(r=_l(r,o,p),h-=t.height/2-p[0]-t.innerHeight/2);var d=this._getOrCreateChild(qs),f=d.createStyle();d.useStyle(f);var g=this._defaultStyle,v=!1,y=0,m=!1,_=ml("fill"in l?l.fill:"fill"in e?e.fill:(v=!0,g.fill)),x=yl("stroke"in l?l.stroke:"stroke"in e?e.stroke:c||s||g.autoStroke&&!v?null:(y=2,m=!0,g.stroke)),b=l.textShadowBlur>0||e.textShadowBlur>0;f.text=t.text,f.x=r,f.y=h,b&&(f.shadowBlur=l.textShadowBlur||e.textShadowBlur||0,f.shadowColor=l.textShadowColor||e.textShadowColor||"transparent",f.shadowOffsetX=l.textShadowOffsetX||e.textShadowOffsetX||0,f.shadowOffsetY=l.textShadowOffsetY||e.textShadowOffsetY||0),f.textAlign=o,f.textBaseline="middle",f.font=t.font||a,f.opacity=ot(l.opacity,e.opacity,1),fl(f,l),x&&(f.lineWidth=ot(l.lineWidth,e.lineWidth,y),f.lineDash=rt(l.lineDash,e.lineDash),f.lineDashOffset=e.lineDashOffset||0,f.stroke=x),_&&(f.fill=_),d.setBoundingRect(Va(f,t.contentWidth,t.contentHeight,m?0:null))},e.prototype._renderBackground=function(t,e,n,i,r,o){var a,s,l,u=t.backgroundColor,h=t.borderWidth,c=t.borderColor,p=u&&u.image,d=u&&!p,f=t.borderRadius,g=this;if(d||t.lineHeight||h&&c){(a=this._getOrCreateChild(ol)).useStyle(a.createStyle()),a.style.fill=null;var v=a.shape;v.x=n,v.y=i,v.width=r,v.height=o,v.r=f,a.dirtyShape()}if(d)(l=a.style).fill=u||null,l.fillOpacity=rt(t.fillOpacity,1);else if(p){(s=this._getOrCreateChild(Qs)).onload=function(){g.dirtyStyle()};var y=s.style;y.image=u.image,y.x=n,y.y=i,y.width=r,y.height=o}h&&c&&((l=a.style).lineWidth=h,l.stroke=c,l.strokeOpacity=rt(t.strokeOpacity,1),l.lineDash=t.borderDash,l.lineDashOffset=t.borderDashOffset||0,a.strokeContainThreshold=0,a.hasFill()&&a.hasStroke()&&(l.strokeFirst=!0,l.lineWidth*=2));var m=(a||s).style;m.shadowBlur=t.shadowBlur||0,m.shadowColor=t.shadowColor||"transparent",m.shadowOffsetX=t.shadowOffsetX||0,m.shadowOffsetY=t.shadowOffsetY||0,m.opacity=ot(t.opacity,e.opacity,1)},e.makeFont=function(t){var e="";return gl(t)&&(e=[t.fontStyle,t.fontWeight,dl(t.fontSize),t.fontFamily||"sans-serif"].join(" ")),e&&ut(e)||t.textFont||t.font},e}(Ya),hl={left:!0,right:1,center:1},cl={top:1,bottom:1,middle:1},pl=["fontStyle","fontWeight","fontSize","fontFamily"];function dl(t){return"string"!=typeof t||-1===t.indexOf("px")&&-1===t.indexOf("rem")&&-1===t.indexOf("em")?isNaN(+t)?"12px":t+"px":t}function fl(t,e){for(var n=0;n<pl.length;n++){var i=pl[n],r=e[i];null!=r&&(t[i]=r)}}function gl(t){return null!=t.fontSize||t.fontFamily||t.fontWeight}function vl(t){if(t){t.font=ul.makeFont(t);var e=t.align;"middle"===e&&(e="center"),t.align=null==e||hl[e]?e:"left";var n=t.verticalAlign;"center"===n&&(n="middle"),t.verticalAlign=null==n||cl[n]?n:"top",t.padding&&(t.padding=st(t.padding))}}function yl(t,e){return null==t||e<=0||"transparent"===t||"none"===t?null:t.image||t.colorStops?"#000":t}function ml(t){return null==t||"none"===t?null:t.image||t.colorStops?"#000":t}function _l(t,e,n){return"right"===e?t-n[1]:"center"===e?t+n[3]/2-n[1]/2:t+n[3]}function xl(t){var e=t.text;return null!=e&&(e+=""),e}function bl(t){return!!(t.backgroundColor||t.lineHeight||t.borderWidth&&t.borderColor)}var wl=Qo(),Sl=1,Ml={},Tl=Qo(),kl=Qo(),Cl=["emphasis","blur","select"],Il=["normal","emphasis","blur","select"],Dl="highlight",Al="downplay",Pl="select",Ll="unselect",Ol="toggleSelect",Rl="selectchanged";function Nl(t){return null!=t&&"none"!==t}function Bl(t,e,n){t.onHoverStateChange&&(t.hoverState||0)!==n&&t.onHoverStateChange(e),t.hoverState=n}function zl(t){Bl(t,"emphasis",2)}function El(t){2===t.hoverState&&Bl(t,"normal",0)}function Vl(t){Bl(t,"blur",1)}function Fl(t){1===t.hoverState&&Bl(t,"normal",0)}function Hl(t){t.selected=!0}function Wl(t){t.selected=!1}function Gl(t,e,n){e(t,n)}function Ul(t,e,n){Gl(t,e,n),t.isGroup&&t.traverse((function(t){Gl(t,e,n)}))}function Zl(t,e){switch(e){case"emphasis":t.hoverState=2;break;case"normal":t.hoverState=0;break;case"blur":t.hoverState=1;break;case"select":t.selected=!0}}function Yl(t,e){var n=this.states[t];if(this.style){if("emphasis"===t)return function(t,e,n,i){var r=n&&L(n,"select")>=0,o=!1;if(t instanceof Xs){var a=Tl(t),s=r&&a.selectFill||a.normalFill,l=r&&a.selectStroke||a.normalStroke;if(Nl(s)||Nl(l)){var u=(i=i||{}).style||{};"inherit"===u.fill?(o=!0,i=D({},i),(u=D({},u)).fill=s):!Nl(u.fill)&&Nl(s)?(o=!0,i=D({},i),(u=D({},u)).fill=ci(s)):!Nl(u.stroke)&&Nl(l)&&(o||(i=D({},i),u=D({},u)),u.stroke=ci(l)),i.style=u}}if(i&&null==i.z2){o||(i=D({},i));var h=t.z2EmphasisLift;i.z2=t.z2+(null!=h?h:10)}return i}(this,0,e,n);if("blur"===t)return function(t,e,n){var i=L(t.currentStates,e)>=0,r=t.style.opacity,o=i?null:function(t,e,n,i){for(var r=t.style,o={},a=0;a<e.length;a++){var s=e[a],l=r[s];o[s]=null==l?i&&i[s]:l}for(a=0;a<t.animators.length;a++){var u=t.animators[a];u.__fromStateTransition&&u.__fromStateTransition.indexOf(n)<0&&"style"===u.targetName&&u.saveTo(o,e)}return o}(t,["opacity"],e,{opacity:1}),a=(n=n||{}).style||{};return null==a.opacity&&(n=D({},n),a=D({opacity:i?r:.1*o.opacity},a),n.style=a),n}(this,t,n);if("select"===t)return function(t,e,n){if(n&&null==n.z2){n=D({},n);var i=t.z2SelectLift;n.z2=t.z2+(null!=i?i:9)}return n}(this,0,n)}return n}function Xl(t){t.stateProxy=Yl;var e=t.getTextContent(),n=t.getTextGuideLine();e&&(e.stateProxy=Yl),n&&(n.stateProxy=Yl)}function jl(t,e){!nu(t,e)&&!t.__highByOuter&&Ul(t,zl)}function ql(t,e){!nu(t,e)&&!t.__highByOuter&&Ul(t,El)}function Kl(t,e){t.__highByOuter|=1<<(e||0),Ul(t,zl)}function $l(t,e){!(t.__highByOuter&=~(1<<(e||0)))&&Ul(t,El)}function Ql(t){Ul(t,Vl)}function Jl(t){Ul(t,Fl)}function tu(t){Ul(t,Hl)}function eu(t){Ul(t,Wl)}function nu(t,e){return t.__highDownSilentOnTouch&&e.zrByTouch}function iu(t){var e=t.getModel(),n=[],i=[];e.eachComponent((function(e,r){var o=kl(r),a="series"===e,s=a?t.getViewOfSeriesModel(r):t.getViewOfComponentModel(r);!a&&i.push(s),o.isBlured&&(s.group.traverse((function(t){Fl(t)})),a&&n.push(r)),o.isBlured=!1})),B(i,(function(t){t&&t.toggleBlurSeries&&t.toggleBlurSeries(n,!1,e)}))}function ru(t,e,n,i){var r=i.getModel();function o(t,e){for(var n=0;n<e.length;n++){var i=t.getItemGraphicEl(e[n]);i&&Jl(i)}}if(n=n||"coordinateSystem",null!=t&&e&&"none"!==e){var a=r.getSeriesByIndex(t),s=a.coordinateSystem;s&&s.master&&(s=s.master);var l=[];r.eachSeries((function(t){var r=a===t,u=t.coordinateSystem;if(u&&u.master&&(u=u.master),!("series"===n&&!r||"coordinateSystem"===n&&!(u&&s?u===s:r)||"series"===e&&r)){if(i.getViewOfSeriesModel(t).group.traverse((function(t){t.__highByOuter&&r&&"self"===e||Vl(t)})),N(e))o(t.getData(),e);else if(q(e))for(var h=H(e),c=0;c<h.length;c++)o(t.getData(h[c]),e[h[c]]);l.push(t),kl(t).isBlured=!0}})),r.eachComponent((function(t,e){if("series"!==t){var n=i.getViewOfComponentModel(e);n&&n.toggleBlurSeries&&n.toggleBlurSeries(l,!0,r)}}))}}function ou(t,e,n){if(null!=t&&null!=e){var i=n.getModel().getComponent(t,e);if(i){kl(i).isBlured=!0;var r=n.getViewOfComponentModel(i);r&&r.focusBlurEnabled&&r.group.traverse((function(t){Vl(t)}))}}}function au(t,e,n,i){var r={focusSelf:!1,dispatchers:null};if(null==t||"series"===t||null==e||null==n)return r;var o=i.getModel().getComponent(t,e);if(!o)return r;var a=i.getViewOfComponentModel(o);if(!a||!a.findHighDownDispatchers)return r;for(var s,l=a.findHighDownDispatchers(n),u=0;u<l.length;u++)if("self"===wl(l[u]).focus){s=!0;break}return{focusSelf:s,dispatchers:l}}function su(t){B(t.getAllData(),(function(e){var n=e.data,i=e.type;n.eachItemGraphicEl((function(e,n){t.isSelected(n,i)?tu(e):eu(e)}))}))}function lu(t){var e=[];return t.eachSeries((function(t){B(t.getAllData(),(function(n){n.data;var i=n.type,r=t.getSelectedDataIndices();if(r.length>0){var o={dataIndex:r,seriesIndex:t.seriesIndex};null!=i&&(o.dataType=i),e.push(o)}}))})),e}function uu(t,e,n){fu(t,!0),Ul(t,Xl),function(t,e,n){var i=wl(t);null!=e?(i.focus=e,i.blurScope=n):i.focus&&(i.focus=null)}(t,e,n)}function hu(t,e,n,i){i?function(t){fu(t,!1)}(t):uu(t,e,n)}var cu=["emphasis","blur","select"],pu={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function du(t,e,n,i){n=n||"itemStyle";for(var r=0;r<cu.length;r++){var o=cu[r],a=e.getModel([o,n]);t.ensureState(o).style=i?i(a):a[pu[n]]()}}function fu(t,e){var n=!1===e,i=t;t.highDownSilentOnTouch&&(i.__highDownSilentOnTouch=t.highDownSilentOnTouch),n&&!i.__highDownDispatcher||(i.__highByOuter=i.__highByOuter||0,i.__highDownDispatcher=!n)}function gu(t){return!(!t||!t.__highDownDispatcher)}function vu(t){var e=t.type;return e===Pl||e===Ll||e===Ol}function yu(t){var e=t.type;return e===Dl||e===Al}var mu=Cs.CMD,_u=[[],[],[]],xu=Math.sqrt,bu=Math.atan2;var wu=Math.sqrt,Su=Math.sin,Mu=Math.cos,Tu=Math.PI;function ku(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Cu(t,e){return(t[0]*e[0]+t[1]*e[1])/(ku(t)*ku(e))}function Iu(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(Cu(t,e))}function Du(t,e,n,i,r,o,a,s,l,u,h){var c=l*(Tu/180),p=Mu(c)*(t-n)/2+Su(c)*(e-i)/2,d=-1*Su(c)*(t-n)/2+Mu(c)*(e-i)/2,f=p*p/(a*a)+d*d/(s*s);f>1&&(a*=wu(f),s*=wu(f));var g=(r===o?-1:1)*wu((a*a*(s*s)-a*a*(d*d)-s*s*(p*p))/(a*a*(d*d)+s*s*(p*p)))||0,v=g*a*d/s,y=g*-s*p/a,m=(t+n)/2+Mu(c)*v-Su(c)*y,_=(e+i)/2+Su(c)*v+Mu(c)*y,x=Iu([1,0],[(p-v)/a,(d-y)/s]),b=[(p-v)/a,(d-y)/s],w=[(-1*p-v)/a,(-1*d-y)/s],S=Iu(b,w);if(Cu(b,w)<=-1&&(S=Tu),Cu(b,w)>=1&&(S=0),S<0){var M=Math.round(S/Tu*1e6)/1e6;S=2*Tu+M%2*Tu}h.addData(u,m,_,a,s,x,S,c,o)}var Au=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/gi,Pu=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;var Lu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.applyTransform=function(t){},e}(Xs);function Ou(t){return null!=t.setData}function Ru(t,e){var n=function(t){var e=new Cs;if(!t)return e;var n,i=0,r=0,o=i,a=r,s=Cs.CMD,l=t.match(Au);if(!l)return e;for(var u=0;u<l.length;u++){for(var h=l[u],c=h.charAt(0),p=void 0,d=h.match(Pu)||[],f=d.length,g=0;g<f;g++)d[g]=parseFloat(d[g]);for(var v=0;v<f;){var y=void 0,m=void 0,_=void 0,x=void 0,b=void 0,w=void 0,S=void 0,M=i,T=r,k=void 0,C=void 0;switch(c){case"l":i+=d[v++],r+=d[v++],p=s.L,e.addData(p,i,r);break;case"L":i=d[v++],r=d[v++],p=s.L,e.addData(p,i,r);break;case"m":i+=d[v++],r+=d[v++],p=s.M,e.addData(p,i,r),o=i,a=r,c="l";break;case"M":i=d[v++],r=d[v++],p=s.M,e.addData(p,i,r),o=i,a=r,c="L";break;case"h":i+=d[v++],p=s.L,e.addData(p,i,r);break;case"H":i=d[v++],p=s.L,e.addData(p,i,r);break;case"v":r+=d[v++],p=s.L,e.addData(p,i,r);break;case"V":r=d[v++],p=s.L,e.addData(p,i,r);break;case"C":p=s.C,e.addData(p,d[v++],d[v++],d[v++],d[v++],d[v++],d[v++]),i=d[v-2],r=d[v-1];break;case"c":p=s.C,e.addData(p,d[v++]+i,d[v++]+r,d[v++]+i,d[v++]+r,d[v++]+i,d[v++]+r),i+=d[v-2],r+=d[v-1];break;case"S":y=i,m=r,k=e.len(),C=e.data,n===s.C&&(y+=i-C[k-4],m+=r-C[k-3]),p=s.C,M=d[v++],T=d[v++],i=d[v++],r=d[v++],e.addData(p,y,m,M,T,i,r);break;case"s":y=i,m=r,k=e.len(),C=e.data,n===s.C&&(y+=i-C[k-4],m+=r-C[k-3]),p=s.C,M=i+d[v++],T=r+d[v++],i+=d[v++],r+=d[v++],e.addData(p,y,m,M,T,i,r);break;case"Q":M=d[v++],T=d[v++],i=d[v++],r=d[v++],p=s.Q,e.addData(p,M,T,i,r);break;case"q":M=d[v++]+i,T=d[v++]+r,i+=d[v++],r+=d[v++],p=s.Q,e.addData(p,M,T,i,r);break;case"T":y=i,m=r,k=e.len(),C=e.data,n===s.Q&&(y+=i-C[k-4],m+=r-C[k-3]),i=d[v++],r=d[v++],p=s.Q,e.addData(p,y,m,i,r);break;case"t":y=i,m=r,k=e.len(),C=e.data,n===s.Q&&(y+=i-C[k-4],m+=r-C[k-3]),i+=d[v++],r+=d[v++],p=s.Q,e.addData(p,y,m,i,r);break;case"A":_=d[v++],x=d[v++],b=d[v++],w=d[v++],S=d[v++],Du(M=i,T=r,i=d[v++],r=d[v++],w,S,_,x,b,p=s.A,e);break;case"a":_=d[v++],x=d[v++],b=d[v++],w=d[v++],S=d[v++],Du(M=i,T=r,i+=d[v++],r+=d[v++],w,S,_,x,b,p=s.A,e)}}"z"!==c&&"Z"!==c||(p=s.Z,e.addData(p),i=o,r=a),n=p}return e.toStatic(),e}(t),i=D({},e);return i.buildPath=function(t){var e,i=Ou(t);i&&t.canSave()?(t.appendPath(n),(e=t.getContext())&&t.rebuildPath(e,1)):(e=i?t.getContext():t)&&n.rebuildPath(e,1)},i.applyTransform=function(t){!function(t,e){if(e){var n,i,r,o,a,s,l=t.data,u=t.len(),h=mu.M,c=mu.C,p=mu.L,d=mu.R,f=mu.A,g=mu.Q;for(r=0,o=0;r<u;){switch(n=l[r++],o=r,i=0,n){case h:case p:i=1;break;case c:i=3;break;case g:i=2;break;case f:var v=e[4],y=e[5],m=xu(e[0]*e[0]+e[1]*e[1]),_=xu(e[2]*e[2]+e[3]*e[3]),x=bu(-e[1]/_,e[0]/m);l[r]*=m,l[r++]+=v,l[r]*=_,l[r++]+=y,l[r++]*=m,l[r++]*=_,l[r++]+=x,l[r++]+=x,o=r+=2;break;case d:s[0]=l[r++],s[1]=l[r++],Ft(s,s,e),l[o++]=s[0],l[o++]=s[1],s[0]+=l[r++],s[1]+=l[r++],Ft(s,s,e),l[o++]=s[0],l[o++]=s[1]}for(a=0;a<i;a++){var b=_u[a];b[0]=l[r++],b[1]=l[r++],Ft(b,b,e),l[o++]=b[0],l[o++]=b[1]}}t.increaseVersion()}}(n,t),this.dirtyShape()},i}var Nu=function(){this.cx=0,this.cy=0,this.r=0},Bu=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultShape=function(){return new Nu},e.prototype.buildPath=function(t,e){t.moveTo(e.cx+e.r,e.cy),t.arc(e.cx,e.cy,e.r,0,2*Math.PI)},e}(Xs);Bu.prototype.type="circle";var zu=function(){this.cx=0,this.cy=0,this.rx=0,this.ry=0},Eu=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultShape=function(){return new zu},e.prototype.buildPath=function(t,e){var n=.5522848,i=e.cx,r=e.cy,o=e.rx,a=e.ry,s=o*n,l=a*n;t.moveTo(i-o,r),t.bezierCurveTo(i-o,r-l,i-s,r-a,i,r-a),t.bezierCurveTo(i+s,r-a,i+o,r-l,i+o,r),t.bezierCurveTo(i+o,r+l,i+s,r+a,i,r+a),t.bezierCurveTo(i-s,r+a,i-o,r+l,i-o,r),t.closePath()},e}(Xs);Eu.prototype.type="ellipse";var Vu=Math.PI,Fu=2*Vu,Hu=Math.sin,Wu=Math.cos,Gu=Math.acos,Uu=Math.atan2,Zu=Math.abs,Yu=Math.sqrt,Xu=Math.max,ju=Math.min,qu=1e-4;function Ku(t,e,n,i,r,o,a){var s=t-n,l=e-i,u=(a?o:-o)/Yu(s*s+l*l),h=u*l,c=-u*s,p=t+h,d=e+c,f=n+h,g=i+c,v=(p+f)/2,y=(d+g)/2,m=f-p,_=g-d,x=m*m+_*_,b=r-o,w=p*g-f*d,S=(_<0?-1:1)*Yu(Xu(0,b*b*x-w*w)),M=(w*_-m*S)/x,T=(-w*m-_*S)/x,k=(w*_+m*S)/x,C=(-w*m+_*S)/x,I=M-v,D=T-y,A=k-v,P=C-y;return I*I+D*D>A*A+P*P&&(M=k,T=C),{cx:M,cy:T,x0:-h,y0:-c,x1:M*(r/b-1),y1:T*(r/b-1)}}function $u(t,e){var n,i=Xu(e.r,0),r=Xu(e.r0||0,0),o=i>0;if(o||r>0){if(o||(i=r,r=0),r>i){var a=i;i=r,r=a}var s=e.startAngle,l=e.endAngle;if(!isNaN(s)&&!isNaN(l)){var u=e.cx,h=e.cy,c=!!e.clockwise,p=Zu(l-s),d=p>Fu&&p%Fu;if(d>qu&&(p=d),i>qu)if(p>Fu-qu)t.moveTo(u+i*Wu(s),h+i*Hu(s)),t.arc(u,h,i,s,l,!c),r>qu&&(t.moveTo(u+r*Wu(l),h+r*Hu(l)),t.arc(u,h,r,l,s,c));else{var f=void 0,g=void 0,v=void 0,y=void 0,m=void 0,_=void 0,x=void 0,b=void 0,w=void 0,S=void 0,M=void 0,T=void 0,k=void 0,C=void 0,I=void 0,D=void 0,A=i*Wu(s),P=i*Hu(s),L=r*Wu(l),O=r*Hu(l),R=p>qu;if(R){var N=e.cornerRadius;N&&(n=function(t){var e;if(U(t)){var n=t.length;if(!n)return t;e=1===n?[t[0],t[0],0,0]:2===n?[t[0],t[0],t[1],t[1]]:3===n?t.concat(t[2]):t}else e=[t,t,t,t];return e}(N),f=n[0],g=n[1],v=n[2],y=n[3]);var B=Zu(i-r)/2;if(m=ju(B,v),_=ju(B,y),x=ju(B,f),b=ju(B,g),M=w=Xu(m,_),T=S=Xu(x,b),(w>qu||S>qu)&&(k=i*Wu(l),C=i*Hu(l),I=r*Wu(s),D=r*Hu(s),p<Vu)){var z=function(t,e,n,i,r,o,a,s){var l=n-t,u=i-e,h=a-r,c=s-o,p=c*l-h*u;if(!(p*p<qu))return[t+(p=(h*(e-o)-c*(t-r))/p)*l,e+p*u]}(A,P,I,D,k,C,L,O);if(z){var E=A-z[0],V=P-z[1],F=k-z[0],H=C-z[1],W=1/Hu(Gu((E*F+V*H)/(Yu(E*E+V*V)*Yu(F*F+H*H)))/2),G=Yu(z[0]*z[0]+z[1]*z[1]);M=ju(w,(i-G)/(W+1)),T=ju(S,(r-G)/(W-1))}}}if(R)if(M>qu){var Z=ju(v,M),Y=ju(y,M),X=Ku(I,D,A,P,i,Z,c),j=Ku(k,C,L,O,i,Y,c);t.moveTo(u+X.cx+X.x0,h+X.cy+X.y0),M<w&&Z===Y?t.arc(u+X.cx,h+X.cy,M,Uu(X.y0,X.x0),Uu(j.y0,j.x0),!c):(Z>0&&t.arc(u+X.cx,h+X.cy,Z,Uu(X.y0,X.x0),Uu(X.y1,X.x1),!c),t.arc(u,h,i,Uu(X.cy+X.y1,X.cx+X.x1),Uu(j.cy+j.y1,j.cx+j.x1),!c),Y>0&&t.arc(u+j.cx,h+j.cy,Y,Uu(j.y1,j.x1),Uu(j.y0,j.x0),!c))}else t.moveTo(u+A,h+P),t.arc(u,h,i,s,l,!c);else t.moveTo(u+A,h+P);if(r>qu&&R)if(T>qu){Z=ju(f,T),X=Ku(L,O,k,C,r,-(Y=ju(g,T)),c),j=Ku(A,P,I,D,r,-Z,c);t.lineTo(u+X.cx+X.x0,h+X.cy+X.y0),T<S&&Z===Y?t.arc(u+X.cx,h+X.cy,T,Uu(X.y0,X.x0),Uu(j.y0,j.x0),!c):(Y>0&&t.arc(u+X.cx,h+X.cy,Y,Uu(X.y0,X.x0),Uu(X.y1,X.x1),!c),t.arc(u,h,r,Uu(X.cy+X.y1,X.cx+X.x1),Uu(j.cy+j.y1,j.cx+j.x1),c),Z>0&&t.arc(u+j.cx,h+j.cy,Z,Uu(j.y1,j.x1),Uu(j.y0,j.x0),!c))}else t.lineTo(u+L,h+O),t.arc(u,h,r,l,s,c);else t.lineTo(u+L,h+O)}else t.moveTo(u,h);t.closePath()}}}var Qu=function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.cornerRadius=0},Ju=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultShape=function(){return new Qu},e.prototype.buildPath=function(t,e){$u(t,e)},e.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},e}(Xs);Ju.prototype.type="sector";var th=function(){this.cx=0,this.cy=0,this.r=0,this.r0=0},eh=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultShape=function(){return new th},e.prototype.buildPath=function(t,e){var n=e.cx,i=e.cy,r=2*Math.PI;t.moveTo(n+e.r,i),t.arc(n,i,e.r,0,r,!1),t.moveTo(n+e.r0,i),t.arc(n,i,e.r0,0,r,!0)},e}(Xs);function nh(t,e,n){var i=e.smooth,r=e.points;if(r&&r.length>=2){if(i){var o=function(t,e,n,i){var r,o,a,s,l=[],u=[],h=[],c=[];if(i){a=[1/0,1/0],s=[-1/0,-1/0];for(var p=0,d=t.length;p<d;p++)Ht(a,a,t[p]),Wt(s,s,t[p]);Ht(a,a,i[0]),Wt(s,s,i[1])}for(p=0,d=t.length;p<d;p++){var f=t[p];if(n)r=t[p?p-1:d-1],o=t[(p+1)%d];else{if(0===p||p===d-1){l.push(kt(t[p]));continue}r=t[p-1],o=t[p+1]}It(u,o,r),Ot(u,u,e);var g=Nt(f,r),v=Nt(f,o),y=g+v;0!==y&&(g/=y,v/=y),Ot(h,u,-g),Ot(c,u,v);var m=Ct([],f,h),_=Ct([],f,c);i&&(Wt(m,m,a),Ht(m,m,s),Wt(_,_,a),Ht(_,_,s)),l.push(m),l.push(_)}return n&&l.push(l.shift()),l}(r,i,n,e.smoothConstraint);t.moveTo(r[0][0],r[0][1]);for(var a=r.length,s=0;s<(n?a:a-1);s++){var l=o[2*s],u=o[2*s+1],h=r[(s+1)%a];t.bezierCurveTo(l[0],l[1],u[0],u[1],h[0],h[1])}}else{t.moveTo(r[0][0],r[0][1]);s=1;for(var c=r.length;s<c;s++)t.lineTo(r[s][0],r[s][1])}n&&t.closePath()}}eh.prototype.type="ring";var ih=function(){this.points=null,this.smooth=0,this.smoothConstraint=null},rh=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultShape=function(){return new ih},e.prototype.buildPath=function(t,e){nh(t,e,!0)},e}(Xs);rh.prototype.type="polygon";var oh=function(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null},ah=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new oh},e.prototype.buildPath=function(t,e){nh(t,e,!1)},e}(Xs);ah.prototype.type="polyline";var sh={},lh=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1},uh=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new lh},e.prototype.buildPath=function(t,e){var n,i,r,o;if(this.subPixelOptimize){var a=tl(sh,e,this.style);n=a.x1,i=a.y1,r=a.x2,o=a.y2}else n=e.x1,i=e.y1,r=e.x2,o=e.y2;var s=e.percent;0!==s&&(t.moveTo(n,i),s<1&&(r=n*(1-s)+r*s,o=i*(1-s)+o*s),t.lineTo(r,o))},e.prototype.pointAt=function(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t]},e}(Xs);uh.prototype.type="line";var hh=[],ch=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1};function ph(t,e,n){var i=t.cpx2,r=t.cpy2;return null!=i||null!=r?[(n?Tn:Mn)(t.x1,t.cpx1,t.cpx2,t.x2,e),(n?Tn:Mn)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(n?Pn:An)(t.x1,t.cpx1,t.x2,e),(n?Pn:An)(t.y1,t.cpy1,t.y2,e)]}var dh=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new ch},e.prototype.buildPath=function(t,e){var n=e.x1,i=e.y1,r=e.x2,o=e.y2,a=e.cpx1,s=e.cpy1,l=e.cpx2,u=e.cpy2,h=e.percent;0!==h&&(t.moveTo(n,i),null==l||null==u?(h<1&&(On(n,a,r,h,hh),a=hh[1],r=hh[2],On(i,s,o,h,hh),s=hh[1],o=hh[2]),t.quadraticCurveTo(a,s,r,o)):(h<1&&(In(n,a,l,r,h,hh),a=hh[1],l=hh[2],r=hh[3],In(i,s,u,o,h,hh),s=hh[1],u=hh[2],o=hh[3]),t.bezierCurveTo(a,s,l,u,r,o)))},e.prototype.pointAt=function(t){return ph(this.shape,t,!1)},e.prototype.tangentAt=function(t){var e=ph(this.shape,t,!0);return Rt(e,e)},e}(Xs);dh.prototype.type="bezier-curve";var fh=function(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0},gh=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new fh},e.prototype.buildPath=function(t,e){var n=e.cx,i=e.cy,r=Math.max(e.r,0),o=e.startAngle,a=e.endAngle,s=e.clockwise,l=Math.cos(o),u=Math.sin(o);t.moveTo(l*r+n,u*r+i),t.arc(n,i,r,o,a,!s)},e}(Xs);gh.prototype.type="arc";var vh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="compound",e}return n(e,t),e.prototype._updatePathDirty=function(){for(var t=this.shape.paths,e=this.shapeChanged(),n=0;n<t.length;n++)e=e||t[n].shapeChanged();e&&this.dirtyShape()},e.prototype.beforeBrush=function(){this._updatePathDirty();for(var t=this.shape.paths||[],e=this.getGlobalScale(),n=0;n<t.length;n++)t[n].path||t[n].createPathProxy(),t[n].path.setScale(e[0],e[1],t[n].segmentIgnoreThreshold)},e.prototype.buildPath=function(t,e){for(var n=e.paths||[],i=0;i<n.length;i++)n[i].buildPath(t,n[i].shape,!0)},e.prototype.afterBrush=function(){for(var t=this.shape.paths||[],e=0;e<t.length;e++)t[e].pathUpdated()},e.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),Xs.prototype.getBoundingRect.call(this)},e}(Xs),yh=function(){function t(t){this.colorStops=t||[]}return t.prototype.addColorStop=function(t,e){this.colorStops.push({offset:t,color:e})},t}(),mh=function(t){function e(e,n,i,r,o,a){var s=t.call(this,o)||this;return s.x=null==e?0:e,s.y=null==n?0:n,s.x2=null==i?1:i,s.y2=null==r?0:r,s.type="linear",s.global=a||!1,s}return n(e,t),e}(yh),_h=function(t){function e(e,n,i,r,o){var a=t.call(this,r)||this;return a.x=null==e?.5:e,a.y=null==n?.5:n,a.r=null==i?.5:i,a.type="radial",a.global=o||!1,a}return n(e,t),e}(yh),xh=Math.min,bh=Math.max,wh=Math.abs,Sh=[0,0],Mh=[0,0],Th=Ge(),kh=Th.minTv,Ch=Th.maxTv,Ih=function(){function t(t,e){this._corners=[],this._axes=[],this._origin=[0,0];for(var n=0;n<4;n++)this._corners[n]=new Te;for(n=0;n<2;n++)this._axes[n]=new Te;t&&this.fromBoundingRect(t,e)}return t.prototype.fromBoundingRect=function(t,e){var n=this._corners,i=this._axes,r=t.x,o=t.y,a=r+t.width,s=o+t.height;if(n[0].set(r,o),n[1].set(a,o),n[2].set(a,s),n[3].set(r,s),e)for(var l=0;l<4;l++)n[l].transform(e);Te.sub(i[0],n[1],n[0]),Te.sub(i[1],n[3],n[0]),i[0].normalize(),i[1].normalize();for(l=0;l<2;l++)this._origin[l]=i[l].dot(n[0])},t.prototype.intersect=function(t,e,n){var i=!0,r=!e;return e&&Te.set(e,0,0),Th.reset(n,!r),!this._intersectCheckOneSide(this,t,r,1)&&(i=!1,r)||!this._intersectCheckOneSide(t,this,r,-1)&&(i=!1,r)||r||Th.negativeSize||Te.copy(e,i?Th.useDir?Th.dirMinTv:kh:Ch),i},t.prototype._intersectCheckOneSide=function(t,e,n,i){for(var r=!0,o=0;o<2;o++){var a=t._axes[o];if(t._getProjMinMaxOnAxis(o,t._corners,Sh),t._getProjMinMaxOnAxis(o,e._corners,Mh),Th.negativeSize||Sh[1]<Mh[0]||Sh[0]>Mh[1]){if(r=!1,Th.negativeSize||n)return r;var s=wh(Mh[0]-Sh[1]),l=wh(Sh[0]-Mh[1]);xh(s,l)>Ch.len()&&(s<l?Te.scale(Ch,a,-s*i):Te.scale(Ch,a,l*i))}else if(!n){s=wh(Mh[0]-Sh[1]),l=wh(Sh[0]-Mh[1]);(Th.useDir||xh(s,l)<kh.len())&&((s<l||!Th.bidirectional)&&(Te.scale(kh,a,s*i),Th.useDir&&Th.calcDirMTV()),(s>=l||!Th.bidirectional)&&(Te.scale(kh,a,-l*i),Th.useDir&&Th.calcDirMTV()))}}return r},t.prototype._getProjMinMaxOnAxis=function(t,e,n){for(var i=this._axes[t],r=this._origin,o=e[0].dot(i)+r[t],a=o,s=o,l=1;l<e.length;l++){var u=e[l].dot(i)+r[t];a=xh(u,a),s=bh(u,s)}n[0]=a+Th.touchThreshold,n[1]=s-Th.touchThreshold,Th.negativeSize=n[1]<n[0]},t}(),Dh=[],Ah=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.notClear=!0,e.incremental=!0,e._displayables=[],e._temporaryDisplayables=[],e._cursor=0,e}return n(e,t),e.prototype.traverse=function(t,e){t.call(e,this)},e.prototype.useStyle=function(){this.style={}},e.prototype.getCursor=function(){return this._cursor},e.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},e.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},e.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},e.prototype.addDisplayable=function(t,e){e?this._temporaryDisplayables.push(t):this._displayables.push(t),this.markRedraw()},e.prototype.addDisplayables=function(t,e){e=e||!1;for(var n=0;n<t.length;n++)this.addDisplayable(t[n],e)},e.prototype.getDisplayables=function(){return this._displayables},e.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},e.prototype.eachPendingDisplayable=function(t){for(var e=this._cursor;e<this._displayables.length;e++)t&&t(this._displayables[e]);for(e=0;e<this._temporaryDisplayables.length;e++)t&&t(this._temporaryDisplayables[e])},e.prototype.update=function(){this.updateTransform();for(var t=this._cursor;t<this._displayables.length;t++){(e=this._displayables[t]).parent=this,e.update(),e.parent=null}for(t=0;t<this._temporaryDisplayables.length;t++){var e;(e=this._temporaryDisplayables[t]).parent=this,e.update(),e.parent=null}},e.prototype.getBoundingRect=function(){if(!this._rect){for(var t=new Ve(1/0,1/0,-1/0,-1/0),e=0;e<this._displayables.length;e++){var n=this._displayables[e],i=n.getBoundingRect().clone();n.needLocalTransform()&&i.applyTransform(n.getLocalTransform(Dh)),t.union(i)}this._rect=t}return this._rect},e.prototype.contain=function(t,e){var n=this.transformCoordToLocal(t,e);if(this.getBoundingRect().contain(n[0],n[1]))for(var i=0;i<this._displayables.length;i++){if(this._displayables[i].contain(t,e))return!0}return!1},e}(Ya),Ph=Qo();function Lh(t,e,n,i,r){var o;if(e&&e.ecModel){var a=e.ecModel.getUpdatePayload();o=a&&a.animation}var s="update"===t;if(e&&e.isAnimationEnabled()){var l=void 0,u=void 0,h=void 0;return i?(l=rt(i.duration,200),u=rt(i.easing,"cubicOut"),h=0):(l=e.getShallow(s?"animationDurationUpdate":"animationDuration"),u=e.getShallow(s?"animationEasingUpdate":"animationEasing"),h=e.getShallow(s?"animationDelayUpdate":"animationDelay")),o&&(null!=o.duration&&(l=o.duration),null!=o.easing&&(u=o.easing),null!=o.delay&&(h=o.delay)),Z(h)&&(h=h(n,r)),Z(l)&&(l=l(n)),{duration:l||0,delay:h,easing:u}}return null}function Oh(t,e,n,i,r,o,a){var s,l=!1;Z(r)?(a=o,o=r,r=null):q(r)&&(o=r.cb,a=r.during,l=r.isFrom,s=r.removeOpt,r=r.dataIndex);var u="leave"===t;u||e.stopAnimation("leave");var h=Lh(t,i,r,u?s||{}:null,i&&i.getAnimationDelayParams?i.getAnimationDelayParams(e,r):null);if(h&&h.duration>0){var c={duration:h.duration,delay:h.delay||0,easing:h.easing,done:o,force:!!o||!!a,setToFinal:!u,scope:t,during:a};l?e.animateFrom(n,c):e.animateTo(n,c)}else e.stopAnimation(),!l&&e.attr(n),a&&a(1),o&&o()}function Rh(t,e,n,i,r,o){Oh("update",t,e,n,i,r,o)}function Nh(t,e,n,i,r,o){Oh("enter",t,e,n,i,r,o)}function Bh(t){if(!t.__zr)return!0;for(var e=0;e<t.animators.length;e++){if("leave"===t.animators[e].scope)return!0}return!1}function zh(t,e,n,i,r,o){Bh(t)||Oh("leave",t,e,n,i,r,o)}function Eh(t,e,n,i){t.removeTextContent(),t.removeTextGuideLine(),zh(t,{style:{opacity:0}},e,n,i)}function Vh(t,e,n){function i(){t.parent&&t.parent.remove(t)}t.isGroup?t.traverse((function(t){t.isGroup||Eh(t,e,n,i)})):Eh(t,e,n,i)}function Fh(t){Ph(t).oldStyle=t.style}var Hh={},Wh=["x","y"],Gh=["width","height"];function Uh(t){return Xs.extend(t)}var Zh=function(t,e){var i=Ru(t,e);return function(t){function e(e){var n=t.call(this,e)||this;return n.applyTransform=i.applyTransform,n.buildPath=i.buildPath,n}return n(e,t),e}(Lu)};function Yh(t,e){return Zh(t,e)}function Xh(t,e){Hh[t]=e}function jh(t){if(Hh.hasOwnProperty(t))return Hh[t]}function qh(t,e,n,i){var r=function(t,e){return new Lu(Ru(t,e))}(t,e);return n&&("center"===i&&(n=$h(n,r.getBoundingRect())),Jh(r,n)),r}function Kh(t,e,n){var i=new Qs({style:{image:t,x:e.x,y:e.y,width:e.width,height:e.height},onload:function(t){if("center"===n){var r={width:t.width,height:t.height};i.setStyle($h(e,r))}}});return i}function $h(t,e){var n,i=e.width/e.height,r=t.height*i;return n=r<=t.width?t.height:(r=t.width)/i,{x:t.x+t.width/2-r/2,y:t.y+t.height/2-n/2,width:r,height:n}}var Qh=function(t,e){for(var n=[],i=t.length,r=0;r<i;r++){var o=t[r];n.push(o.getUpdatedPathProxy(!0))}var a=new Xs(e);return a.createPathProxy(),a.buildPath=function(t){if(Ou(t)){t.appendPath(n);var e=t.getContext();e&&t.rebuildPath(e,1)}},a};function Jh(t,e){if(t.applyTransform){var n=t.getBoundingRect().calculateTransform(e);t.applyTransform(n)}}function tc(t,e){return tl(t,t,{lineWidth:e}),t}var ec=nl;function nc(t,e){for(var n=ye([]);t&&t!==e;)_e(n,t.getLocalTransform(),n),t=t.parent;return n}function ic(t,e,n){return e&&!N(e)&&(e=wr.getLocalTransform(e)),n&&(e=Se([],e)),Ft([],t,e)}function rc(t,e,n){var i=0===e[4]||0===e[5]||0===e[0]?1:so(2*e[4]/e[0]),r=0===e[4]||0===e[5]||0===e[2]?1:so(2*e[4]/e[2]),o=["left"===t?-i:"right"===t?i:0,"top"===t?-r:"bottom"===t?r:0];return o=ic(o,e,n),so(o[0])>so(o[1])?o[0]>0?"right":"left":o[1]>0?"bottom":"top"}function oc(t){return!t.isGroup}function ac(t,e,n){if(t&&e){var i,r=(i={},t.traverse((function(t){oc(t)&&t.anid&&(i[t.anid]=t)})),i);e.traverse((function(t){if(oc(t)&&t.anid){var e=r[t.anid];if(e){var i=o(t);t.attr(o(e)),Rh(t,i,n,wl(t).dataIndex)}}}))}function o(t){var e={x:t.x,y:t.y,rotation:t.rotation};return function(t){return null!=t.shape}(t)&&(e.shape=k(t.shape)),e}}function sc(t,e){return z(t,(function(t){var n=t[0];n=ao(n,e.x),n=oo(n,e.x+e.width);var i=t[1];return i=ao(i,e.y),[n,i=oo(i,e.y+e.height)]}))}function lc(t,e){var n=ao(t.x,e.x),i=oo(t.x+t.width,e.x+e.width),r=ao(t.y,e.y),o=oo(t.y+t.height,e.y+e.height);if(i>=n&&o>=r)return{x:n,y:r,width:i-n,height:o-r}}function uc(t,e,n){var i=D({rectHover:!0},e),r=i.style={strokeNoScale:!0};if(n=n||{x:-1,y:-1,width:2,height:2},t)return 0===t.indexOf("image://")?(r.image=t.slice(8),A(r,n),new Qs(i)):qh(t.replace("path://",""),i,n,"center")}function hc(t,e,n,i,r,o,a,s){var l,u=n-t,h=i-e,c=a-r,p=s-o,d=cc(c,p,u,h);if((l=d)<=1e-6&&l>=-1e-6)return!1;var f=t-r,g=e-o,v=cc(f,g,u,h)/d;if(v<0||v>1)return!1;var y=cc(f,g,c,p)/d;return!(y<0||y>1)}function cc(t,e,n,i){return t*i-n*e}function pc(t,e,n,i,r){return null==e||(j(e)?dc[0]=dc[1]=dc[2]=dc[3]=e:(dc[0]=e[0],dc[1]=e[1],dc[2]=e[2],dc[3]=e[3]),i&&(dc[0]=ao(0,dc[0]),dc[1]=ao(0,dc[1]),dc[2]=ao(0,dc[2]),dc[3]=ao(0,dc[3])),n&&(dc[0]=-dc[0],dc[1]=-dc[1],dc[2]=-dc[2],dc[3]=-dc[3]),fc(t,dc,"x","width",3,1,r&&r[0]||0),fc(t,dc,"y","height",0,2,r&&r[1]||0)),t}var dc=[0,0,0,0];function fc(t,e,n,i,r,o,a){var s=e[o]+e[r],l=t[i];t[i]+=s,a=ao(0,oo(a,l)),t[i]<a?(t[i]=a,t[n]+=e[r]>=0?-e[r]:e[o]>=0?l+e[o]:so(s)>1e-8?(l-a)*e[r]/s:0):t[n]-=e[r]}function gc(t){var e=t.itemTooltipOption,n=t.componentModel,i=t.itemName,r=Y(e)?{formatter:e}:e,o=n.mainType,a=n.componentIndex,s={componentType:o,name:i,$vars:["name"]};s[o+"Index"]=a;var l=t.formatterParamsExtra;l&&B(H(l),(function(t){xt(s,t)||(s[t]=l[t],s.$vars.push(t))}));var u=wl(t.el);u.componentMainType=o,u.componentIndex=a,u.tooltipConfig={name:i,option:A({content:i,encodeHTMLContent:!0,formatterParams:s},r)}}function vc(t,e){var n;t.isGroup&&(n=e(t)),n||t.traverse(e)}function yc(t,e){if(t)if(U(t))for(var n=0;n<t.length;n++)vc(t[n],e);else vc(t,e)}function mc(t){return!t||so(t[1])<_c&&so(t[2])<_c||so(t[0])<_c&&so(t[3])<_c}var _c=1e-5;function xc(t,e){return t?Ve.copy(t,e):e.clone()}function bc(t,e){return e?me(t||[1,0,0,1,0,0],e):void 0}function wc(t){return{z:t.get("z")||0,zlevel:t.get("zlevel")||0}}function Sc(t,e,n){Mc(t,e,n,-1/0)}function Mc(t,e,n,i){if(t.ignoreModelZ)return i;var r=t.getTextContent(),o=t.getTextGuideLine();if(t.isGroup)for(var a=t.childrenRef(),s=0;s<a.length;s++)i=ao(Mc(a[s],e,n,i),i);else t.z=e,t.zlevel=n,i=ao(t.z2||0,i);if(r&&(r.z=e,r.zlevel=n,isFinite(i)&&(r.z2=i+2)),o){var l=t.textGuideLineConfig;o.z=e,o.zlevel=n,isFinite(i)&&(o.z2=i+(l&&l.showAbove?1:-1))}return i}Xh("circle",Bu),Xh("ellipse",Eu),Xh("sector",Ju),Xh("ring",eh),Xh("polygon",rh),Xh("polyline",ah),Xh("rect",ol),Xh("line",uh),Xh("bezierCurve",dh),Xh("arc",gh);var Tc=Object.freeze({__proto__:null,updateProps:Rh,initProps:Nh,removeElement:zh,removeElementWithFadeOut:Vh,isElementRemoved:Bh,XY:Wh,WH:Gh,extendShape:Uh,extendPath:Yh,registerShape:Xh,getShapeClass:jh,makePath:qh,makeImage:Kh,mergePath:Qh,resizePath:Jh,subPixelOptimizeLine:tc,subPixelOptimizeRect:function(t,e){return el(t,t,e),t},subPixelOptimize:ec,getTransform:nc,applyTransform:ic,transformDirection:rc,groupTransition:ac,clipPointsByRect:sc,clipRectByRect:lc,createIcon:uc,linePolygonIntersect:function(t,e,n,i,r){for(var o=0,a=r[r.length-1];o<r.length;o++){var s=r[o];if(hc(t,e,n,i,s[0],s[1],a[0],a[1]))return!0;a=s}},lineLineIntersect:hc,expandOrShrinkRect:pc,setTooltipConfig:gc,traverseElements:yc,isBoundingRectAxisAligned:mc,ensureCopyRect:xc,ensureCopyTransform:bc,retrieveZInfo:wc,calcZ2Range:function(t){var e=-1/0,n=1/0;function i(t){if(t&&!t.isGroup){var e=t.currentStates;if(e.length)for(var n=0;n<e.length;n++)r(t.states[e[n]]);r(t)}}function r(t){if(t){var i=t.z2;i>e&&(e=i),i<n&&(n=i)}}return vc(t,(function(t){i(t),i(t.getTextContent()),i(t.getTextGuideLine())})),n>e&&(n=e=0),{min:n,max:e}},traverseUpdateZ:Sc,Group:jr,Image:Qs,Text:ul,Circle:Bu,Ellipse:Eu,Sector:Ju,Ring:eh,Polygon:rh,Polyline:ah,Rect:ol,Line:uh,BezierCurve:dh,Arc:gh,IncrementalDisplayable:Ah,CompoundPath:vh,LinearGradient:mh,RadialGradient:_h,BoundingRect:Ve,OrientedBoundingRect:Ih,Point:Te,Path:Xs}),kc={};function Cc(t,e,n){var i,r=t.labelFetcher,o=t.labelDataIndex,a=t.labelDimIndex,s=e.normal;r&&(i=r.getFormattedLabel(o,"normal",null,a,s&&s.get("formatter"),null!=n?{interpolatedValue:n}:null)),null==i&&(i=Z(t.defaultText)?t.defaultText(o,t,n):t.defaultText);for(var l={normal:i},u=0;u<Cl.length;u++){var h=Cl[u],c=e[h];l[h]=rt(r?r.getFormattedLabel(o,h,null,a,c&&c.get("formatter")):null,i)}return l}function Ic(t,e,n,i){n=n||kc;for(var r=t instanceof ul,o=!1,a=0;a<Il.length;a++){if((p=e[Il[a]])&&p.getShallow("show")){o=!0;break}}var s=r?t:t.getTextContent();if(o){r||(s||(s=new ul,t.setTextContent(s)),t.stateProxy&&(s.stateProxy=t.stateProxy));var l=Cc(n,e),u=e.normal,h=!!u.getShallow("show"),c=Ac(u,i&&i.normal,n,!1,!r);c.text=l.normal,r||t.setTextConfig(Pc(u,n,!1));for(a=0;a<Cl.length;a++){var p,d=Cl[a];if(p=e[d]){var f=s.ensureState(d),g=!!rt(p.getShallow("show"),h);if(g!==h&&(f.ignore=!g),f.style=Ac(p,i&&i[d],n,!0,!r),f.style.text=l[d],!r)t.ensureState(d).textConfig=Pc(p,n,!0)}}s.silent=!!u.getShallow("silent"),null!=s.style.x&&(c.x=s.style.x),null!=s.style.y&&(c.y=s.style.y),s.ignore=!h,s.useStyle(c),s.dirty(),n.enableTextSetter&&(zc(s).setLabelText=function(t){var i=Cc(n,e,t);!function(t,e){for(var n=0;n<Cl.length;n++){var i=Cl[n],r=e[i],o=t.ensureState(i);o.style=o.style||{},o.style.text=r}var a=t.currentStates.slice();t.clearStates(!0),t.setStyle({text:e.normal}),t.useStates(a,!0)}(s,i)})}else s&&(s.ignore=!0);t.dirty()}function Dc(t,e){e=e||"label";for(var n={normal:t.getModel(e)},i=0;i<Cl.length;i++){var r=Cl[i];n[r]=t.getModel([r,e])}return n}function Ac(t,e,n,i,r){var o={};return function(t,e,n,i,r){n=n||kc;var o,a=e.ecModel,s=a&&a.option.textStyle,l=function(t){var e;for(;t&&t!==t.ecModel;){var n=(t.option||kc).rich;if(n){e=e||{};for(var i=H(n),r=0;r<i.length;r++){e[i[r]]=1}}t=t.parentModel}return e}(e);if(l){o={};var u="richInheritPlainLabel",h=rt(e.get(u),a?a.get(u):void 0);for(var c in l)if(l.hasOwnProperty(c)){var p=e.getModel(["rich",c]);Nc(o[c]={},p,s,e,h,n,i,r,!1,!0)}}o&&(t.rich=o);var d=e.get("overflow");d&&(t.overflow=d);var f=e.get("lineOverflow");f&&(t.lineOverflow=f);var g=t,v=e.get("minMargin");if(null!=v)v=j(v)?v/2:0,g.margin=[v,v,v,v],g.__marginType=Fc.minMargin;else{var y=e.get("textMargin");null!=y&&(g.margin=st(y),g.__marginType=Fc.textMargin)}Nc(t,e,s,null,null,n,i,r,!0,!1)}(o,t,n,i,r),e&&D(o,e),o}function Pc(t,e,n){e=e||{};var i,r={},o=t.getShallow("rotate"),a=rt(t.getShallow("distance"),n?null:5),s=t.getShallow("offset");return"outside"===(i=t.getShallow("position")||(n?null:"inside"))&&(i=e.defaultOutsidePosition||"top"),null!=i&&(r.position=i),null!=s&&(r.offset=s),null!=o&&(o*=Math.PI/180,r.rotation=o),null!=a&&(r.distance=a),r.outsideFill="inherit"===t.get("color")?e.inheritColor||null:"auto",null!=e.autoOverflowArea&&(r.autoOverflowArea=e.autoOverflowArea),null!=e.layoutRect&&(r.layoutRect=e.layoutRect),r}var Lc=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],Oc=["align","lineHeight","width","height","tag","verticalAlign","ellipsis"],Rc=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function Nc(t,e,n,i,r,o,a,s,l,u){n=!a&&n||kc;var h=o&&o.inheritColor,c=e.getShallow("color"),p=e.getShallow("textBorderColor"),d=rt(e.getShallow("opacity"),n.opacity);"inherit"!==c&&"auto"!==c||(c=h||null),"inherit"!==p&&"auto"!==p||(p=h||null),s||(c=c||n.color,p=p||n.textBorderColor),null!=c&&(t.fill=c),null!=p&&(t.stroke=p);var f=rt(e.getShallow("textBorderWidth"),n.textBorderWidth);null!=f&&(t.lineWidth=f);var g=rt(e.getShallow("textBorderType"),n.textBorderType);null!=g&&(t.lineDash=g);var v=rt(e.getShallow("textBorderDashOffset"),n.textBorderDashOffset);null!=v&&(t.lineDashOffset=v),a||null!=d||u||(d=o&&o.defaultOpacity),null!=d&&(t.opacity=d),a||s||null==t.fill&&o.inheritColor&&(t.fill=o.inheritColor);for(var y=0;y<Lc.length;y++){var m=Lc[y];null!=(x=!1!==r&&i?ot(e.getShallow(m),i.getShallow(m),n[m]):rt(e.getShallow(m),n[m]))&&(t[m]=x)}for(y=0;y<Oc.length;y++){m=Oc[y];null!=(x=e.getShallow(m))&&(t[m]=x)}if(null==t.verticalAlign){var _=e.getShallow("baseline");null!=_&&(t.verticalAlign=_)}if(!l||!o.disableBox){for(y=0;y<Rc.length;y++){var x;m=Rc[y];null!=(x=e.getShallow(m))&&(t[m]=x)}var b=e.getShallow("borderType");null!=b&&(t.borderDash=b),"auto"!==t.backgroundColor&&"inherit"!==t.backgroundColor||!h||(t.backgroundColor=h),"auto"!==t.borderColor&&"inherit"!==t.borderColor||!h||(t.borderColor=h)}}function Bc(t,e){var n=e&&e.getModel("textStyle");return ut([t.fontStyle||n&&n.getShallow("fontStyle")||"",t.fontWeight||n&&n.getShallow("fontWeight")||"",(t.fontSize||n&&n.getShallow("fontSize")||12)+"px",t.fontFamily||n&&n.getShallow("fontFamily")||"sans-serif"].join(" "))}var zc=Qo();var Ec,Vc,Fc={minMargin:1,textMargin:2},Hc=["textStyle","color"],Wc=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],Gc=new ul,Uc=function(){function t(){}return t.prototype.getTextColor=function(t){var e=this.ecModel;return this.getShallow("color")||(!t&&e?e.get(Hc):null)},t.prototype.getFont=function(){return Bc({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},t.prototype.getTextRect=function(t){for(var e={text:t,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},n=0;n<Wc.length;n++)e[Wc[n]]=this.getShallow(Wc[n]);return Gc.useStyle(e),Gc.update(),Gc.getBoundingRect()},t}(),Zc=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],Yc=ga(Zc),Xc=function(){function t(){}return t.prototype.getLineStyle=function(t){return Yc(this,t)},t}(),jc=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],qc=ga(jc),Kc=function(){function t(){}return t.prototype.getItemStyle=function(t,e){return qc(this,t,e)},t}(),$c=function(){function t(t,e,n){this.parentModel=e,this.ecModel=n,this.option=t}return t.prototype.init=function(t,e,n){for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r]},t.prototype.mergeOption=function(t,e){C(this.option,t,!0)},t.prototype.get=function(t,e){return null==t?this.option:this._doGet(this.parsePath(t),!e&&this.parentModel)},t.prototype.getShallow=function(t,e){var n=this.option,i=null==n?n:n[t];if(null==i&&!e){var r=this.parentModel;r&&(i=r.getShallow(t))}return i},t.prototype.getModel=function(e,n){var i=null!=e,r=i?this.parsePath(e):null;return new t(i?this._doGet(r):this.option,n=n||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(r)),this.ecModel)},t.prototype.isEmpty=function(){return null==this.option},t.prototype.restoreData=function(){},t.prototype.clone=function(){return new(0,this.constructor)(k(this.option))},t.prototype.parsePath=function(t){return"string"==typeof t?t.split("."):t},t.prototype.resolveParentPath=function(t){return t},t.prototype.isAnimationEnabled=function(){if(!r.node&&this.option){if(null!=this.option.animation)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},t.prototype._doGet=function(t,e){var n=this.option;if(!t)return n;for(var i=0;i<t.length&&(!t[i]||null!=(n=n&&"object"==typeof n?n[t[i]]:null));i++);return null==n&&e&&(n=e._doGet(this.resolveParentPath(t),e.parentModel)),n},t}();ua($c),Ec=$c,Vc=["__\0is_clz",ca++].join("_"),Ec.prototype[Vc]=!0,Ec.isInstance=function(t){return!(!t||!t[Vc])},R($c,Xc),R($c,Kc),R($c,ya),R($c,Uc);var Qc=Math.round(10*Math.random());function Jc(t){return[t||"",Qc++].join("_")}function tp(t,e){return C(C({},t,!0),e,!0)}var ep="ZH",np="EN",ip=np,rp={},op={},ap=r.domSupported&&(document.documentElement.lang||navigator.language||navigator.browserLanguage||ip).toUpperCase().indexOf(ep)>-1?ep:ip;function sp(t,e){t=t.toUpperCase(),op[t]=new $c(e),rp[t]=e}sp(np,{time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst",custom:"Custom chart",chart:"Chart"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}}),sp(ep,{time:{month:["涓€鏈?,"浜屾湀","涓夋湀","鍥涙湀","浜旀湀","鍏湀","涓冩湀","鍏湀","涔濇湀","鍗佹湀","鍗佷竴鏈?,"鍗佷簩鏈?],monthAbbr:["1鏈?,"2鏈?,"3鏈?,"4鏈?,"5鏈?,"6鏈?,"7鏈?,"8鏈?,"9鏈?,"10鏈?,"11鏈?,"12鏈?],dayOfWeek:["鏄熸湡鏃?,"鏄熸湡涓€","鏄熸湡浜?,"鏄熸湡涓?,"鏄熸湡鍥?,"鏄熸湡浜?,"鏄熸湡鍏?],dayOfWeekAbbr:["鏃?,"涓€","浜?,"涓?,"鍥?,"浜?,"鍏?]},legend:{selector:{all:"鍏ㄩ€?,inverse:"鍙嶉€?}},toolbox:{bruFINDSTR: 写入错误
D:\housekeeping-platform\backend>findstr /s /i /n "order_sop_records" *.js
models\orderSopRecord.js:3: * 瀵瑰簲鏁版嵁搴撹〃: order_sop_records
models\orderSopRecord.js:46:    tableName: 'order_sop_records',


D:\housekeeping-platform\backend>findstr /s /i /n "sop_checklists" *.js
models\sopChecklist - 副本.js:4: * 瀵瑰簲鏁版嵁搴撹〃: sop_checklists
models\sopChecklist - 副本.js:93:    tableName: 'sop_checklists',
models\sopChecklist.js:4: * 瀵瑰簲鏁版嵁搴撹〃: sop_checklists
models\sopChecklist.js:93:    tableName: 'sop_checklists',


D:\housekeeping-platform\backend>findstr /s /i /n "template_id" *.js
jobs\acceptanceReminder.js:58:      templateId: process.env.WECHAT_REMINDER_TEMPLATE_ID
libs\notification.js:47:      //   template_id: templateId,
models\index - 副本.js:10:OrderSopRecord.belongsTo(SopTemplate, { foreignKey: 'template_id', as: 'template' });
models\index - 副本.js:11:SopTemplate.hasMany(OrderSopRecord, { foreignKey: 'template_id', as: 'records' });
models\index.js:408:SopTemplate.hasMany(OrderSopRecord, { foreignKey: 'template_id', as: 'records' });
models\index.js:409:OrderSopRecord.belongsTo(SopTemplate, { foreignKey: 'template_id', as: 'template' });
models\index.js:420:SopChecklist.belongsTo(SopTemplate, { as: 'template', foreignKey: 'template_id' });
models\index_wrong.js:19:  foreignKey: 'template_id',
models\index_wrong.js:23:  foreignKey: 'template_id',
models\MessageTemplate.js:24:    wechat_template_id: {
models\MessageTemplate.js:35:    sms_template_id: {
models\orderSopRecord.js:12:    template_id: { type: DataTypes.INTEGER, allowNull: false },
models\sopChecklist - 副本.js:22:    template_id: {
models\sopChecklist.js:22:    template_id: {
routes\admin\sopChecklist - 副本 (2).js:432:      template_id: templateId,
routes\admin\sopChecklist.js:432:      template_id: templateId,
services\messageService.js:143:    if (!template.wechat_template_id) {
services\messageService.js:172:        template_id: template.wechat_template_id,
services\messageService.js:262:    if (!template.sms_template_id) {
services\messageService.js:334:      TemplateCode: template.sms_template_id,
tasks\jurorDecayTasks.js:163:    //   template_id: 'xxx',


D:\housekeeping-platform\backend>findstr /s /i /n "cron" *.js
cron\finance\dailySettle.js:3: * 璺緞: backend/cron/finance/dailySettle.js
cron\finance\dailySettle.js:4: * 杩愯鏂瑰紡: node cron/finance/dailySettle.js
jobs\acceptanceReminder.js:28:  cronExpression: '* * * * *',
jobs\acceptanceReminder.js:98:  scheduledJob = schedule.scheduleJob(CONFIG.cronExpression, async () => {
jobs\acceptanceReminder.js:106:  console.log(`[楠屾敹鎻愰啋浠诲姟] 宸插惎鍔紝鎵ц璁″垝: ${CONFIG.cronExpression}`);
jobs\acceptanceReminder.js:338:      cronExpression: CONFIG.cronExpression,
jobs\autoAcceptance.js:26:  cronExpression: '*/5 * * * *',
jobs\autoAcceptance.js:76:  scheduledJob = schedule.scheduleJob(CONFIG.cronExpression, async () => {
jobs\autoAcceptance.js:80:  console.log(`[鑷姩楠屾敹浠诲姟] 宸插惎鍔紝鎵ц璁″垝: ${CONFIG.cronExpression}`);
node_modules\bull\lib\repeatable.js:4:const parser = require('cron-parser');
node_modules\bull\lib\repeatable.js:151:      cron: data[4]
node_modules\bull\lib\repeatable.js:171:          tz: data.cron ? data.tz : null,
node_modules\bull\lib\repeatable.js:172:          cron: data.cron || null,
node_modules\bull\lib\repeatable.js:173:          every: !data.cron ? parseInt(data.tz) : null,
node_modules\bull\lib\repeatable.js:194:    const suffix = repeat.cron ? tz + repeat.cron : String(repeat.every);
node_modules\bull\lib\repeatable.js:200:    if (opts.cron && opts.every) {
node_modules\bull\lib\repeatable.js:202:        'Both .cron and .every options are defined for this repeatable job'
node_modules\bull\lib\repeatable.js:215:      opts.cron,
node_modules\cron-parser\lib\date.js:5:CronDate.prototype.addYear = function() {
node_modules\cron-parser\lib\date.js:9:CronDate.prototype.addMonth = function() {
node_modules\cron-parser\lib\date.js:13:CronDate.prototype.addDay = function() {
node_modules\cron-parser\lib\date.js:17:CronDate.prototype.addHour = function() {
node_modules\cron-parser\lib\date.js:25:CronDate.prototype.addMinute = function() {
node_modules\cron-parser\lib\date.js:33:CronDate.prototype.addSecond = function() {
node_modules\cron-parser\lib\date.js:41:CronDate.prototype.subtractYear = function() {
node_modules\cron-parser\lib\date.js:45:CronDate.prototype.subtractMonth = function() {
node_modules\cron-parser\lib\date.js:52:CronDate.prototype.subtractDay = function() {
node_modules\cron-parser\lib\date.js:59:CronDate.prototype.subtractHour = function() {
node_modules\cron-parser\lib\date.js:70:CronDate.prototype.subtractMinute = function() {
node_modules\cron-parser\lib\date.js:80:CronDate.prototype.subtractSecond = function() {
node_modules\cron-parser\lib\date.js:90:CronDate.prototype.getDate = function() {
node_modules\cron-parser\lib\date.js:94:CronDate.prototype.getFullYear = function() {
node_modules\cron-parser\lib\date.js:98:CronDate.prototype.getDay = function() {
node_modules\cron-parser\lib\date.js:103:CronDate.prototype.getMonth = function() {
node_modules\cron-parser\lib\date.js:107:CronDate.prototype.getHours = function() {
node_modules\cron-parser\lib\date.js:111:CronDate.prototype.getMinutes = function() {
node_modules\cron-parser\lib\date.js:115:CronDate.prototype.getSeconds = function() {
node_modules\cron-parser\lib\date.js:119:CronDate.prototype.getMilliseconds = function() {
node_modules\cron-parser\lib\date.js:123:CronDate.prototype.getTime = function() {
node_modules\cron-parser\lib\date.js:127:CronDate.prototype.getUTCDate = function() {
node_modules\cron-parser\lib\date.js:131:CronDate.prototype.getUTCFullYear = function() {
node_modules\cron-parser\lib\date.js:135:CronDate.prototype.getUTCDay = function() {
node_modules\cron-parser\lib\date.js:140:CronDate.prototype.getUTCMonth = function() {
node_modules\cron-parser\lib\date.js:144:CronDate.prototype.getUTCHours = function() {
node_modules\cron-parser\lib\date.js:148:CronDate.prototype.getUTCMinutes = function() {
node_modules\cron-parser\lib\date.js:152:CronDate.prototype.getUTCSeconds = function() {
node_modules\cron-parser\lib\date.js:156:CronDate.prototype.toISOString = function() {
node_modules\cron-parser\lib\date.js:160:CronDate.prototype.toJSON = function() {
node_modules\cron-parser\lib\date.js:164:CronDate.prototype.setDate = function(d) {
node_modules\cron-parser\lib\date.js:168:CronDate.prototype.setFullYear = function(y) {
node_modules\cron-parser\lib\date.js:172:CronDate.prototype.setDay = function(d) {
node_modules\cron-parser\lib\date.js:176:CronDate.prototype.setMonth = function(m) {
node_modules\cron-parser\lib\date.js:180:CronDate.prototype.setHours = function(h) {
node_modules\cron-parser\lib\date.js:184:CronDate.prototype.setMinutes = function(m) {
node_modules\cron-parser\lib\date.js:188:CronDate.prototype.setSeconds = function(s) {
node_modules\cron-parser\lib\date.js:192:CronDate.prototype.setMilliseconds = function(s) {
node_modules\cron-parser\lib\date.js:196:CronDate.prototype._getUTC = function() {
node_modules\cron-parser\lib\date.js:200:CronDate.prototype.toString = function() {
node_modules\cron-parser\lib\date.js:204:CronDate.prototype.toDate = function() {
node_modules\cron-parser\lib\date.js:208:CronDate.prototype.isLastDayOfMonth = function() {
node_modules\cron-parser\lib\date.js:218:CronDate.prototype.isLastWeekdayOfMonth = function() {
node_modules\cron-parser\lib\date.js:225:function CronDate (timestamp, tz) {
node_modules\cron-parser\lib\date.js:229:  } else if (timestamp instanceof CronDate) {
node_modules\cron-parser\lib\date.js:244:    throw new Error('CronDate: unhandled timestamp: ' + JSON.stringify(timestamp));
node_modules\cron-parser\lib\date.js:252:module.exports = CronDate;
node_modules\cron-parser\lib\expression.js:4:var CronDate = require('./date');
node_modules\cron-parser\lib\expression.js:9: * Cron iteration loop safety limit
node_modules\cron-parser\lib\expression.js:25:function CronExpression (fields, options) {
node_modules\cron-parser\lib\expression.js:29:  this._currentDate = new CronDate(options.currentDate, this._tz);
node_modules\cron-parser\lib\expression.js:30:  this._startDate = options.startDate ? new CronDate(options.startDate, this._tz) : null;
node_modules\cron-parser\lib\expression.js:31:  this._endDate = options.endDate ? new CronDate(options.endDate, this._tz) : null;
node_modules\cron-parser\lib\expression.js:35:  this.fields = CronExpression._freezeFields(fields);
node_modules\cron-parser\lib\expression.js:42:CronExpression.map = [ 'second', 'minute', 'hour', 'dayOfMonth', 'month', 'dayOfWeek' ];
node_modules\cron-parser\lib\expression.js:48:CronExpression.predefined = {
node_modules\cron-parser\lib\expression.js:60:CronExpression.constraints = [
node_modules\cron-parser\lib\expression.js:73:CronExpression.daysInMonth = [
node_modules\cron-parser\lib\expression.js:92:CronExpression.aliases = {
node_modules\cron-parser\lib\expression.js:123:CronExpression.parseDefaults = [ '0', '*', '*', '*', '*', '*' ];
node_modules\cron-parser\lib\expression.js:125:CronExpression.standardValidCharacters = /^[,*\d/-]+$/;
node_modules\cron-parser\lib\expression.js:126:CronExpression.dayOfWeekValidCharacters = /^[?,*\dL#/-]+$/;
node_modules\cron-parser\lib\expression.js:127:CronExpression.dayOfMonthValidCharacters = /^[?,*\dL/-]+$/;
node_modules\cron-parser\lib\expression.js:128:CronExpression.validCharacters = {
node_modules\cron-parser\lib\expression.js:129:  second: CronExpression.standardValidCharacters,
node_modules\cron-parser\lib\expression.js:130:  minute: CronExpression.standardValidCharacters,
node_modules\cron-parser\lib\expression.js:131:  hour: CronExpression.standardValidCharacters,
node_modules\cron-parser\lib\expression.js:132:  dayOfMonth: CronExpression.dayOfMonthValidCharacters,
node_modules\cron-parser\lib\expression.js:133:  month: CronExpression.standardValidCharacters,
node_modules\cron-parser\lib\expression.js:134:  dayOfWeek: CronExpression.dayOfWeekValidCharacters,
node_modules\cron-parser\lib\expression.js:137:CronExpression._isValidConstraintChar = function _isValidConstraintChar(constraints, value) {
node_modules\cron-parser\lib\expression.js:156:CronExpression._parseField = function _parseField (field, value, constraints) {
node_modules\cron-parser\lib\expression.js:161:      var aliases = CronExpression.aliases[field];
node_modules\cron-parser\lib\expression.js:176:  if (!(CronExpression.validCharacters[field].test(value))) {
node_modules\cron-parser\lib\expression.js:210:          if (CronExpression._isValidConstraintChar(constraints, value)) {
node_modules\cron-parser\lib\expression.js:226:        if (CronExpression._isValidConstraintChar(constraints, result)) {
node_modules\cron-parser\lib\expression.js:264:    stack.sort(CronExpression._sortCompareFn);
node_modules\cron-parser\lib\expression.js:366:CronExpression._sortCompareFn = function(a, b) {
node_modules\cron-parser\lib\expression.js:385:CronExpression._handleMaxDaysInMonth = function(mappedFields) {
node_modules\cron-parser\lib\expression.js:388:    var daysInMonth = CronExpression.daysInMonth[mappedFields.month[0] - 1];
node_modules\cron-parser\lib\expression.js:398:      .sort(CronExpression._sortCompareFn);
node_modules\cron-parser\lib\expression.js:402:CronExpression._freezeFields = function(fields) {
node_modules\cron-parser\lib\expression.js:403:  for (var i = 0, c = CronExpression.map.length; i < c; ++i) {
node_modules\cron-parser\lib\expression.js:404:    var field = CronExpression.map[i]; // Field name
node_modules\cron-parser\lib\expression.js:411:CronExpression.prototype._applyTimezoneShift = function(currentDate, dateMathVerb, method) {
node_modules\cron-parser\lib\expression.js:453: * @return {CronDate}
node_modules\cron-parser\lib\expression.js:456:CronExpression.prototype._findSchedule = function _findSchedule (reverse) {
node_modules\cron-parser\lib\expression.js:480:   * @param {CronDate} date
node_modules\cron-parser\lib\expression.js:520:  var currentDate = new CronDate(this._currentDate, this._tz);
node_modules\cron-parser\lib\expression.js:569:    // http://unixhelp.ed.ac.uk/CGI/man-cgi?crontab+5
node_modules\cron-parser\lib\expression.js:580:    var isDayOfMonthWildcardMatch = this.fields.dayOfMonth.length >= CronExpression.daysInMonth[currentDate.getMonth()];
node_modules\cron-parser\lib\expression.js:581:    var isDayOfWeekWildcardMatch = this.fields.dayOfWeek.length === CronExpression.constraints[5].max - CronExpression.constraints[5].min + 1;
node_modules\cron-parser\lib\expression.js:666:  this._currentDate = new CronDate(currentDate, this._tz);
node_modules\cron-parser\lib\expression.js:676: * @return {CronDate|Object}
node_modules\cron-parser\lib\expression.js:678:CronExpression.prototype.next = function next () {
node_modules\cron-parser\lib\expression.js:696: * @return {CronDate|Object}
node_modules\cron-parser\lib\expression.js:698:CronExpression.prototype.prev = function prev () {
node_modules\cron-parser\lib\expression.js:718:CronExpression.prototype.hasNext = function() {
node_modules\cron-parser\lib\expression.js:739:CronExpression.prototype.hasPrev = function() {
node_modules\cron-parser\lib\expression.js:762:CronExpression.prototype.iterate = function iterate (steps, callback) {
node_modules\cron-parser\lib\expression.js:803:CronExpression.prototype.reset = function reset (newDate) {
node_modules\cron-parser\lib\expression.js:804:  this._currentDate = new CronDate(newDate || this._options.currentDate);
node_modules\cron-parser\lib\expression.js:814:CronExpression.prototype.stringify = function stringify(includeSeconds) {
node_modules\cron-parser\lib\expression.js:816:  for (var i = includeSeconds ? 0 : 1, c = CronExpression.map.length; i < c; ++i) {
node_modules\cron-parser\lib\expression.js:817:    var field = CronExpression.map[i];
node_modules\cron-parser\lib\expression.js:819:    var constraint = CronExpression.constraints[i];
node_modules\cron-parser\lib\expression.js:822:      constraint = { min: 1, max: CronExpression.daysInMonth[this.fields.month[0] - 1] };
node_modules\cron-parser\lib\expression.js:841:CronExpression.parse = function parse(expression, options) {
node_modules\cron-parser\lib\expression.js:853:      options.currentDate = new CronDate(undefined, self._tz);
node_modules\cron-parser\lib\expression.js:857:    if (CronExpression.predefined[expression]) {
node_modules\cron-parser\lib\expression.js:858:      expression = CronExpression.predefined[expression];
node_modules\cron-parser\lib\expression.js:866:      throw new Error('Invalid cron expression');
node_modules\cron-parser\lib\expression.js:870:    var start = (CronExpression.map.length - atoms.length);
node_modules\cron-parser\lib\expression.js:871:    for (var i = 0, c = CronExpression.map.length; i < c; ++i) {
node_modules\cron-parser\lib\expression.js:872:      var field = CronExpression.map[i]; // Field name
node_modules\cron-parser\lib\expression.js:876:        fields.push(CronExpression._parseField(
node_modules\cron-parser\lib\expression.js:878:          CronExpression.parseDefaults[i],
node_modules\cron-parser\lib\expression.js:879:          CronExpression.constraints[i]
node_modules\cron-parser\lib\expression.js:885:        fields.push(CronExpression._parseField(
node_modules\cron-parser\lib\expression.js:888:          CronExpression.constraints[i]
node_modules\cron-parser\lib\expression.js:895:    for (var i = 0, c = CronExpression.map.length; i < c; i++) {
node_modules\cron-parser\lib\expression.js:896:      var key = CronExpression.map[i];
node_modules\cron-parser\lib\expression.js:900:    var dayOfMonth = CronExpression._handleMaxDaysInMonth(mappedFields);
node_modules\cron-parser\lib\expression.js:902:    return new CronExpression(mappedFields, options);
node_modules\cron-parser\lib\expression.js:942: * Convert cron fields back to Cron Expression
node_modules\cron-parser\lib\expression.js:949:CronExpression.fieldsToExpression = function fieldsToExpression(fields, options) {
node_modules\cron-parser\lib\expression.js:960:      if (CronExpression._isValidConstraintChar(constraints, value)) {
node_modules\cron-parser\lib\expression.js:975:  for (var i = 0, c = CronExpression.map.length; i < c; ++i) {
node_modules\cron-parser\lib\expression.js:976:    var field = CronExpression.map[i]; // Field name
node_modules\cron-parser\lib\expression.js:981:      CronExpression.constraints[i]
node_modules\cron-parser\lib\expression.js:988:    values = copy.sort(CronExpression._sortCompareFn)
node_modules\cron-parser\lib\expression.js:997:  var dayOfMonth = CronExpression._handleMaxDaysInMonth(mappedFields);
node_modules\cron-parser\lib\expression.js:999:  return new CronExpression(mappedFields, options || {});
node_modules\cron-parser\lib\expression.js:1002:module.exports = CronExpression;
node_modules\cron-parser\lib\parser.js:3:var CronExpression = require('./expression');
node_modules\cron-parser\lib\parser.js:5:function CronParser() {}
node_modules\cron-parser\lib\parser.js:8: * Parse crontab entry
node_modules\cron-parser\lib\parser.js:11: * @param {String} entry Crontab file entry/line
node_modules\cron-parser\lib\parser.js:13:CronParser._parseEntry = function _parseEntry (entry) {
node_modules\cron-parser\lib\parser.js:18:      interval: CronExpression.parse(entry)
node_modules\cron-parser\lib\parser.js:22:      interval: CronExpression.parse(
node_modules\cron-parser\lib\parser.js:33: * Wrapper for CronExpression.parser method
node_modules\cron-parser\lib\parser.js:40:CronParser.parseExpression = function parseExpression (expression, options) {
node_modules\cron-parser\lib\parser.js:41:  return CronExpression.parse(expression, options);
node_modules\cron-parser\lib\parser.js:45: * Wrapper for CronExpression.fieldsToExpression method
node_modules\cron-parser\lib\parser.js:52:CronParser.fieldsToExpression = function fieldsToExpression (fields, options) {
node_modules\cron-parser\lib\parser.js:53:  return CronExpression.fieldsToExpression(fields, options);
node_modules\cron-parser\lib\parser.js:60: * @param {String} data Crontab content
node_modules\cron-parser\lib\parser.js:63:CronParser.parseString = function parseString (data) {
node_modules\cron-parser\lib\parser.js:86:          result = CronParser._parseEntry('0 ' + entry);
node_modules\cron-parser\lib\parser.js:99: * Parse crontab file
node_modules\cron-parser\lib\parser.js:105:CronParser.parseFile = function parseFile (filePath, callback) {
node_modules\cron-parser\lib\parser.js:112:    return callback(null, CronParser.parseString(data.toString()));
node_modules\cron-parser\lib\parser.js:116:module.exports = CronParser;
node_modules\esprima\dist\esprima.js:6420:          Omicron: '\u039F',
node_modules\esprima\dist\esprima.js:6444:          omicron: '\u03BF',
node_modules\exifr\dist\full.esm.js:1:var e="undefined"!=typeof self?self:global;const t="undefined"!=typeof navigator,i=t&&"undefined"==typeof HTMLImageElement,n=!("undefined"==typeof global||"undefined"==typeof process||!process.versions||!process.versions.node),s=e.Buffer,r=e.BigInt,a=!!s,o=e=>e;function l(e,t=o){if(n)try{return"function"==typeof require?Promise.resolve(t(require(e))):import(/* webpackIgnore: true */ e).then(t)}catch(t){console.warn(`Couldn't load ${e}`)}}let h=e.fetch;const u=e=>h=e;if(!e.fetch){const e=l("http",(e=>e)),t=l("https",(e=>e)),i=(n,{headers:s}={})=>new Promise((async(r,a)=>{let{port:o,hostname:l,pathname:h,protocol:u,search:c}=new URL(n);const f={method:"GET",hostname:l,path:encodeURI(h)+c,headers:s};""!==o&&(f.port=Number(o));const d=("https:"===u?await t:await e).request(f,(e=>{if(301===e.statusCode||302===e.statusCode){let t=new URL(e.headers.location,n).toString();return i(t,{headers:s}).then(r).catch(a)}r({status:e.statusCode,arrayBuffer:()=>new Promise((t=>{let i=[];e.on("data",(e=>i.push(e))),e.on("end",(()=>t(Buffer.concat(i))))}))})}));d.on("error",a),d.end()}));u(i)}function c(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const f=e=>p(e)?void 0:e,d=e=>void 0!==e;function p(e){return void 0===e||(e instanceof Map?0===e.size:0===Object.values(e).filter(d).length)}function g(e){let t=new Error(e);throw delete t.stack,t}function m(e){return""===(e=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(e).trim())?void 0:e}function S(e){let t=function(e){let t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}const C=e=>String.fromCharCode.apply(null,e),y="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;function b(e){return y?y.decode(e):a?Buffer.from(e).toString("utf8"):decodeURIComponent(escape(C(e)))}class I{static from(e,t){return e instanceof this&&e.le===t?e:new I(e,void 0,void 0,t)}constructor(e,t=0,i,n){if("boolean"==typeof n&&(this.le=n),Array.isArray(e)&&(e=new Uint8Array(e)),0===e)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){void 0===i&&(i=e.byteLength-t);let n=new DataView(e,t,i);this._swapDataView(n)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof I){void 0===i&&(i=e.byteLength-t),(t+=e.byteOffset)+i>e.byteOffset+e.byteLength&&g("Creating view outside of available memory in ArrayBuffer");let n=new DataView(e.buffer,t,i);this._swapDataView(n)}else if("number"==typeof e){let t=new DataView(new ArrayBuffer(e));this._swapDataView(t)}else g("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,i=I){return e instanceof DataView||e instanceof I?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||g("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new i(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new I(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return b(this.getUint8Array(e,t))}getLatin1String(e=0,t=this.byteLength){let i=this.getUint8Array(e,t);return C(i)}getUnicodeString(e=0,t=this.byteLength){const i=[];for(let n=0;n<t&&e+n<this.byteLength;n+=2)i.push(this.getUint16(e+n));return C(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,i){switch(t){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,t,i){switch(t){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function P(e,t){g(`${e} '${t}' was not loaded, try using full build of exifr.`)}class k extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||P(this.kind,e),t&&(e in t||function(e,t){g(`Unknown ${e} '${t}'.`)}(this.kind,e),t[e].enabled||P(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var w=new k("file parser"),T=new k("segment parser"),A=new k("file reader");function D(e,n){return"string"==typeof e?O(e,n):t&&!i&&e instanceof HTMLImageElement?O(e.src,n):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new I(e):t&&e instanceof Blob?x(e,n,"blob",R):void g("Invalid input argument")}function O(e,i){return(s=e).startsWith("data:")||s.length>1e4?v(e,i,"base64"):n&&e.includes("://")?x(e,i,"url",M):n?v(e,i,"fs"):t?x(e,i,"url",M):void g("Invalid input argument");var s}async function x(e,t,i,n){return A.has(i)?v(e,t,i):n?async function(e,t){let i=await t(e);return new I(i)}(e,n):void g(`Parser ${i} is not loaded`)}async function v(e,t,i){let n=new(A.get(i))(e,t);return await n.read(),n}const M=e=>h(e).then((e=>e.arrayBuffer())),R=e=>new Promise(((t,i)=>{let n=new FileReader;n.onloadend=()=>t(n.result||new ArrayBuffer),n.onerror=i,n.readAsArrayBuffer(e)}));class L extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function U(e,t,i){let n=new L;for(let[e,t]of i)n.set(e,t);if(Array.isArray(t))for(let i of t)e.set(i,n);else e.set(t,n);return n}function F(e,t,i){let n,s=e.get(t);for(n of i)s.set(n[0],n[1])}const E=new Map,B=new Map,N=new Map,G=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],V=["jfif","xmp","icc","iptc","ihdr"],z=["tiff",...V],H=["ifd0","ifd1","exif","gps","interop"],j=[...z,...H],W=["makerNote","userComment"],K=["translateKeys","translateValues","reviveValues","multiSegment"],X=[...K,"sanitize","mergeOutput","silentErrors"];class _{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class Y extends _{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,i,n){if(super(),c(this,"enabled",!1),c(this,"skip",new Set),c(this,"pick",new Set),c(this,"deps",new Set),c(this,"translateKeys",!1),c(this,"translateValues",!1),c(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(n),this.canBeFiltered=H.includes(e),this.canBeFiltered&&(this.dict=E.get(e)),void 0!==i)if(Array.isArray(i))this.parse=this.enabled=!0,this.canBeFiltered&&i.length>0&&this.translateTagSet(i,this.pick);else if("object"==typeof i){if(this.enabled=!0,this.parse=!1!==i.parse,this.canBeFiltered){let{pick:e,skip:t}=i;e&&e.length>0&&this.translateTagSet(e,this.pick),t&&t.length>0&&this.translateTagSet(t,this.skip)}this.applyInheritables(i)}else!0===i||!1===i?this.parse=this.enabled=i:g(`Invalid options argument: ${i}`)}applyInheritables(e){let t,i;for(t of K)i=e[t],void 0!==i&&(this[t]=i)}translateTagSet(e,t){if(this.dict){let i,n,{tagKeys:s,tagValues:r}=this.dict;for(i of e)"string"==typeof i?(n=r.indexOf(i),-1===n&&(n=s.indexOf(Number(i))),-1!==n&&t.add(Number(s[n]))):t.add(i)}else for(let i of e)t.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,ee(this.pick,this.deps)):this.enabled&&this.pick.size>0&&ee(this.pick,this.deps)}}var $={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},J=new Map;class q extends _{static useCached(e){let t=J.get(e);return void 0!==t||(t=new this(e),J.set(e,t)),t}constructor(e){super(),!0===e?this.setupFromTrue():void 0===e?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):"object"==typeof e?this.setupFromObject(e):g(`Invalid options argument ${e}`),void 0===this.firstChunkSize&&(this.firstChunkSize=t?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of G)this[e]=$[e];for(e of X)this[e]=$[e];for(e of W)this[e]=$[e];for(e of j)this[e]=new Y(e,$[e],void 0,this)}setupFromTrue(){let e;for(e of G)this[e]=$[e];for(e of X)this[e]=$[e];for(e of W)this[e]=!0;for(e of j)this[e]=new Y(e,!0,void 0,this)}setupFromArray(e){let t;for(t of G)this[t]=$[t];for(t of X)this[t]=$[t];for(t of W)this[t]=$[t];for(t of j)this[t]=new Y(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,H)}setupFromObject(e){let t;for(t of(H.ifd0=H.ifd0||H.image,H.ifd1=H.ifd1||H.thumbnail,Object.assign(this,e),G))this[t]=Z(e[t],$[t]);for(t of X)this[t]=Z(e[t],$[t]);for(t of W)this[t]=Z(e[t],$[t]);for(t of z)this[t]=new Y(t,$[t],e[t],this);for(t of H)this[t]=new Y(t,$[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,H,j),!0===e.tiff?this.batchEnableWithBool(H,!0):!1===e.tiff?this.batchEnableWithUserValue(H,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,H):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,H)}batchEnableWithBool(e,t){for(let i of e)this[i].enabled=t}batchEnableWithUserValue(e,t){for(let i of e){let e=t[i];this[i].enabled=!1!==e&&void 0!==e}}setupGlobalFilters(e,t,i,n=i){if(e&&e.length){for(let e of n)this[e].enabled=!1;let t=Q(e,i);for(let[e,i]of t)ee(this[e].pick,i),this[e].enabled=!0}else if(t&&t.length){let e=Q(t,i);for(let[t,i]of e)ee(this[t].skip,i)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:i,iptc:n,icc:s}=this;this.makerNote?t.deps.add(37500):t.skip.add(37500),this.userComment?t.deps.add(37510):t.skip.add(37510),i.enabled||e.skip.add(700),n.enabled||e.skip.add(33723),s.enabled||e.skip.add(34675)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:i,interop:n}=this;n.needed&&(t.deps.add(40965),e.deps.add(40965)),t.needed&&e.deps.add(34665),i.needed&&e.deps.add(34853),this.tiff.enabled=H.some((e=>!0===this[e].enabled))||this.makerNote||this.userComment;for(let e of H)this[e].finalizeFilters()}get onlyTiff(){return!V.map((e=>this[e].enabled)).some((e=>!0===e))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of z)this[e].enabled&&!T.has(e)&&P("segment parser",e)}}function Q(e,t){let i,n,s,r,a=[];for(s of t){for(r of(i=E.get(s),n=[],i))(e.includes(r[0])||e.includes(r[1]))&&n.push(r[0]);n.length&&a.push([s,n])}return a}function Z(e,t){return void 0!==e?e:void 0!==t?t:void 0}function ee(e,t){for(let i of t)e.add(i)}c(q,"default",$);class te{constructor(e){c(this,"parsers",{}),c(this,"output",{}),c(this,"errors",[]),c(this,"pushToErrors",(e=>this.errors.push(e))),this.options=q.useCached(e)}async read(e){this.file=await D(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[i,n]of w)if(n.canHandle(e,t))return this.fileParser=new n(this.options,this.file,this.parsers),e[i]=!0;this.file.close&&this.file.close(),g("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),f(e)}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map((async t=>{let i=await t.parse();t.assignToOutput(e,i)}));this.options.silentErrors&&(t=t.map((e=>e.catch(this.pushToErrors)))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,i=T.get("tiff",e);var n;if(t.tiff?n={start:0,type:"tiff"}:t.jpeg&&(n=await this.fileParser.getOrFindSegment("tiff")),void 0===n)return;let s=await this.fileParser.ensureSegmentChunk(n),r=this.parsers.tiff=new i(s,e,t),a=await r.extractThumbnail();return t.close&&t.close(),a}}async function ie(e,t){let i=new te(t);return await i.read(e),i.parse()}var ne=Object.freeze({__proto__:null,parse:ie,Exifr:te,fileParsers:w,segmentParsers:T,fileReaders:A,tagKeys:E,tagValues:B,tagRevivers:N,createDictionary:U,extendDictionary:F,fetchUrlAsArrayBuffer:M,readBlobAsArrayBuffer:R,chunkedProps:G,otherSegments:V,segments:z,tiffBlocks:H,segmentsAndBlocks:j,tiffExtractables:W,inheritables:K,allFormatters:X,Options:q});class se{constructor(e,t,i){c(this,"errors",[]),c(this,"ensureSegmentChunk",(async e=>{let t=e.start,i=e.size||65536;if(this.file.chunked)if(this.file.available(t,i))e.chunk=this.file.subarray(t,i);else try{e.chunk=await this.file.readChunk(t,i)}catch(t){g(`Couldn't read segment: ${JSON.stringify(e)}. ${t.message}`)}else this.file.byteLength>t+i?e.chunk=this.file.subarray(t,i):void 0===e.size?e.chunk=this.file.subarray(t):g("Segment unreachable: "+JSON.stringify(e));return e.chunk})),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=i}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let i=new(T.get(e))(t,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let t of e){let{type:e,chunk:i}=t,n=this.options[e];if(n&&n.enabled){let t=this.parsers[e];t&&t.append||t||this.createParser(e,i)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}class re{static findPosition(e,t){let i=e.getUint16(t+2)+2,n="function"==typeof this.headerLength?this.headerLength(e,t,i):this.headerLength,s=t+n,r=i-n;return{offset:t,length:i,headerLength:n,start:s,size:r,end:s+r}}static parse(e,t={}){return new this(e,new q({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof I?e:new I(e)}constructor(e,t={},i){c(this,"errors",[]),c(this,"raw",new Map),c(this,"handleError",(e=>{if(!this.options.silentErrors)throw e;this.errors.push(e.message)})),this.chunk=this.normalizeInput(e),this.file=i,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let i=N.get(t),n=B.get(t),s=E.get(t),r=this.options[t],a=r.reviveValues&&!!i,o=r.translateValues&&!!n,l=r.translateKeys&&!!s,h={};for(let[t,r]of e)a&&i.has(t)?r=i.get(t)(r):o&&n.has(t)&&(r=this.translateValue(r,n.get(t))),l&&s.has(t)&&(t=s.get(t)||t),h[t]=r;return h}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[t]?Object.assign(e[t],i):e[t]=i}}c(re,"headerLength",4),c(re,"type",void 0),c(re,"multiSegment",!1),c(re,"canHandle",(()=>!1));function ae(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function oe(e){return e>=224&&e<=239}function le(e,t,i){for(let[n,s]of T)if(s.canHandle(e,t,i))return n}class he extends se{constructor(...e){super(...e),c(this,"appSegments",[]),c(this,"jpegSegments",[]),c(this,"unknownSegments",[])}static canHandle(e,t){return 65496===t}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){!0===e?(this.findAll=!0,this.wanted=new Set(T.keyList())):(e=void 0===e?T.keyList().filter((e=>this.options[e].enabled)):e.filter((e=>this.options[e].enabled&&T.has(e))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:i,findAll:n,wanted:s,remaining:r}=this;if(!n&&this.file.chunked&&(n=Array.from(s).some((e=>{let t=T.get(e),i=this.options[e];return t.multiSegment&&i.multiSegment})),n&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let t=!1;for(;r.size>0&&!t&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:n}=i,s=this.appSegments.some((e=>!this.file.available(e.offset||e.start,e.length||e.size)));if(t=e>n&&!s?!await i.readNextChunk(e):!await i.readNextChunk(n),void 0===(e=this.findAppSegmentsInRange(e,i.byteLength)))return}}}findAppSegmentsInRange(e,t){t-=2;let i,n,s,r,a,o,{file:l,findAll:h,wanted:u,remaining:c,options:f}=this;for(;e<t;e++)if(255===l.getUint8(e))if(i=l.getUint8(e+1),oe(i)){if(n=l.getUint16(e+2),s=le(l,e,n),s&&u.has(s)&&(r=T.get(s),a=r.findPosition(l,e),o=f[s],a.type=s,this.appSegments.push(a),!h&&(r.multiSegment&&o.multiSegment?(this.unfinishedMultiSegment=a.chunkNumber<a.chunkCount,this.unfinishedMultiSegment||c.delete(s)):c.delete(s),0===c.size)))break;f.recordUnknownSegments&&(a=re.findPosition(l,e),a.marker=i,this.unknownSegments.push(a)),e+=n+1}else if(ae(i)){if(n=l.getUint16(e+2),218===i&&!1!==f.stopAfterSos)return;f.recordJpegSegments&&this.jpegSegments.push({offset:e,length:n,marker:i}),e+=n+1}return e}mergeMultiSegments(){if(!this.appSegments.some((e=>e.multiSegment)))return;let e=function(e,t){let i,n,s,r=new Map;for(let a=0;a<e.length;a++)i=e[a],n=i[t],r.has(n)?s=r.get(n):r.set(n,s=[]),s.push(i);return Array.from(r)}(this.appSegments,"type");this.mergedAppSegments=e.map((([e,t])=>{let i=T.get(e,this.options);if(i.handleMultiSegments){return{type:e,chunk:i.handleMultiSegments(t)}}return t[0]}))}getSegment(e){return this.appSegments.find((t=>t.type===e))}async getOrFindSegment(e){let t=this.getSegment(e);return void 0===t&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}c(he,"type","jpeg"),w.set("jpeg",he);const ue=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class ce extends re{parseHeader(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,i=new Map){let{pick:n,skip:s}=this.options[t];n=new Set(n);let r=n.size>0,a=0===s.size,o=this.chunk.getUint16(e);e+=2;for(let l=0;l<o;l++){let o=this.chunk.getUint16(e);if(r){if(n.has(o)&&(i.set(o,this.parseTag(e,o,t)),n.delete(o),0===n.size))break}else!a&&s.has(o)||i.set(o,this.parseTag(e,o,t));e+=12}return i}parseTag(e,t,i){let{chunk:n}=this,s=n.getUint16(e+2),r=n.getUint32(e+4),a=ue[s];if(a*r<=4?e+=8:e=n.getUint32(e+8),(s<1||s>13)&&g(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e}`),e>n.byteLength&&g(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e} is outside of chunk size ${n.byteLength}`),1===s)return n.getUint8Array(e,r);if(2===s)return m(n.getString(e,r));if(7===s)return n.getUint8Array(e,r);if(1===r)return this.parseTagValue(s,e);{let t=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(s))(r),i=a;for(let n=0;n<r;n++)t[n]=this.parseTagValue(s,e),e+=i;return t}}parseTagValue(e,t){let{chunk:i}=this;switch(e){case 1:return i.getUint8(t);case 3:return i.getUint16(t);case 4:return i.getUint32(t);case 5:return i.getUint32(t)/i.getUint32(t+4);case 6:return i.getInt8(t);case 8:return i.getInt16(t);case 9:return i.getInt32(t);case 10:return i.getInt32(t)/i.getInt32(t+4);case 11:return i.getFloat(t);case 12:return i.getDouble(t);case 13:return i.getUint32(t);default:g(`Invalid tiff type ${e}`)}}}class fe extends ce{static canHandle(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}findIfd0Offset(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(void 0===this.ifd1Offset){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let i=new Map;return this[t]=i,this.parseTags(e,t,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&g("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&g(`IFD0 offset points to outside of file.\nthis.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,S(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return 0!==t.size?(this.exifOffset=t.get(34665),this.interopOffset=t.get(40965),this.gpsOffset=t.get(34853),this.xmp=t.get(700),this.iptc=t.get(33723),this.icc=t.get(34675),this.options.sanitize&&(t.delete(34665),t.delete(40965),t.delete(34853),t.delete(700),t.delete(33723),t.delete(34675)),t):void 0}async parseExifBlock(){if(this.exif)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.exifOffset)return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,S(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(40965)),this.makerNote=e.get(37500),this.userComment=e.get(37510),this.options.sanitize&&(e.delete(40965),e.delete(37500),e.delete(37510)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let i=e.get(t);i&&1===i.length&&e.set(t,i[0])}async parseGpsBlock(){if(this.gps)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.gpsOffset)return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",de(...e.get(2),e.get(1))),e.set("longitude",de(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),void 0!==this.interopOffset||this.exif||await this.parseExifBlock(),void 0!==this.interopOffset))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),void 0===this.ifd1)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,i,n={};for(t of H)if(e=this[t],!p(e))if(i=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if("ifd1"===t)continue;Object.assign(n,i)}else n[t]=i;return this.makerNote&&(n.makerNote=this.makerNote),this.userComment&&(n.userComment=this.userComment),n}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[i,n]of Object.entries(t))this.assignObjectToOutput(e,i,n)}}function de(e,t,i,n){var s=e+t/60+i/3600;return"S"!==n&&"W"!==n||(s*=-1),s}c(fe,"type","tiff"),c(fe,"headerLength",10),T.set("tiff",fe);var pe=Object.freeze({__proto__:null,default:ne,Exifr:te,fileParsers:w,segmentParsers:T,fileReaders:A,tagKeys:E,tagValues:B,tagRevivers:N,createDictionary:U,extendDictionary:F,fetchUrlAsArrayBuffer:M,readBlobAsArrayBuffer:R,chunkedProps:G,otherSegments:V,segments:z,tiffBlocks:H,segmentsAndBlocks:j,tiffExtractables:W,inheritables:K,allFormatters:X,Options:q,parse:ie});const ge={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},me=Object.assign({},ge,{firstChunkSize:4e4,gps:[1,2,3,4]});async function Se(e){let t=new te(me);await t.read(e);let i=await t.parse();if(i&&i.gps){let{latitude:e,longitude:t}=i.gps;return{latitude:e,longitude:t}}}const Ce=Object.assign({},ge,{tiff:!1,ifd1:!0,mergeOutput:!1});async function ye(e){let t=new te(Ce);await t.read(e);let i=await t.extractThumbnail();return i&&a?s.from(i):i}async function be(e){let t=await this.thumbnail(e);if(void 0!==t){let e=new Blob([t]);return URL.createObjectURL(e)}}const Ie=Object.assign({},ge,{firstChunkSize:4e4,ifd0:[274]});async function Pe(e){let t=new te(Ie);await t.read(e);let i=await t.parse();if(i&&i.ifd0)return i.ifd0[274]}const ke=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});let we=!0,Te=!0;if("object"==typeof navigator){let e=navigator.userAgent;if(e.includes("iPad")||e.includes("iPhone")){let t=e.match(/OS (\d+)_(\d+)/);if(t){let[,e,i]=t,n=Number(e)+.1*Number(i);we=n<13.4,Te=!1}}else if(e.includes("OS X 10")){let[,t]=e.match(/OS X 10[_.](\d+)/);we=Te=Number(t)<15}if(e.includes("Chrome/")){let[,t]=e.match(/Chrome\/(\d+)/);we=Te=Number(t)<81}else if(e.includes("Firefox/")){let[,t]=e.match(/Firefox\/(\d+)/);we=Te=Number(t)<77}}async function Ae(e){let t=await Pe(e);return Object.assign({canvas:we,css:Te},ke[t])}class De extends I{constructor(...e){super(...e),c(this,"ranges",new Oe),0!==this.byteLength&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,i){if(0===e&&0===this.byteLength&&i){let e=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(e)}else{let i=e+t;if(i>this.byteLength){let{dataView:e}=this._extend(i);this._swapDataView(e)}}}_extend(e){let t;t=a?s.allocUnsafe(e):new Uint8Array(e);let i=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:i}}subarray(e,t,i=!1){return t=t||this._lengthToEnd(e),i&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,i=!1){i&&this._tryExtend(t,e.byteLength,e);let n=super.set(e,t);return this.ranges.add(t,n.byteLength),n}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class Oe{constructor(){c(this,"list",[])}get length(){return this.list.length}add(e,t,i=0){let n=e+t,s=this.list.filter((t=>xe(e,t.offset,n)||xe(e,t.end,n)));if(s.length>0){e=Math.min(e,...s.map((e=>e.offset))),n=Math.max(n,...s.map((e=>e.end))),t=n-e;let i=s.shift();i.offset=e,i.length=t,i.end=n,this.list=this.list.filter((e=>!s.includes(e)))}else this.list.push({offset:e,length:t,end:n})}available(e,t){let i=e+t;return this.list.some((t=>t.offset<=e&&i<=t.end))}}function xe(e,t,i){return e<=t&&t<=i}class ve extends De{constructor(e,t){super(0),c(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,i=await this.readChunk(e,t);return!!i&&i.byteLength===t}async readChunk(e,t){if(this.chunksRead++,0!==(t=this.safeWrapAddress(e,t)))return this._readChunk(e,t)}safeWrapAddress(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return void 0!==this.size&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}A.set("blob",class extends ve{async readWhole(){this.chunked=!1;let e=await R(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let i=t?e+t:void 0,n=this.input.slice(e,i),s=await R(n);return this.set(s,e,!0)}});var Me=Object.freeze({__proto__:null,default:pe,Exifr:te,fileParsers:w,segmentParsers:T,fileReaders:A,tagKeys:E,tagValues:B,tagRevivers:N,createDictionary:U,extendDictionary:F,fetchUrlAsArrayBuffer:M,readBlobAsArrayBuffer:R,chunkedProps:G,otherSegments:V,segments:z,tiffBlocks:H,segmentsAndBlocks:j,tiffExtractables:W,inheritables:K,allFormatters:X,Options:q,parse:ie,gpsOnlyOptions:me,gps:Se,thumbnailOnlyOptions:Ce,thumbnail:ye,thumbnailUrl:be,orientationOnlyOptions:Ie,orientation:Pe,rotations:ke,get rotateCanvas(){return we},get rotateCss(){return Te},rotation:Ae});A.set("url",class extends ve{async readWhole(){this.chunked=!1;let e=await M(this.input);e instanceof ArrayBuffer?this._swapArrayBuffer(e):e instanceof Uint8Array&&this._swapBuffer(e)}async _readChunk(e,t){let i=t?e+t-1:void 0,n=this.options.httpHeaders||{};(e||i)&&(n.range=`bytes=${[e,i].join("-")}`);let s=await h(this.input,{headers:n}),r=await s.arrayBuffer(),a=r.byteLength;if(416!==s.status)return a!==t&&(this.size=e+a),this.set(r,e,!0)}});I.prototype.getUint64=function(e){let t=this.getUint32(e),i=this.getUint32(e+4);return t<1048575?t<<32|i:void 0!==typeof r?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),r(t)<<r(32)|r(i)):void g("Trying to read 64b value but JS can only handle 53b numbers.")};class Re extends se{parseBoxes(e=0){let t=[];for(;e<this.file.byteLength-4;){let i=this.parseBoxHead(e);if(t.push(i),0===i.length)break;e+=i.length}return t}parseSubBoxes(e){e.boxes=this.parseBoxes(e.start)}findBox(e,t){return void 0===e.boxes&&this.parseSubBoxes(e),e.boxes.find((e=>e.kind===t))}parseBoxHead(e){let t=this.file.getUint32(e),i=this.file.getString(e+4,4),n=e+8;return 1===t&&(t=this.file.getUint64(e+8),n+=8),{offset:e,length:t,kind:i,start:n}}parseBoxFullHead(e){if(void 0!==e.version)return;let t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}class Le extends Re{static canHandle(e,t){if(0!==t)return!1;let i=e.getUint16(2);if(i>50)return!1;let n=16,s=[];for(;n<i;)s.push(e.getString(n,4)),n+=4;return s.includes(this.type)}async parse(){let e=this.file.getUint32(0),t=this.parseBoxHead(e);for(;"meta"!==t.kind;)e+=t.length,await this.file.ensureChunk(e,16),t=this.parseBoxHead(e);await this.file.ensureChunk(t.offset,t.length),this.parseBoxFullHead(t),this.parseSubBoxes(t),this.options.icc.enabled&&await this.findIcc(t),this.options.tiff.enabled&&await this.findExif(t)}async registerSegment(e,t,i){await this.file.ensureChunk(t,i);let n=this.file.subarray(t,i);this.createParser(e,n)}async findIcc(e){let t=this.findBox(e,"iprp");if(void 0===t)return;let i=this.findBox(t,"ipco");if(void 0===i)return;let n=this.findBox(i,"colr");void 0!==n&&await this.registerSegment("icc",n.offset+12,n.length)}async findExif(e){let t=this.findBox(e,"iinf");if(void 0===t)return;let i=this.findBox(e,"iloc");if(void 0===i)return;let n=this.findExifLocIdInIinf(t),s=this.findExtentInIloc(i,n);if(void 0===s)return;let[r,a]=s;await this.file.ensureChunk(r,a);let o=4+this.file.getUint32(r);r+=o,a-=o,await this.registerSegment("tiff",r,a)}findExifLocIdInIinf(e){this.parseBoxFullHead(e);let t,i,n,s,r=e.start,a=this.file.getUint16(r);for(r+=2;a--;){if(t=this.parseBoxHead(r),this.parseBoxFullHead(t),i=t.start,t.version>=2&&(n=3===t.version?4:2,s=this.file.getString(i+n+2,4),"Exif"===s))return this.file.getUintBytes(i,n);r+=t.length}}get8bits(e){let t=this.file.getUint8(e);return[t>>4,15&t]}findExtentInIloc(e,t){this.parseBoxFullHead(e);let i=e.start,[n,s]=this.get8bits(i++),[r,a]=this.get8bits(i++),o=2===e.version?4:2,l=1===e.version||2===e.version?2:0,h=a+n+s,u=2===e.version?4:2,c=this.file.getUintBytes(i,u);for(i+=u;c--;){let e=this.file.getUintBytes(i,o);i+=o+l+2+r;let u=this.file.getUint16(i);if(i+=2,e===t)return u>1&&console.warn("ILOC box has more than one extent but we're only processing one\nPlease create an issue at https://github.com/MikeKovarik/exifr with this file"),[this.file.getUintBytes(i+a,n),this.file.getUintBytes(i+a+n,s)];i+=u*h}}}class Ue extends Le{}c(Ue,"type","heic");class Fe extends Le{}c(Fe,"type","avif"),w.set("heic",Ue),w.set("avif",Fe),U(E,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),U(E,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),U(E,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),U(B,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let Ee=U(B,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const Be={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};Ee.set(37392,Be),Ee.set(41488,Be);const Ne={0:"Normal",1:"Low",2:"High"};function Ge(e){return"object"==typeof e&&void 0!==e.length?e[0]:e}function Ve(e){let t=Array.from(e).slice(1);return t[1]>15&&(t=t.map((e=>String.fromCharCode(e)))),"0"!==t[2]&&0!==t[2]||t.pop(),t.join(".")}function ze(e){if("string"==typeof e){var[t,i,n,s,r,a]=e.trim().split(/[-: ]/g).map(Number),o=new Date(t,i-1,n);return Number.isNaN(s)||Number.isNaN(r)||Number.isNaN(a)||(o.setHours(s),o.setMinutes(r),o.setSeconds(a)),Number.isNaN(+o)?e:o}}function He(e){if("string"==typeof e)return e;let t=[];if(0===e[1]&&0===e[e.length-1])for(let i=0;i<e.length;i+=2)t.push(je(e[i+1],e[i]));else for(let i=0;i<e.length;i+=2)t.push(je(e[i],e[i+1]));return m(String.fromCodePoint(...t))}function je(e,t){return e<<8|t}Ee.set(41992,Ne),Ee.set(41993,Ne),Ee.set(41994,Ne),U(N,["ifd0","ifd1"],[[50827,function(e){return"string"!=typeof e?b(e):e}],[306,ze],[40091,He],[40092,He],[40093,He],[40094,He],[40095,He]]),U(N,"exif",[[40960,Ve],[36864,Ve],[36867,ze],[36868,ze],[40962,Ge],[40963,Ge]]),U(N,"gps",[[0,e=>Array.from(e).join(".")],[7,e=>Array.from(e).join(":")]]);class We extends re{static canHandle(e,t){return 225===e.getUint8(t+1)&&1752462448===e.getUint32(t+4)&&"http://ns.adobe.com/"===e.getString(t+4,"http://ns.adobe.com/".length)}static headerLength(e,t){return"http://ns.adobe.com/xmp/extension/"===e.getString(t+4,"http://ns.adobe.com/xmp/extension/".length)?79:4+"http://ns.adobe.com/xap/1.0/".length+1}static findPosition(e,t){let i=super.findPosition(e,t);return i.multiSegment=i.extended=79===i.headerLength,i.multiSegment?(i.chunkCount=e.getUint8(t+72),i.chunkNumber=e.getUint8(t+76),0!==e.getUint8(t+77)&&i.chunkNumber++):(i.chunkCount=1/0,i.chunkNumber=-1),i}static handleMultiSegments(e){return e.map((e=>e.chunk.getString())).join("")}normalizeInput(e){return"string"==typeof e?e:I.from(e).getString()}parse(e=this.chunk){if(!this.localOptions.parse)return e;e=function(e){let t={},i={};for(let e of Ze)t[e]=[],i[e]=0;return e.replace(et,((e,n,s)=>{if("<"===n){let n=++i[s];return t[s].push(n),`${e}#${n}`}return`${e}#${t[s].pop()}`}))}(e);let t=Xe.findAll(e,"rdf","Description");0===t.length&&t.push(new Xe("rdf","Description",void 0,e));let i,n={};for(let e of t)for(let t of e.properties)i=Je(t.ns,n),_e(t,i);return function(e){let t;for(let i in e)t=e[i]=f(e[i]),void 0===t&&delete e[i];return f(e)}(n)}assignToOutput(e,t){if(this.localOptions.parse)for(let[i,n]of Object.entries(t))switch(i){case"tiff":this.assignObjectToOutput(e,"ifd0",n);break;case"exif":this.assignObjectToOutput(e,"exif",n);break;case"xmlns":break;default:this.assignObjectToOutput(e,i,n)}else e.xmp=t}}c(We,"type","xmp"),c(We,"multiSegment",!0),T.set("xmp",We);class Ke{static findAll(e){return qe(e,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(Ke.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[3].slice(1,-1);return n=Qe(n),new Ke(t,i,n)}constructor(e,t,i){this.ns=e,this.name=t,this.value=i}serialize(){return this.value}}class Xe{static findAll(e,t,i){if(void 0!==t||void 0!==i){t=t||"[\\w\\d-]+",i=i||"[\\w\\d-]+";var n=new RegExp(`<(${t}):(${i})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else n=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return qe(e,n).map(Xe.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[4],s=e[8];return new Xe(t,i,n,s)}constructor(e,t,i,n){this.ns=e,this.name=t,this.attrString=i,this.innerXml=n,this.attrs=Ke.findAll(i),this.children=Xe.findAll(n),this.value=0===this.children.length?Qe(n):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return void 0!==this.value&&0===this.attrs.length&&0===this.children.length}get isListContainer(){return 1===this.children.length&&this.children[0].isList}get isList(){let{ns:e,name:t}=this;return"rdf"===e&&("Seq"===t||"Bag"===t||"Alt"===t)}get isListItem(){return"rdf"===this.ns&&"li"===this.name}serialize(){if(0===this.properties.length&&void 0===this.value)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return $e(this.children.map(Ye));if(this.isListItem&&1===this.children.length&&0===this.attrs.length)return this.children[0].serialize();let e={};for(let t of this.properties)_e(t,e);return void 0!==this.value&&(e.value=this.value),f(e)}}function _e(e,t){let i=e.serialize();void 0!==i&&(t[e.name]=i)}var Ye=e=>e.serialize(),$e=e=>1===e.length?e[0]:e,Je=(e,t)=>t[e]?t[e]:t[e]={};function qe(e,t){let i,n=[];if(!e)return n;for(;null!==(i=t.exec(e));)n.push(i);return n}function Qe(e){if(function(e){return null==e||"null"===e||"undefined"===e||""===e||""===e.trim()}(e))return;let t=Number(e);if(!Number.isNaN(t))return t;let i=e.toLowerCase();return"true"===i||"false"!==i&&e.trim()}const Ze=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],et=new RegExp(`(<|\\/)(${Ze.join("|")})`,"g");var tt=Object.freeze({__proto__:null,default:Me,Exifr:te,fileParsers:w,segmentParsers:T,fileReaders:A,tagKeys:E,tagValues:B,tagRevivers:N,createDictionary:U,extendDictionary:F,fetchUrlAsArrayBuffer:M,readBlobAsArrayBuffer:R,chunkedProps:G,otherSegments:V,segments:z,tiffBlocks:H,segmentsAndBlocks:j,tiffExtractables:W,inheritables:K,allFormatters:X,Options:q,parse:ie,gpsOnlyOptions:me,gps:Se,thumbnailOnlyOptions:Ce,thumbnail:ye,thumbnailUrl:be,orientationOnlyOptions:Ie,orientation:Pe,rotations:ke,get rotateCanvas(){return we},get rotateCss(){return Te},rotation:Ae});const it=["xmp","icc","iptc","tiff"],nt=()=>{};async function st(e,t,i){let n=new q(t);n.chunked=!1,void 0===i&&"string"==typeof e&&(i=function(e){let t=e.toLowerCase().split(".").pop();if(function(e){return"exif"===e||"tiff"===e||"tif"===e}(t))return"tiff";if(it.includes(t))return t}(e));let s=await D(e,n);if(i){if(it.includes(i))return rt(i,s,n);g("Invalid segment type")}else{if(function(e){let t=e.getString(0,50).trim();return t.includes("<?xpacket")||t.includes("<x:")}(s))return rt("xmp",s,n);for(let[e]of T){if(!it.includes(e))continue;let t=await rt(e,s,n).catch(nt);if(t)return t}g("Unknown file format")}}async function rt(e,t,i){let n=i[e];return n.enabled=!0,n.parse=!0,T.get(e).parse(t,n)}let at=l("fs",(e=>e.promises));A.set("fs",class extends ve{async readWhole(){this.chunked=!1,this.fs=await at;let e=await this.fs.readFile(this.input);this._swapBuffer(e)}async readChunked(){this.chunked=!0,this.fs=await at,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){void 0===this.fh&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(e,t){void 0===this.fh&&await this.open(),e+t>this.size&&(t=this.size-e);var i=this.subarray(e,t,!0);return await this.fh.read(i.dataView,0,t,e),i}async close(){if(this.fh){let e=this.fh;this.fh=void 0,await e.close()}}});A.set("base64",class extends ve{constructor(...e){super(...e),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(e,t){let i,n,r=this.input;void 0===e?(e=0,i=0,n=0):(i=4*Math.floor(e/3),n=e-i/4*3),void 0===t&&(t=this.size);let o=e+t,l=i+4*Math.ceil(o/3);r=r.slice(i,l);let h=Math.min(t,this.size-e);if(a){let t=s.from(r,"base64").slice(n,n+h);return this.set(t,e,!0)}{let t=this.subarray(e,h,!0),i=atob(r),s=t.toUint8();for(let e=0;e<h;e++)s[e]=i.charCodeAt(n+e);return t}}});class ot extends se{static canHandle(e,t){return 18761===t||19789===t}extendOptions(e){let{ifd0:t,xmp:i,iptc:n,icc:s}=e;i.enabled&&t.deps.add(700),n.enabled&&t.deps.add(33723),s.enabled&&t.deps.add(34675),t.finalizeFilters()}async parse(){let{tiff:e,xmp:t,iptc:i,icc:n}=this.options;if(e.enabled||t.enabled||i.enabled||n.enabled){let e=Math.max(S(this.options),this.options.chunkSize);await this.file.ensureChunk(0,e),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(e){if(this.parsers.tiff[e]){let t=this.parsers.tiff[e];this.injectSegment(e,t)}}}c(ot,"type","tiff"),w.set("tiff",ot);let lt=l("zlib");const ht=["ihdr","iccp","text","itxt","exif"];class ut extends se{constructor(...e){super(...e),c(this,"catchError",(e=>this.errors.push(e))),c(this,"metaChunks",[]),c(this,"unknownChunks",[])}static canHandle(e,t){return 35152===t&&2303741511===e.getUint32(0)&&218765834===e.getUint32(4)}async parse(){let{file:e}=this;await this.findPngChunksInRange("聣PNG\r\n\n".length,e.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(e,t){let{file:i}=this;for(;e<t;){let t=i.getUint32(e),n=i.getUint32(e+4),s=i.getString(e+4,4).toLowerCase(),r=t+4+4+4,a={type:s,offset:e,length:r,start:e+4+4,size:t,marker:n};ht.includes(s)?this.metaChunks.push(a):this.unknownChunks.push(a),e+=r}}parseTextChunks(){let e=this.metaChunks.filter((e=>"text"===e.type));for(let t of e){let[e,i]=this.file.getString(t.start,t.size).split("\0");this.injectKeyValToIhdr(e,i)}}injectKeyValToIhdr(e,t){let i=this.parsers.ihdr;i&&i.raw.set(e,t)}findIhdr(){let e=this.metaChunks.find((e=>"ihdr"===e.type));e&&!1!==this.options.ihdr.enabled&&this.createParser("ihdr",e.chunk)}async findExif(){let e=this.metaChunks.find((e=>"exif"===e.type));e&&this.injectSegment("tiff",e.chunk)}async findXmp(){let e=this.metaChunks.filter((e=>"itxt"===e.type));for(let t of e){"XML:com.adobe.xmp"===t.chunk.getString(0,"XML:com.adobe.xmp".length)&&this.injectSegment("xmp",t.chunk)}}async findIcc(){let e=this.metaChunks.find((e=>"iccp"===e.type));if(!e)return;let{chunk:t}=e,i=t.getUint8Array(0,81),s=0;for(;s<80&&0!==i[s];)s++;let r=s+2,a=t.getString(0,s);if(this.injectKeyValToIhdr("ProfileName",a),n){let e=await lt,i=t.getUint8Array(r);i=e.inflateSync(i),this.injectSegment("icc",i)}}}c(ut,"type","png"),w.set("png",ut),U(E,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),F(E,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);let ct=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];F(E,"ifd0",ct),F(E,"exif",ct),U(B,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);class ft extends re{static canHandle(e,t){return 224===e.getUint8(t+1)&&1246120262===e.getUint32(t+4)&&0===e.getUint8(t+8)}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}c(ft,"type","jfif"),c(ft,"headerLength",9),T.set("jfif",ft),U(E,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);class dt extends re{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}}c(dt,"type","ihdr"),T.set("ihdr",dt),U(E,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),U(B,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);class pt extends re{static canHandle(e,t){return 226===e.getUint8(t+1)&&1229144927===e.getUint32(t+4)}static findPosition(e,t){let i=super.findPosition(e,t);return i.chunkNumber=e.getUint8(t+16),i.chunkCount=e.getUint8(t+17),i.multiSegment=i.chunkCount>1,i}static handleMultiSegments(e){return function(e){let t=function(e){let t=e[0].constructor,i=0;for(let t of e)i+=t.length;let n=new t(i),s=0;for(let t of e)n.set(t,s),s+=t.length;return n}(e.map((e=>e.chunk.toUint8())));return new I(t)}(e)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:e}=this;this.chunk.byteLength<84&&g("ICC header is too short");for(let[t,i]of Object.entries(gt)){t=parseInt(t,10);let n=i(this.chunk,t);"\0\0\0\0"!==n&&e.set(t,n)}}parseTags(){let e,t,i,n,s,{raw:r}=this,a=this.chunk.getUint32(128),o=132,l=this.chunk.byteLength;for(;a--;){if(e=this.chunk.getString(o,4),t=this.chunk.getUint32(o+4),i=this.chunk.getUint32(o+8),n=this.chunk.getString(t,4),t+i>l)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");s=this.parseTag(n,t,i),void 0!==s&&"\0\0\0\0"!==s&&r.set(e,s),o+=12}}parseTag(e,t,i){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,i);case"sig ":return this.parseSig(t)}if(!(t+i>this.chunk.byteLength))return this.chunk.getUint8Array(t,i)}parseDesc(e){let t=this.chunk.getUint32(e+8)-1;return m(this.chunk.getString(e+12,t))}parseText(e,t){return m(this.chunk.getString(e+8,t-8))}parseSig(e){return m(this.chunk.getString(e+8,4))}parseMluc(e){let{chunk:t}=this,i=t.getUint32(e+8),n=t.getUint32(e+12),s=e+16,r=[];for(let a=0;a<i;a++){let i=t.getString(s+0,2),a=t.getString(s+2,2),o=t.getUint32(s+4),l=t.getUint32(s+8)+e,h=m(t.getUnicodeString(l,o));r.push({lang:i,country:a,text:h}),s+=n}return 1===i?r[0].text:r}translateValue(e,t){return"string"==typeof e?t[e]||t[e.toLowerCase()]||e:t[e]||e}}c(pt,"type","icc"),c(pt,"multiSegment",!0),c(pt,"headerLength",18);const gt={4:mt,8:function(e,t){return[e.getUint8(t),e.getUint8(t+1)>>4,e.getUint8(t+1)%16].map((e=>e.toString(10))).join(".")},12:mt,16:mt,20:mt,24:function(e,t){const i=e.getUint16(t),n=e.getUint16(t+2)-1,s=e.getUint16(t+4),r=e.getUint16(t+6),a=e.getUint16(t+8),o=e.getUint16(t+10);return new Date(Date.UTC(i,n,s,r,a,o))},36:mt,40:mt,48:mt,52:mt,64:(e,t)=>e.getUint32(t),80:mt};function mt(e,t){return m(e.getString(t,4))}T.set("icc",pt),U(E,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);const St={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},Ct={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};U(B,"icc",[[4,St],[12,Ct],[40,Object.assign({},St,Ct)],[48,St],[80,St],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);class yt extends re{static canHandle(e,t,i){return 237===e.getUint8(t+1)&&"Photoshop"===e.getString(t+4,9)&&void 0!==this.containsIptc8bim(e,t,i)}static headerLength(e,t,i){let n,s=this.containsIptc8bim(e,t,i);if(void 0!==s)return n=e.getUint8(t+s+7),n%2!=0&&(n+=1),0===n&&(n=4),s+8+n}static containsIptc8bim(e,t,i){for(let n=0;n<i;n++)if(this.isIptcSegmentHead(e,t+n))return n}static isIptcSegmentHead(e,t){return 56===e.getUint8(t)&&943868237===e.getUint32(t)&&1028===e.getUint16(t+4)}parse(){let{raw:e}=this,t=this.chunk.byteLength-1,i=!1;for(let n=0;n<t;n++)if(28===this.chunk.getUint8(n)&&2===this.chunk.getUint8(n+1)){i=!0;let t=this.chunk.getUint16(n+3),s=this.chunk.getUint8(n+2),r=this.chunk.getLatin1String(n+5,t);e.set(s,this.pluralizeValue(e.get(s),r)),n+=4+t}else if(i)break;return this.translate(),this.output}pluralizeValue(e,t){return void 0!==e?e instanceof Array?(e.push(t),e):[e,t]:t}}c(yt,"type","iptc"),c(yt,"translateValues",!1),c(yt,"reviveValues",!1),T.set("iptc",yt),U(E,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),U(B,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]);export default tt;export{te as Exifr,q as Options,X as allFormatters,G as chunkedProps,U as createDictionary,F as extendDictionary,M as fetchUrlAsArrayBuffer,w as fileParsers,A as fileReaders,Se as gps,me as gpsOnlyOptions,K as inheritables,Pe as orientation,Ie as orientationOnlyOptions,V as otherSegments,ie as parse,R as readBlobAsArrayBuffer,we as rotateCanvas,Te as rotateCss,Ae as rotation,ke as rotations,T as segmentParsers,z as segments,j as segmentsAndBlocks,st as sidecar,E as tagKeys,N as tagRevivers,B as tagValues,ye as thumbnail,Ce as thumbnailOnlyOptions,be as thumbnailUrl,H as tiffBlocks,W as tiffExtractables};
node_modules\exifr\dist\full.legacy.umd.js:1:!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("exifr",["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).exifr={})}(this,(function(e){"use strict";function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function r(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}});var n=["prototype","__proto__","caller","arguments","length","name"];Object.getOwnPropertyNames(t).forEach((function(r){-1===n.indexOf(r)&&e[r]!==t[r]&&(e[r]=t[r])})),t&&s(e,t)}function o(e){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function s(e,t){return(s=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function u(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function f(e,t,n){return(f=u()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);var i=new(Function.bind.apply(e,r));return n&&s(i,n.prototype),i}).apply(null,arguments)}function c(e){var t="function"==typeof Map?new Map:void 0;return(c=function(e){if(null===e||(n=e,-1===Function.toString.call(n).indexOf("[native code]")))return e;var n;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return f(e,arguments,o(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),s(r,e)})(e)}function l(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function h(e,t){return!t||"object"!=typeof t&&"function"!=typeof t?l(e):t}function d(e){var t=u();return function(){var n,r=o(e);if(t){var i=o(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return h(this,n)}}function p(e,t,n){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=o(e)););return e}(e,t);if(r){var i=Object.getOwnPropertyDescriptor(r,t);return i.get?i.get.call(n):i.value}})(e,t,n||e)}var g="undefined"!=typeof self?self:global,v=Object.values||function(e){var t=[];for(var n in e)t.push(e[n]);return t},y=Object.entries||function(e){var t=[];for(var n in e)t.push([n,e[n]]);return t},m=Object.assign||function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return n.forEach((function(t){for(var n in t)e[n]=t[n]})),e},k=Object.fromEntries||function(e){var t={};return S(e).forEach((function(e){var n=e[0],r=e[1];t[n]=r})),t},S=Array.from||function(e){if(e instanceof A){var t=[];return e.forEach((function(e,n){return t.push([n,e])})),t}return Array.prototype.slice.call(e)};function C(e){return-1!==this.indexOf(e)}Array.prototype.includes||(Array.prototype.includes=C),String.prototype.includes||(String.prototype.includes=C),String.prototype.startsWith||(String.prototype.startsWith=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.substring(t,t+e.length)===e}),String.prototype.endsWith||(String.prototype.endsWith=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.length;return this.substring(t-e.length,t)===e});var P=function(e){var t=[];if(Object.defineProperties(t,{size:{get:function(){return this.length}},has:{value:function(e){return-1!==this.indexOf(e)}},add:{value:function(e){this.has(e)||this.push(e)}},delete:{value:function(e){if(this.has(e)){var t=this.indexOf(e);this.splice(t,1)}}}}),Array.isArray(e))for(var n=0;n<e.length;n++)t.add(e[n]);return t},b=function(e){return new A(e)},A=void 0!==g.Map&&void 0!==g.Map.prototype.keys?g.Map:function(){function e(n){if(t(this,e),this.clear(),n)for(var r=0;r<n.length;r++)this.set(n[r][0],n[r][1])}return r(e,[{key:"clear",value:function(){this._map={},this._keys=[]}},{key:"size",get:function(){return this._keys.length}},{key:"get",value:function(e){return this._map["map_"+e]}},{key:"set",value:function(e,t){return this._map["map_"+e]=t,this._keys.indexOf(e)<0&&this._keys.push(e),this}},{key:"has",value:function(e){return this._keys.indexOf(e)>=0}},{key:"delete",value:function(e){var t=this._keys.indexOf(e);return!(t<0)&&(delete this._map["map_"+e],this._keys.splice(t,1),!0)}},{key:"keys",value:function(){return this._keys.slice(0)}},{key:"values",value:function(){var e=this;return this._keys.map((function(t){return e.get(t)}))}},{key:"entries",value:function(){var e=this;return this._keys.map((function(t){return[t,e.get(t)]}))}},{key:"forEach",value:function(e,t){for(var n=0;n<this._keys.length;n++)e.call(t,this._map["map_"+this._keys[n]],this._keys[n],this)}}]),e}(),I=g.fetch;g.fetch||(I=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return new Promise((function(n,r){var i=new XMLHttpRequest;if(i.open("get",e,!0),i.responseType="arraybuffer",i.onerror=r,t.headers)for(var a in t.headers)i.setRequestHeader(a,t.headers[a]);i.onload=function(){n({status:i.status,arrayBuffer:function(){return Promise.resolve(i.response)}})},i.send(null)}))});var T="undefined"!=typeof navigator,O=T&&"undefined"==typeof HTMLImageElement,D=!("undefined"==typeof global||"undefined"==typeof process||!process.versions||!process.versions.node),w=g.Buffer,x=g.BigInt,R=!!w,M=function(e){return U(e)?void 0:e},L=function(e){return void 0!==e};function U(e){return void 0===e||(e instanceof A?0===e.size:0===v(e).filter(L).length)}function F(e){var t=new Error(e);throw delete t.stack,t}function E(e){return""===(e=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(e).trim())?void 0:e}function B(e){var t=function(e){var t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}var N=function(e){return String.fromCharCode.apply(null,e)},G="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;function j(e){return G?G.decode(e):R?Buffer.from(e).toString("utf8"):decodeURIComponent(escape(N(e)))}var V=function(){function e(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,i=arguments.length>2?arguments[2]:void 0,a=arguments.length>3?arguments[3]:void 0;if(t(this,e),"boolean"==typeof a&&(this.le=a),Array.isArray(n)&&(n=new Uint8Array(n)),0===n)this.byteOffset=0,this.byteLength=0;else if(n instanceof ArrayBuffer){void 0===i&&(i=n.byteLength-r);var o=new DataView(n,r,i);this._swapDataView(o)}else if(n instanceof Uint8Array||n instanceof DataView||n instanceof e){void 0===i&&(i=n.byteLength-r),(r+=n.byteOffset)+i>n.byteOffset+n.byteLength&&F("Creating view outside of available memory in ArrayBuffer");var s=new DataView(n.buffer,r,i);this._swapDataView(s)}else if("number"==typeof n){var u=new DataView(new ArrayBuffer(n));this._swapDataView(u)}else F("Invalid input argument for BufferView: "+n)}return r(e,[{key:"_swapArrayBuffer",value:function(e){this._swapDataView(new DataView(e))}},{key:"_swapBuffer",value:function(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}},{key:"_swapDataView",value:function(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}},{key:"_lengthToEnd",value:function(e){return this.byteLength-e}},{key:"set",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;t instanceof DataView||t instanceof e?t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t instanceof ArrayBuffer&&(t=new Uint8Array(t)),t instanceof Uint8Array||F("BufferView.set(): Invalid data argument.");var i=this.toUint8();return i.set(t,n),new r(this,n,t.byteLength)}},{key:"subarray",value:function(t,n){return new e(this,t,n=n||this._lengthToEnd(t))}},{key:"toUint8",value:function(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}},{key:"getUint8Array",value:function(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}},{key:"getString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=this.getUint8Array(e,t);return j(n)}},{key:"getLatin1String",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=this.getUint8Array(e,t);return N(n)}},{key:"getUnicodeString",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.byteLength,n=[],r=0;r<t&&e+r<this.byteLength;r+=2)n.push(this.getUint16(e+r));return N(n)}},{key:"getInt8",value:function(e){return this.dataView.getInt8(e)}},{key:"getUint8",value:function(e){return this.dataView.getUint8(e)}},{key:"getInt16",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getInt16(e,t)}},{key:"getInt32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getInt32(e,t)}},{key:"getUint16",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getUint16(e,t)}},{key:"getUint32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getUint32(e,t)}},{key:"getFloat32",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat32(e,t)}},{key:"getFloat64",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat64(e,t)}},{key:"getFloat",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat32(e,t)}},{key:"getDouble",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.le;return this.dataView.getFloat64(e,t)}},{key:"getUintBytes",value:function(e,t,n){switch(t){case 1:return this.getUint8(e,n);case 2:return this.getUint16(e,n);case 4:return this.getUint32(e,n);case 8:return this.getUint64&&this.getUint64(e,n)}}},{key:"getUint",value:function(e,t,n){switch(t){case 8:return this.getUint8(e,n);case 16:return this.getUint16(e,n);case 32:return this.getUint32(e,n);case 64:return this.getUint64&&this.getUint64(e,n)}}},{key:"toString",value:function(e){return this.dataView.toString(e,this.constructor.name)}},{key:"ensureChunk",value:function(){}}],[{key:"from",value:function(t,n){return t instanceof this&&t.le===n?t:new e(t,void 0,void 0,n)}}]),e}();function z(e,t){F("".concat(e," '").concat(t,"' was not loaded, try using full build of exifr."))}var H=function(e){a(i,e);var n=d(i);function i(e){var r;return t(this,i),(r=n.call(this)).kind=e,r}return r(i,[{key:"get",value:function(e,t){return this.has(e)||z(this.kind,e),t&&(e in t||function(e,t){F("Unknown ".concat(e," '").concat(t,"'."))}(this.kind,e),t[e].enabled||z(this.kind,e)),p(o(i.prototype),"get",this).call(this,e)}},{key:"keyList",value:function(){return S(this.keys())}}]),i}(c(A)),_=new H("file parser"),W=new H("segment parser"),K=new H("file reader");function X(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var Y=J((function(e,t){return X(t(e),(function(e){return new V(e)}))}));function J(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var q=J((function(e,t,n){var r=new(K.get(n))(e,t);return X(r.read(),(function(){return r}))})),Q=J((function(e,t,n,r){return K.has(n)?q(e,t,n):r?Y(e,r):(F("Parser ".concat(n," is not loaded")),X())})),Z="Invalid input argument";function $(e,t){return"string"==typeof e?ee(e,t):T&&!O&&e instanceof HTMLImageElement?ee(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new V(e):T&&e instanceof Blob?Q(e,t,"blob",ne):void F(Z)}function ee(e,t){return(n=e).startsWith("data:")||n.length>1e4?q(e,t,"base64"):D&&e.includes("://")?Q(e,t,"url",te):D?q(e,t,"fs"):T?Q(e,t,"url",te):void F(Z);var n}var te=function(e){return I(e).then((function(e){return e.arrayBuffer()}))},ne=function(e){return new Promise((function(t,n){var r=new FileReader;r.onloadend=function(){return t(r.result||new ArrayBuffer)},r.onerror=n,r.readAsArrayBuffer(e)}))};var re=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"tagKeys",get:function(){return this.allKeys||(this.allKeys=S(this.keys())),this.allKeys}},{key:"tagValues",get:function(){return this.allValues||(this.allValues=S(this.values())),this.allValues}}]),i}(c(A));function ie(e,t,n){var r=new re,i=n;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=S(i));for(var a=0;a<i.length;a++){var o=i[a],s=o[0],u=o[1];r.set(s,u)}if(Array.isArray(t)){var f=t;Array.isArray(f)||("function"==typeof f.entries&&(f=f.entries()),f=S(f));for(var c=0;c<f.length;c++){var l=f[c];e.set(l,r)}}else e.set(t,r);return r}function ae(e,t,n){var r,i=e.get(t),a=n;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=S(a));for(var o=0;o<a.length;o++)r=a[o],i.set(r[0],r[1])}var oe=b(),se=b(),ue=b(),fe=37500,ce=37510,le=700,he=33723,de=34675,pe=34665,ge=34853,ve=40965,ye=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],me=["jfif","xmp","icc","iptc","ihdr"],ke=["tiff"].concat(me),Se=["ifd0","ifd1","exif","gps","interop"],Ce=[].concat(ke,Se),Pe=["makerNote","userComment"],be=["translateKeys","translateValues","reviveValues","multiSegment"],Ae=[].concat(be,["sanitize","mergeOutput","silentErrors"]),Ie=function(){function e(){t(this,e)}return r(e,[{key:"translate",get:function(){return this.translateKeys||this.translateValues||this.reviveValues}}]),e}(),Te=function(e){a(o,e);var n=d(o);function o(e,r,a,s){var u;if(t(this,o),i(l(u=n.call(this)),"enabled",!1),i(l(u),"skip",P()),i(l(u),"pick",P()),i(l(u),"deps",P()),i(l(u),"translateKeys",!1),i(l(u),"translateValues",!1),i(l(u),"reviveValues",!1),u.key=e,u.enabled=r,u.parse=u.enabled,u.applyInheritables(s),u.canBeFiltered=Se.includes(e),u.canBeFiltered&&(u.dict=oe.get(e)),void 0!==a)if(Array.isArray(a))u.parse=u.enabled=!0,u.canBeFiltered&&a.length>0&&u.translateTagSet(a,u.pick);else if("object"==typeof a){if(u.enabled=!0,u.parse=!1!==a.parse,u.canBeFiltered){var f=a.pick,c=a.skip;f&&f.length>0&&u.translateTagSet(f,u.pick),c&&c.length>0&&u.translateTagSet(c,u.skip)}u.applyInheritables(a)}else!0===a||!1===a?u.parse=u.enabled=a:F("Invalid options argument: ".concat(a));return u}return r(o,[{key:"needed",get:function(){return this.enabled||this.deps.size>0}},{key:"applyInheritables",value:function(e){var t,n,r=be;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=S(r));for(var i=0;i<r.length;i++)void 0!==(n=e[t=r[i]])&&(this[t]=n)}},{key:"translateTagSet",value:function(e,t){if(this.dict){var n,r,i=this.dict,a=i.tagKeys,o=i.tagValues,s=e;Array.isArray(s)||("function"==typeof s.entries&&(s=s.entries()),s=S(s));for(var u=0;u<s.length;u++)"string"==typeof(n=s[u])?(-1===(r=o.indexOf(n))&&(r=a.indexOf(Number(n))),-1!==r&&t.add(Number(a[r]))):t.add(n)}else{var f=e;Array.isArray(f)||("function"==typeof f.entries&&(f=f.entries()),f=S(f));for(var c=0;c<f.length;c++){var l=f[c];t.add(l)}}}},{key:"finalizeFilters",value:function(){!this.enabled&&this.deps.size>0?(this.enabled=!0,Me(this.pick,this.deps)):this.enabled&&this.pick.size>0&&Me(this.pick,this.deps)}}]),o}(Ie),Oe={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},De=b(),we=function(e){a(i,e);var n=d(i);function i(e){var r;return t(this,i),r=n.call(this),!0===e?r.setupFromTrue():void 0===e?r.setupFromUndefined():Array.isArray(e)?r.setupFromArray(e):"object"==typeof e?r.setupFromObject(e):F("Invalid options argument ".concat(e)),void 0===r.firstChunkSize&&(r.firstChunkSize=T?r.firstChunkSizeBrowser:r.firstChunkSizeNode),r.mergeOutput&&(r.ifd1.enabled=!1),r.filterNestedSegmentTags(),r.traverseTiffDependencyTree(),r.checkLoadedPlugins(),r}return r(i,[{key:"setupFromUndefined",value:function(){var e,t=ye;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=S(t));for(var n=0;n<t.length;n++)this[e=t[n]]=Oe[e];var r=Ae;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=S(r));for(var i=0;i<r.length;i++)this[e=r[i]]=Oe[e];var a=Pe;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=S(a));for(var o=0;o<a.length;o++)this[e=a[o]]=Oe[e];var s=Ce;Array.isArray(s)||("function"==typeof s.entries&&(s=s.entries()),s=S(s));for(var u=0;u<s.length;u++)this[e=s[u]]=new Te(e,Oe[e],void 0,this)}},{key:"setupFromTrue",value:function(){var e,t=ye;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=S(t));for(var n=0;n<t.length;n++)this[e=t[n]]=Oe[e];var r=Ae;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=S(r));for(var i=0;i<r.length;i++)this[e=r[i]]=Oe[e];var a=Pe;Array.isArray(a)||("function"==typeof a.entries&&(a=a.entries()),a=S(a));for(var o=0;o<a.length;o++)this[e=a[o]]=!0;var s=Ce;Array.isArray(s)||("function"==typeof s.entries&&(s=s.entries()),s=S(s));for(var u=0;u<s.length;u++)this[e=s[u]]=new Te(e,!0,void 0,this)}},{key:"setupFromArray",value:function(e){var t,n=ye;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++)this[t=n[r]]=Oe[t];var i=Ae;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=S(i));for(var a=0;a<i.length;a++)this[t=i[a]]=Oe[t];var o=Pe;Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=S(o));for(var s=0;s<o.length;s++)this[t=o[s]]=Oe[t];var u=Ce;Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=S(u));for(var f=0;f<u.length;f++)this[t=u[f]]=new Te(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,Se)}},{key:"setupFromObject",value:function(e){var t;Se.ifd0=Se.ifd0||Se.image,Se.ifd1=Se.ifd1||Se.thumbnail,m(this,e);var n=ye;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++)this[t=n[r]]=Re(e[t],Oe[t]);var i=Ae;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=S(i));for(var a=0;a<i.length;a++)this[t=i[a]]=Re(e[t],Oe[t]);var o=Pe;Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=S(o));for(var s=0;s<o.length;s++)this[t=o[s]]=Re(e[t],Oe[t]);var u=ke;Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=S(u));for(var f=0;f<u.length;f++)this[t=u[f]]=new Te(t,Oe[t],e[t],this);var c=Se;Array.isArray(c)||("function"==typeof c.entries&&(c=c.entries()),c=S(c));for(var l=0;l<c.length;l++)this[t=c[l]]=new Te(t,Oe[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,Se,Ce),!0===e.tiff?this.batchEnableWithBool(Se,!0):!1===e.tiff?this.batchEnableWithUserValue(Se,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,Se):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,Se)}},{key:"batchEnableWithBool",value:function(e,t){var n=e;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++){this[n[r]].enabled=t}}},{key:"batchEnableWithUserValue",value:function(e,t){var n=e;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++){var i=n[r],a=t[i];this[i].enabled=!1!==a&&void 0!==a}}},{key:"setupGlobalFilters",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:n;if(e&&e.length){var i=r;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=S(i));for(var a=0;a<i.length;a++){var o=i[a];this[o].enabled=!1}var s=xe(e,n),u=s;Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=S(u));for(var f=0;f<u.length;f++){var c=u[f],l=c[0],h=c[1];Me(this[l].pick,h),this[l].enabled=!0}}else if(t&&t.length){var d=xe(t,n),p=d;Array.isArray(p)||("function"==typeof p.entries&&(p=p.entries()),p=S(p));for(var g=0;g<p.length;g++){var v=p[g],y=v[0],m=v[1];Me(this[y].skip,m)}}}},{key:"filterNestedSegmentTags",value:function(){var e=this.ifd0,t=this.exif,n=this.xmp,r=this.iptc,i=this.icc;this.makerNote?t.deps.add(fe):t.skip.add(fe),this.userComment?t.deps.add(ce):t.skip.add(ce),n.enabled||e.skip.add(le),r.enabled||e.skip.add(he),i.enabled||e.skip.add(de)}},{key:"traverseTiffDependencyTree",value:function(){var e=this,t=this.ifd0,n=this.exif,r=this.gps;this.interop.needed&&(n.deps.add(ve),t.deps.add(ve)),n.needed&&t.deps.add(pe),r.needed&&t.deps.add(ge),this.tiff.enabled=Se.some((function(t){return!0===e[t].enabled}))||this.makerNote||this.userComment;var i=Se;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=S(i));for(var a=0;a<i.length;a++){this[i[a]].finalizeFilters()}}},{key:"onlyTiff",get:function(){var e=this;return!me.map((function(t){return e[t].enabled})).some((function(e){return!0===e}))&&this.tiff.enabled}},{key:"checkLoadedPlugins",value:function(){var e=ke;Array.isArray(e)||("function"==typeof e.entries&&(e=e.entries()),e=S(e));for(var t=0;t<e.length;t++){var n=e[t];this[n].enabled&&!W.has(n)&&z("segment parser",n)}}}],[{key:"useCached",value:function(e){var t=De.get(e);return void 0!==t||(t=new this(e),De.set(e,t)),t}}]),i}(Ie);function xe(e,t){var n,r,i,a=[],o=t;Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=S(o));for(var s=0;s<o.length;s++){r=o[s],n=[];var u=oe.get(r);Array.isArray(u)||("function"==typeof u.entries&&(u=u.entries()),u=S(u));for(var f=0;f<u.length;f++)i=u[f],(e.includes(i[0])||e.includes(i[1]))&&n.push(i[0]);n.length&&a.push([r,n])}return a}function Re(e,t){return void 0!==e?e:void 0!==t?t:void 0}function Me(e,t){var n=t;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++){var i=n[r];e.add(i)}}function Le(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Ue(){}function Fe(e,t){if(!t)return e&&e.then?e.then(Ue):Promise.resolve()}function Ee(e,t){var n=e();return n&&n.then?n.then(t):t(n)}i(we,"default",Oe);var Be=function(){function e(n){var r=this;t(this,e),i(this,"parsers",{}),i(this,"output",{}),i(this,"errors",[]),i(this,"pushToErrors",(function(e){return r.errors.push(e)})),this.options=we.useCached(n)}return r(e,[{key:"read",value:function(e){try{var t=this;return Le($(e,t.options),(function(e){t.file=e}))}catch(e){return Promise.reject(e)}}},{key:"setup",value:function(){if(!this.fileParser){var e=this.file,t=e.getUint16(0),n=_;Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++){var i=n[r],a=i[0],o=i[1];if(o.canHandle(e,t))return this.fileParser=new o(this.options,this.file,this.parsers),e[a]=!0}this.file.close&&this.file.close(),F("Unknown file format")}}},{key:"parse",value:function(){try{var e=this,t=e.output,n=e.errors;return e.setup(),Ee((function(){return e.options.silentErrors?Le(e.executeParsers().catch(e.pushToErrors),(function(){n.push.apply(n,e.fileParser.errors)})):Fe(e.executeParsers())}),(function(){return e.file.close&&e.file.close(),e.options.silentErrors&&n.length>0&&(t.errors=n),M(t)}))}catch(e){return Promise.reject(e)}}},{key:"executeParsers",value:function(){try{var e=this,t=e.output;return Le(e.fileParser.parse(),(function(){var n=v(e.parsers).map(function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(e){return Le(e.parse(),(function(n){e.assignToOutput(t,n)}))})));return e.options.silentErrors&&(n=n.map((function(t){return t.catch(e.pushToErrors)}))),Fe(Promise.all(n))}))}catch(e){return Promise.reject(e)}}},{key:"extractThumbnail",value:function(){try{var e=this;e.setup();var t,n=e.options,r=e.file,i=W.get("tiff",n);return Ee((function(){if(!r.tiff)return function(e){var t=e();if(t&&t.then)return t.then(Ue)}((function(){if(r.jpeg)return Le(e.fileParser.getOrFindSegment("tiff"),(function(e){t=e}))}));t={start:0,type:"tiff"}}),(function(){if(void 0!==t)return Le(e.fileParser.ensureSegmentChunk(t),(function(t){return Le((e.parsers.tiff=new i(t,n,r)).extractThumbnail(),(function(e){return r.close&&r.close(),e}))}))}))}catch(e){return Promise.reject(e)}}}]),e}();var Ne=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(e,t){var n,r,i,a=new Be(t);return n=a.read(e),r=function(){return a.parse()},i?r?r(n):n:(n&&n.then||(n=Promise.resolve(n)),r?n.then(r):n)})),Ge=Object.freeze({__proto__:null,parse:Ne,Exifr:Be,fileParsers:_,segmentParsers:W,fileReaders:K,tagKeys:oe,tagValues:se,tagRevivers:ue,createDictionary:ie,extendDictionary:ae,fetchUrlAsArrayBuffer:te,readBlobAsArrayBuffer:ne,chunkedProps:ye,otherSegments:me,segments:ke,tiffBlocks:Se,segmentsAndBlocks:Ce,tiffExtractables:Pe,inheritables:be,allFormatters:Ae,Options:we});function je(){}var Ve=function(){function e(n,r,a){var o=this;t(this,e),i(this,"errors",[]),i(this,"ensureSegmentChunk",function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(e){var t,n,r,i=e.start,a=e.size||65536;return t=function(){if(o.file.chunked)return function(e){var t=e();if(t&&t.then)return t.then(je)}((function(){if(!o.file.available(i,a))return function(e){if(e&&e.then)return e.then(je)}(function(e,t){try{var n=e()}catch(e){return t(e)}return n&&n.then?n.then(void 0,t):n}((function(){return t=o.file.readChunk(i,a),n=function(t){e.chunk=t},r?n?n(t):t:(t&&t.then||(t=Promise.resolve(t)),n?t.then(n):t);var t,n,r}),(function(t){F("Couldn't read segment: ".concat(JSON.stringify(e),". ").concat(t.message))})));e.chunk=o.file.subarray(i,a)}));o.file.byteLength>i+a?e.chunk=o.file.subarray(i,a):void 0===e.size?e.chunk=o.file.subarray(i):F("Segment unreachable: "+JSON.stringify(e))},n=function(){return e.chunk},(r=t())&&r.then?r.then(n):n(r)}))),this.extendOptions&&this.extendOptions(n),this.options=n,this.file=r,this.parsers=a}return r(e,[{key:"injectSegment",value:function(e,t){this.options[e].enabled&&this.createParser(e,t)}},{key:"createParser",value:function(e,t){var n=new(W.get(e))(t,this.options,this.file);return this.parsers[e]=n}},{key:"createParsers",value:function(e){var t=e;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=S(t));for(var n=0;n<t.length;n++){var r=t[n],i=r.type,a=r.chunk,o=this.options[i];if(o&&o.enabled){var s=this.parsers[i];s&&s.append||s||this.createParser(i,a)}}}},{key:"readSegments",value:function(e){try{var t=e.map(this.ensureSegmentChunk);return function(e,t){if(!t)return e&&e.then?e.then(je):Promise.resolve()}(Promise.all(t))}catch(e){return Promise.reject(e)}}}]),e}(),ze=function(){function e(n){var r=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2?arguments[2]:void 0;t(this,e),i(this,"errors",[]),i(this,"raw",b()),i(this,"handleError",(function(e){if(!r.options.silentErrors)throw e;r.errors.push(e.message)})),this.chunk=this.normalizeInput(n),this.file=o,this.type=this.constructor.type,this.globalOptions=this.options=a,this.localOptions=a[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}return r(e,[{key:"normalizeInput",value:function(e){return e instanceof V?e:new V(e)}},{key:"translate",value:function(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}},{key:"output",get:function(){return this.translated?this.translated:this.raw?k(this.raw):void 0}},{key:"translateBlock",value:function(e,t){var n=ue.get(t),r=se.get(t),i=oe.get(t),a=this.options[t],o=a.reviveValues&&!!n,s=a.translateValues&&!!r,u=a.translateKeys&&!!i,f={},c=e;Array.isArray(c)||("function"==typeof c.entries&&(c=c.entries()),c=S(c));for(var l=0;l<c.length;l++){var h=c[l],d=h[0],p=h[1];o&&n.has(d)?p=n.get(d)(p):s&&r.has(d)&&(p=this.translateValue(p,r.get(d))),u&&i.has(d)&&(d=i.get(d)||d),f[d]=p}return f}},{key:"translateValue",value:function(e,t){return t[e]||t.DEFAULT||e}},{key:"assignToOutput",value:function(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}},{key:"assignObjectToOutput",value:function(e,t,n){if(this.globalOptions.mergeOutput)return m(e,n);e[t]?m(e[t],n):e[t]=n}}],[{key:"findPosition",value:function(e,t){var n=e.getUint16(t+2)+2,r="function"==typeof this.headerLength?this.headerLength(e,t,n):this.headerLength,i=t+r,a=n-r;return{offset:t,length:n,headerLength:r,start:i,size:a,end:i+a}}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new we(i({},this.type,t)),r=new this(e,n,e);return r.parse()}}]),e}();function He(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}i(ze,"headerLength",4),i(ze,"type",void 0),i(ze,"multiSegment",!1),i(ze,"canHandle",(function(){return!1}));function _e(){}function We(e,t){if(!t)return e&&e.then?e.then(_e):Promise.resolve()}function Ke(e){var t=e();if(t&&t.then)return t.then(_e)}function Xe(e,t){var n=e();return n&&n.then?n.then(t):t(n)}function Ye(e,t,n){if(!e.s){if(n instanceof Je){if(!n.s)return void(n.o=Ye.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(Ye.bind(null,e,t),Ye.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var Je=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,i=this.s;if(i){var a=1&i?t:n;if(a){try{Ye(r,1,a(this.v))}catch(e){Ye(r,2,e)}return r}return this}return this.o=function(e){try{var i=e.v;1&e.s?Ye(r,1,t?t(i):i):n?Ye(r,1,n(i)):Ye(r,2,i)}catch(e){Ye(r,2,e)}},r},e}();function qe(e){return e instanceof Je&&1&e.s}function Qe(e,t,n){for(var r;;){var i=e();if(qe(i)&&(i=i.v),!i)return a;if(i.then){r=0;break}var a=n();if(a&&a.then){if(!qe(a)){r=1;break}a=a.s}if(t){var o=t();if(o&&o.then&&!qe(o)){r=2;break}}}var s=new Je,u=Ye.bind(null,s,2);return(0===r?i.then(c):1===r?a.then(f):o.then(l)).then(void 0,u),s;function f(r){a=r;do{if(t&&(o=t())&&o.then&&!qe(o))return void o.then(l).then(void 0,u);if(!(i=e())||qe(i)&&!i.v)return void Ye(s,1,a);if(i.then)return void i.then(c).then(void 0,u);qe(a=n())&&(a=a.v)}while(!a||!a.then);a.then(f).then(void 0,u)}function c(e){e?(a=n())&&a.then?a.then(f).then(void 0,u):f(a):Ye(s,1,a)}function l(){(i=e())?i.then?i.then(c).then(void 0,u):c(i):Ye(s,1,a)}}function Ze(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function $e(e){return e>=224&&e<=239}function et(e,t,n){var r=W;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=S(r));for(var i=0;i<r.length;i++){var a=r[i],o=a[0];if(a[1].canHandle(e,t,n))return o}}var tt=function(e){a(o,e);var n=d(o);function o(){var e;t(this,o);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return i(l(e=n.call.apply(n,[this].concat(a))),"appSegments",[]),i(l(e),"jpegSegments",[]),i(l(e),"unknownSegments",[]),e}return r(o,[{key:"parse",value:function(){try{var e=this;return He(e.findAppSegments(),(function(){return He(e.readSegments(e.appSegments),(function(){e.mergeMultiSegments(),e.createParsers(e.mergedAppSegments||e.appSegments)}))}))}catch(e){return Promise.reject(e)}}},{key:"setupSegmentFinderArgs",value:function(e){var t=this;!0===e?(this.findAll=!0,this.wanted=P(W.keyList())):(e=void 0===e?W.keyList().filter((function(e){return t.options[e].enabled})):e.filter((function(e){return t.options[e].enabled&&W.has(e)})),this.findAll=!1,this.remaining=P(e),this.wanted=P(e)),this.unfinishedMultiSegment=!1}},{key:"findAppSegments",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0;try{var n=this;n.setupSegmentFinderArgs(t);var r=n.file,i=n.findAll,a=n.wanted,o=n.remaining;return Xe((function(){if(!i&&n.file.chunked)return i=S(a).some((function(e){var t=W.get(e),r=n.options[e];return t.multiSegment&&r.multiSegment})),Ke((function(){if(i)return We(n.file.readWhole())}))}),(function(){var t=!1;if(e=n.findAppSegmentsInRange(e,r.byteLength),!n.options.onlyTiff)return function(){if(r.chunked){var i=!1;return Qe((function(){return!t&&o.size>0&&!i&&(!!r.canReadNextChunk||!!n.unfinishedMultiSegment)}),void 0,(function(){var a=r.nextChunkOffset,o=n.appSegments.some((function(e){return!n.file.available(e.offset||e.start,e.length||e.size)}));return Xe((function(){return e>a&&!o?He(r.readNextChunk(e),(function(e){i=!e})):He(r.readNextChunk(a),(function(e){i=!e}))}),(function(){void 0===(e=n.findAppSegmentsInRange(e,r.byteLength))&&(t=!0)}))}))}}()}))}catch(e){return Promise.reject(e)}}},{key:"findAppSegmentsInRange",value:function(e,t){t-=2;for(var n,r,i,a,o,s,u=this.file,f=this.findAll,c=this.wanted,l=this.remaining,h=this.options;e<t;e++)if(255===u.getUint8(e))if($e(n=u.getUint8(e+1))){if(r=u.getUint16(e+2),(i=et(u,e,r))&&c.has(i)&&(o=(a=W.get(i)).findPosition(u,e),s=h[i],o.type=i,this.appSegments.push(o),!f&&(a.multiSegment&&s.multiSegment?(this.unfinishedMultiSegment=o.chunkNumber<o.chunkCount,this.unfinishedMultiSegment||l.delete(i)):l.delete(i),0===l.size)))break;h.recordUnknownSegments&&((o=ze.findPosition(u,e)).marker=n,this.unknownSegments.push(o)),e+=r+1}else if(Ze(n)){if(r=u.getUint16(e+2),218===n&&!1!==h.stopAfterSos)return;h.recordJpegSegments&&this.jpegSegments.push({offset:e,length:r,marker:n}),e+=r+1}return e}},{key:"mergeMultiSegments",value:function(){var e=this;if(this.appSegments.some((function(e){return e.multiSegment}))){var t=function(e,t){for(var n,r,i,a=b(),o=0;o<e.length;o++)r=(n=e[o])[t],a.has(r)?i=a.get(r):a.set(r,i=[]),i.push(n);return S(a)}(this.appSegments,"type");this.mergedAppSegments=t.map((function(t){var n=t[0],r=t[1],i=W.get(n,e.options);return i.handleMultiSegments?{type:n,chunk:i.handleMultiSegments(r)}:r[0]}))}}},{key:"getSegment",value:function(e){return this.appSegments.find((function(t){return t.type===e}))}},{key:"getOrFindSegment",value:function(e){try{var t=this,n=t.getSegment(e);return Xe((function(){if(void 0===n)return He(t.findAppSegments(0,[e]),(function(){n=t.getSegment(e)}))}),(function(){return n}))}catch(e){return Promise.reject(e)}}}],[{key:"canHandle",value:function(e,t){return 65496===t}}]),o}(Ve);function nt(){}i(tt,"type","jpeg"),_.set("jpeg",tt);function rt(e,t){if(!t)return e&&e.then?e.then(nt):Promise.resolve()}function it(e,t){var n=e();return n&&n.then?n.then(t):t(n)}var at=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];var ot=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parse",value:function(){try{var e=this;e.parseHeader();var t=e.options;return it((function(){if(t.ifd0.enabled)return rt(e.parseIfd0Block())}),(function(){return it((function(){if(t.exif.enabled)return rt(e.safeParse("parseExifBlock"))}),(function(){return it((function(){if(t.gps.enabled)return rt(e.safeParse("parseGpsBlock"))}),(function(){return it((function(){if(t.interop.enabled)return rt(e.safeParse("parseInteropBlock"))}),(function(){return it((function(){if(t.ifd1.enabled)return rt(e.safeParse("parseThumbnailBlock"))}),(function(){return e.createOutput()}))}))}))}))}))}catch(e){return Promise.reject(e)}}},{key:"safeParse",value:function(e){var t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}},{key:"findIfd0Offset",value:function(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}},{key:"findIfd1Offset",value:function(){if(void 0===this.ifd1Offset){this.findIfd0Offset();var e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}},{key:"parseBlock",value:function(e,t){var n=b();return this[t]=n,this.parseTags(e,t,n),n}},{key:"parseIfd0Block",value:function(){try{var e=this;if(e.ifd0)return;var t=e.file;return e.findIfd0Offset(),e.ifd0Offset<8&&F("Malformed EXIF data"),!t.chunked&&e.ifd0Offset>t.byteLength&&F("IFD0 offset points to outside of file.\nthis.ifd0Offset: ".concat(e.ifd0Offset,", file.byteLength: ").concat(t.byteLength)),it((function(){if(t.tiff)return rt(t.ensureChunk(e.ifd0Offset,B(e.options)))}),(function(){var t=e.parseBlock(e.ifd0Offset,"ifd0");if(0!==t.size)return e.exifOffset=t.get(pe),e.interopOffset=t.get(ve),e.gpsOffset=t.get(ge),e.xmp=t.get(le),e.iptc=t.get(he),e.icc=t.get(de),e.options.sanitize&&(t.delete(pe),t.delete(ve),t.delete(ge),t.delete(le),t.delete(he),t.delete(de)),t}))}catch(e){return Promise.reject(e)}}},{key:"parseExifBlock",value:function(){try{var e=this;if(e.exif)return;return it((function(){if(!e.ifd0)return rt(e.parseIfd0Block())}),(function(){if(void 0!==e.exifOffset)return it((function(){if(e.file.tiff)return rt(e.file.ensureChunk(e.exifOffset,B(e.options)))}),(function(){var t=e.parseBlock(e.exifOffset,"exif");return e.interopOffset||(e.interopOffset=t.get(ve)),e.makerNote=t.get(fe),e.userComment=t.get(ce),e.options.sanitize&&(t.delete(ve),t.delete(fe),t.delete(ce)),e.unpack(t,41728),e.unpack(t,41729),t}))}))}catch(e){return Promise.reject(e)}}},{key:"unpack",value:function(e,t){var n=e.get(t);n&&1===n.length&&e.set(t,n[0])}},{key:"parseGpsBlock",value:function(){try{var e=this;if(e.gps)return;return it((function(){if(!e.ifd0)return rt(e.parseIfd0Block())}),(function(){if(void 0!==e.gpsOffset){var t=e.parseBlock(e.gpsOffset,"gps");return t&&t.has(2)&&t.has(4)&&(t.set("latitude",st.apply(void 0,t.get(2).concat([t.get(1)]))),t.set("longitude",st.apply(void 0,t.get(4).concat([t.get(3)])))),t}}))}catch(e){return Promise.reject(e)}}},{key:"parseInteropBlock",value:function(){try{var e=this;if(e.interop)return;return it((function(){if(!e.ifd0)return rt(e.parseIfd0Block())}),(function(){return it((function(){if(void 0===e.interopOffset&&!e.exif)return rt(e.parseExifBlock())}),(function(){if(void 0!==e.interopOffset)return e.parseBlock(e.interopOffset,"interop")}))}))}catch(e){return Promise.reject(e)}}},{key:"parseThumbnailBlock",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{var t=this;if(t.ifd1||t.ifd1Parsed)return;if(t.options.mergeOutput&&!e)return;return t.findIfd1Offset(),t.ifd1Offset>0&&(t.parseBlock(t.ifd1Offset,"ifd1"),t.ifd1Parsed=!0),t.ifd1}catch(e){return Promise.reject(e)}}},{key:"extractThumbnail",value:function(){try{var e=this;return e.headerParsed||e.parseHeader(),it((function(){if(!e.ifd1Parsed)return rt(e.parseThumbnailBlock(!0))}),(function(){if(void 0!==e.ifd1){var t=e.ifd1.get(513),n=e.ifd1.get(514);return e.chunk.getUint8Array(t,n)}}))}catch(e){return Promise.reject(e)}}},{key:"image",get:function(){return this.ifd0}},{key:"thumbnail",get:function(){return this.ifd1}},{key:"createOutput",value:function(){var e,t,n,r={},i=Se;Array.isArray(i)||("function"==typeof i.entries&&(i=i.entries()),i=S(i));for(var a=0;a<i.length;a++)if(!U(e=this[t=i[a]]))if(n=this.canTranslate?this.translateBlock(e,t):k(e),this.options.mergeOutput){if("ifd1"===t)continue;m(r,n)}else r[t]=n;return this.makerNote&&(r.makerNote=this.makerNote),this.userComment&&(r.userComment=this.userComment),r}},{key:"assignToOutput",value:function(e,t){if(this.globalOptions.mergeOutput)m(e,t);else{var n=y(t);Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++){var i=n[r],a=i[0],o=i[1];this.assignObjectToOutput(e,a,o)}}}}],[{key:"canHandle",value:function(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}}]),i}(function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parseHeader",value:function(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}},{key:"parseTags",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:b(),r=this.options[t],i=r.pick,a=r.skip,o=(i=P(i)).size>0,s=0===a.size,u=this.chunk.getUint16(e);e+=2;for(var f=0;f<u;f++){var c=this.chunk.getUint16(e);if(o){if(i.has(c)&&(n.set(c,this.parseTag(e,c,t)),i.delete(c),0===i.size))break}else!s&&a.has(c)||n.set(c,this.parseTag(e,c,t));e+=12}return n}},{key:"parseTag",value:function(e,t,n){var r=this.chunk,i=r.getUint16(e+2),a=r.getUint32(e+4),o=at[i];if(o*a<=4?e+=8:e=r.getUint32(e+8),(i<1||i>13)&&F("Invalid TIFF value type. block: ".concat(n.toUpperCase(),", tag: ").concat(t.toString(16),", type: ").concat(i,", offset ").concat(e)),e>r.byteLength&&F("Invalid TIFF value offset. block: ".concat(n.toUpperCase(),", tag: ").concat(t.toString(16),", type: ").concat(i,", offset ").concat(e," is outside of chunk size ").concat(r.byteLength)),1===i)return r.getUint8Array(e,a);if(2===i)return E(r.getString(e,a));if(7===i)return r.getUint8Array(e,a);if(1===a)return this.parseTagValue(i,e);for(var s=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(i))(a),u=o,f=0;f<a;f++)s[f]=this.parseTagValue(i,e),e+=u;return s}},{key:"parseTagValue",value:function(e,t){var n=this.chunk;switch(e){case 1:return n.getUint8(t);case 3:return n.getUint16(t);case 4:return n.getUint32(t);case 5:return n.getUint32(t)/n.getUint32(t+4);case 6:return n.getInt8(t);case 8:return n.getInt16(t);case 9:return n.getInt32(t);case 10:return n.getInt32(t)/n.getInt32(t+4);case 11:return n.getFloat(t);case 12:return n.getDouble(t);case 13:return n.getUint32(t);default:F("Invalid tiff type ".concat(e))}}}]),i}(ze));function st(e,t,n,r){var i=e+t/60+n/3600;return"S"!==r&&"W"!==r||(i*=-1),i}i(ot,"type","tiff"),i(ot,"headerLength",10),W.set("tiff",ot);var ut=Object.freeze({__proto__:null,default:Ge,Exifr:Be,fileParsers:_,segmentParsers:W,fileReaders:K,tagKeys:oe,tagValues:se,tagRevivers:ue,createDictionary:ie,extendDictionary:ae,fetchUrlAsArrayBuffer:te,readBlobAsArrayBuffer:ne,chunkedProps:ye,otherSegments:me,segments:ke,tiffBlocks:Se,segmentsAndBlocks:Ce,tiffExtractables:Pe,inheritables:be,allFormatters:Ae,Options:we,parse:Ne}),ft={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1};function ct(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var lt=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(e){var t=new Be(ht);return ct(t.read(e),(function(){return ct(t.parse(),(function(e){if(e&&e.gps){var t=e.gps;return{latitude:t.latitude,longitude:t.longitude}}}))}))})),ht=m({},ft,{firstChunkSize:4e4,gps:[1,2,3,4]});function dt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function pt(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var gt=pt((function(e){return dt(this.thumbnail(e),(function(e){if(void 0!==e){var t=new Blob([e]);return URL.createObjectURL(t)}}))})),vt=pt((function(e){var t=new Be(yt);return dt(t.read(e),(function(){return dt(t.extractThumbnail(),(function(e){return e&&R?w.from(e):e}))}))})),yt=m({},ft,{tiff:!1,ifd1:!0,mergeOutput:!1});function mt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var kt=function(t){return mt(St(t),(function(t){return m({canvas:e.rotateCanvas,css:e.rotateCss},Pt[t])}))},St=function(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}((function(e){var t=new Be(Ct);return mt(t.read(e),(function(){return mt(t.parse(),(function(e){if(e&&e.ifd0)return e.ifd0[274]}))}))})),Ct=m({},ft,{firstChunkSize:4e4,ifd0:[274]}),Pt=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});if(e.rotateCanvas=!0,e.rotateCss=!0,"object"==typeof navigator){var bt=navigator.userAgent;if(bt.includes("iPad")||bt.includes("iPhone")){var At=bt.match(/OS (\d+)_(\d+)/);if(At){var It=At[1],Tt=At[2],Ot=Number(It)+.1*Number(Tt);e.rotateCanvas=Ot<13.4,e.rotateCss=!1}}else if(bt.includes("OS X 10")){var Dt=bt.match(/OS X 10[_.](\d+)/)[1];e.rotateCanvas=e.rotateCss=Number(Dt)<15}if(bt.includes("Chrome/")){var wt=bt.match(/Chrome\/(\d+)/)[1];e.rotateCanvas=e.rotateCss=Number(wt)<81}else if(bt.includes("Firefox/")){var xt=bt.match(/Firefox\/(\d+)/)[1];e.rotateCanvas=e.rotateCss=Number(xt)<77}}function Rt(){}var Mt=function(e){a(s,e);var n=d(s);function s(){var e;t(this,s);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return i(l(e=n.call.apply(n,[this].concat(a))),"ranges",new Lt),0!==e.byteLength&&e.ranges.add(0,e.byteLength),e}return r(s,[{key:"_tryExtend",value:function(e,t,n){if(0===e&&0===this.byteLength&&n){var r=new DataView(n.buffer||n,n.byteOffset,n.byteLength);this._swapDataView(r)}else{var i=e+t;if(i>this.byteLength){var a=this._extend(i).dataView;this._swapDataView(a)}}}},{key:"_extend",value:function(e){var t;t=R?w.allocUnsafe(e):new Uint8Array(e);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:n}}},{key:"subarray",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t=t||this._lengthToEnd(e),n&&this._tryExtend(e,t),this.ranges.add(e,t),p(o(s.prototype),"subarray",this).call(this,e,t)}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];n&&this._tryExtend(t,e.byteLength,e);var r=p(o(s.prototype),"set",this).call(this,e,t);return this.ranges.add(t,r.byteLength),r}},{key:"ensureChunk",value:function(e,t){try{var n=this;if(!n.chunked)return;if(n.ranges.available(e,t))return;return function(e,t){if(!t)return e&&e.then?e.then(Rt):Promise.resolve()}(n.readChunk(e,t))}catch(e){return Promise.reject(e)}}},{key:"available",value:function(e,t){return this.ranges.available(e,t)}}]),s}(V),Lt=function(){function e(){t(this,e),i(this,"list",[])}return r(e,[{key:"length",get:function(){return this.list.length}},{key:"add",value:function(e,t){var n=e+t,r=this.list.filter((function(t){return Ut(e,t.offset,n)||Ut(e,t.end,n)}));if(r.length>0){e=Math.min.apply(Math,[e].concat(r.map((function(e){return e.offset})))),t=(n=Math.max.apply(Math,[n].concat(r.map((function(e){return e.end})))))-e;var i=r.shift();i.offset=e,i.length=t,i.end=n,this.list=this.list.filter((function(e){return!r.includes(e)}))}else this.list.push({offset:e,length:t,end:n})}},{key:"available",value:function(e,t){var n=e+t;return this.list.some((function(t){return t.offset<=e&&n<=t.end}))}}]),e}();function Ut(e,t,n){return e<=t&&t<=n}function Ft(){}function Et(e,t){if(!t)return e&&e.then?e.then(Ft):Promise.resolve()}var Bt=function(e){a(o,e);var n=d(o);function o(e,r){var a;return t(this,o),i(l(a=n.call(this,0)),"chunksRead",0),a.input=e,a.options=r,a}return r(o,[{key:"readWhole",value:function(){try{var e=this;return e.chunked=!1,Et(e.readChunk(e.nextChunkOffset))}catch(e){return Promise.reject(e)}}},{key:"readChunked",value:function(){try{var e=this;return e.chunked=!0,Et(e.readChunk(0,e.options.firstChunkSize))}catch(e){return Promise.reject(e)}}},{key:"readNextChunk",value:function(e){try{var t=this;if(void 0===e&&(e=t.nextChunkOffset),t.fullyRead)return t.chunksRead++,!1;var n=t.options.chunkSize;return r=t.readChunk(e,n),i=function(e){return!!e&&e.byteLength===n},a?i?i(r):r:(r&&r.then||(r=Promise.resolve(r)),i?r.then(i):r)}catch(e){return Promise.reject(e)}var r,i,a}},{key:"readChunk",value:function(e,t){try{var n=this;if(n.chunksRead++,0===(t=n.safeWrapAddress(e,t)))return;return n._readChunk(e,t)}catch(e){return Promise.reject(e)}}},{key:"safeWrapAddress",value:function(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}},{key:"nextChunkOffset",get:function(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}},{key:"canReadNextChunk",get:function(){return this.chunksRead<this.options.chunkLimit}},{key:"fullyRead",get:function(){return void 0!==this.size&&this.nextChunkOffset===this.size}},{key:"read",value:function(){return this.options.chunked?this.readChunked():this.readWhole()}},{key:"close",value:function(){}}]),o}(Mt);function Nt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var Gt=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"readWhole",value:function(){try{var e=this;return e.chunked=!1,Nt(ne(e.input),(function(t){e._swapArrayBuffer(t)}))}catch(e){return Promise.reject(e)}}},{key:"readChunked",value:function(){return this.chunked=!0,this.size=this.input.size,p(o(i.prototype),"readChunked",this).call(this)}},{key:"_readChunk",value:function(e,t){try{var n=this,r=t?e+t:void 0,i=n.input.slice(e,r);return Nt(ne(i),(function(t){return n.set(t,e,!0)}))}catch(e){return Promise.reject(e)}}}]),i}(Bt);K.set("blob",Gt);var jt=Object.freeze({__proto__:null,default:ut,Exifr:Be,fileParsers:_,segmentParsers:W,fileReaders:K,tagKeys:oe,tagValues:se,tagRevivers:ue,createDictionary:ie,extendDictionary:ae,fetchUrlAsArrayBuffer:te,readBlobAsArrayBuffer:ne,chunkedProps:ye,otherSegments:me,segments:ke,tiffBlocks:Se,segmentsAndBlocks:Ce,tiffExtractables:Pe,inheritables:be,allFormatters:Ae,Options:we,parse:Ne,gps:lt,gpsOnlyOptions:ht,thumbnailUrl:gt,thumbnail:vt,thumbnailOnlyOptions:yt,rotation:kt,orientation:St,orientationOnlyOptions:Ct,rotations:Pt,get rotateCanvas(){return e.rotateCanvas},get rotateCss(){return e.rotateCss}});function Vt(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var zt=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"readWhole",value:function(){try{var e=this;return e.chunked=!1,Vt(te(e.input),(function(t){t instanceof ArrayBuffer?e._swapArrayBuffer(t):t instanceof Uint8Array&&e._swapBuffer(t)}))}catch(e){return Promise.reject(e)}}},{key:"_readChunk",value:function(e,t){try{var n=this,r=t?e+t-1:void 0,i=n.options.httpHeaders||{};return(e||r)&&(i.range="bytes=".concat([e,r].join("-"))),Vt(I(n.input,{headers:i}),(function(r){return Vt(r.arrayBuffer(),(function(i){var a=i.byteLength;if(416!==r.status)return a!==t&&(n.size=e+a),n.set(i,e,!0)}))}))}catch(e){return Promise.reject(e)}}}]),i}(Bt);K.set("url",zt);function Ht(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}V.prototype.getUint64=function(e){var t=this.getUint32(e),n=this.getUint32(e+4);return t<1048575?t<<32|n:void 0!==typeof x?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),x(t)<<x(32)|x(n)):void F("Trying to read 64b value but JS can only handle 53b numbers.")};function _t(e,t,n){if(!e.s){if(n instanceof Wt){if(!n.s)return void(n.o=_t.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(_t.bind(null,e,t),_t.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var Wt=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,i=this.s;if(i){var a=1&i?t:n;if(a){try{_t(r,1,a(this.v))}catch(e){_t(r,2,e)}return r}return this}return this.o=function(e){try{var i=e.v;1&e.s?_t(r,1,t?t(i):i):n?_t(r,1,n(i)):_t(r,2,i)}catch(e){_t(r,2,e)}},r},e}();function Kt(e){return e instanceof Wt&&1&e.s}function Xt(){}function Yt(e,t){if(!t)return e&&e.then?e.then(Xt):Promise.resolve()}var Jt=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parse",value:function(){try{var e=this,t=e.file.getUint32(0),n=e.parseBoxHead(t);return r=function(e,t,n){for(var r;;){var i=e();if(Kt(i)&&(i=i.v),!i)return a;if(i.then){r=0;break}var a=n();if(a&&a.then){if(!Kt(a)){r=1;break}a=a.s}if(t){var o=t();if(o&&o.then&&!Kt(o)){r=2;break}}}var s=new Wt,u=_t.bind(null,s,2);return(0===r?i.then(c):1===r?a.then(f):o.then(l)).then(void 0,u),s;function f(r){a=r;do{if(t&&(o=t())&&o.then&&!Kt(o))return void o.then(l).then(void 0,u);if(!(i=e())||Kt(i)&&!i.v)return void _t(s,1,a);if(i.then)return void i.then(c).then(void 0,u);Kt(a=n())&&(a=a.v)}while(!a||!a.then);a.then(f).then(void 0,u)}function c(e){e?(a=n())&&a.then?a.then(f).then(void 0,u):f(a):_t(s,1,a)}function l(){(i=e())?i.then?i.then(c).then(void 0,u):c(i):_t(s,1,a)}}((function(){return"meta"!==n.kind}),void 0,(function(){return t+=n.length,Ht(e.file.ensureChunk(t,16),(function(){n=e.parseBoxHead(t)}))})),i=function(){return Ht(e.file.ensureChunk(n.offset,n.length),(function(){return e.parseBoxFullHead(n),e.parseSubBoxes(n),t=function(){return function(e){var t=e();if(t&&t.then)return t.then(Xt)}((function(){if(e.options.tiff.enabled)return Yt(e.findExif(n))}))},(r=function(){if(e.options.icc.enabled)return Yt(e.findIcc(n))}())&&r.then?r.then(t):t(r);var t,r}))},r&&r.then?r.then(i):i(r)}catch(e){return Promise.reject(e)}var r,i}},{key:"registerSegment",value:function(e,t,n){try{var r=this;return Ht(r.file.ensureChunk(t,n),(function(){var i=r.file.subarray(t,n);r.createParser(e,i)}))}catch(e){return Promise.reject(e)}}},{key:"findIcc",value:function(e){try{var t=this,n=t.findBox(e,"iprp");if(void 0===n)return;var r=t.findBox(n,"ipco");if(void 0===r)return;var i=t.findBox(r,"colr");if(void 0===i)return;return Yt(t.registerSegment("icc",i.offset+12,i.length))}catch(e){return Promise.reject(e)}}},{key:"findExif",value:function(e){try{var t=this,n=t.findBox(e,"iinf");if(void 0===n)return;var r=t.findBox(e,"iloc");if(void 0===r)return;var i=t.findExifLocIdInIinf(n),a=t.findExtentInIloc(r,i);if(void 0===a)return;var o=a[0],s=a[1];return Ht(t.file.ensureChunk(o,s),(function(){var e=4+t.file.getUint32(o);return o+=e,s-=e,Yt(t.registerSegment("tiff",o,s))}))}catch(e){return Promise.reject(e)}}},{key:"findExifLocIdInIinf",value:function(e){this.parseBoxFullHead(e);var t,n,r,i=e.start,a=this.file.getUint16(i);for(i+=2;a--;){if(t=this.parseBoxHead(i),this.parseBoxFullHead(t),n=t.start,t.version>=2&&(r=3===t.version?4:2,"Exif"===this.file.getString(n+r+2,4)))return this.file.getUintBytes(n,r);i+=t.length}}},{key:"get8bits",value:function(e){var t=this.file.getUint8(e);return[t>>4,15&t]}},{key:"findExtentInIloc",value:function(e,t){this.parseBoxFullHead(e);var n=e.start,r=this.get8bits(n++),i=r[0],a=r[1],o=this.get8bits(n++),s=o[0],u=o[1],f=2===e.version?4:2,c=1===e.version||2===e.version?2:0,l=u+i+a,h=2===e.version?4:2,d=this.file.getUintBytes(n,h);for(n+=h;d--;){var p=this.file.getUintBytes(n,f);n+=f+c+2+s;var g=this.file.getUint16(n);if(n+=2,p===t)return g>1&&console.warn("ILOC box has more than one extent but we're only processing one\nPlease create an issue at https://github.com/MikeKovarik/exifr with this file"),[this.file.getUintBytes(n+u,i),this.file.getUintBytes(n+u+i,a)];n+=g*l}}}],[{key:"canHandle",value:function(e,t){if(0!==t)return!1;var n=e.getUint16(2);if(n>50)return!1;for(var r=16,i=[];r<n;)i.push(e.getString(r,4)),r+=4;return i.includes(this.type)}}]),i}(function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parseBoxes",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=[];e<this.file.byteLength-4;){var n=this.parseBoxHead(e);if(t.push(n),0===n.length)break;e+=n.length}return t}},{key:"parseSubBoxes",value:function(e){e.boxes=this.parseBoxes(e.start)}},{key:"findBox",value:function(e,t){return void 0===e.boxes&&this.parseSubBoxes(e),e.boxes.find((function(e){return e.kind===t}))}},{key:"parseBoxHead",value:function(e){var t=this.file.getUint32(e),n=this.file.getString(e+4,4),r=e+8;return 1===t&&(t=this.file.getUint64(e+8),r+=8),{offset:e,length:t,kind:n,start:r}}},{key:"parseBoxFullHead",value:function(e){if(void 0===e.version){var t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}}]),i}(Ve)),qt=function(e){a(r,e);var n=d(r);function r(){return t(this,r),n.apply(this,arguments)}return r}(Jt);i(qt,"type","heic");var Qt=function(e){a(r,e);var n=d(r);function r(){return t(this,r),n.apply(this,arguments)}return r}(Jt);i(Qt,"type","avif"),_.set("heic",qt),_.set("avif",Qt),ie(oe,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),ie(oe,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),ie(oe,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),ie(se,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);var Zt=ie(se,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]),$t={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};Zt.set(37392,$t),Zt.set(41488,$t);var en={0:"Normal",1:"Low",2:"High"};function tn(e){return"object"==typeof e&&void 0!==e.length?e[0]:e}function nn(e){var t=S(e).slice(1);return t[1]>15&&(t=t.map((function(e){return String.fromCharCode(e)}))),"0"!==t[2]&&0!==t[2]||t.pop(),t.join(".")}function rn(e){if("string"==typeof e){var t=e.trim().split(/[-: ]/g).map(Number),n=t[0],r=t[1],i=t[2],a=t[3],o=t[4],s=t[5],u=new Date(n,r-1,i);return isNaN(a)||isNaN(o)||isNaN(s)||(u.setHours(a),u.setMinutes(o),u.setSeconds(s)),isNaN(+u)?e:u}}function an(e){if("string"==typeof e)return e;var t=[];if(0===e[1]&&0===e[e.length-1])for(var n=0;n<e.length;n+=2)t.push(on(e[n+1],e[n]));else for(var r=0;r<e.length;r+=2)t.push(on(e[r],e[r+1]));return E(String.fromCodePoint.apply(String,t))}function on(e,t){return e<<8|t}Zt.set(41992,en),Zt.set(41993,en),Zt.set(41994,en),ie(ue,["ifd0","ifd1"],[[50827,function(e){return"string"!=typeof e?j(e):e}],[306,rn],[40091,an],[40092,an],[40093,an],[40094,an],[40095,an]]),ie(ue,"exif",[[40960,nn],[36864,nn],[36867,rn],[36868,rn],[40962,tn],[40963,tn]]),ie(ue,"gps",[[0,function(e){return S(e).join(".")}],[7,function(e){return S(e).join(":")}]]);var sn="http://ns.adobe.com/",un="http://ns.adobe.com/xmp/extension/",fn=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"normalizeInput",value:function(e){return"string"==typeof e?e:V.from(e).getString()}},{key:"parse",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.chunk;if(!this.localOptions.parse)return e;e=Pn(e);var t=dn.findAll(e,"rdf","Description");0===t.length&&t.push(new dn("rdf","Description",void 0,e));var n={},r=t;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=S(r));for(var i=0;i<r.length;i++){var a=r[i],o=a.properties;Array.isArray(o)||("function"==typeof o.entries&&(o=o.entries()),o=S(o));for(var s=0;s<o.length;s++){var u=o[s];pn(u,yn(u.ns,n))}}return cn(n)}},{key:"assignToOutput",value:function(e,t){if(this.localOptions.parse){var n=y(t);Array.isArray(n)||("function"==typeof n.entries&&(n=n.entries()),n=S(n));for(var r=0;r<n.length;r++){var i=n[r],a=i[0],o=i[1];switch(a){case"tiff":this.assignObjectToOutput(e,"ifd0",o);break;case"exif":this.assignObjectToOutput(e,"exif",o);break;case"xmlns":break;default:this.assignObjectToOutput(e,a,o)}}}else e.xmp=t}}],[{key:"canHandle",value:function(e,t){return 225===e.getUint8(t+1)&&1752462448===e.getUint32(t+4)&&e.getString(t+4,sn.length)===sn}},{key:"headerLength",value:function(e,t){return e.getString(t+4,un.length)===un?79:4+"http://ns.adobe.com/xap/1.0/".length+1}},{key:"findPosition",value:function(e,t){var n=p(o(i),"findPosition",this).call(this,e,t);return n.multiSegment=n.extended=79===n.headerLength,n.multiSegment?(n.chunkCount=e.getUint8(t+72),n.chunkNumber=e.getUint8(t+76),0!==e.getUint8(t+77)&&n.chunkNumber++):(n.chunkCount=1/0,n.chunkNumber=-1),n}},{key:"handleMultiSegments",value:function(e){return e.map((function(e){return e.chunk.getString()})).join("")}}]),i}(ze);function cn(e){for(var t in e)void 0===(e[t]=M(e[t]))&&delete e[t];return M(e)}i(fn,"type","xmp"),i(fn,"multiSegment",!0),W.set("xmp",fn);var ln=function(){function e(n,r,i){t(this,e),this.ns=n,this.name=r,this.value=i}return r(e,[{key:"serialize",value:function(){return this.value}}],[{key:"findAll",value:function(t){return mn(t,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(e.unpackMatch)}},{key:"unpackMatch",value:function(t){var n=t[1],r=t[2],i=t[3].slice(1,-1);return new e(n,r,i=kn(i))}}]),e}(),hn="[\\w\\d-]+",dn=function(){function e(n,r,i,a){t(this,e),this.ns=n,this.name=r,this.attrString=i,this.innerXml=a,this.attrs=ln.findAll(i),this.children=e.findAll(a),this.value=0===this.children.length?kn(a):void 0,this.properties=[].concat(this.attrs,this.children)}return r(e,[{key:"isPrimitive",get:function(){return void 0!==this.value&&0===this.attrs.length&&0===this.children.length}},{key:"isListContainer",get:function(){return 1===this.children.length&&this.children[0].isList}},{key:"isList",get:function(){var e=this.ns,t=this.name;return"rdf"===e&&("Seq"===t||"Bag"===t||"Alt"===t)}},{key:"isListItem",get:function(){return"rdf"===this.ns&&"li"===this.name}},{key:"serialize",value:function(){if(0!==this.properties.length||void 0!==this.value){if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return vn(this.children.map(gn));if(this.isListItem&&1===this.children.length&&0===this.attrs.length)return this.children[0].serialize();var e={},t=this.properties;Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=S(t));for(var n=0;n<t.length;n++){pn(t[n],e)}return void 0!==this.value&&(e.value=this.value),M(e)}}}],[{key:"findAll",value:function(t,n,r){if(void 0!==n||void 0!==r){n=n||hn,r=r||hn;var i=new RegExp("<(".concat(n,"):(").concat(r,")(#\\d+)?((\\s+?[\\w\\d-:]+=(\"[^\"]*\"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)"),"gm")}else i=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return mn(t,i).map(e.unpackMatch)}},{key:"unpackMatch",value:function(t){return new e(t[1],t[2],t[4],t[8])}}]),e}();function pn(e,t){var n=e.serialize();void 0!==n&&(t[e.name]=n)}var gn=function(e){return e.serialize()},vn=function(e){return 1===e.length?e[0]:e},yn=function(e,t){return t[e]?t[e]:t[e]={}};function mn(e,t){var n,r=[];if(!e)return r;for(;null!==(n=t.exec(e));)r.push(n);return r}function kn(e){if(!function(e){return null==e||"null"===e||"undefined"===e||""===e||""===e.trim()}(e)){var t=Number(e);if(!isNaN(t))return t;var n=e.toLowerCase();return"true"===n||"false"!==n&&e.trim()}}var Sn=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],Cn=new RegExp("(<|\\/)(".concat(Sn.join("|"),")"),"g");function Pn(e){var t={},n={},r=Sn;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=S(r));for(var i=0;i<r.length;i++){var a=r[i];t[a]=[],n[a]=0}return e.replace(Cn,(function(e,r,i){if("<"===r){var a=++n[i];return t[i].push(a),"".concat(e,"#").concat(a)}var o=t[i].pop();return"".concat(e,"#").concat(o)}))}var bn=Object.freeze({__proto__:null,default:jt,Exifr:Be,fileParsers:_,segmentParsers:W,fileReaders:K,tagKeys:oe,tagValues:se,tagRevivers:ue,createDictionary:ie,extendDictionary:ae,fetchUrlAsArrayBuffer:te,readBlobAsArrayBuffer:ne,chunkedProps:ye,otherSegments:me,segments:ke,tiffBlocks:Se,segmentsAndBlocks:Ce,tiffExtractables:Pe,inheritables:be,allFormatters:Ae,Options:we,parse:Ne,gps:lt,gpsOnlyOptions:ht,thumbnailUrl:gt,thumbnail:vt,thumbnailOnlyOptions:yt,rotation:kt,orientation:St,orientationOnlyOptions:Ct,rotations:Pt,get rotateCanvas(){return e.rotateCanvas},get rotateCss(){return e.rotateCss}});function An(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var In=Rn((function(e,t,n){var r=n[e];return r.enabled=!0,r.parse=!0,W.get(e).parse(t,r)})),Tn="undefined"!=typeof Symbol?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function On(e,t,n){if(!e.s){if(n instanceof Dn){if(!n.s)return void(n.o=On.bind(null,e,t));1&t&&(t=n.s),n=n.v}if(n&&n.then)return void n.then(On.bind(null,e,t),On.bind(null,e,2));e.s=t,e.v=n;var r=e.o;r&&r(e)}}var Dn=function(){function e(){}return e.prototype.then=function(t,n){var r=new e,i=this.s;if(i){var a=1&i?t:n;if(a){try{On(r,1,a(this.v))}catch(e){On(r,2,e)}return r}return this}return this.o=function(e){try{var i=e.v;1&e.s?On(r,1,t?t(i):i):n?On(r,1,n(i)):On(r,2,i)}catch(e){On(r,2,e)}},r},e}();function wn(e){return e instanceof Dn&&1&e.s}function xn(e,t,n){if("function"==typeof e[Tn]){var r,i,a,o=e[Tn]();if(function e(s){try{for(;!((r=o.next()).done||n&&n());)if((s=t(r.value))&&s.then){if(!wn(s))return void s.then(e,a||(a=On.bind(null,i=new Dn,2)));s=s.v}i?On(i,1,s):i=s}catch(e){On(i||(i=new Dn),2,e)}}(),o.return){var s=function(e){try{r.done||o.return()}catch(e){}return e};if(i&&i.then)return i.then(s,(function(e){throw s(e)}));s()}return i}if(!("length"in e))throw new TypeError("Object is not iterable");for(var u=[],f=0;f<e.length;f++)u.push(e[f]);return function(e,t,n){var r,i,a=-1;return function o(s){try{for(;++a<e.length&&(!n||!n());)if((s=t(a))&&s.then){if(!wn(s))return void s.then(o,i||(i=On.bind(null,r=new Dn,2)));s=s.v}r?On(r,1,s):r=s}catch(e){On(r||(r=new Dn),2,e)}}(),r}(u,(function(e){return t(u[e])}),n)}function Rn(e){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];try{return Promise.resolve(e.apply(this,t))}catch(e){return Promise.reject(e)}}}var Mn=Rn((function(e,t,n){var r=new we(t);return r.chunked=!1,void 0===n&&"string"==typeof e&&(n=function(e){var t=e.toLowerCase().split(".").pop();if(function(e){return"exif"===e||"tiff"===e||"tif"===e}(t))return"tiff";if(Ln.includes(t))return t}(e)),An($(e,r),(function(e){var t,i,a=!1;return n?Ln.includes(n)?In(n,e,r):void F("Invalid segment type"):function(e){var t=e.getString(0,50).trim();return t.includes("<?xpacket")||t.includes("<x:")}(e)?In("xmp",e,r):(t=xn(W,(function(t){var n=t[0];if(Ln.includes(n))return An(In(n,e,r).catch(Un),(function(e){if(e)return a=!0,e}))}),(function(){return a})),i=function(e){if(a)return e;F("Unknown file format")},t&&t.then?t.then(i):i(t))}))})),Ln=["xmp","icc","iptc","tiff"],Un=function(){};var Fn=function(e){a(i,e);var n=d(i);function i(){var e;t(this,i);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(e=n.call.apply(n,[this].concat(a))).input=e.input.replace(/^data:([^;]+);base64,/gim,""),e.size=e.input.length/4*3,e.input.endsWith("==")?e.size-=2:e.input.endsWith("=")&&(e.size-=1),e}return r(i,[{key:"_readChunk",value:function(e,t){try{var n,r,i=this,a=i.input;void 0===e?(e=0,n=0,r=0):r=e-(n=4*Math.floor(e/3))/4*3,void 0===t&&(t=i.size);var o=e+t,s=n+4*Math.ceil(o/3);a=a.slice(n,s);var u=Math.min(t,i.size-e);if(R){var f=w.from(a,"base64").slice(r,r+u);return i.set(f,e,!0)}for(var c=i.subarray(e,u,!0),l=atob(a),h=c.toUint8(),d=0;d<u;d++)h[d]=l.charCodeAt(r+d);return c}catch(e){return Promise.reject(e)}}}]),i}(Bt);function En(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}function Bn(){}K.set("base64",Fn);var Nn=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"extendOptions",value:function(e){var t=e.ifd0,n=e.xmp,r=e.iptc,i=e.icc;n.enabled&&t.deps.add(le),r.enabled&&t.deps.add(he),i.enabled&&t.deps.add(de),t.finalizeFilters()}},{key:"parse",value:function(){try{var e=this,t=e.options,n=t.tiff,r=t.xmp,i=t.iptc,a=t.icc;return function(e){var t=e();if(t&&t.then)return t.then(Bn)}((function(){if(n.enabled||r.enabled||i.enabled||a.enabled){var t=Math.max(B(e.options),e.options.chunkSize);return En(e.file.ensureChunk(0,t),(function(){return e.createParser("tiff",e.file),e.parsers.tiff.parseHeader(),En(e.parsers.tiff.parseIfd0Block(),(function(){e.adaptTiffPropAsSegment("xmp"),e.adaptTiffPropAsSegment("iptc"),e.adaptTiffPropAsSegment("icc")}))}))}}))}catch(e){return Promise.reject(e)}}},{key:"adaptTiffPropAsSegment",value:function(e){if(this.parsers.tiff[e]){var t=this.parsers.tiff[e];this.injectSegment(e,t)}}}],[{key:"canHandle",value:function(e,t){return 18761===t||19789===t}}]),i}(Ve);function Gn(){}i(Nn,"type","tiff"),_.set("tiff",Nn);function jn(e,t,n){return n?t?t(e):e:(e&&e.then||(e=Promise.resolve(e)),t?e.then(t):e)}var Vn="XML:com.adobe.xmp";var zn="ihdr",Hn="iccp",_n="text",Wn="itxt",Kn=[zn,Hn,_n,Wn,"exif"],Xn=function(e){a(o,e);var n=d(o);function o(){var e;t(this,o);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return i(l(e=n.call.apply(n,[this].concat(a))),"catchError",(function(t){return e.errors.push(t)})),i(l(e),"metaChunks",[]),i(l(e),"unknownChunks",[]),e}return r(o,[{key:"parse",value:function(){try{var e=this,t=e.file;return jn(e.findPngChunksInRange("聣PNG\r\n\n".length,t.byteLength),(function(){return jn(e.readSegments(e.metaChunks),(function(){return e.findIhdr(),e.parseTextChunks(),jn(e.findExif().catch(e.catchError),(function(){return jn(e.findXmp().catch(e.catchError),(function(){return function(e,t){if(!t)return e&&e.then?e.then(Gn):Promise.resolve()}(e.findIcc().catch(e.catchError))}))}))}))}))}catch(e){return Promise.reject(e)}}},{key:"findPngChunksInRange",value:function(e,t){try{for(var n=this,r=n.file;e<t;){var i=r.getUint32(e),a=r.getUint32(e+4),o=r.getString(e+4,4).toLowerCase(),s=i+4+4+4,u={type:o,offset:e,length:s,start:e+4+4,size:i,marker:a};Kn.includes(o)?n.metaChunks.push(u):n.unknownChunks.push(u),e+=s}return jn()}catch(e){return Promise.reject(e)}}},{key:"parseTextChunks",value:function(){var e=this.metaChunks.filter((function(e){return e.type===_n}));Array.isArray(e)||("function"==typeof e.entries&&(e=e.entries()),e=S(e));for(var t=0;t<e.length;t++){var n=e[t],r=this.file.getString(n.start,n.size).split("\0"),i=r[0],a=r[1];this.injectKeyValToIhdr(i,a)}}},{key:"injectKeyValToIhdr",value:function(e,t){var n=this.parsers.ihdr;n&&n.raw.set(e,t)}},{key:"findIhdr",value:function(){var e=this.metaChunks.find((function(e){return e.type===zn}));e&&!1!==this.options.ihdr.enabled&&this.createParser(zn,e.chunk)}},{key:"findExif",value:function(){try{var e=this.metaChunks.find((function(e){return"exif"===e.type}));if(!e)return;return this.injectSegment("tiff",e.chunk),jn()}catch(e){return Promise.reject(e)}}},{key:"findXmp",value:function(){try{var e=this.metaChunks.filter((function(e){return e.type===Wn}));Array.isArray(e)||("function"==typeof e.entries&&(e=e.entries()),e=S(e));for(var t=0;t<e.length;t++){var n=e[t];n.chunk.getString(0,Vn.length)===Vn&&this.injectSegment("xmp",n.chunk)}return jn()}catch(e){return Promise.reject(e)}}},{key:"findIcc",value:function(){try{var e=this,t=e.metaChunks.find((function(e){return e.type===Hn}));if(!t)return;for(var n=t.chunk,r=n.getUint8Array(0,81),i=0;i<80&&0!==r[i];)i++;var a=i+2,o=n.getString(0,i);return e.injectKeyValToIhdr("ProfileName",o),function(e){var t=e();if(t&&t.then)return t.then(Gn)}((function(){if(D)return jn(undefined,(function(t){var r=n.getUint8Array(a);r=t.inflateSync(r),e.injectSegment("icc",r)}))}))}catch(e){return Promise.reject(e)}}}],[{key:"canHandle",value:function(e,t){return 35152===t&&2303741511===e.getUint32(0)&&218765834===e.getUint32(4)}}]),o}(Ve);i(Xn,"type","png"),_.set("png",Xn),ie(oe,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),ae(oe,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);var Yn=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];ae(oe,"ifd0",Yn),ae(oe,"exif",Yn),ie(se,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);var Jn=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parse",value:function(){return this.parseTags(),this.translate(),this.output}},{key:"parseTags",value:function(){this.raw=b([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}],[{key:"canHandle",value:function(e,t){return 224===e.getUint8(t+1)&&1246120262===e.getUint32(t+4)&&0===e.getUint8(t+8)}}]),i}(ze);i(Jn,"type","jfif"),i(Jn,"headerLength",9),W.set("jfif",Jn),ie(oe,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);var qn=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parse",value:function(){return this.parseTags(),this.translate(),this.output}},{key:"parseTags",value:function(){this.raw=b([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)]].concat(S(this.raw)))}}]),i}(ze);i(qn,"type","ihdr"),W.set("ihdr",qn),ie(oe,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),ie(se,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);var Qn="\0\0\0\0",Zn=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parse",value:function(){return this.raw=b(),this.parseHeader(),this.parseTags(),this.translate(),this.output}},{key:"parseHeader",value:function(){var e=this.raw;this.chunk.byteLength<84&&F("ICC header is too short");var t=y($n);Array.isArray(t)||("function"==typeof t.entries&&(t=t.entries()),t=S(t));for(var n=0;n<t.length;n++){var r=t[n],i=r[0],a=r[1];i=parseInt(i,10);var o=a(this.chunk,i);o!==Qn&&e.set(i,o)}}},{key:"parseTags",value:function(){for(var e,t,n,r,i,a=this.raw,o=this.chunk.getUint32(128),s=132,u=this.chunk.byteLength;o--;){if(e=this.chunk.getString(s,4),t=this.chunk.getUint32(s+4),n=this.chunk.getUint32(s+8),r=this.chunk.getString(t,4),t+n>u)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");void 0!==(i=this.parseTag(r,t,n))&&i!==Qn&&a.set(e,i),s+=12}}},{key:"parseTag",value:function(e,t,n){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,n);case"sig ":return this.parseSig(t)}if(!(t+n>this.chunk.byteLength))return this.chunk.getUint8Array(t,n)}},{key:"parseDesc",value:function(e){var t=this.chunk.getUint32(e+8)-1;return E(this.chunk.getString(e+12,t))}},{key:"parseText",value:function(e,t){return E(this.chunk.getString(e+8,t-8))}},{key:"parseSig",value:function(e){return E(this.chunk.getString(e+8,4))}},{key:"parseMluc",value:function(e){for(var t=this.chunk,n=t.getUint32(e+8),r=t.getUint32(e+12),i=e+16,a=[],o=0;o<n;o++){var s=t.getString(i+0,2),u=t.getString(i+2,2),f=t.getUint32(i+4),c=t.getUint32(i+8)+e,l=E(t.getUnicodeString(c,f));a.push({lang:s,country:u,text:l}),i+=r}return 1===n?a[0].text:a}},{key:"translateValue",value:function(e,t){return"string"==typeof e?t[e]||t[e.toLowerCase()]||e:t[e]||e}}],[{key:"canHandle",value:function(e,t){return 226===e.getUint8(t+1)&&1229144927===e.getUint32(t+4)}},{key:"findPosition",value:function(e,t){var n=p(o(i),"findPosition",this).call(this,e,t);return n.chunkNumber=e.getUint8(t+16),n.chunkCount=e.getUint8(t+17),n.multiSegment=n.chunkCount>1,n}},{key:"handleMultiSegments",value:function(e){return t=function(e){var t=e[0].constructor,n=0,r=e;Array.isArray(r)||("function"==typeof r.entries&&(r=r.entries()),r=S(r));for(var i=0;i<r.length;i++)n+=r[i].length;var a=new t(n),o=0,s=e;Array.isArray(s)||("function"==typeof s.entries&&(s=s.entries()),s=S(s));for(var u=0;u<s.length;u++){var f=s[u];a.set(f,o),o+=f.length}return a}(e.map((function(e){return e.chunk.toUint8()}))),new V(t);var t}}]),i}(ze);i(Zn,"type","icc"),i(Zn,"multiSegment",!0),i(Zn,"headerLength",18);var $n={4:er,8:function(e,t){return[e.getUint8(t),e.getUint8(t+1)>>4,e.getUint8(t+1)%16].map((function(e){return e.toString(10)})).join(".")},12:er,16:er,20:er,24:function(e,t){var n=e.getUint16(t),r=e.getUint16(t+2)-1,i=e.getUint16(t+4),a=e.getUint16(t+6),o=e.getUint16(t+8),s=e.getUint16(t+10);return new Date(Date.UTC(n,r,i,a,o,s))},36:er,40:er,48:er,52:er,64:function(e,t){return e.getUint32(t)},80:er};function er(e,t){return E(e.getString(t,4))}W.set("icc",Zn),ie(oe,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);var tr={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},nr={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};ie(se,"icc",[[4,tr],[12,nr],[40,m({},tr,nr)],[48,tr],[80,tr],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);var rr=function(e){a(i,e);var n=d(i);function i(){return t(this,i),n.apply(this,arguments)}return r(i,[{key:"parse",value:function(){for(var e=this.raw,t=this.chunk.byteLength-1,n=!1,r=0;r<t;r++)if(28===this.chunk.getUint8(r)&&2===this.chunk.getUint8(r+1)){n=!0;var i=this.chunk.getUint16(r+3),a=this.chunk.getUint8(r+2),o=this.chunk.getLatin1String(r+5,i);e.set(a,this.pluralizeValue(e.get(a),o)),r+=4+i}else if(n)break;return this.translate(),this.output}},{key:"pluralizeValue",value:function(e,t){return void 0!==e?e instanceof Array?(e.push(t),e):[e,t]:t}}],[{key:"canHandle",value:function(e,t,n){return 237===e.getUint8(t+1)&&"Photoshop"===e.getString(t+4,9)&&void 0!==this.containsIptc8bim(e,t,n)}},{key:"headerLength",value:function(e,t,n){var r,i=this.containsIptc8bim(e,t,n);if(void 0!==i)return(r=e.getUint8(t+i+7))%2!=0&&(r+=1),0===r&&(r=4),i+8+r}},{key:"containsIptc8bim",value:function(e,t,n){for(var r=0;r<n;r++)if(this.isIptcSegmentHead(e,t+r))return r}},{key:"isIptcSegmentHead",value:function(e,t){return 56===e.getUint8(t)&&943868237===e.getUint32(t)&&1028===e.getUint16(t+4)}}]),i}(ze);i(rr,"type","iptc"),i(rr,"translateValues",!1),i(rr,"reviveValues",!1),W.set("iptc",rr),ie(oe,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),ie(se,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]),e.Exifr=Be,e.Options=we,e.allFormatters=Ae,e.chunkedProps=ye,e.createDictionary=ie,e.default=bn,e.extendDictionary=ae,e.fetchUrlAsArrayBuffer=te,e.fileParsers=_,e.fileReaders=K,e.gps=lt,e.gpsOnlyOptions=ht,e.inheritables=be,e.orientation=St,e.orientationOnlyOptions=Ct,e.otherSegments=me,e.parse=Ne,e.readBlobAsArrayBuffer=ne,e.rotation=kt,e.rotations=Pt,e.segmentParsers=W,e.segments=ke,e.segmentsAndBlocks=Ce,e.sidecar=Mn,e.tagKeys=oe,e.tagRevivers=ue,e.tagValues=se,e.thumbnail=vt,e.thumbnailOnlyOptions=yt,e.thumbnailUrl=gt,e.tiffBlocks=Se,e.tiffExtractables=Pe,Object.defineProperty(e,"__esModule",{value:!0})}));
node_modules\exifr\dist\full.umd.js:1:!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define("exifr",["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).exifr={})}(this,(function(e){"use strict";var t="undefined"!=typeof self?self:global;const i="undefined"!=typeof navigator,n=i&&"undefined"==typeof HTMLImageElement,s=!("undefined"==typeof global||"undefined"==typeof process||!process.versions||!process.versions.node),r=t.Buffer,a=t.BigInt,o=!!r,l=e=>e;function h(e,t=l){if(s)try{return"function"==typeof require?Promise.resolve(t(require(e))):import(/* webpackIgnore: true */ e).then(t)}catch(t){console.warn(`Couldn't load ${e}`)}}let u=t.fetch;const c=e=>u=e;if(!t.fetch){const e=h("http",(e=>e)),t=h("https",(e=>e)),i=(n,{headers:s}={})=>new Promise((async(r,a)=>{let{port:o,hostname:l,pathname:h,protocol:u,search:c}=new URL(n);const f={method:"GET",hostname:l,path:encodeURI(h)+c,headers:s};""!==o&&(f.port=Number(o));const d=("https:"===u?await t:await e).request(f,(e=>{if(301===e.statusCode||302===e.statusCode){let t=new URL(e.headers.location,n).toString();return i(t,{headers:s}).then(r).catch(a)}r({status:e.statusCode,arrayBuffer:()=>new Promise((t=>{let i=[];e.on("data",(e=>i.push(e))),e.on("end",(()=>t(Buffer.concat(i))))}))})}));d.on("error",a),d.end()}));c(i)}function f(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}const d=e=>g(e)?void 0:e,p=e=>void 0!==e;function g(e){return void 0===e||(e instanceof Map?0===e.size:0===Object.values(e).filter(p).length)}function m(e){let t=new Error(e);throw delete t.stack,t}function S(e){return""===(e=function(e){for(;e.endsWith("\0");)e=e.slice(0,-1);return e}(e).trim())?void 0:e}function C(e){let t=function(e){let t=0;return e.ifd0.enabled&&(t+=1024),e.exif.enabled&&(t+=2048),e.makerNote&&(t+=2048),e.userComment&&(t+=1024),e.gps.enabled&&(t+=512),e.interop.enabled&&(t+=100),e.ifd1.enabled&&(t+=1024),t+2048}(e);return e.jfif.enabled&&(t+=50),e.xmp.enabled&&(t+=2e4),e.iptc.enabled&&(t+=14e3),e.icc.enabled&&(t+=6e3),t}const y=e=>String.fromCharCode.apply(null,e),b="undefined"!=typeof TextDecoder?new TextDecoder("utf-8"):void 0;function P(e){return b?b.decode(e):o?Buffer.from(e).toString("utf8"):decodeURIComponent(escape(y(e)))}class I{static from(e,t){return e instanceof this&&e.le===t?e:new I(e,void 0,void 0,t)}constructor(e,t=0,i,n){if("boolean"==typeof n&&(this.le=n),Array.isArray(e)&&(e=new Uint8Array(e)),0===e)this.byteOffset=0,this.byteLength=0;else if(e instanceof ArrayBuffer){void 0===i&&(i=e.byteLength-t);let n=new DataView(e,t,i);this._swapDataView(n)}else if(e instanceof Uint8Array||e instanceof DataView||e instanceof I){void 0===i&&(i=e.byteLength-t),(t+=e.byteOffset)+i>e.byteOffset+e.byteLength&&m("Creating view outside of available memory in ArrayBuffer");let n=new DataView(e.buffer,t,i);this._swapDataView(n)}else if("number"==typeof e){let t=new DataView(new ArrayBuffer(e));this._swapDataView(t)}else m("Invalid input argument for BufferView: "+e)}_swapArrayBuffer(e){this._swapDataView(new DataView(e))}_swapBuffer(e){this._swapDataView(new DataView(e.buffer,e.byteOffset,e.byteLength))}_swapDataView(e){this.dataView=e,this.buffer=e.buffer,this.byteOffset=e.byteOffset,this.byteLength=e.byteLength}_lengthToEnd(e){return this.byteLength-e}set(e,t,i=I){return e instanceof DataView||e instanceof I?e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e instanceof ArrayBuffer&&(e=new Uint8Array(e)),e instanceof Uint8Array||m("BufferView.set(): Invalid data argument."),this.toUint8().set(e,t),new i(this,t,e.byteLength)}subarray(e,t){return t=t||this._lengthToEnd(e),new I(this,e,t)}toUint8(){return new Uint8Array(this.buffer,this.byteOffset,this.byteLength)}getUint8Array(e,t){return new Uint8Array(this.buffer,this.byteOffset+e,t)}getString(e=0,t=this.byteLength){return P(this.getUint8Array(e,t))}getLatin1String(e=0,t=this.byteLength){let i=this.getUint8Array(e,t);return y(i)}getUnicodeString(e=0,t=this.byteLength){const i=[];for(let n=0;n<t&&e+n<this.byteLength;n+=2)i.push(this.getUint16(e+n));return y(i)}getInt8(e){return this.dataView.getInt8(e)}getUint8(e){return this.dataView.getUint8(e)}getInt16(e,t=this.le){return this.dataView.getInt16(e,t)}getInt32(e,t=this.le){return this.dataView.getInt32(e,t)}getUint16(e,t=this.le){return this.dataView.getUint16(e,t)}getUint32(e,t=this.le){return this.dataView.getUint32(e,t)}getFloat32(e,t=this.le){return this.dataView.getFloat32(e,t)}getFloat64(e,t=this.le){return this.dataView.getFloat64(e,t)}getFloat(e,t=this.le){return this.dataView.getFloat32(e,t)}getDouble(e,t=this.le){return this.dataView.getFloat64(e,t)}getUintBytes(e,t,i){switch(t){case 1:return this.getUint8(e,i);case 2:return this.getUint16(e,i);case 4:return this.getUint32(e,i);case 8:return this.getUint64&&this.getUint64(e,i)}}getUint(e,t,i){switch(t){case 8:return this.getUint8(e,i);case 16:return this.getUint16(e,i);case 32:return this.getUint32(e,i);case 64:return this.getUint64&&this.getUint64(e,i)}}toString(e){return this.dataView.toString(e,this.constructor.name)}ensureChunk(){}}function k(e,t){m(`${e} '${t}' was not loaded, try using full build of exifr.`)}class w extends Map{constructor(e){super(),this.kind=e}get(e,t){return this.has(e)||k(this.kind,e),t&&(e in t||function(e,t){m(`Unknown ${e} '${t}'.`)}(this.kind,e),t[e].enabled||k(this.kind,e)),super.get(e)}keyList(){return Array.from(this.keys())}}var T=new w("file parser"),A=new w("segment parser"),D=new w("file reader");const O="Invalid input argument";function x(e,t){return"string"==typeof e?v(e,t):i&&!n&&e instanceof HTMLImageElement?v(e.src,t):e instanceof Uint8Array||e instanceof ArrayBuffer||e instanceof DataView?new I(e):i&&e instanceof Blob?M(e,t,"blob",U):void m(O)}function v(e,t){return(n=e).startsWith("data:")||n.length>1e4?R(e,t,"base64"):s&&e.includes("://")?M(e,t,"url",L):s?R(e,t,"fs"):i?M(e,t,"url",L):void m(O);var n}async function M(e,t,i,n){return D.has(i)?R(e,t,i):n?async function(e,t){let i=await t(e);return new I(i)}(e,n):void m(`Parser ${i} is not loaded`)}async function R(e,t,i){let n=new(D.get(i))(e,t);return await n.read(),n}const L=e=>u(e).then((e=>e.arrayBuffer())),U=e=>new Promise(((t,i)=>{let n=new FileReader;n.onloadend=()=>t(n.result||new ArrayBuffer),n.onerror=i,n.readAsArrayBuffer(e)}));class F extends Map{get tagKeys(){return this.allKeys||(this.allKeys=Array.from(this.keys())),this.allKeys}get tagValues(){return this.allValues||(this.allValues=Array.from(this.values())),this.allValues}}function B(e,t,i){let n=new F;for(let[e,t]of i)n.set(e,t);if(Array.isArray(t))for(let i of t)e.set(i,n);else e.set(t,n);return n}function E(e,t,i){let n,s=e.get(t);for(n of i)s.set(n[0],n[1])}const N=new Map,G=new Map,V=new Map,z=37500,H=37510,j=700,W=33723,K=34675,X=34665,_=34853,Y=40965,$=["chunked","firstChunkSize","firstChunkSizeNode","firstChunkSizeBrowser","chunkSize","chunkLimit"],J=["jfif","xmp","icc","iptc","ihdr"],q=["tiff",...J],Q=["ifd0","ifd1","exif","gps","interop"],Z=[...q,...Q],ee=["makerNote","userComment"],te=["translateKeys","translateValues","reviveValues","multiSegment"],ie=[...te,"sanitize","mergeOutput","silentErrors"];class ne{get translate(){return this.translateKeys||this.translateValues||this.reviveValues}}class se extends ne{get needed(){return this.enabled||this.deps.size>0}constructor(e,t,i,n){if(super(),f(this,"enabled",!1),f(this,"skip",new Set),f(this,"pick",new Set),f(this,"deps",new Set),f(this,"translateKeys",!1),f(this,"translateValues",!1),f(this,"reviveValues",!1),this.key=e,this.enabled=t,this.parse=this.enabled,this.applyInheritables(n),this.canBeFiltered=Q.includes(e),this.canBeFiltered&&(this.dict=N.get(e)),void 0!==i)if(Array.isArray(i))this.parse=this.enabled=!0,this.canBeFiltered&&i.length>0&&this.translateTagSet(i,this.pick);else if("object"==typeof i){if(this.enabled=!0,this.parse=!1!==i.parse,this.canBeFiltered){let{pick:e,skip:t}=i;e&&e.length>0&&this.translateTagSet(e,this.pick),t&&t.length>0&&this.translateTagSet(t,this.skip)}this.applyInheritables(i)}else!0===i||!1===i?this.parse=this.enabled=i:m(`Invalid options argument: ${i}`)}applyInheritables(e){let t,i;for(t of te)i=e[t],void 0!==i&&(this[t]=i)}translateTagSet(e,t){if(this.dict){let i,n,{tagKeys:s,tagValues:r}=this.dict;for(i of e)"string"==typeof i?(n=r.indexOf(i),-1===n&&(n=s.indexOf(Number(i))),-1!==n&&t.add(Number(s[n]))):t.add(i)}else for(let i of e)t.add(i)}finalizeFilters(){!this.enabled&&this.deps.size>0?(this.enabled=!0,ue(this.pick,this.deps)):this.enabled&&this.pick.size>0&&ue(this.pick,this.deps)}}var re={jfif:!1,tiff:!0,xmp:!1,icc:!1,iptc:!1,ifd0:!0,ifd1:!1,exif:!0,gps:!0,interop:!1,ihdr:void 0,makerNote:!1,userComment:!1,multiSegment:!1,skip:[],pick:[],translateKeys:!0,translateValues:!0,reviveValues:!0,sanitize:!0,mergeOutput:!0,silentErrors:!0,chunked:!0,firstChunkSize:void 0,firstChunkSizeNode:512,firstChunkSizeBrowser:65536,chunkSize:65536,chunkLimit:5},ae=new Map;class oe extends ne{static useCached(e){let t=ae.get(e);return void 0!==t||(t=new this(e),ae.set(e,t)),t}constructor(e){super(),!0===e?this.setupFromTrue():void 0===e?this.setupFromUndefined():Array.isArray(e)?this.setupFromArray(e):"object"==typeof e?this.setupFromObject(e):m(`Invalid options argument ${e}`),void 0===this.firstChunkSize&&(this.firstChunkSize=i?this.firstChunkSizeBrowser:this.firstChunkSizeNode),this.mergeOutput&&(this.ifd1.enabled=!1),this.filterNestedSegmentTags(),this.traverseTiffDependencyTree(),this.checkLoadedPlugins()}setupFromUndefined(){let e;for(e of $)this[e]=re[e];for(e of ie)this[e]=re[e];for(e of ee)this[e]=re[e];for(e of Z)this[e]=new se(e,re[e],void 0,this)}setupFromTrue(){let e;for(e of $)this[e]=re[e];for(e of ie)this[e]=re[e];for(e of ee)this[e]=!0;for(e of Z)this[e]=new se(e,!0,void 0,this)}setupFromArray(e){let t;for(t of $)this[t]=re[t];for(t of ie)this[t]=re[t];for(t of ee)this[t]=re[t];for(t of Z)this[t]=new se(t,!1,void 0,this);this.setupGlobalFilters(e,void 0,Q)}setupFromObject(e){let t;for(t of(Q.ifd0=Q.ifd0||Q.image,Q.ifd1=Q.ifd1||Q.thumbnail,Object.assign(this,e),$))this[t]=he(e[t],re[t]);for(t of ie)this[t]=he(e[t],re[t]);for(t of ee)this[t]=he(e[t],re[t]);for(t of q)this[t]=new se(t,re[t],e[t],this);for(t of Q)this[t]=new se(t,re[t],e[t],this.tiff);this.setupGlobalFilters(e.pick,e.skip,Q,Z),!0===e.tiff?this.batchEnableWithBool(Q,!0):!1===e.tiff?this.batchEnableWithUserValue(Q,e):Array.isArray(e.tiff)?this.setupGlobalFilters(e.tiff,void 0,Q):"object"==typeof e.tiff&&this.setupGlobalFilters(e.tiff.pick,e.tiff.skip,Q)}batchEnableWithBool(e,t){for(let i of e)this[i].enabled=t}batchEnableWithUserValue(e,t){for(let i of e){let e=t[i];this[i].enabled=!1!==e&&void 0!==e}}setupGlobalFilters(e,t,i,n=i){if(e&&e.length){for(let e of n)this[e].enabled=!1;let t=le(e,i);for(let[e,i]of t)ue(this[e].pick,i),this[e].enabled=!0}else if(t&&t.length){let e=le(t,i);for(let[t,i]of e)ue(this[t].skip,i)}}filterNestedSegmentTags(){let{ifd0:e,exif:t,xmp:i,iptc:n,icc:s}=this;this.makerNote?t.deps.add(z):t.skip.add(z),this.userComment?t.deps.add(H):t.skip.add(H),i.enabled||e.skip.add(j),n.enabled||e.skip.add(W),s.enabled||e.skip.add(K)}traverseTiffDependencyTree(){let{ifd0:e,exif:t,gps:i,interop:n}=this;n.needed&&(t.deps.add(Y),e.deps.add(Y)),t.needed&&e.deps.add(X),i.needed&&e.deps.add(_),this.tiff.enabled=Q.some((e=>!0===this[e].enabled))||this.makerNote||this.userComment;for(let e of Q)this[e].finalizeFilters()}get onlyTiff(){return!J.map((e=>this[e].enabled)).some((e=>!0===e))&&this.tiff.enabled}checkLoadedPlugins(){for(let e of q)this[e].enabled&&!A.has(e)&&k("segment parser",e)}}function le(e,t){let i,n,s,r,a=[];for(s of t){for(r of(i=N.get(s),n=[],i))(e.includes(r[0])||e.includes(r[1]))&&n.push(r[0]);n.length&&a.push([s,n])}return a}function he(e,t){return void 0!==e?e:void 0!==t?t:void 0}function ue(e,t){for(let i of t)e.add(i)}f(oe,"default",re);class ce{constructor(e){f(this,"parsers",{}),f(this,"output",{}),f(this,"errors",[]),f(this,"pushToErrors",(e=>this.errors.push(e))),this.options=oe.useCached(e)}async read(e){this.file=await x(e,this.options)}setup(){if(this.fileParser)return;let{file:e}=this,t=e.getUint16(0);for(let[i,n]of T)if(n.canHandle(e,t))return this.fileParser=new n(this.options,this.file,this.parsers),e[i]=!0;this.file.close&&this.file.close(),m("Unknown file format")}async parse(){let{output:e,errors:t}=this;return this.setup(),this.options.silentErrors?(await this.executeParsers().catch(this.pushToErrors),t.push(...this.fileParser.errors)):await this.executeParsers(),this.file.close&&this.file.close(),this.options.silentErrors&&t.length>0&&(e.errors=t),d(e)}async executeParsers(){let{output:e}=this;await this.fileParser.parse();let t=Object.values(this.parsers).map((async t=>{let i=await t.parse();t.assignToOutput(e,i)}));this.options.silentErrors&&(t=t.map((e=>e.catch(this.pushToErrors)))),await Promise.all(t)}async extractThumbnail(){this.setup();let{options:e,file:t}=this,i=A.get("tiff",e);var n;if(t.tiff?n={start:0,type:"tiff"}:t.jpeg&&(n=await this.fileParser.getOrFindSegment("tiff")),void 0===n)return;let s=await this.fileParser.ensureSegmentChunk(n),r=this.parsers.tiff=new i(s,e,t),a=await r.extractThumbnail();return t.close&&t.close(),a}}async function fe(e,t){let i=new ce(t);return await i.read(e),i.parse()}var de=Object.freeze({__proto__:null,parse:fe,Exifr:ce,fileParsers:T,segmentParsers:A,fileReaders:D,tagKeys:N,tagValues:G,tagRevivers:V,createDictionary:B,extendDictionary:E,fetchUrlAsArrayBuffer:L,readBlobAsArrayBuffer:U,chunkedProps:$,otherSegments:J,segments:q,tiffBlocks:Q,segmentsAndBlocks:Z,tiffExtractables:ee,inheritables:te,allFormatters:ie,Options:oe});class pe{constructor(e,t,i){f(this,"errors",[]),f(this,"ensureSegmentChunk",(async e=>{let t=e.start,i=e.size||65536;if(this.file.chunked)if(this.file.available(t,i))e.chunk=this.file.subarray(t,i);else try{e.chunk=await this.file.readChunk(t,i)}catch(t){m(`Couldn't read segment: ${JSON.stringify(e)}. ${t.message}`)}else this.file.byteLength>t+i?e.chunk=this.file.subarray(t,i):void 0===e.size?e.chunk=this.file.subarray(t):m("Segment unreachable: "+JSON.stringify(e));return e.chunk})),this.extendOptions&&this.extendOptions(e),this.options=e,this.file=t,this.parsers=i}injectSegment(e,t){this.options[e].enabled&&this.createParser(e,t)}createParser(e,t){let i=new(A.get(e))(t,this.options,this.file);return this.parsers[e]=i}createParsers(e){for(let t of e){let{type:e,chunk:i}=t,n=this.options[e];if(n&&n.enabled){let t=this.parsers[e];t&&t.append||t||this.createParser(e,i)}}}async readSegments(e){let t=e.map(this.ensureSegmentChunk);await Promise.all(t)}}class ge{static findPosition(e,t){let i=e.getUint16(t+2)+2,n="function"==typeof this.headerLength?this.headerLength(e,t,i):this.headerLength,s=t+n,r=i-n;return{offset:t,length:i,headerLength:n,start:s,size:r,end:s+r}}static parse(e,t={}){return new this(e,new oe({[this.type]:t}),e).parse()}normalizeInput(e){return e instanceof I?e:new I(e)}constructor(e,t={},i){f(this,"errors",[]),f(this,"raw",new Map),f(this,"handleError",(e=>{if(!this.options.silentErrors)throw e;this.errors.push(e.message)})),this.chunk=this.normalizeInput(e),this.file=i,this.type=this.constructor.type,this.globalOptions=this.options=t,this.localOptions=t[this.type],this.canTranslate=this.localOptions&&this.localOptions.translate}translate(){this.canTranslate&&(this.translated=this.translateBlock(this.raw,this.type))}get output(){return this.translated?this.translated:this.raw?Object.fromEntries(this.raw):void 0}translateBlock(e,t){let i=V.get(t),n=G.get(t),s=N.get(t),r=this.options[t],a=r.reviveValues&&!!i,o=r.translateValues&&!!n,l=r.translateKeys&&!!s,h={};for(let[t,r]of e)a&&i.has(t)?r=i.get(t)(r):o&&n.has(t)&&(r=this.translateValue(r,n.get(t))),l&&s.has(t)&&(t=s.get(t)||t),h[t]=r;return h}translateValue(e,t){return t[e]||t.DEFAULT||e}assignToOutput(e,t){this.assignObjectToOutput(e,this.constructor.type,t)}assignObjectToOutput(e,t,i){if(this.globalOptions.mergeOutput)return Object.assign(e,i);e[t]?Object.assign(e[t],i):e[t]=i}}f(ge,"headerLength",4),f(ge,"type",void 0),f(ge,"multiSegment",!1),f(ge,"canHandle",(()=>!1));function me(e){return 192===e||194===e||196===e||219===e||221===e||218===e||254===e}function Se(e){return e>=224&&e<=239}function Ce(e,t,i){for(let[n,s]of A)if(s.canHandle(e,t,i))return n}class ye extends pe{constructor(...e){super(...e),f(this,"appSegments",[]),f(this,"jpegSegments",[]),f(this,"unknownSegments",[])}static canHandle(e,t){return 65496===t}async parse(){await this.findAppSegments(),await this.readSegments(this.appSegments),this.mergeMultiSegments(),this.createParsers(this.mergedAppSegments||this.appSegments)}setupSegmentFinderArgs(e){!0===e?(this.findAll=!0,this.wanted=new Set(A.keyList())):(e=void 0===e?A.keyList().filter((e=>this.options[e].enabled)):e.filter((e=>this.options[e].enabled&&A.has(e))),this.findAll=!1,this.remaining=new Set(e),this.wanted=new Set(e)),this.unfinishedMultiSegment=!1}async findAppSegments(e=0,t){this.setupSegmentFinderArgs(t);let{file:i,findAll:n,wanted:s,remaining:r}=this;if(!n&&this.file.chunked&&(n=Array.from(s).some((e=>{let t=A.get(e),i=this.options[e];return t.multiSegment&&i.multiSegment})),n&&await this.file.readWhole()),e=this.findAppSegmentsInRange(e,i.byteLength),!this.options.onlyTiff&&i.chunked){let t=!1;for(;r.size>0&&!t&&(i.canReadNextChunk||this.unfinishedMultiSegment);){let{nextChunkOffset:n}=i,s=this.appSegments.some((e=>!this.file.available(e.offset||e.start,e.length||e.size)));if(t=e>n&&!s?!await i.readNextChunk(e):!await i.readNextChunk(n),void 0===(e=this.findAppSegmentsInRange(e,i.byteLength)))return}}}findAppSegmentsInRange(e,t){t-=2;let i,n,s,r,a,o,{file:l,findAll:h,wanted:u,remaining:c,options:f}=this;for(;e<t;e++)if(255===l.getUint8(e))if(i=l.getUint8(e+1),Se(i)){if(n=l.getUint16(e+2),s=Ce(l,e,n),s&&u.has(s)&&(r=A.get(s),a=r.findPosition(l,e),o=f[s],a.type=s,this.appSegments.push(a),!h&&(r.multiSegment&&o.multiSegment?(this.unfinishedMultiSegment=a.chunkNumber<a.chunkCount,this.unfinishedMultiSegment||c.delete(s)):c.delete(s),0===c.size)))break;f.recordUnknownSegments&&(a=ge.findPosition(l,e),a.marker=i,this.unknownSegments.push(a)),e+=n+1}else if(me(i)){if(n=l.getUint16(e+2),218===i&&!1!==f.stopAfterSos)return;f.recordJpegSegments&&this.jpegSegments.push({offset:e,length:n,marker:i}),e+=n+1}return e}mergeMultiSegments(){if(!this.appSegments.some((e=>e.multiSegment)))return;let e=function(e,t){let i,n,s,r=new Map;for(let a=0;a<e.length;a++)i=e[a],n=i[t],r.has(n)?s=r.get(n):r.set(n,s=[]),s.push(i);return Array.from(r)}(this.appSegments,"type");this.mergedAppSegments=e.map((([e,t])=>{let i=A.get(e,this.options);if(i.handleMultiSegments){return{type:e,chunk:i.handleMultiSegments(t)}}return t[0]}))}getSegment(e){return this.appSegments.find((t=>t.type===e))}async getOrFindSegment(e){let t=this.getSegment(e);return void 0===t&&(await this.findAppSegments(0,[e]),t=this.getSegment(e)),t}}f(ye,"type","jpeg"),T.set("jpeg",ye);const be=[void 0,1,1,2,4,8,1,1,2,4,8,4,8,4];class Pe extends ge{parseHeader(){var e=this.chunk.getUint16();18761===e?this.le=!0:19789===e&&(this.le=!1),this.chunk.le=this.le,this.headerParsed=!0}parseTags(e,t,i=new Map){let{pick:n,skip:s}=this.options[t];n=new Set(n);let r=n.size>0,a=0===s.size,o=this.chunk.getUint16(e);e+=2;for(let l=0;l<o;l++){let o=this.chunk.getUint16(e);if(r){if(n.has(o)&&(i.set(o,this.parseTag(e,o,t)),n.delete(o),0===n.size))break}else!a&&s.has(o)||i.set(o,this.parseTag(e,o,t));e+=12}return i}parseTag(e,t,i){let{chunk:n}=this,s=n.getUint16(e+2),r=n.getUint32(e+4),a=be[s];if(a*r<=4?e+=8:e=n.getUint32(e+8),(s<1||s>13)&&m(`Invalid TIFF value type. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e}`),e>n.byteLength&&m(`Invalid TIFF value offset. block: ${i.toUpperCase()}, tag: ${t.toString(16)}, type: ${s}, offset ${e} is outside of chunk size ${n.byteLength}`),1===s)return n.getUint8Array(e,r);if(2===s)return S(n.getString(e,r));if(7===s)return n.getUint8Array(e,r);if(1===r)return this.parseTagValue(s,e);{let t=new(function(e){switch(e){case 1:return Uint8Array;case 3:return Uint16Array;case 4:return Uint32Array;case 5:return Array;case 6:return Int8Array;case 8:return Int16Array;case 9:return Int32Array;case 10:return Array;case 11:return Float32Array;case 12:return Float64Array;default:return Array}}(s))(r),i=a;for(let n=0;n<r;n++)t[n]=this.parseTagValue(s,e),e+=i;return t}}parseTagValue(e,t){let{chunk:i}=this;switch(e){case 1:return i.getUint8(t);case 3:return i.getUint16(t);case 4:return i.getUint32(t);case 5:return i.getUint32(t)/i.getUint32(t+4);case 6:return i.getInt8(t);case 8:return i.getInt16(t);case 9:return i.getInt32(t);case 10:return i.getInt32(t)/i.getInt32(t+4);case 11:return i.getFloat(t);case 12:return i.getDouble(t);case 13:return i.getUint32(t);default:m(`Invalid tiff type ${e}`)}}}class Ie extends Pe{static canHandle(e,t){return 225===e.getUint8(t+1)&&1165519206===e.getUint32(t+4)&&0===e.getUint16(t+8)}async parse(){this.parseHeader();let{options:e}=this;return e.ifd0.enabled&&await this.parseIfd0Block(),e.exif.enabled&&await this.safeParse("parseExifBlock"),e.gps.enabled&&await this.safeParse("parseGpsBlock"),e.interop.enabled&&await this.safeParse("parseInteropBlock"),e.ifd1.enabled&&await this.safeParse("parseThumbnailBlock"),this.createOutput()}safeParse(e){let t=this[e]();return void 0!==t.catch&&(t=t.catch(this.handleError)),t}findIfd0Offset(){void 0===this.ifd0Offset&&(this.ifd0Offset=this.chunk.getUint32(4))}findIfd1Offset(){if(void 0===this.ifd1Offset){this.findIfd0Offset();let e=this.chunk.getUint16(this.ifd0Offset),t=this.ifd0Offset+2+12*e;this.ifd1Offset=this.chunk.getUint32(t)}}parseBlock(e,t){let i=new Map;return this[t]=i,this.parseTags(e,t,i),i}async parseIfd0Block(){if(this.ifd0)return;let{file:e}=this;this.findIfd0Offset(),this.ifd0Offset<8&&m("Malformed EXIF data"),!e.chunked&&this.ifd0Offset>e.byteLength&&m(`IFD0 offset points to outside of file.\nthis.ifd0Offset: ${this.ifd0Offset}, file.byteLength: ${e.byteLength}`),e.tiff&&await e.ensureChunk(this.ifd0Offset,C(this.options));let t=this.parseBlock(this.ifd0Offset,"ifd0");return 0!==t.size?(this.exifOffset=t.get(X),this.interopOffset=t.get(Y),this.gpsOffset=t.get(_),this.xmp=t.get(j),this.iptc=t.get(W),this.icc=t.get(K),this.options.sanitize&&(t.delete(X),t.delete(Y),t.delete(_),t.delete(j),t.delete(W),t.delete(K)),t):void 0}async parseExifBlock(){if(this.exif)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.exifOffset)return;this.file.tiff&&await this.file.ensureChunk(this.exifOffset,C(this.options));let e=this.parseBlock(this.exifOffset,"exif");return this.interopOffset||(this.interopOffset=e.get(Y)),this.makerNote=e.get(z),this.userComment=e.get(H),this.options.sanitize&&(e.delete(Y),e.delete(z),e.delete(H)),this.unpack(e,41728),this.unpack(e,41729),e}unpack(e,t){let i=e.get(t);i&&1===i.length&&e.set(t,i[0])}async parseGpsBlock(){if(this.gps)return;if(this.ifd0||await this.parseIfd0Block(),void 0===this.gpsOffset)return;let e=this.parseBlock(this.gpsOffset,"gps");return e&&e.has(2)&&e.has(4)&&(e.set("latitude",ke(...e.get(2),e.get(1))),e.set("longitude",ke(...e.get(4),e.get(3)))),e}async parseInteropBlock(){if(!this.interop&&(this.ifd0||await this.parseIfd0Block(),void 0!==this.interopOffset||this.exif||await this.parseExifBlock(),void 0!==this.interopOffset))return this.parseBlock(this.interopOffset,"interop")}async parseThumbnailBlock(e=!1){if(!this.ifd1&&!this.ifd1Parsed&&(!this.options.mergeOutput||e))return this.findIfd1Offset(),this.ifd1Offset>0&&(this.parseBlock(this.ifd1Offset,"ifd1"),this.ifd1Parsed=!0),this.ifd1}async extractThumbnail(){if(this.headerParsed||this.parseHeader(),this.ifd1Parsed||await this.parseThumbnailBlock(!0),void 0===this.ifd1)return;let e=this.ifd1.get(513),t=this.ifd1.get(514);return this.chunk.getUint8Array(e,t)}get image(){return this.ifd0}get thumbnail(){return this.ifd1}createOutput(){let e,t,i,n={};for(t of Q)if(e=this[t],!g(e))if(i=this.canTranslate?this.translateBlock(e,t):Object.fromEntries(e),this.options.mergeOutput){if("ifd1"===t)continue;Object.assign(n,i)}else n[t]=i;return this.makerNote&&(n.makerNote=this.makerNote),this.userComment&&(n.userComment=this.userComment),n}assignToOutput(e,t){if(this.globalOptions.mergeOutput)Object.assign(e,t);else for(let[i,n]of Object.entries(t))this.assignObjectToOutput(e,i,n)}}function ke(e,t,i,n){var s=e+t/60+i/3600;return"S"!==n&&"W"!==n||(s*=-1),s}f(Ie,"type","tiff"),f(Ie,"headerLength",10),A.set("tiff",Ie);var we=Object.freeze({__proto__:null,default:de,Exifr:ce,fileParsers:T,segmentParsers:A,fileReaders:D,tagKeys:N,tagValues:G,tagRevivers:V,createDictionary:B,extendDictionary:E,fetchUrlAsArrayBuffer:L,readBlobAsArrayBuffer:U,chunkedProps:$,otherSegments:J,segments:q,tiffBlocks:Q,segmentsAndBlocks:Z,tiffExtractables:ee,inheritables:te,allFormatters:ie,Options:oe,parse:fe});const Te={ifd0:!1,ifd1:!1,exif:!1,gps:!1,interop:!1,sanitize:!1,reviveValues:!0,translateKeys:!1,translateValues:!1,mergeOutput:!1},Ae=Object.assign({},Te,{firstChunkSize:4e4,gps:[1,2,3,4]});async function De(e){let t=new ce(Ae);await t.read(e);let i=await t.parse();if(i&&i.gps){let{latitude:e,longitude:t}=i.gps;return{latitude:e,longitude:t}}}const Oe=Object.assign({},Te,{tiff:!1,ifd1:!0,mergeOutput:!1});async function xe(e){let t=new ce(Oe);await t.read(e);let i=await t.extractThumbnail();return i&&o?r.from(i):i}async function ve(e){let t=await this.thumbnail(e);if(void 0!==t){let e=new Blob([t]);return URL.createObjectURL(e)}}const Me=Object.assign({},Te,{firstChunkSize:4e4,ifd0:[274]});async function Re(e){let t=new ce(Me);await t.read(e);let i=await t.parse();if(i&&i.ifd0)return i.ifd0[274]}const Le=Object.freeze({1:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:0,rad:0},2:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:0,rad:0},3:{dimensionSwapped:!1,scaleX:1,scaleY:1,deg:180,rad:180*Math.PI/180},4:{dimensionSwapped:!1,scaleX:-1,scaleY:1,deg:180,rad:180*Math.PI/180},5:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:90,rad:90*Math.PI/180},6:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:90,rad:90*Math.PI/180},7:{dimensionSwapped:!0,scaleX:1,scaleY:-1,deg:270,rad:270*Math.PI/180},8:{dimensionSwapped:!0,scaleX:1,scaleY:1,deg:270,rad:270*Math.PI/180}});if(e.rotateCanvas=!0,e.rotateCss=!0,"object"==typeof navigator){let t=navigator.userAgent;if(t.includes("iPad")||t.includes("iPhone")){let i=t.match(/OS (\d+)_(\d+)/);if(i){let[,t,n]=i,s=Number(t)+.1*Number(n);e.rotateCanvas=s<13.4,e.rotateCss=!1}}else if(t.includes("OS X 10")){let[,i]=t.match(/OS X 10[_.](\d+)/);e.rotateCanvas=e.rotateCss=Number(i)<15}if(t.includes("Chrome/")){let[,i]=t.match(/Chrome\/(\d+)/);e.rotateCanvas=e.rotateCss=Number(i)<81}else if(t.includes("Firefox/")){let[,i]=t.match(/Firefox\/(\d+)/);e.rotateCanvas=e.rotateCss=Number(i)<77}}async function Ue(t){let i=await Re(t);return Object.assign({canvas:e.rotateCanvas,css:e.rotateCss},Le[i])}class Fe extends I{constructor(...e){super(...e),f(this,"ranges",new Be),0!==this.byteLength&&this.ranges.add(0,this.byteLength)}_tryExtend(e,t,i){if(0===e&&0===this.byteLength&&i){let e=new DataView(i.buffer||i,i.byteOffset,i.byteLength);this._swapDataView(e)}else{let i=e+t;if(i>this.byteLength){let{dataView:e}=this._extend(i);this._swapDataView(e)}}}_extend(e){let t;t=o?r.allocUnsafe(e):new Uint8Array(e);let i=new DataView(t.buffer,t.byteOffset,t.byteLength);return t.set(new Uint8Array(this.buffer,this.byteOffset,this.byteLength),0),{uintView:t,dataView:i}}subarray(e,t,i=!1){return t=t||this._lengthToEnd(e),i&&this._tryExtend(e,t),this.ranges.add(e,t),super.subarray(e,t)}set(e,t,i=!1){i&&this._tryExtend(t,e.byteLength,e);let n=super.set(e,t);return this.ranges.add(t,n.byteLength),n}async ensureChunk(e,t){this.chunked&&(this.ranges.available(e,t)||await this.readChunk(e,t))}available(e,t){return this.ranges.available(e,t)}}class Be{constructor(){f(this,"list",[])}get length(){return this.list.length}add(e,t,i=0){let n=e+t,s=this.list.filter((t=>Ee(e,t.offset,n)||Ee(e,t.end,n)));if(s.length>0){e=Math.min(e,...s.map((e=>e.offset))),n=Math.max(n,...s.map((e=>e.end))),t=n-e;let i=s.shift();i.offset=e,i.length=t,i.end=n,this.list=this.list.filter((e=>!s.includes(e)))}else this.list.push({offset:e,length:t,end:n})}available(e,t){let i=e+t;return this.list.some((t=>t.offset<=e&&i<=t.end))}}function Ee(e,t,i){return e<=t&&t<=i}class Ne extends Fe{constructor(e,t){super(0),f(this,"chunksRead",0),this.input=e,this.options=t}async readWhole(){this.chunked=!1,await this.readChunk(this.nextChunkOffset)}async readChunked(){this.chunked=!0,await this.readChunk(0,this.options.firstChunkSize)}async readNextChunk(e=this.nextChunkOffset){if(this.fullyRead)return this.chunksRead++,!1;let t=this.options.chunkSize,i=await this.readChunk(e,t);return!!i&&i.byteLength===t}async readChunk(e,t){if(this.chunksRead++,0!==(t=this.safeWrapAddress(e,t)))return this._readChunk(e,t)}safeWrapAddress(e,t){return void 0!==this.size&&e+t>this.size?Math.max(0,this.size-e):t}get nextChunkOffset(){if(0!==this.ranges.list.length)return this.ranges.list[0].length}get canReadNextChunk(){return this.chunksRead<this.options.chunkLimit}get fullyRead(){return void 0!==this.size&&this.nextChunkOffset===this.size}read(){return this.options.chunked?this.readChunked():this.readWhole()}close(){}}D.set("blob",class extends Ne{async readWhole(){this.chunked=!1;let e=await U(this.input);this._swapArrayBuffer(e)}readChunked(){return this.chunked=!0,this.size=this.input.size,super.readChunked()}async _readChunk(e,t){let i=t?e+t:void 0,n=this.input.slice(e,i),s=await U(n);return this.set(s,e,!0)}});var Ge=Object.freeze({__proto__:null,default:we,Exifr:ce,fileParsers:T,segmentParsers:A,fileReaders:D,tagKeys:N,tagValues:G,tagRevivers:V,createDictionary:B,extendDictionary:E,fetchUrlAsArrayBuffer:L,readBlobAsArrayBuffer:U,chunkedProps:$,otherSegments:J,segments:q,tiffBlocks:Q,segmentsAndBlocks:Z,tiffExtractables:ee,inheritables:te,allFormatters:ie,Options:oe,parse:fe,gpsOnlyOptions:Ae,gps:De,thumbnailOnlyOptions:Oe,thumbnail:xe,thumbnailUrl:ve,orientationOnlyOptions:Me,orientation:Re,rotations:Le,get rotateCanvas(){return e.rotateCanvas},get rotateCss(){return e.rotateCss},rotation:Ue});D.set("url",class extends Ne{async readWhole(){this.chunked=!1;let e=await L(this.input);e instanceof ArrayBuffer?this._swapArrayBuffer(e):e instanceof Uint8Array&&this._swapBuffer(e)}async _readChunk(e,t){let i=t?e+t-1:void 0,n=this.options.httpHeaders||{};(e||i)&&(n.range=`bytes=${[e,i].join("-")}`);let s=await u(this.input,{headers:n}),r=await s.arrayBuffer(),a=r.byteLength;if(416!==s.status)return a!==t&&(this.size=e+a),this.set(r,e,!0)}});I.prototype.getUint64=function(e){let t=this.getUint32(e),i=this.getUint32(e+4);return t<1048575?t<<32|i:void 0!==typeof a?(console.warn("Using BigInt because of type 64uint but JS can only handle 53b numbers."),a(t)<<a(32)|a(i)):void m("Trying to read 64b value but JS can only handle 53b numbers.")};class Ve extends pe{parseBoxes(e=0){let t=[];for(;e<this.file.byteLength-4;){let i=this.parseBoxHead(e);if(t.push(i),0===i.length)break;e+=i.length}return t}parseSubBoxes(e){e.boxes=this.parseBoxes(e.start)}findBox(e,t){return void 0===e.boxes&&this.parseSubBoxes(e),e.boxes.find((e=>e.kind===t))}parseBoxHead(e){let t=this.file.getUint32(e),i=this.file.getString(e+4,4),n=e+8;return 1===t&&(t=this.file.getUint64(e+8),n+=8),{offset:e,length:t,kind:i,start:n}}parseBoxFullHead(e){if(void 0!==e.version)return;let t=this.file.getUint32(e.start);e.version=t>>24,e.start+=4}}class ze extends Ve{static canHandle(e,t){if(0!==t)return!1;let i=e.getUint16(2);if(i>50)return!1;let n=16,s=[];for(;n<i;)s.push(e.getString(n,4)),n+=4;return s.includes(this.type)}async parse(){let e=this.file.getUint32(0),t=this.parseBoxHead(e);for(;"meta"!==t.kind;)e+=t.length,await this.file.ensureChunk(e,16),t=this.parseBoxHead(e);await this.file.ensureChunk(t.offset,t.length),this.parseBoxFullHead(t),this.parseSubBoxes(t),this.options.icc.enabled&&await this.findIcc(t),this.options.tiff.enabled&&await this.findExif(t)}async registerSegment(e,t,i){await this.file.ensureChunk(t,i);let n=this.file.subarray(t,i);this.createParser(e,n)}async findIcc(e){let t=this.findBox(e,"iprp");if(void 0===t)return;let i=this.findBox(t,"ipco");if(void 0===i)return;let n=this.findBox(i,"colr");void 0!==n&&await this.registerSegment("icc",n.offset+12,n.length)}async findExif(e){let t=this.findBox(e,"iinf");if(void 0===t)return;let i=this.findBox(e,"iloc");if(void 0===i)return;let n=this.findExifLocIdInIinf(t),s=this.findExtentInIloc(i,n);if(void 0===s)return;let[r,a]=s;await this.file.ensureChunk(r,a);let o=4+this.file.getUint32(r);r+=o,a-=o,await this.registerSegment("tiff",r,a)}findExifLocIdInIinf(e){this.parseBoxFullHead(e);let t,i,n,s,r=e.start,a=this.file.getUint16(r);for(r+=2;a--;){if(t=this.parseBoxHead(r),this.parseBoxFullHead(t),i=t.start,t.version>=2&&(n=3===t.version?4:2,s=this.file.getString(i+n+2,4),"Exif"===s))return this.file.getUintBytes(i,n);r+=t.length}}get8bits(e){let t=this.file.getUint8(e);return[t>>4,15&t]}findExtentInIloc(e,t){this.parseBoxFullHead(e);let i=e.start,[n,s]=this.get8bits(i++),[r,a]=this.get8bits(i++),o=2===e.version?4:2,l=1===e.version||2===e.version?2:0,h=a+n+s,u=2===e.version?4:2,c=this.file.getUintBytes(i,u);for(i+=u;c--;){let e=this.file.getUintBytes(i,o);i+=o+l+2+r;let u=this.file.getUint16(i);if(i+=2,e===t)return u>1&&console.warn("ILOC box has more than one extent but we're only processing one\nPlease create an issue at https://github.com/MikeKovarik/exifr with this file"),[this.file.getUintBytes(i+a,n),this.file.getUintBytes(i+a+n,s)];i+=u*h}}}class He extends ze{}f(He,"type","heic");class je extends ze{}f(je,"type","avif"),T.set("heic",He),T.set("avif",je),B(N,["ifd0","ifd1"],[[256,"ImageWidth"],[257,"ImageHeight"],[258,"BitsPerSample"],[259,"Compression"],[262,"PhotometricInterpretation"],[270,"ImageDescription"],[271,"Make"],[272,"Model"],[273,"StripOffsets"],[274,"Orientation"],[277,"SamplesPerPixel"],[278,"RowsPerStrip"],[279,"StripByteCounts"],[282,"XResolution"],[283,"YResolution"],[284,"PlanarConfiguration"],[296,"ResolutionUnit"],[301,"TransferFunction"],[305,"Software"],[306,"ModifyDate"],[315,"Artist"],[316,"HostComputer"],[317,"Predictor"],[318,"WhitePoint"],[319,"PrimaryChromaticities"],[513,"ThumbnailOffset"],[514,"ThumbnailLength"],[529,"YCbCrCoefficients"],[530,"YCbCrSubSampling"],[531,"YCbCrPositioning"],[532,"ReferenceBlackWhite"],[700,"ApplicationNotes"],[33432,"Copyright"],[33723,"IPTC"],[34665,"ExifIFD"],[34675,"ICC"],[34853,"GpsIFD"],[330,"SubIFD"],[40965,"InteropIFD"],[40091,"XPTitle"],[40092,"XPComment"],[40093,"XPAuthor"],[40094,"XPKeywords"],[40095,"XPSubject"]]),B(N,"exif",[[33434,"ExposureTime"],[33437,"FNumber"],[34850,"ExposureProgram"],[34852,"SpectralSensitivity"],[34855,"ISO"],[34858,"TimeZoneOffset"],[34859,"SelfTimerMode"],[34864,"SensitivityType"],[34865,"StandardOutputSensitivity"],[34866,"RecommendedExposureIndex"],[34867,"ISOSpeed"],[34868,"ISOSpeedLatitudeyyy"],[34869,"ISOSpeedLatitudezzz"],[36864,"ExifVersion"],[36867,"DateTimeOriginal"],[36868,"CreateDate"],[36873,"GooglePlusUploadCode"],[36880,"OffsetTime"],[36881,"OffsetTimeOriginal"],[36882,"OffsetTimeDigitized"],[37121,"ComponentsConfiguration"],[37122,"CompressedBitsPerPixel"],[37377,"ShutterSpeedValue"],[37378,"ApertureValue"],[37379,"BrightnessValue"],[37380,"ExposureCompensation"],[37381,"MaxApertureValue"],[37382,"SubjectDistance"],[37383,"MeteringMode"],[37384,"LightSource"],[37385,"Flash"],[37386,"FocalLength"],[37393,"ImageNumber"],[37394,"SecurityClassification"],[37395,"ImageHistory"],[37396,"SubjectArea"],[37500,"MakerNote"],[37510,"UserComment"],[37520,"SubSecTime"],[37521,"SubSecTimeOriginal"],[37522,"SubSecTimeDigitized"],[37888,"AmbientTemperature"],[37889,"Humidity"],[37890,"Pressure"],[37891,"WaterDepth"],[37892,"Acceleration"],[37893,"CameraElevationAngle"],[40960,"FlashpixVersion"],[40961,"ColorSpace"],[40962,"ExifImageWidth"],[40963,"ExifImageHeight"],[40964,"RelatedSoundFile"],[41483,"FlashEnergy"],[41486,"FocalPlaneXResolution"],[41487,"FocalPlaneYResolution"],[41488,"FocalPlaneResolutionUnit"],[41492,"SubjectLocation"],[41493,"ExposureIndex"],[41495,"SensingMethod"],[41728,"FileSource"],[41729,"SceneType"],[41730,"CFAPattern"],[41985,"CustomRendered"],[41986,"ExposureMode"],[41987,"WhiteBalance"],[41988,"DigitalZoomRatio"],[41989,"FocalLengthIn35mmFormat"],[41990,"SceneCaptureType"],[41991,"GainControl"],[41992,"Contrast"],[41993,"Saturation"],[41994,"Sharpness"],[41996,"SubjectDistanceRange"],[42016,"ImageUniqueID"],[42032,"OwnerName"],[42033,"SerialNumber"],[42034,"LensInfo"],[42035,"LensMake"],[42036,"LensModel"],[42037,"LensSerialNumber"],[42080,"CompositeImage"],[42081,"CompositeImageCount"],[42082,"CompositeImageExposureTimes"],[42240,"Gamma"],[59932,"Padding"],[59933,"OffsetSchema"],[65e3,"OwnerName"],[65001,"SerialNumber"],[65002,"Lens"],[65100,"RawFile"],[65101,"Converter"],[65102,"WhiteBalance"],[65105,"Exposure"],[65106,"Shadows"],[65107,"Brightness"],[65108,"Contrast"],[65109,"Saturation"],[65110,"Sharpness"],[65111,"Smoothness"],[65112,"MoireFilter"],[40965,"InteropIFD"]]),B(N,"gps",[[0,"GPSVersionID"],[1,"GPSLatitudeRef"],[2,"GPSLatitude"],[3,"GPSLongitudeRef"],[4,"GPSLongitude"],[5,"GPSAltitudeRef"],[6,"GPSAltitude"],[7,"GPSTimeStamp"],[8,"GPSSatellites"],[9,"GPSStatus"],[10,"GPSMeasureMode"],[11,"GPSDOP"],[12,"GPSSpeedRef"],[13,"GPSSpeed"],[14,"GPSTrackRef"],[15,"GPSTrack"],[16,"GPSImgDirectionRef"],[17,"GPSImgDirection"],[18,"GPSMapDatum"],[19,"GPSDestLatitudeRef"],[20,"GPSDestLatitude"],[21,"GPSDestLongitudeRef"],[22,"GPSDestLongitude"],[23,"GPSDestBearingRef"],[24,"GPSDestBearing"],[25,"GPSDestDistanceRef"],[26,"GPSDestDistance"],[27,"GPSProcessingMethod"],[28,"GPSAreaInformation"],[29,"GPSDateStamp"],[30,"GPSDifferential"],[31,"GPSHPositioningError"]]),B(G,["ifd0","ifd1"],[[274,{1:"Horizontal (normal)",2:"Mirror horizontal",3:"Rotate 180",4:"Mirror vertical",5:"Mirror horizontal and rotate 270 CW",6:"Rotate 90 CW",7:"Mirror horizontal and rotate 90 CW",8:"Rotate 270 CW"}],[296,{1:"None",2:"inches",3:"cm"}]]);let We=B(G,"exif",[[34850,{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"}],[37121,{0:"-",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}],[37383,{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"}],[37384,{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"}],[37385,{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"}],[41495,{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"}],[41728,{1:"Film Scanner",2:"Reflection Print Scanner",3:"Digital Camera"}],[41729,{1:"Directly photographed"}],[41985,{0:"Normal",1:"Custom",2:"HDR (no original saved)",3:"HDR (original saved)",4:"Original (for HDR)",6:"Panorama",7:"Portrait HDR",8:"Portrait"}],[41986,{0:"Auto",1:"Manual",2:"Auto bracket"}],[41987,{0:"Auto",1:"Manual"}],[41990,{0:"Standard",1:"Landscape",2:"Portrait",3:"Night",4:"Other"}],[41991,{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"}],[41996,{0:"Unknown",1:"Macro",2:"Close",3:"Distant"}],[42080,{0:"Unknown",1:"Not a Composite Image",2:"General Composite Image",3:"Composite Image Captured While Shooting"}]]);const Ke={1:"No absolute unit of measurement",2:"Inch",3:"Centimeter"};We.set(37392,Ke),We.set(41488,Ke);const Xe={0:"Normal",1:"Low",2:"High"};function _e(e){return"object"==typeof e&&void 0!==e.length?e[0]:e}function Ye(e){let t=Array.from(e).slice(1);return t[1]>15&&(t=t.map((e=>String.fromCharCode(e)))),"0"!==t[2]&&0!==t[2]||t.pop(),t.join(".")}function $e(e){if("string"==typeof e){var[t,i,n,s,r,a]=e.trim().split(/[-: ]/g).map(Number),o=new Date(t,i-1,n);return Number.isNaN(s)||Number.isNaN(r)||Number.isNaN(a)||(o.setHours(s),o.setMinutes(r),o.setSeconds(a)),Number.isNaN(+o)?e:o}}function Je(e){if("string"==typeof e)return e;let t=[];if(0===e[1]&&0===e[e.length-1])for(let i=0;i<e.length;i+=2)t.push(qe(e[i+1],e[i]));else for(let i=0;i<e.length;i+=2)t.push(qe(e[i],e[i+1]));return S(String.fromCodePoint(...t))}function qe(e,t){return e<<8|t}We.set(41992,Xe),We.set(41993,Xe),We.set(41994,Xe),B(V,["ifd0","ifd1"],[[50827,function(e){return"string"!=typeof e?P(e):e}],[306,$e],[40091,Je],[40092,Je],[40093,Je],[40094,Je],[40095,Je]]),B(V,"exif",[[40960,Ye],[36864,Ye],[36867,$e],[36868,$e],[40962,_e],[40963,_e]]),B(V,"gps",[[0,e=>Array.from(e).join(".")],[7,e=>Array.from(e).join(":")]]);const Qe="http://ns.adobe.com/",Ze="http://ns.adobe.com/xmp/extension/";class et extends ge{static canHandle(e,t){return 225===e.getUint8(t+1)&&1752462448===e.getUint32(t+4)&&e.getString(t+4,Qe.length)===Qe}static headerLength(e,t){return e.getString(t+4,Ze.length)===Ze?79:4+"http://ns.adobe.com/xap/1.0/".length+1}static findPosition(e,t){let i=super.findPosition(e,t);return i.multiSegment=i.extended=79===i.headerLength,i.multiSegment?(i.chunkCount=e.getUint8(t+72),i.chunkNumber=e.getUint8(t+76),0!==e.getUint8(t+77)&&i.chunkNumber++):(i.chunkCount=1/0,i.chunkNumber=-1),i}static handleMultiSegments(e){return e.map((e=>e.chunk.getString())).join("")}normalizeInput(e){return"string"==typeof e?e:I.from(e).getString()}parse(e=this.chunk){if(!this.localOptions.parse)return e;e=function(e){let t={},i={};for(let e of ut)t[e]=[],i[e]=0;return e.replace(ct,((e,n,s)=>{if("<"===n){let n=++i[s];return t[s].push(n),`${e}#${n}`}return`${e}#${t[s].pop()}`}))}(e);let t=nt.findAll(e,"rdf","Description");0===t.length&&t.push(new nt("rdf","Description",void 0,e));let i,n={};for(let e of t)for(let t of e.properties)i=ot(t.ns,n),st(t,i);return function(e){let t;for(let i in e)t=e[i]=d(e[i]),void 0===t&&delete e[i];return d(e)}(n)}assignToOutput(e,t){if(this.localOptions.parse)for(let[i,n]of Object.entries(t))switch(i){case"tiff":this.assignObjectToOutput(e,"ifd0",n);break;case"exif":this.assignObjectToOutput(e,"exif",n);break;case"xmlns":break;default:this.assignObjectToOutput(e,i,n)}else e.xmp=t}}f(et,"type","xmp"),f(et,"multiSegment",!0),A.set("xmp",et);class tt{static findAll(e){return lt(e,/([a-zA-Z0-9-]+):([a-zA-Z0-9-]+)=("[^"]*"|'[^']*')/gm).map(tt.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[3].slice(1,-1);return n=ht(n),new tt(t,i,n)}constructor(e,t,i){this.ns=e,this.name=t,this.value=i}serialize(){return this.value}}const it="[\\w\\d-]+";class nt{static findAll(e,t,i){if(void 0!==t||void 0!==i){t=t||it,i=i||it;var n=new RegExp(`<(${t}):(${i})(#\\d+)?((\\s+?[\\w\\d-:]+=("[^"]*"|'[^']*'))*\\s*)(\\/>|>([\\s\\S]*?)<\\/\\1:\\2\\3>)`,"gm")}else n=/<([\w\d-]+):([\w\d-]+)(#\d+)?((\s+?[\w\d-:]+=("[^"]*"|'[^']*'))*\s*)(\/>|>([\s\S]*?)<\/\1:\2\3>)/gm;return lt(e,n).map(nt.unpackMatch)}static unpackMatch(e){let t=e[1],i=e[2],n=e[4],s=e[8];return new nt(t,i,n,s)}constructor(e,t,i,n){this.ns=e,this.name=t,this.attrString=i,this.innerXml=n,this.attrs=tt.findAll(i),this.children=nt.findAll(n),this.value=0===this.children.length?ht(n):void 0,this.properties=[...this.attrs,...this.children]}get isPrimitive(){return void 0!==this.value&&0===this.attrs.length&&0===this.children.length}get isListContainer(){return 1===this.children.length&&this.children[0].isList}get isList(){let{ns:e,name:t}=this;return"rdf"===e&&("Seq"===t||"Bag"===t||"Alt"===t)}get isListItem(){return"rdf"===this.ns&&"li"===this.name}serialize(){if(0===this.properties.length&&void 0===this.value)return;if(this.isPrimitive)return this.value;if(this.isListContainer)return this.children[0].serialize();if(this.isList)return at(this.children.map(rt));if(this.isListItem&&1===this.children.length&&0===this.attrs.length)return this.children[0].serialize();let e={};for(let t of this.properties)st(t,e);return void 0!==this.value&&(e.value=this.value),d(e)}}function st(e,t){let i=e.serialize();void 0!==i&&(t[e.name]=i)}var rt=e=>e.serialize(),at=e=>1===e.length?e[0]:e,ot=(e,t)=>t[e]?t[e]:t[e]={};function lt(e,t){let i,n=[];if(!e)return n;for(;null!==(i=t.exec(e));)n.push(i);return n}function ht(e){if(function(e){return null==e||"null"===e||"undefined"===e||""===e||""===e.trim()}(e))return;let t=Number(e);if(!Number.isNaN(t))return t;let i=e.toLowerCase();return"true"===i||"false"!==i&&e.trim()}const ut=["rdf:li","rdf:Seq","rdf:Bag","rdf:Alt","rdf:Description"],ct=new RegExp(`(<|\\/)(${ut.join("|")})`,"g");var ft=Object.freeze({__proto__:null,default:Ge,Exifr:ce,fileParsers:T,segmentParsers:A,fileReaders:D,tagKeys:N,tagValues:G,tagRevivers:V,createDictionary:B,extendDictionary:E,fetchUrlAsArrayBuffer:L,readBlobAsArrayBuffer:U,chunkedProps:$,otherSegments:J,segments:q,tiffBlocks:Q,segmentsAndBlocks:Z,tiffExtractables:ee,inheritables:te,allFormatters:ie,Options:oe,parse:fe,gpsOnlyOptions:Ae,gps:De,thumbnailOnlyOptions:Oe,thumbnail:xe,thumbnailUrl:ve,orientationOnlyOptions:Me,orientation:Re,rotations:Le,get rotateCanvas(){return e.rotateCanvas},get rotateCss(){return e.rotateCss},rotation:Ue});const dt=["xmp","icc","iptc","tiff"],pt=()=>{};async function gt(e,t,i){let n=i[e];return n.enabled=!0,n.parse=!0,A.get(e).parse(t,n)}let mt=h("fs",(e=>e.promises));D.set("fs",class extends Ne{async readWhole(){this.chunked=!1,this.fs=await mt;let e=await this.fs.readFile(this.input);this._swapBuffer(e)}async readChunked(){this.chunked=!0,this.fs=await mt,await this.open(),await this.readChunk(0,this.options.firstChunkSize)}async open(){void 0===this.fh&&(this.fh=await this.fs.open(this.input,"r"),this.size=(await this.fh.stat(this.input)).size)}async _readChunk(e,t){void 0===this.fh&&await this.open(),e+t>this.size&&(t=this.size-e);var i=this.subarray(e,t,!0);return await this.fh.read(i.dataView,0,t,e),i}async close(){if(this.fh){let e=this.fh;this.fh=void 0,await e.close()}}});D.set("base64",class extends Ne{constructor(...e){super(...e),this.input=this.input.replace(/^data:([^;]+);base64,/gim,""),this.size=this.input.length/4*3,this.input.endsWith("==")?this.size-=2:this.input.endsWith("=")&&(this.size-=1)}async _readChunk(e,t){let i,n,s=this.input;void 0===e?(e=0,i=0,n=0):(i=4*Math.floor(e/3),n=e-i/4*3),void 0===t&&(t=this.size);let a=e+t,l=i+4*Math.ceil(a/3);s=s.slice(i,l);let h=Math.min(t,this.size-e);if(o){let t=r.from(s,"base64").slice(n,n+h);return this.set(t,e,!0)}{let t=this.subarray(e,h,!0),i=atob(s),r=t.toUint8();for(let e=0;e<h;e++)r[e]=i.charCodeAt(n+e);return t}}});class St extends pe{static canHandle(e,t){return 18761===t||19789===t}extendOptions(e){let{ifd0:t,xmp:i,iptc:n,icc:s}=e;i.enabled&&t.deps.add(j),n.enabled&&t.deps.add(W),s.enabled&&t.deps.add(K),t.finalizeFilters()}async parse(){let{tiff:e,xmp:t,iptc:i,icc:n}=this.options;if(e.enabled||t.enabled||i.enabled||n.enabled){let e=Math.max(C(this.options),this.options.chunkSize);await this.file.ensureChunk(0,e),this.createParser("tiff",this.file),this.parsers.tiff.parseHeader(),await this.parsers.tiff.parseIfd0Block(),this.adaptTiffPropAsSegment("xmp"),this.adaptTiffPropAsSegment("iptc"),this.adaptTiffPropAsSegment("icc")}}adaptTiffPropAsSegment(e){if(this.parsers.tiff[e]){let t=this.parsers.tiff[e];this.injectSegment(e,t)}}}f(St,"type","tiff"),T.set("tiff",St);let Ct=h("zlib");const yt="XML:com.adobe.xmp",bt="ihdr",Pt="iccp",It="text",kt="itxt",wt=[bt,Pt,It,kt,"exif"];class Tt extends pe{constructor(...e){super(...e),f(this,"catchError",(e=>this.errors.push(e))),f(this,"metaChunks",[]),f(this,"unknownChunks",[])}static canHandle(e,t){return 35152===t&&2303741511===e.getUint32(0)&&218765834===e.getUint32(4)}async parse(){let{file:e}=this;await this.findPngChunksInRange("聣PNG\r\n\n".length,e.byteLength),await this.readSegments(this.metaChunks),this.findIhdr(),this.parseTextChunks(),await this.findExif().catch(this.catchError),await this.findXmp().catch(this.catchError),await this.findIcc().catch(this.catchError)}async findPngChunksInRange(e,t){let{file:i}=this;for(;e<t;){let t=i.getUint32(e),n=i.getUint32(e+4),s=i.getString(e+4,4).toLowerCase(),r=t+4+4+4,a={type:s,offset:e,length:r,start:e+4+4,size:t,marker:n};wt.includes(s)?this.metaChunks.push(a):this.unknownChunks.push(a),e+=r}}parseTextChunks(){let e=this.metaChunks.filter((e=>e.type===It));for(let t of e){let[e,i]=this.file.getString(t.start,t.size).split("\0");this.injectKeyValToIhdr(e,i)}}injectKeyValToIhdr(e,t){let i=this.parsers.ihdr;i&&i.raw.set(e,t)}findIhdr(){let e=this.metaChunks.find((e=>e.type===bt));e&&!1!==this.options.ihdr.enabled&&this.createParser(bt,e.chunk)}async findExif(){let e=this.metaChunks.find((e=>"exif"===e.type));e&&this.injectSegment("tiff",e.chunk)}async findXmp(){let e=this.metaChunks.filter((e=>e.type===kt));for(let t of e){t.chunk.getString(0,yt.length)===yt&&this.injectSegment("xmp",t.chunk)}}async findIcc(){let e=this.metaChunks.find((e=>e.type===Pt));if(!e)return;let{chunk:t}=e,i=t.getUint8Array(0,81),n=0;for(;n<80&&0!==i[n];)n++;let r=n+2,a=t.getString(0,n);if(this.injectKeyValToIhdr("ProfileName",a),s){let e=await Ct,i=t.getUint8Array(r);i=e.inflateSync(i),this.injectSegment("icc",i)}}}f(Tt,"type","png"),T.set("png",Tt),B(N,"interop",[[1,"InteropIndex"],[2,"InteropVersion"],[4096,"RelatedImageFileFormat"],[4097,"RelatedImageWidth"],[4098,"RelatedImageHeight"]]),E(N,"ifd0",[[11,"ProcessingSoftware"],[254,"SubfileType"],[255,"OldSubfileType"],[263,"Thresholding"],[264,"CellWidth"],[265,"CellLength"],[266,"FillOrder"],[269,"DocumentName"],[280,"MinSampleValue"],[281,"MaxSampleValue"],[285,"PageName"],[286,"XPosition"],[287,"YPosition"],[290,"GrayResponseUnit"],[297,"PageNumber"],[321,"HalftoneHints"],[322,"TileWidth"],[323,"TileLength"],[332,"InkSet"],[337,"TargetPrinter"],[18246,"Rating"],[18249,"RatingPercent"],[33550,"PixelScale"],[34264,"ModelTransform"],[34377,"PhotoshopSettings"],[50706,"DNGVersion"],[50707,"DNGBackwardVersion"],[50708,"UniqueCameraModel"],[50709,"LocalizedCameraModel"],[50736,"DNGLensInfo"],[50739,"ShadowScale"],[50740,"DNGPrivateData"],[33920,"IntergraphMatrix"],[33922,"ModelTiePoint"],[34118,"SEMInfo"],[34735,"GeoTiffDirectory"],[34736,"GeoTiffDoubleParams"],[34737,"GeoTiffAsciiParams"],[50341,"PrintIM"],[50721,"ColorMatrix1"],[50722,"ColorMatrix2"],[50723,"CameraCalibration1"],[50724,"CameraCalibration2"],[50725,"ReductionMatrix1"],[50726,"ReductionMatrix2"],[50727,"AnalogBalance"],[50728,"AsShotNeutral"],[50729,"AsShotWhiteXY"],[50730,"BaselineExposure"],[50731,"BaselineNoise"],[50732,"BaselineSharpness"],[50734,"LinearResponseLimit"],[50735,"CameraSerialNumber"],[50741,"MakerNoteSafety"],[50778,"CalibrationIlluminant1"],[50779,"CalibrationIlluminant2"],[50781,"RawDataUniqueID"],[50827,"OriginalRawFileName"],[50828,"OriginalRawFileData"],[50831,"AsShotICCProfile"],[50832,"AsShotPreProfileMatrix"],[50833,"CurrentICCProfile"],[50834,"CurrentPreProfileMatrix"],[50879,"ColorimetricReference"],[50885,"SRawType"],[50898,"PanasonicTitle"],[50899,"PanasonicTitle2"],[50931,"CameraCalibrationSig"],[50932,"ProfileCalibrationSig"],[50933,"ProfileIFD"],[50934,"AsShotProfileName"],[50936,"ProfileName"],[50937,"ProfileHueSatMapDims"],[50938,"ProfileHueSatMapData1"],[50939,"ProfileHueSatMapData2"],[50940,"ProfileToneCurve"],[50941,"ProfileEmbedPolicy"],[50942,"ProfileCopyright"],[50964,"ForwardMatrix1"],[50965,"ForwardMatrix2"],[50966,"PreviewApplicationName"],[50967,"PreviewApplicationVersion"],[50968,"PreviewSettingsName"],[50969,"PreviewSettingsDigest"],[50970,"PreviewColorSpace"],[50971,"PreviewDateTime"],[50972,"RawImageDigest"],[50973,"OriginalRawFileDigest"],[50981,"ProfileLookTableDims"],[50982,"ProfileLookTableData"],[51043,"TimeCodes"],[51044,"FrameRate"],[51058,"TStop"],[51081,"ReelName"],[51089,"OriginalDefaultFinalSize"],[51090,"OriginalBestQualitySize"],[51091,"OriginalDefaultCropSize"],[51105,"CameraLabel"],[51107,"ProfileHueSatMapEncoding"],[51108,"ProfileLookTableEncoding"],[51109,"BaselineExposureOffset"],[51110,"DefaultBlackRender"],[51111,"NewRawImageDigest"],[51112,"RawToPreviewGain"]]);let At=[[273,"StripOffsets"],[279,"StripByteCounts"],[288,"FreeOffsets"],[289,"FreeByteCounts"],[291,"GrayResponseCurve"],[292,"T4Options"],[293,"T6Options"],[300,"ColorResponseUnit"],[320,"ColorMap"],[324,"TileOffsets"],[325,"TileByteCounts"],[326,"BadFaxLines"],[327,"CleanFaxData"],[328,"ConsecutiveBadFaxLines"],[330,"SubIFD"],[333,"InkNames"],[334,"NumberofInks"],[336,"DotRange"],[338,"ExtraSamples"],[339,"SampleFormat"],[340,"SMinSampleValue"],[341,"SMaxSampleValue"],[342,"TransferRange"],[343,"ClipPath"],[344,"XClipPathUnits"],[345,"YClipPathUnits"],[346,"Indexed"],[347,"JPEGTables"],[351,"OPIProxy"],[400,"GlobalParametersIFD"],[401,"ProfileType"],[402,"FaxProfile"],[403,"CodingMethods"],[404,"VersionYear"],[405,"ModeNumber"],[433,"Decode"],[434,"DefaultImageColor"],[435,"T82Options"],[437,"JPEGTables"],[512,"JPEGProc"],[515,"JPEGRestartInterval"],[517,"JPEGLosslessPredictors"],[518,"JPEGPointTransforms"],[519,"JPEGQTables"],[520,"JPEGDCTables"],[521,"JPEGACTables"],[559,"StripRowCounts"],[999,"USPTOMiscellaneous"],[18247,"XP_DIP_XML"],[18248,"StitchInfo"],[28672,"SonyRawFileType"],[28688,"SonyToneCurve"],[28721,"VignettingCorrection"],[28722,"VignettingCorrParams"],[28724,"ChromaticAberrationCorrection"],[28725,"ChromaticAberrationCorrParams"],[28726,"DistortionCorrection"],[28727,"DistortionCorrParams"],[29895,"SonyCropTopLeft"],[29896,"SonyCropSize"],[32781,"ImageID"],[32931,"WangTag1"],[32932,"WangAnnotation"],[32933,"WangTag3"],[32934,"WangTag4"],[32953,"ImageReferencePoints"],[32954,"RegionXformTackPoint"],[32955,"WarpQuadrilateral"],[32956,"AffineTransformMat"],[32995,"Matteing"],[32996,"DataType"],[32997,"ImageDepth"],[32998,"TileDepth"],[33300,"ImageFullWidth"],[33301,"ImageFullHeight"],[33302,"TextureFormat"],[33303,"WrapModes"],[33304,"FovCot"],[33305,"MatrixWorldToScreen"],[33306,"MatrixWorldToCamera"],[33405,"Model2"],[33421,"CFARepeatPatternDim"],[33422,"CFAPattern2"],[33423,"BatteryLevel"],[33424,"KodakIFD"],[33445,"MDFileTag"],[33446,"MDScalePixel"],[33447,"MDColorTable"],[33448,"MDLabName"],[33449,"MDSampleInfo"],[33450,"MDPrepDate"],[33451,"MDPrepTime"],[33452,"MDFileUnits"],[33589,"AdventScale"],[33590,"AdventRevision"],[33628,"UIC1Tag"],[33629,"UIC2Tag"],[33630,"UIC3Tag"],[33631,"UIC4Tag"],[33918,"IntergraphPacketData"],[33919,"IntergraphFlagRegisters"],[33921,"INGRReserved"],[34016,"Site"],[34017,"ColorSequence"],[34018,"IT8Header"],[34019,"RasterPadding"],[34020,"BitsPerRunLength"],[34021,"BitsPerExtendedRunLength"],[34022,"ColorTable"],[34023,"ImageColorIndicator"],[34024,"BackgroundColorIndicator"],[34025,"ImageColorValue"],[34026,"BackgroundColorValue"],[34027,"PixelIntensityRange"],[34028,"TransparencyIndicator"],[34029,"ColorCharacterization"],[34030,"HCUsage"],[34031,"TrapIndicator"],[34032,"CMYKEquivalent"],[34152,"AFCP_IPTC"],[34232,"PixelMagicJBIGOptions"],[34263,"JPLCartoIFD"],[34306,"WB_GRGBLevels"],[34310,"LeafData"],[34687,"TIFF_FXExtensions"],[34688,"MultiProfiles"],[34689,"SharedData"],[34690,"T88Options"],[34732,"ImageLayer"],[34750,"JBIGOptions"],[34856,"Opto-ElectricConvFactor"],[34857,"Interlace"],[34908,"FaxRecvParams"],[34909,"FaxSubAddress"],[34910,"FaxRecvTime"],[34929,"FedexEDR"],[34954,"LeafSubIFD"],[37387,"FlashEnergy"],[37388,"SpatialFrequencyResponse"],[37389,"Noise"],[37390,"FocalPlaneXResolution"],[37391,"FocalPlaneYResolution"],[37392,"FocalPlaneResolutionUnit"],[37397,"ExposureIndex"],[37398,"TIFF-EPStandardID"],[37399,"SensingMethod"],[37434,"CIP3DataFile"],[37435,"CIP3Sheet"],[37436,"CIP3Side"],[37439,"StoNits"],[37679,"MSDocumentText"],[37680,"MSPropertySetStorage"],[37681,"MSDocumentTextPosition"],[37724,"ImageSourceData"],[40965,"InteropIFD"],[40976,"SamsungRawPointersOffset"],[40977,"SamsungRawPointersLength"],[41217,"SamsungRawByteOrder"],[41218,"SamsungRawUnknown"],[41484,"SpatialFrequencyResponse"],[41485,"Noise"],[41489,"ImageNumber"],[41490,"SecurityClassification"],[41491,"ImageHistory"],[41494,"TIFF-EPStandardID"],[41995,"DeviceSettingDescription"],[42112,"GDALMetadata"],[42113,"GDALNoData"],[44992,"ExpandSoftware"],[44993,"ExpandLens"],[44994,"ExpandFilm"],[44995,"ExpandFilterLens"],[44996,"ExpandScanner"],[44997,"ExpandFlashLamp"],[46275,"HasselbladRawImage"],[48129,"PixelFormat"],[48130,"Transformation"],[48131,"Uncompressed"],[48132,"ImageType"],[48256,"ImageWidth"],[48257,"ImageHeight"],[48258,"WidthResolution"],[48259,"HeightResolution"],[48320,"ImageOffset"],[48321,"ImageByteCount"],[48322,"AlphaOffset"],[48323,"AlphaByteCount"],[48324,"ImageDataDiscard"],[48325,"AlphaDataDiscard"],[50215,"OceScanjobDesc"],[50216,"OceApplicationSelector"],[50217,"OceIDNumber"],[50218,"OceImageLogic"],[50255,"Annotations"],[50459,"HasselbladExif"],[50547,"OriginalFileName"],[50560,"USPTOOriginalContentType"],[50656,"CR2CFAPattern"],[50710,"CFAPlaneColor"],[50711,"CFALayout"],[50712,"LinearizationTable"],[50713,"BlackLevelRepeatDim"],[50714,"BlackLevel"],[50715,"BlackLevelDeltaH"],[50716,"BlackLevelDeltaV"],[50717,"WhiteLevel"],[50718,"DefaultScale"],[50719,"DefaultCropOrigin"],[50720,"DefaultCropSize"],[50733,"BayerGreenSplit"],[50737,"ChromaBlurRadius"],[50738,"AntiAliasStrength"],[50752,"RawImageSegmentation"],[50780,"BestQualityScale"],[50784,"AliasLayerMetadata"],[50829,"ActiveArea"],[50830,"MaskedAreas"],[50935,"NoiseReductionApplied"],[50974,"SubTileBlockSize"],[50975,"RowInterleaveFactor"],[51008,"OpcodeList1"],[51009,"OpcodeList2"],[51022,"OpcodeList3"],[51041,"NoiseProfile"],[51114,"CacheVersion"],[51125,"DefaultUserCrop"],[51157,"NikonNEFInfo"],[65024,"KdcIFD"]];E(N,"ifd0",At),E(N,"exif",At),B(G,"gps",[[23,{M:"Magnetic North",T:"True North"}],[25,{K:"Kilometers",M:"Miles",N:"Nautical Miles"}]]);class Dt extends ge{static canHandle(e,t){return 224===e.getUint8(t+1)&&1246120262===e.getUint32(t+4)&&0===e.getUint8(t+8)}parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint16(0)],[2,this.chunk.getUint8(2)],[3,this.chunk.getUint16(3)],[5,this.chunk.getUint16(5)],[7,this.chunk.getUint8(7)],[8,this.chunk.getUint8(8)]])}}f(Dt,"type","jfif"),f(Dt,"headerLength",9),A.set("jfif",Dt),B(N,"jfif",[[0,"JFIFVersion"],[2,"ResolutionUnit"],[3,"XResolution"],[5,"YResolution"],[7,"ThumbnailWidth"],[8,"ThumbnailHeight"]]);class Ot extends ge{parse(){return this.parseTags(),this.translate(),this.output}parseTags(){this.raw=new Map([[0,this.chunk.getUint32(0)],[4,this.chunk.getUint32(4)],[8,this.chunk.getUint8(8)],[9,this.chunk.getUint8(9)],[10,this.chunk.getUint8(10)],[11,this.chunk.getUint8(11)],[12,this.chunk.getUint8(12)],...Array.from(this.raw)])}}f(Ot,"type","ihdr"),A.set("ihdr",Ot),B(N,"ihdr",[[0,"ImageWidth"],[4,"ImageHeight"],[8,"BitDepth"],[9,"ColorType"],[10,"Compression"],[11,"Filter"],[12,"Interlace"]]),B(G,"ihdr",[[9,{0:"Grayscale",2:"RGB",3:"Palette",4:"Grayscale with Alpha",6:"RGB with Alpha",DEFAULT:"Unknown"}],[10,{0:"Deflate/Inflate",DEFAULT:"Unknown"}],[11,{0:"Adaptive",DEFAULT:"Unknown"}],[12,{0:"Noninterlaced",1:"Adam7 Interlace",DEFAULT:"Unknown"}]]);const xt="\0\0\0\0";class vt extends ge{static canHandle(e,t){return 226===e.getUint8(t+1)&&1229144927===e.getUint32(t+4)}static findPosition(e,t){let i=super.findPosition(e,t);return i.chunkNumber=e.getUint8(t+16),i.chunkCount=e.getUint8(t+17),i.multiSegment=i.chunkCount>1,i}static handleMultiSegments(e){return function(e){let t=function(e){let t=e[0].constructor,i=0;for(let t of e)i+=t.length;let n=new t(i),s=0;for(let t of e)n.set(t,s),s+=t.length;return n}(e.map((e=>e.chunk.toUint8())));return new I(t)}(e)}parse(){return this.raw=new Map,this.parseHeader(),this.parseTags(),this.translate(),this.output}parseHeader(){let{raw:e}=this;this.chunk.byteLength<84&&m("ICC header is too short");for(let[t,i]of Object.entries(Mt)){t=parseInt(t,10);let n=i(this.chunk,t);n!==xt&&e.set(t,n)}}parseTags(){let e,t,i,n,s,{raw:r}=this,a=this.chunk.getUint32(128),o=132,l=this.chunk.byteLength;for(;a--;){if(e=this.chunk.getString(o,4),t=this.chunk.getUint32(o+4),i=this.chunk.getUint32(o+8),n=this.chunk.getString(t,4),t+i>l)return void console.warn("reached the end of the first ICC chunk. Enable options.tiff.multiSegment to read all ICC segments.");s=this.parseTag(n,t,i),void 0!==s&&s!==xt&&r.set(e,s),o+=12}}parseTag(e,t,i){switch(e){case"desc":return this.parseDesc(t);case"mluc":return this.parseMluc(t);case"text":return this.parseText(t,i);case"sig ":return this.parseSig(t)}if(!(t+i>this.chunk.byteLength))return this.chunk.getUint8Array(t,i)}parseDesc(e){let t=this.chunk.getUint32(e+8)-1;return S(this.chunk.getString(e+12,t))}parseText(e,t){return S(this.chunk.getString(e+8,t-8))}parseSig(e){return S(this.chunk.getString(e+8,4))}parseMluc(e){let{chunk:t}=this,i=t.getUint32(e+8),n=t.getUint32(e+12),s=e+16,r=[];for(let a=0;a<i;a++){let i=t.getString(s+0,2),a=t.getString(s+2,2),o=t.getUint32(s+4),l=t.getUint32(s+8)+e,h=S(t.getUnicodeString(l,o));r.push({lang:i,country:a,text:h}),s+=n}return 1===i?r[0].text:r}translateValue(e,t){return"string"==typeof e?t[e]||t[e.toLowerCase()]||e:t[e]||e}}f(vt,"type","icc"),f(vt,"multiSegment",!0),f(vt,"headerLength",18);const Mt={4:Rt,8:function(e,t){return[e.getUint8(t),e.getUint8(t+1)>>4,e.getUint8(t+1)%16].map((e=>e.toString(10))).join(".")},12:Rt,16:Rt,20:Rt,24:function(e,t){const i=e.getUint16(t),n=e.getUint16(t+2)-1,s=e.getUint16(t+4),r=e.getUint16(t+6),a=e.getUint16(t+8),o=e.getUint16(t+10);return new Date(Date.UTC(i,n,s,r,a,o))},36:Rt,40:Rt,48:Rt,52:Rt,64:(e,t)=>e.getUint32(t),80:Rt};function Rt(e,t){return S(e.getString(t,4))}A.set("icc",vt),B(N,"icc",[[4,"ProfileCMMType"],[8,"ProfileVersion"],[12,"ProfileClass"],[16,"ColorSpaceData"],[20,"ProfileConnectionSpace"],[24,"ProfileDateTime"],[36,"ProfileFileSignature"],[40,"PrimaryPlatform"],[44,"CMMFlags"],[48,"DeviceManufacturer"],[52,"DeviceModel"],[56,"DeviceAttributes"],[64,"RenderingIntent"],[68,"ConnectionSpaceIlluminant"],[80,"ProfileCreator"],[84,"ProfileID"],["Header","ProfileHeader"],["MS00","WCSProfiles"],["bTRC","BlueTRC"],["bXYZ","BlueMatrixColumn"],["bfd","UCRBG"],["bkpt","MediaBlackPoint"],["calt","CalibrationDateTime"],["chad","ChromaticAdaptation"],["chrm","Chromaticity"],["ciis","ColorimetricIntentImageState"],["clot","ColorantTableOut"],["clro","ColorantOrder"],["clrt","ColorantTable"],["cprt","ProfileCopyright"],["crdi","CRDInfo"],["desc","ProfileDescription"],["devs","DeviceSettings"],["dmdd","DeviceModelDesc"],["dmnd","DeviceMfgDesc"],["dscm","ProfileDescriptionML"],["fpce","FocalPlaneColorimetryEstimates"],["gTRC","GreenTRC"],["gXYZ","GreenMatrixColumn"],["gamt","Gamut"],["kTRC","GrayTRC"],["lumi","Luminance"],["meas","Measurement"],["meta","Metadata"],["mmod","MakeAndModel"],["ncl2","NamedColor2"],["ncol","NamedColor"],["ndin","NativeDisplayInfo"],["pre0","Preview0"],["pre1","Preview1"],["pre2","Preview2"],["ps2i","PS2RenderingIntent"],["ps2s","PostScript2CSA"],["psd0","PostScript2CRD0"],["psd1","PostScript2CRD1"],["psd2","PostScript2CRD2"],["psd3","PostScript2CRD3"],["pseq","ProfileSequenceDesc"],["psid","ProfileSequenceIdentifier"],["psvm","PS2CRDVMSize"],["rTRC","RedTRC"],["rXYZ","RedMatrixColumn"],["resp","OutputResponse"],["rhoc","ReflectionHardcopyOrigColorimetry"],["rig0","PerceptualRenderingIntentGamut"],["rig2","SaturationRenderingIntentGamut"],["rpoc","ReflectionPrintOutputColorimetry"],["sape","SceneAppearanceEstimates"],["scoe","SceneColorimetryEstimates"],["scrd","ScreeningDesc"],["scrn","Screening"],["targ","CharTarget"],["tech","Technology"],["vcgt","VideoCardGamma"],["view","ViewingConditions"],["vued","ViewingCondDesc"],["wtpt","MediaWhitePoint"]]);const Lt={"4d2p":"Erdt Systems",AAMA:"Aamazing Technologies",ACER:"Acer",ACLT:"Acolyte Color Research",ACTI:"Actix Sytems",ADAR:"Adara Technology",ADBE:"Adobe",ADI:"ADI Systems",AGFA:"Agfa Graphics",ALMD:"Alps Electric",ALPS:"Alps Electric",ALWN:"Alwan Color Expertise",AMTI:"Amiable Technologies",AOC:"AOC International",APAG:"Apago",APPL:"Apple Computer",AST:"AST","AT&T":"AT&T",BAEL:"BARBIERI electronic",BRCO:"Barco NV",BRKP:"Breakpoint",BROT:"Brother",BULL:"Bull",BUS:"Bus Computer Systems","C-IT":"C-Itoh",CAMR:"Intel",CANO:"Canon",CARR:"Carroll Touch",CASI:"Casio",CBUS:"Colorbus PL",CEL:"Crossfield",CELx:"Crossfield",CGS:"CGS Publishing Technologies International",CHM:"Rochester Robotics",CIGL:"Colour Imaging Group, London",CITI:"Citizen",CL00:"Candela",CLIQ:"Color IQ",CMCO:"Chromaco",CMiX:"CHROMiX",COLO:"Colorgraphic Communications",COMP:"Compaq",COMp:"Compeq/Focus Technology",CONR:"Conrac Display Products",CORD:"Cordata Technologies",CPQ:"Compaq",CPRO:"ColorPro",CRN:"Cornerstone",CTX:"CTX International",CVIS:"ColorVision",CWC:"Fujitsu Laboratories",DARI:"Darius Technology",DATA:"Dataproducts",DCP:"Dry Creek Photo",DCRC:"Digital Contents Resource Center, Chung-Ang University",DELL:"Dell Computer",DIC:"Dainippon Ink and Chemicals",DICO:"Diconix",DIGI:"Digital","DL&C":"Digital Light & Color",DPLG:"Doppelganger",DS:"Dainippon Screen",DSOL:"DOOSOL",DUPN:"DuPont",EPSO:"Epson",ESKO:"Esko-Graphics",ETRI:"Electronics and Telecommunications Research Institute",EVER:"Everex Systems",EXAC:"ExactCODE",Eizo:"Eizo",FALC:"Falco Data Products",FF:"Fuji Photo Film",FFEI:"FujiFilm Electronic Imaging",FNRD:"Fnord Software",FORA:"Fora",FORE:"Forefront Technology",FP:"Fujitsu",FPA:"WayTech Development",FUJI:"Fujitsu",FX:"Fuji Xerox",GCC:"GCC Technologies",GGSL:"Global Graphics Software",GMB:"Gretagmacbeth",GMG:"GMG",GOLD:"GoldStar Technology",GOOG:"Google",GPRT:"Giantprint",GTMB:"Gretagmacbeth",GVC:"WayTech Development",GW2K:"Sony",HCI:"HCI",HDM:"Heidelberger Druckmaschinen",HERM:"Hermes",HITA:"Hitachi America",HP:"Hewlett-Packard",HTC:"Hitachi",HiTi:"HiTi Digital",IBM:"IBM",IDNT:"Scitex",IEC:"Hewlett-Packard",IIYA:"Iiyama North America",IKEG:"Ikegami Electronics",IMAG:"Image Systems",IMI:"Ingram Micro",INTC:"Intel",INTL:"N/A (INTL)",INTR:"Intra Electronics",IOCO:"Iocomm International Technology",IPS:"InfoPrint Solutions Company",IRIS:"Scitex",ISL:"Ichikawa Soft Laboratory",ITNL:"N/A (ITNL)",IVM:"IVM",IWAT:"Iwatsu Electric",Idnt:"Scitex",Inca:"Inca Digital Printers",Iris:"Scitex",JPEG:"Joint Photographic Experts Group",JSFT:"Jetsoft Development",JVC:"JVC Information Products",KART:"Scitex",KFC:"KFC Computek Components",KLH:"KLH Computers",KMHD:"Konica Minolta",KNCA:"Konica",KODA:"Kodak",KYOC:"Kyocera",Kart:"Scitex",LCAG:"Leica",LCCD:"Leeds Colour",LDAK:"Left Dakota",LEAD:"Leading Technology",LEXM:"Lexmark International",LINK:"Link Computer",LINO:"Linotronic",LITE:"Lite-On",Leaf:"Leaf",Lino:"Linotronic",MAGC:"Mag Computronic",MAGI:"MAG Innovision",MANN:"Mannesmann",MICN:"Micron Technology",MICR:"Microtek",MICV:"Microvitec",MINO:"Minolta",MITS:"Mitsubishi Electronics America",MITs:"Mitsuba",MNLT:"Minolta",MODG:"Modgraph",MONI:"Monitronix",MONS:"Monaco Systems",MORS:"Morse Technology",MOTI:"Motive Systems",MSFT:"Microsoft",MUTO:"MUTOH INDUSTRIES",Mits:"Mitsubishi Electric",NANA:"NANAO",NEC:"NEC",NEXP:"NexPress Solutions",NISS:"Nissei Sangyo America",NKON:"Nikon",NONE:"none",OCE:"Oce Technologies",OCEC:"OceColor",OKI:"Oki",OKID:"Okidata",OKIP:"Okidata",OLIV:"Olivetti",OLYM:"Olympus",ONYX:"Onyx Graphics",OPTI:"Optiquest",PACK:"Packard Bell",PANA:"Matsushita Electric Industrial",PANT:"Pantone",PBN:"Packard Bell",PFU:"PFU",PHIL:"Philips Consumer Electronics",PNTX:"HOYA",POne:"Phase One A/S",PREM:"Premier Computer Innovations",PRIN:"Princeton Graphic Systems",PRIP:"Princeton Publishing Labs",QLUX:"Hong Kong",QMS:"QMS",QPCD:"QPcard AB",QUAD:"QuadLaser",QUME:"Qume",RADI:"Radius",RDDx:"Integrated Color Solutions",RDG:"Roland DG",REDM:"REDMS Group",RELI:"Relisys",RGMS:"Rolf Gierling Multitools",RICO:"Ricoh",RNLD:"Edmund Ronald",ROYA:"Royal",RPC:"Ricoh Printing Systems",RTL:"Royal Information Electronics",SAMP:"Sampo",SAMS:"Samsung",SANT:"Jaime Santana Pomares",SCIT:"Scitex",SCRN:"Dainippon Screen",SDP:"Scitex",SEC:"Samsung",SEIK:"Seiko Instruments",SEIk:"Seikosha",SGUY:"ScanGuy.com",SHAR:"Sharp Laboratories",SICC:"International Color Consortium",SONY:"Sony",SPCL:"SpectraCal",STAR:"Star",STC:"Sampo Technology",Scit:"Scitex",Sdp:"Scitex",Sony:"Sony",TALO:"Talon Technology",TAND:"Tandy",TATU:"Tatung",TAXA:"TAXAN America",TDS:"Tokyo Denshi Sekei",TECO:"TECO Information Systems",TEGR:"Tegra",TEKT:"Tektronix",TI:"Texas Instruments",TMKR:"TypeMaker",TOSB:"Toshiba",TOSH:"Toshiba",TOTK:"TOTOKU ELECTRIC",TRIU:"Triumph",TSBT:"Toshiba",TTX:"TTX Computer Products",TVM:"TVM Professional Monitor",TW:"TW Casper",ULSX:"Ulead Systems",UNIS:"Unisys",UTZF:"Utz Fehlau & Sohn",VARI:"Varityper",VIEW:"Viewsonic",VISL:"Visual communication",VIVO:"Vivo Mobile Communication",WANG:"Wang",WLBR:"Wilbur Imaging",WTG2:"Ware To Go",WYSE:"WYSE Technology",XERX:"Xerox",XRIT:"X-Rite",ZRAN:"Zoran",Zebr:"Zebra Technologies",appl:"Apple Computer",bICC:"basICColor",berg:"bergdesign",ceyd:"Integrated Color Solutions",clsp:"MacDermid ColorSpan",ds:"Dainippon Screen",dupn:"DuPont",ffei:"FujiFilm Electronic Imaging",flux:"FluxData",iris:"Scitex",kart:"Scitex",lcms:"Little CMS",lino:"Linotronic",none:"none",ob4d:"Erdt Systems",obic:"Medigraph",quby:"Qubyx Sarl",scit:"Scitex",scrn:"Dainippon Screen",sdp:"Scitex",siwi:"SIWI GRAFIKA",yxym:"YxyMaster"},Ut={scnr:"Scanner",mntr:"Monitor",prtr:"Printer",link:"Device Link",abst:"Abstract",spac:"Color Space Conversion Profile",nmcl:"Named Color",cenc:"ColorEncodingSpace profile",mid:"MultiplexIdentification profile",mlnk:"MultiplexLink profile",mvis:"MultiplexVisualization profile",nkpf:"Nikon Input Device Profile (NON-STANDARD!)"};B(G,"icc",[[4,Lt],[12,Ut],[40,Object.assign({},Lt,Ut)],[48,Lt],[80,Lt],[64,{0:"Perceptual",1:"Relative Colorimetric",2:"Saturation",3:"Absolute Colorimetric"}],["tech",{amd:"Active Matrix Display",crt:"Cathode Ray Tube Display",kpcd:"Photo CD",pmd:"Passive Matrix Display",dcam:"Digital Camera",dcpj:"Digital Cinema Projector",dmpc:"Digital Motion Picture Camera",dsub:"Dye Sublimation Printer",epho:"Electrophotographic Printer",esta:"Electrostatic Printer",flex:"Flexography",fprn:"Film Writer",fscn:"Film Scanner",grav:"Gravure",ijet:"Ink Jet Printer",imgs:"Photo Image Setter",mpfr:"Motion Picture Film Recorder",mpfs:"Motion Picture Film Scanner",offs:"Offset Lithography",pjtv:"Projection Television",rpho:"Photographic Paper Printer",rscn:"Reflective Scanner",silk:"Silkscreen",twax:"Thermal Wax Printer",vidc:"Video Camera",vidm:"Video Monitor"}]]);class Ft extends ge{static canHandle(e,t,i){return 237===e.getUint8(t+1)&&"Photoshop"===e.getString(t+4,9)&&void 0!==this.containsIptc8bim(e,t,i)}static headerLength(e,t,i){let n,s=this.containsIptc8bim(e,t,i);if(void 0!==s)return n=e.getUint8(t+s+7),n%2!=0&&(n+=1),0===n&&(n=4),s+8+n}static containsIptc8bim(e,t,i){for(let n=0;n<i;n++)if(this.isIptcSegmentHead(e,t+n))return n}static isIptcSegmentHead(e,t){return 56===e.getUint8(t)&&943868237===e.getUint32(t)&&1028===e.getUint16(t+4)}parse(){let{raw:e}=this,t=this.chunk.byteLength-1,i=!1;for(let n=0;n<t;n++)if(28===this.chunk.getUint8(n)&&2===this.chunk.getUint8(n+1)){i=!0;let t=this.chunk.getUint16(n+3),s=this.chunk.getUint8(n+2),r=this.chunk.getLatin1String(n+5,t);e.set(s,this.pluralizeValue(e.get(s),r)),n+=4+t}else if(i)break;return this.translate(),this.output}pluralizeValue(e,t){return void 0!==e?e instanceof Array?(e.push(t),e):[e,t]:t}}f(Ft,"type","iptc"),f(Ft,"translateValues",!1),f(Ft,"reviveValues",!1),A.set("iptc",Ft),B(N,"iptc",[[0,"ApplicationRecordVersion"],[3,"ObjectTypeReference"],[4,"ObjectAttributeReference"],[5,"ObjectName"],[7,"EditStatus"],[8,"EditorialUpdate"],[10,"Urgency"],[12,"SubjectReference"],[15,"Category"],[20,"SupplementalCategories"],[22,"FixtureIdentifier"],[25,"Keywords"],[26,"ContentLocationCode"],[27,"ContentLocationName"],[30,"ReleaseDate"],[35,"ReleaseTime"],[37,"ExpirationDate"],[38,"ExpirationTime"],[40,"SpecialInstructions"],[42,"ActionAdvised"],[45,"ReferenceService"],[47,"ReferenceDate"],[50,"ReferenceNumber"],[55,"DateCreated"],[60,"TimeCreated"],[62,"DigitalCreationDate"],[63,"DigitalCreationTime"],[65,"OriginatingProgram"],[70,"ProgramVersion"],[75,"ObjectCycle"],[80,"Byline"],[85,"BylineTitle"],[90,"City"],[92,"Sublocation"],[95,"State"],[100,"CountryCode"],[101,"Country"],[103,"OriginalTransmissionReference"],[105,"Headline"],[110,"Credit"],[115,"Source"],[116,"CopyrightNotice"],[118,"Contact"],[120,"Caption"],[121,"LocalCaption"],[122,"Writer"],[125,"RasterizedCaption"],[130,"ImageType"],[131,"ImageOrientation"],[135,"LanguageIdentifier"],[150,"AudioType"],[151,"AudioSamplingRate"],[152,"AudioSamplingResolution"],[153,"AudioDuration"],[154,"AudioOutcue"],[184,"JobID"],[185,"MasterDocumentID"],[186,"ShortDocumentID"],[187,"UniqueDocumentID"],[188,"OwnerID"],[200,"ObjectPreviewFileFormat"],[201,"ObjectPreviewFileVersion"],[202,"ObjectPreviewData"],[221,"Prefs"],[225,"ClassifyState"],[228,"SimilarityIndex"],[230,"DocumentNotes"],[231,"DocumentHistory"],[232,"ExifCameraInfo"],[255,"CatalogSets"]]),B(G,"iptc",[[10,{0:"0 (reserved)",1:"1 (most urgent)",2:"2",3:"3",4:"4",5:"5 (normal urgency)",6:"6",7:"7",8:"8 (least urgent)",9:"9 (user-defined priority)"}],[75,{a:"Morning",b:"Both Morning and Evening",p:"Evening"}],[131,{L:"Landscape",P:"Portrait",S:"Square"}]]),e.Exifr=ce,e.Options=oe,e.allFormatters=ie,e.chunkedProps=$,e.createDictionary=B,e.default=ft,e.extendDictionary=E,e.fetchUrlAsArrayBuffer=L,e.fileParsers=T,e.fileReaders=D,e.gps=De,e.gpsOnlyOptions=Ae,e.inheritables=te,e.orientation=Re,e.orientationOnlyOptions=Me,e.otherSegments=J,e.parse=fe,e.readBlobAsArrayBuffer=U,e.rotation=Ue,e.rotations=Le,e.segmentParsers=A,e.segments=q,e.segmentsAndBlocks=Z,e.sidecar=async function(e,t,i){let n=new oe(t);n.chunked=!1,void 0===i&&"string"==typeof e&&(i=function(e){let t=e.toLowerCase().split(".").pop();if(function(e){return"exif"===e||"tiff"===e||"tif"===e}(t))return"tiff";if(dt.includes(t))return t}(e));let s=await x(e,n);if(i){if(dt.includes(i))return gt(i,s,n);m("Invalid segment type")}else{if(function(e){let t=e.getString(0,50).trim();return t.includes("<?xpacket")||t.includes("<x:")}(s))return gt("xmp",s,n);for(let[e]of A){if(!dt.includes(e))continue;let t=await gt(e,s,n).catch(pt);if(t)return t}m("Unknown file format")}},e.tagKeys=N,e.tagRevivers=V,e.tagValues=G,e.thumbnail=xe,e.thumbnailOnlyOptions=Oe,e.thumbnailUrl=ve,e.tiffBlocks=Q,e.tiffExtractables=ee,Object.defineProperty(e,"__esModule",{value:!0})}));
node_modules\node-cron\dist\cjs\logger.js:14:    const prefix = `[${timestamp}] [PID: ${process.pid}] ${GREEN}[NODE-CRON]${GREEN} ${color}[${level}]${RESET}`;
node_modules\node-cron\dist\cjs\node-cron.js:6:exports.nodeCron = exports.getTask = exports.getTasks = void 0;
node_modules\node-cron\dist\cjs\node-cron.js:63:exports.nodeCron = {
node_modules\node-cron\dist\cjs\node-cron.js:70:exports.default = exports.nodeCron;
node_modules\node-cron\dist\cjs\node-cron.js:71://# sourceMappingURL=node-cron.js.mapnode_modules\node-cron\dist\cjs\scheduler\runner.js:106:                    logger_1.default.warn(`missed execution at ${expectedNextExecution}! Possible blocking IO or high CPU user at the same process used by node-cron.`);
node_modules\node-cron\dist\cjs\tasks\background-scheduled-task\background-scheduled-task.js:21:    cronExpression;
node_modules\node-cron\dist\cjs\tasks\background-scheduled-task\background-scheduled-task.js:26:    constructor(cronExpression, taskPath, options) {
node_modules\node-cron\dist\cjs\tasks\background-scheduled-task\background-scheduled-task.js:27:        this.cronExpression = cronExpression;
node_modules\node-cron\dist\cjs\tasks\background-scheduled-task\background-scheduled-task.js:47:            const timeMatcher = new time_matcher_1.TimeMatcher(this.cronExpression, this.options?.timezone);
node_modules\node-cron\dist\cjs\tasks\background-scheduled-task\background-scheduled-task.js:68:                        const erro = new Error(`node-cron daemon exited with code ${code || signal}`);
node_modules\node-cron\dist\cjs\tasks\background-scheduled-task\background-scheduled-task.js:99:                    cron: this.cronExpression,
node_modules\node-cron\dist\cjs\tasks\background-scheduled-task\daemon.js:52:    const task = new inline_scheduled_task_1.InlineScheduledTask(message.cron, script.task, message.options);
node_modules\node-cron\dist\cjs\tasks\inline-scheduled-task.js:18:    cronExpression;
node_modules\node-cron\dist\cjs\tasks\inline-scheduled-task.js:25:    constructor(cronExpression, taskFn, options) {
node_modules\node-cron\dist\cjs\tasks\inline-scheduled-task.js:27:        this.cronExpression = cronExpression;
node_modules\node-cron\dist\cjs\tasks\inline-scheduled-task.js:31:        this.timeMatcher = new time_matcher_1.TimeMatcher(cronExpression, options?.timezone);
node_modules\node-cron\dist\cjs\time\matcher-walker.js:12:    cronExpression;
node_modules\node-cron\dist\cjs\time\matcher-walker.js:18:    constructor(cronExpression, baseDate, timezone) {
node_modules\node-cron\dist\cjs\time\matcher-walker.js:19:        this.cronExpression = cronExpression;
node_modules\node-cron\dist\cjs\time\matcher-walker.js:21:        this.timeMatcher = new time_matcher_1.TimeMatcher(cronExpression, timezone);
node_modules\node-cron\dist\cjs\time\matcher-walker.js:23:        this.expressions = (0, convertion_1.default)(cronExpression);
node_modules\node-cron\dist\esm\logger.js:14:    const prefix = `[${timestamp}] [PID: ${process.pid}] ${GREEN}[NODE-CRON]${GREEN} ${color}[${level}]${RESET}`;
node_modules\node-cron\dist\esm\node-cron.js:6:exports.nodeCron = exports.getTask = exports.getTasks = void 0;
node_modules\node-cron\dist\esm\node-cron.js:63:exports.nodeCron = {
node_modules\node-cron\dist\esm\node-cron.js:70:exports.default = exports.nodeCron;
node_modules\node-cron\dist\esm\node-cron.js:71://# sourceMappingURL=node-cron.js.mapnode_modules\node-cron\dist\esm\scheduler\runner.js:106:                    logger_1.default.warn(`missed execution at ${expectedNextExecution}! Possible blocking IO or high CPU user at the same process used by node-cron.`);
node_modules\node-cron\dist\esm\tasks\background-scheduled-task\background-scheduled-task.js:21:    cronExpression;
node_modules\node-cron\dist\esm\tasks\background-scheduled-task\background-scheduled-task.js:26:    constructor(cronExpression, taskPath, options) {
node_modules\node-cron\dist\esm\tasks\background-scheduled-task\background-scheduled-task.js:27:        this.cronExpression = cronExpression;
node_modules\node-cron\dist\esm\tasks\background-scheduled-task\background-scheduled-task.js:47:            const timeMatcher = new time_matcher_1.TimeMatcher(this.cronExpression, this.options?.timezone);
node_modules\node-cron\dist\esm\tasks\background-scheduled-task\background-scheduled-task.js:68:                        const erro = new Error(`node-cron daemon exited with code ${code || signal}`);
node_modules\node-cron\dist\esm\tasks\background-scheduled-task\background-scheduled-task.js:99:                    cron: this.cronExpression,
node_modules\node-cron\dist\esm\tasks\background-scheduled-task\daemon.js:19:    const task = new inline_scheduled_task_1.InlineScheduledTask(message.cron, script.task, message.options);
node_modules\node-cron\dist\esm\tasks\inline-scheduled-task.js:18:    cronExpression;
node_modules\node-cron\dist\esm\tasks\inline-scheduled-task.js:25:    constructor(cronExpression, taskFn, options) {
node_modules\node-cron\dist\esm\tasks\inline-scheduled-task.js:27:        this.cronExpression = cronExpression;
node_modules\node-cron\dist\esm\tasks\inline-scheduled-task.js:31:        this.timeMatcher = new time_matcher_1.TimeMatcher(cronExpression, options?.timezone);
node_modules\node-cron\dist\esm\time\matcher-walker.js:12:    cronExpression;
node_modules\node-cron\dist\esm\time\matcher-walker.js:18:    constructor(cronExpression, baseDate, timezone) {
node_modules\node-cron\dist\esm\time\matcher-walker.js:19:        this.cronExpression = cronExpression;
node_modules\node-cron\dist\esm\time\matcher-walker.js:21:        this.timeMatcher = new time_matcher_1.TimeMatcher(cronExpression, timezone);
node_modules\node-cron\dist\esm\time\matcher-walker.js:23:        this.expressions = (0, convertion_1.default)(cronExpression);
node_modules\node-schedule\lib\Invocation.js:4:const CronDate = require('cron-parser/lib/date')
node_modules\node-schedule\lib\Invocation.js:57:  NOTE: Cron months are 1-based, but RecurrenceRule months are 0-based.
node_modules\node-schedule\lib\Invocation.js:128:  base = ((base instanceof CronDate) || (base instanceof Date)) ? base : (new Date());
node_modules\node-schedule\lib\Invocation.js:137:  const now = new CronDate(Date.now(), this.tz);
node_modules\node-schedule\lib\Invocation.js:145:  let next = new CronDate(base.getTime(), this.tz);
node_modules\node-schedule\lib\Invocation.js:235:  const date = invocation.fireDate instanceof CronDate ? invocation.fireDate.toDate() : invocation.fireDate;
node_modules\node-schedule\lib\Invocation.js:268:        const result = job.invoke(cinv.fireDate instanceof CronDate ? cinv.fireDate.toDate() : cinv.fireDate);
node_modules\node-schedule\lib\Invocation.js:322:  prevDate = (prevDate instanceof CronDate) ? prevDate : new CronDate();
node_modules\node-schedule\lib\Invocation.js:329:  if ((endDate instanceof CronDate) && date.getTime() > endDate.getTime()) {
node_modules\node-schedule\lib\Job.js:4:const cronParser = require('cron-parser')
node_modules\node-schedule\lib\Job.js:5:const CronDate = require('cron-parser/lib/date')
node_modules\node-schedule\lib\Job.js:201:      start = new CronDate(start, tz);
node_modules\node-schedule\lib\Job.js:212:      end = new CronDate(end, tz);
node_modules\node-schedule\lib\Job.js:217:    const res = cronParser.parseExpression(spec, {currentDate: start, tz: tz});
node_modules\node-schedule\lib\Job.js:229:      spec = new CronDate(spec);
node_modules\node-schedule\lib\schedule.js:5:  A cron-like and not-cron-like job scheduler for Node.
node_modules\node-schedule\lib\schedule.js:13:  schedule(date || recurrenceRule || cronstring)
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:15:    async UpdateCronJob(req, cb) {
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:16:        return this.request("UpdateCronJob", req, cb);
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:78:    async AbortCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:79:        return this.request("AbortCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:84:    async RestartCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:85:        return this.request("RestartCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:117:    async DeleteCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:118:        return this.request("DeleteCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:120:    async DescribeCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:121:        return this.request("DescribeCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:147:    async CreateCronJob(req, cb) {
node_modules\tencentcloud-sdk-nodejs\es\services\pts\v20210728\pts_client.js:148:        return this.request("CreateCronJob", req, cb);
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:51:    async UpdateCronJob(req, cb) {
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:52:        return this.request("UpdateCronJob", req, cb);
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:177:    async AbortCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:178:        return this.request("AbortCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:189:    async RestartCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:190:        return this.request("RestartCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:255:    async DeleteCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:256:        return this.request("DeleteCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:261:    async DescribeCronJobs(req, cb) {
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:262:        return this.request("DescribeCronJobs", req, cb);
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:315:    async CreateCronJob(req, cb) {
node_modules\tencentcloud-sdk-nodejs\tencentcloud\services\pts\v20210728\pts_client.js:316:        return this.request("CreateCronJob", req, cb);
tasks\autoSettlement.js:12: * - 鍙€氳繃 node-cron 鎴?pm2 瀹氭椂璋冨害
FINDSTR: 写入错误


D:\housekeeping-platform\backend>findstr /s /i /n "setInterval" *.js
app.js:432:        setInterval(async () => {
jobs\acceptanceReminder.js:102:  setInterval(() => {
node_modules\basic-ftp\dist\ProgressTracker.js:60:    const id = setInterval(updateFunc, intervalMs);
node_modules\bull\lib\job.js:535:      const interval = setInterval(() => {
node_modules\bull\lib\queue.js:1091:    this.moveUnlockedJobsToWaitInterval = setInterval(
node_modules\echarts\dist\echarts.common.js:28128:          // In WeChat embedded browser, `requestAnimationFrame` and `setInterval`
node_modules\echarts\dist\echarts.common.js:32255:      IntervalScale.prototype.setInterval = function (interval) {
node_modules\echarts\dist\echarts.common.js:33853:        scale.setInterval && scale.setInterval(interval);
node_modules\echarts\dist\echarts.common.js:45640:      // NOTE: Must in setExtent -> setInterval -> setNiceExtent order.
node_modules\echarts\dist\echarts.common.js:45642:      intervalScaleProto.setInterval.call(scale, interval);
node_modules\echarts\dist\echarts.common.js:58508:        // Notice: this._resetInterval() should not be executed when payload.type
node_modules\echarts\dist\echarts.common.js:58532:        this._resetInterval();
node_modules\echarts\dist\echarts.common.js:58940:      SliderZoomView.prototype._resetInterval = function () {
node_modules\echarts\dist\echarts.common.min.js:45:var qr={},Kr={};var $r,Qr=function(){function t(t,e,n){var i=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,n=n||{},this.dom=e,this.id=t;var o=new hn,a=n.renderer||"canvas";qr[a]||(a=H(qr)[0]),n.useDirtyRect=null!=n.useDirtyRect&&n.useDirtyRect;var s=new qr[a](e,o,n,t),l=n.ssr||s.ssrOnly;this.storage=o,this.painter=s;var u,h=r.node||r.worker||l?null:new ur(s.getViewportRoot(),s.root),c=n.useCoarsePointer;(null==c||"auto"===c?r.touchEventsSupported:!!c)&&(u=rt(n.pointerSize,44)),this.handler=new Ke(o,s,h,s.root,u),this.animation=new Yi({stage:{update:l?null:function(){return i._flush(!0)}}}),l||this.animation.start()}return t.prototype.add=function(t){!this._disposed&&t&&(this.storage.addRoot(t),t.addSelfToZr(this),this.refresh())},t.prototype.remove=function(t){!this._disposed&&t&&(this.storage.delRoot(t),t.removeSelfFromZr(this),this.refresh())},t.prototype.configLayer=function(t,e){this._disposed||(this.painter.configLayer&&this.painter.configLayer(t,e),this.refresh())},t.prototype.setBackgroundColor=function(t){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(t),this.refresh(),this._backgroundColor=t,this._darkMode=function(t){if(!t)return!1;if("string"==typeof t)return ui(t,1)<.4;if(t.colorStops){for(var e=t.colorStops,n=0,i=e.length,r=0;r<i;r++)n+=ui(e[r].color,1);return(n/=i)<.4}return!1}(t))},t.prototype.getBackgroundColor=function(){return this._backgroundColor},t.prototype.setDarkMode=function(t){this._darkMode=t},t.prototype.isDarkMode=function(){return this._darkMode},t.prototype.refreshImmediately=function(t){this._disposed||(t||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},t.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},t.prototype.flush=function(){this._disposed||this._flush(!1)},t.prototype._flush=function(t){var e,n=Gi();this._needsRefresh&&(e=!0,this.refreshImmediately(t)),this._needsRefreshHover&&(e=!0,this.refreshHoverImmediately());var i=Gi();e?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:i-n})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},t.prototype.setSleepAfterStill=function(t){this._sleepAfterStill=t},t.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},t.prototype.refreshHover=function(){this._needsRefreshHover=!0},t.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&"canvas"===this.painter.getType()&&this.painter.refreshHover())},t.prototype.resize=function(t){this._disposed||(t=t||{},this.painter.resize(t.width,t.height),this.handler.resize())},t.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},t.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},t.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},t.prototype.setCursorStyle=function(t){this._disposed||this.handler.setCursorStyle(t)},t.prototype.findHover=function(t,e){if(!this._disposed)return this.handler.findHover(t,e)},t.prototype.on=function(t,e,n){return this._disposed||this.handler.on(t,e,n),this},t.prototype.off=function(t,e){this._disposed||this.handler.off(t,e)},t.prototype.trigger=function(t,e){this._disposed||this.handler.trigger(t,e)},t.prototype.clear=function(){if(!this._disposed){for(var t=this.storage.getRoots(),e=0;e<t.length;e++)t[e]instanceof jr&&t[e].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},t.prototype.dispose=function(){var t;this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,t=this.id,delete Kr[t])},t}();function Jr(t,e){var n=new Qr(M(),t,e);return Kr[n.id]=n,n}function to(t,e){qr[t]=e}function eo(t){if("function"==typeof $r)return $r(t)}function no(t){$r=t}var io=Object.freeze({__proto__:null,init:Jr,dispose:function(t){t.dispose()},disposeAll:function(){for(var t in Kr)Kr.hasOwnProperty(t)&&Kr[t].dispose();Kr={}},getInstance:function(t){return Kr[t]},registerPainter:to,getElementSSRData:eo,registerSSRDataGetter:no,version:"6.0.0"}),ro=1e-4;var oo=Math.min,ao=Math.max,so=Math.abs;function lo(t,e,n,i){var r=e[0],o=e[1],a=n[0],s=n[1],l=o-r,u=s-a;if(0===l)return 0===u?a:(a+s)/2;if(i)if(l>0){if(t<=r)return a;if(t>=o)return s}else{if(t>=r)return a;if(t<=o)return s}else{if(t===r)return a;if(t===o)return s}return(t-r)/l*u+a}var uo=function(t,e,n){switch(t){case"center":case"middle":t="50%";break;case"left":case"top":t="0%";break;case"right":case"bottom":t="100%"}return ho(t,e,n)};function ho(t,e,n){return Y(t)?(i=t,i.replace(/^\s+|\s+$/g,"")).match(/%$/)?parseFloat(t)/100*e+(n||0):parseFloat(t):null==t?NaN:+t;var i}function co(t,e,n){return null==e&&(e=10),e=Math.min(Math.max(0,e),20),t=(+t).toFixed(e),n?t:+t}function po(t){return t.sort((function(t,e){return t-e})),t}function fo(t){if(t=+t,isNaN(t))return 0;if(t>1e-14)for(var e=1,n=0;n<15;n++,e*=10)if(Math.round(t*e)/e===t)return n;return go(t)}function go(t){var e=t.toString().toLowerCase(),n=e.indexOf("e"),i=n>0?+e.slice(n+1):0,r=n>0?n:e.length,o=e.indexOf("."),a=o<0?0:r-1-o;return Math.max(0,a-i)}function vo(t,e){var n=Math.log,i=Math.LN10,r=Math.floor(n(t[1]-t[0])/i),o=Math.round(n(so(e[1]-e[0]))/i),a=Math.min(Math.max(-r+o,0),20);return isFinite(a)?a:20}function yo(t,e){var n=E(t,(function(t,e){return t+(isNaN(e)?0:e)}),0);if(0===n)return[];for(var i=Math.pow(10,e),r=z(t,(function(t){return(isNaN(t)?0:t)/n*i*100})),o=100*i,a=z(r,(function(t){return Math.floor(t)})),s=E(a,(function(t,e){return t+e}),0),l=z(r,(function(t,e){return t-a[e]}));s<o;){for(var u=Number.NEGATIVE_INFINITY,h=null,c=0,p=l.length;c<p;++c)l[c]>u&&(u=l[c],h=c);++a[h],l[h]=0,++s}return z(a,(function(t){return t/i}))}function mo(t,e){var n=Math.max(fo(t),fo(e)),i=t+e;return n>20?i:co(i,n)}function _o(t){var e=2*Math.PI;return(t%e+e)%e}function xo(t){return t>-1e-4&&t<ro}var bo=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function wo(t){if(t instanceof Date)return t;if(Y(t)){var e=bo.exec(t);if(!e)return new Date(NaN);if(e[8]){var n=+e[4]||0;return"Z"!==e[8].toUpperCase()&&(n-=+e[8].slice(0,3)),new Date(Date.UTC(+e[1],+(e[2]||1)-1,+e[3]||1,n,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0))}return new Date(+e[1],+(e[2]||1)-1,+e[3]||1,+e[4]||0,+(e[5]||0),+e[6]||0,e[7]?+e[7].substring(0,3):0)}return null==t?new Date(NaN):new Date(Math.round(t))}function So(t){return Math.pow(10,Mo(t))}function Mo(t){if(0===t)return 0;var e=Math.floor(Math.log(t)/Math.LN10);return t/Math.pow(10,e)>=10&&e++,e}function To(t,e){var n=Mo(t),i=Math.pow(10,n),r=t/i;return t=(e?r<1.5?1:r<2.5?2:r<4?3:r<7?5:10:r<1?1:r<2?2:r<3?3:r<5?5:10)*i,n>=-20?+t.toFixed(n<0?-n:0):t}function ko(t){var e=parseFloat(t);return e==t&&(0!==e||!Y(t)||t.indexOf("x")<=0)?e:NaN}function Co(t){return!isNaN(ko(t))}function Io(){return Math.round(9*Math.random())}function Do(t,e){return 0===e?t:Do(e,t%e)}function Ao(t,e){return null==t?e:null==e?t:t*e/Do(t,e)}var Po={},Lo="undefined"!=typeof console&&console.warn&&console.log;function Oo(t,e,n){if(Lo){if(n){if(Po[e])return;Po[e]=!0}console[t]("[ECharts] "+e)}}function Ro(t,e){Oo("error",t,e)}function No(t){0}function Bo(t){throw new Error(t)}function zo(t,e,n){return(e-t)*n+t}var Eo="series\0",Vo="\0_ec_\0";function Fo(t){return t instanceof Array?t:null==t?[]:[t]}function Ho(t,e,n){if(t){t[e]=t[e]||{},t.emphasis=t.emphasis||{},t.emphasis[e]=t.emphasis[e]||{};for(var i=0,r=n.length;i<r;i++){var o=n[i];!t.emphasis[e].hasOwnProperty(o)&&t[e].hasOwnProperty(o)&&(t.emphasis[e][o]=t[e][o])}}}var Wo=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function Go(t){return!q(t)||U(t)||t instanceof Date?t:t.value}function Uo(t){return q(t)&&!(t instanceof Array)}function Zo(t,e,n){var i="normalMerge"===n,r="replaceMerge"===n,o="replaceAll"===n;t=t||[],e=(e||[]).slice();var a=vt();B(e,(function(t,n){q(t)||(e[n]=null)}));var s,l,u=function(t,e,n){var i=[];if("replaceAll"===n)return i;for(var r=0;r<t.length;r++){var o=t[r];o&&null!=o.id&&e.set(o.id,r),i.push({existing:"replaceMerge"===n||Ko(o)?null:o,newOption:null,keyInfo:null,brandNew:null})}return i}(t,a,n);return(i||r)&&function(t,e,n,i){B(i,(function(r,o){if(r&&null!=r.id){var a=Xo(r.id),s=n.get(a);if(null!=s){var l=t[s];lt(!l.newOption,'Duplicated option on id "'+a+'".'),l.newOption=r,l.existing=e[s],i[o]=null}}}))}(u,t,a,e),i&&function(t,e){B(e,(function(n,i){if(n&&null!=n.name)for(var r=0;r<t.length;r++){var o=t[r].existing;if(!t[r].newOption&&o&&(null==o.id||null==n.id)&&!Ko(n)&&!Ko(o)&&Yo("name",o,n))return t[r].newOption=n,void(e[i]=null)}}))}(u,e),i||r?function(t,e,n){B(e,(function(e){if(e){for(var i,r=0;(i=t[r])&&(i.newOption||Ko(i.existing)||i.existing&&null!=e.id&&!Yo("id",e,i.existing));)r++;i?(i.newOption=e,i.brandNew=n):t.push({newOption:e,brandNew:n,existing:null,keyInfo:null}),r++}}))}(u,e,r):o&&function(t,e){B(e,(function(e){t.push({newOption:e,brandNew:!0,existing:null,keyInfo:null})}))}(u,e),s=u,l=vt(),B(s,(function(t){var e=t.existing;e&&l.set(e.id,t)})),B(s,(function(t){var e=t.newOption;lt(!e||null==e.id||!l.get(e.id)||l.get(e.id)===t,"id duplicates: "+(e&&e.id)),e&&null!=e.id&&l.set(e.id,t),!t.keyInfo&&(t.keyInfo={})})),B(s,(function(t,e){var n=t.existing,i=t.newOption,r=t.keyInfo;if(q(i)){if(r.name=null!=i.name?Xo(i.name):n?n.name:Eo+e,n)r.id=Xo(n.id);else if(null!=i.id)r.id=Xo(i.id);else{var o=0;do{r.id="\0"+r.name+"\0"+o++}while(l.get(r.id))}l.set(r.id,t)}})),u}function Yo(t,e,n){var i=jo(e[t],null),r=jo(n[t],null);return null!=i&&null!=r&&i===r}function Xo(t){return jo(t,"")}function jo(t,e){return null==t?e:Y(t)?t:j(t)||X(t)?t+"":e}function qo(t){var e=t.name;return!(!e||!e.indexOf(Eo))}function Ko(t){return t&&null!=t.id&&0===Xo(t.id).indexOf(Vo)}function $o(t,e){return null!=e.dataIndexInside?e.dataIndexInside:null!=e.dataIndex?U(e.dataIndex)?z(e.dataIndex,(function(e){return t.indexOfRawIndex(e)})):t.indexOfRawIndex(e.dataIndex):null!=e.name?U(e.name)?z(e.name,(function(e){return t.indexOfName(e)})):t.indexOfName(e.name):void 0}function Qo(){var t="__ec_inner_"+Jo++;return function(e){return e[t]||(e[t]={})}}var Jo=Io();function ta(t,e,n){var i=ea(e,n),r=i.mainTypeSpecified,o=i.queryOptionMap,a=i.others,s=n?n.defaultMainType:null;return!r&&s&&o.set(s,{}),o.each((function(e,i){var r=ra(t,i,e,{useDefault:s===i,enableAll:!n||null==n.enableAll||n.enableAll,enableNone:!n||null==n.enableNone||n.enableNone});a[i+"Models"]=r.models,a[i+"Model"]=r.models[0]})),a}function ea(t,e){var n;if(Y(t)){var i={};i[t+"Index"]=0,n=i}else n=t;var r=vt(),o={},a=!1;return B(n,(function(t,n){if("dataIndex"!==n&&"dataIndexInside"!==n){var i=n.match(/^(\w+)(Index|Id|Name)$/)||[],s=i[1],l=(i[2]||"").toLowerCase();if(s&&l&&!(e&&e.includeMainTypes&&L(e.includeMainTypes,s)<0))a=a||!!s,(r.get(s)||r.set(s,{}))[l]=t}else o[n]=t})),{mainTypeSpecified:a,queryOptionMap:r,others:o}}var na={useDefault:!0,enableAll:!1,enableNone:!1},ia={useDefault:!1,enableAll:!0,enableNone:!0};function ra(t,e,n,i){i=i||na;var r=n.index,o=n.id,a=n.name,s={models:null,specified:null!=r||null!=o||null!=a};if(!s.specified){var l=void 0;return s.models=i.useDefault&&(l=t.getComponent(e))?[l]:[],s}if("none"===r||!1===r){if(i.enableNone)return s.models=[],s;r=-1}return"all"===r&&(r=i.enableAll?o=a=null:-1),s.models=t.queryComponents({mainType:e,index:r,id:o,name:a}),s}function oa(t,e,n){t.setAttribute?t.setAttribute(e,n):t[e]=n}var aa="___EC__COMPONENT__CONTAINER___",sa="___EC__EXTENDED_CLASS___";function la(t){var e={main:"",sub:""};if(t){var n=t.split(".");e.main=n[0]||"",e.sub=n[1]||""}return e}function ua(t,e){t.$constructor=t,t.extend=function(t){var e,i,r=this;return Z(i=r)&&/^class\s/.test(Function.prototype.toString.call(i))?e=function(t){function e(){return t.apply(this,arguments)||this}return n(e,t),e}(r):(e=function(){(t.$constructor||r).apply(this,arguments)},O(e,this)),D(e.prototype,t),e[sa]=!0,e.extend=this.extend,e.superCall=pa,e.superApply=da,e.superClass=r,e}}function ha(t,e){t.extend=e.extend}var ca=Math.round(10*Math.random());function pa(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];return this.superClass.prototype[e].apply(t,n)}function da(t,e,n){return this.superClass.prototype[e].apply(t,n)}function fa(t){var e={};t.registerClass=function(t){var n,i=t.type||t.prototype.type;if(i){lt(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(n=i),'componentType "'+n+'" illegal'),t.prototype.type=i;var r=la(i);if(r.sub){if(r.sub!==aa){var o=function(t){var n=e[t.main];n&&n[aa]||((n=e[t.main]={})[aa]=!0);return n}(r);o[r.sub]=t}}else e[r.main]=t}return t},t.getClass=function(t,n,i){var r=e[t];if(r&&r[aa]&&(r=n?r[n]:null),i&&!r)throw new Error(n?"Component "+t+"."+(n||"")+" is used but not imported.":t+".type should be specified.");return r},t.getClassesByMainType=function(t){var n=la(t),i=[],r=e[n.main];return r&&r[aa]?B(r,(function(t,e){e!==aa&&i.push(t)})):i.push(r),i},t.hasClass=function(t){var n=la(t);return!!e[n.main]},t.getAllClassMainTypes=function(){var t=[];return B(e,(function(e,n){t.push(n)})),t},t.hasSubTypes=function(t){var n=la(t),i=e[n.main];return i&&i[aa]}}function ga(t,e){for(var n=0;n<t.length;n++)t[n][1]||(t[n][1]=t[n][0]);return e=e||!1,function(n,i,r){for(var o={},a=0;a<t.length;a++){var s=t[a][1];if(!(i&&L(i,s)>=0||r&&L(r,s)<0)){var l=n.getShallow(s,e);null!=l&&(o[t[a][0]]=l)}}return o}}var va=ga([["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]]),ya=function(){function t(){}return t.prototype.getAreaStyle=function(t,e){return va(this,t,e)},t}(),ma=new Fn(50);function _a(t){if("string"==typeof t){var e=ma.get(t);return e&&e.image}return t}function xa(t,e,n,i,r){if(t){if("string"==typeof t){if(e&&e.__zrImageSrc===t||!n)return e;var o=ma.get(t),a={hostEl:n,cb:i,cbPayload:r};return o?!wa(e=o.image)&&o.pending.push(a):((e=h.loadImage(t,ba,ba)).__zrImageSrc=t,ma.put(t,e.__cachedImgObj={image:e,pending:[a]})),e}return t}return e}function ba(){var t=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var e=0;e<t.pending.length;e++){var n=t.pending[e],i=n.cb;i&&i(this,n.cbPayload),n.hostEl.dirty()}t.pending.length=0}function wa(t){return t&&t.width&&t.height}var Sa=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function Ma(t,e,n,i,r,o){if(!n)return t.text="",void(t.isTruncated=!1);var a=(e+"").split("\n");o=Ta(n,i,r,o);for(var s=!1,l={},u=0,h=a.length;u<h;u++)ka(l,a[u],o),a[u]=l.textLine,s=s||l.isTruncated;t.text=a.join("\n"),t.isTruncated=s}function Ta(t,e,n,i){var r=D({},i=i||{});n=rt(n,"..."),r.maxIterations=rt(i.maxIterations,2);var o=r.minChar=rt(i.minChar,0),a=r.fontMeasureInfo=Tr(e),s=a.asciiCharWidth;r.placeholder=rt(i.placeholder,"");for(var l=t=Math.max(0,t-1),u=0;u<o&&l>=s;u++)l-=s;var h=Dr(a,n);return h>l&&(n="",h=0),l=t-h,r.ellipsis=n,r.ellipsisWidth=h,r.contentWidth=l,r.containerWidth=t,r}function ka(t,e,n){var i=n.containerWidth,r=n.contentWidth,o=n.fontMeasureInfo;if(!i)return t.textLine="",void(t.isTruncated=!1);var a=Dr(o,e);if(a<=i)return t.textLine=e,void(t.isTruncated=!1);for(var s=0;;s++){if(a<=r||s>=n.maxIterations){e+=n.ellipsis;break}var l=0===s?Ca(e,r,o):a>0?Math.floor(e.length*r/a):0;a=Dr(o,e=e.substr(0,l))}""===e&&(e=n.placeholder),t.textLine=e,t.isTruncated=!0}function Ca(t,e,n){for(var i=0,r=0,o=t.length;r<o&&i<e;r++)i+=Ir(n,t.charCodeAt(r));return r}var Ia=function(){},Da=function(t){this.tokens=[],t&&(this.tokens=t)},Aa=function(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[],this.isTruncated=!1};function Pa(t,e,n,i,r){var o,a,s=""===e,l=r&&n.rich[r]||{},u=t.lines,h=l.font||n.font,c=!1;if(i){var p=l.padding,d=p?p[1]+p[3]:0;if(null!=l.width&&"auto"!==l.width){var f=Nr(l.width,i.width)+d;u.length>0&&f+i.accumWidth>i.width&&(o=e.split("\n"),c=!0),i.accumWidth=f}else{var g=Ra(e,h,i.width,i.breakAll,i.accumWidth);i.accumWidth=g.accumWidth+d,a=g.linesWidths,o=g.lines}}o||(o=e.split("\n"));for(var v=Tr(h),y=0;y<o.length;y++){var m=o[y],_=new Ia;if(_.styleName=r,_.text=m,_.isLineHolder=!m&&!s,"number"==typeof l.width?_.width=l.width:_.width=a?a[y]:Dr(v,m),y||c)u.push(new Da([_]));else{var x=(u[u.length-1]||(u[0]=new Da)).tokens,b=x.length;1===b&&x[0].isLineHolder?x[0]=_:(m||!b||s)&&x.push(_)}}}var La=E(",&?/;] ".split(""),(function(t,e){return t[e]=!0,t}),{});function Oa(t){return!function(t){var e=t.charCodeAt(0);return e>=32&&e<=591||e>=880&&e<=4351||e>=4608&&e<=5119||e>=7680&&e<=8303}(t)||!!La[t]}function Ra(t,e,n,i,r){for(var o=[],a=[],s="",l="",u=0,h=0,c=Tr(e),p=0;p<t.length;p++){var d=t.charAt(p);if("\n"!==d){var f=Ir(c,d.charCodeAt(0)),g=!i&&!Oa(d);(o.length?h+f>n:r+h+f>n)?h?(s||l)&&(g?(s||(s=l,l="",h=u=0),o.push(s),a.push(h-u),l+=d,s="",h=u+=f):(l&&(s+=l,l="",u=0),o.push(s),a.push(h),s=d,h=f)):g?(o.push(l),a.push(u),l=d,u=f):(o.push(d),a.push(f)):(h+=f,g?(l+=d,u+=f):(l&&(s+=l,l="",u=0),s+=d))}else l&&(s+=l,h+=u),o.push(s),a.push(h),s="",l="",u=0,h=0}return l&&(s+=l),s&&(o.push(s),a.push(h)),1===o.length&&(h+=r),{accumWidth:h,lines:o,linesWidths:a}}function Na(t,e,n,i,r,o){if(t.baseX=n,t.baseY=i,t.outerWidth=t.outerHeight=null,e){var a=2*e.width,s=2*e.height;Ve.set(Ba,Lr(n,a,r),Or(i,s,o),a,s),Ve.intersect(e,Ba,null,za);var l=za.outIntersectRect;t.outerWidth=l.width,t.outerHeight=l.height,t.baseX=Lr(l.x,l.width,r,!0),t.baseY=Or(l.y,l.height,o,!0)}}var Ba=new Ve(0,0,0,0),za={outIntersectRect:{},clamp:!0};function Ea(t){return null!=t?t+="":t=""}function Va(t,e,n,i){var r=new Ve(Lr(t.x||0,e,t.textAlign),Or(t.y||0,n,t.textBaseline),e,n),o=null!=i?i:Fa(t)?t.lineWidth:0;return o>0&&(r.x-=o/2,r.y-=o/2,r.width+=o,r.height+=o),r}function Fa(t){var e=t.stroke;return null!=e&&"none"!==e&&t.lineWidth>0}var Ha="__zr_style_"+Math.round(10*Math.random()),Wa={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},Ga={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};Wa[Ha]=!0;var Ua=["z","z2","invisible"],Za=["invisible"],Ya=function(t){function e(e){return t.call(this,e)||this}var i;return n(e,t),e.prototype._init=function(e){for(var n=H(e),i=0;i<n.length;i++){var r=n[i];"style"===r?this.useStyle(e[r]):t.prototype.attrKV.call(this,r,e[r])}this.style||this.useStyle({})},e.prototype.beforeBrush=function(){},e.prototype.afterBrush=function(){},e.prototype.innerBeforeBrush=function(){},e.prototype.innerAfterBrush=function(){},e.prototype.shouldBePainted=function(t,e,n,i){var r=this.transform;if(this.ignore||this.invisible||0===this.style.opacity||this.culling&&function(t,e,n){Xa.copy(t.getBoundingRect()),t.transform&&Xa.applyTransform(t.transform);return ja.width=e,ja.height=n,!Xa.intersect(ja)}(this,t,e)||r&&!r[0]&&!r[3])return!1;if(n&&this.__clipPaths&&this.__clipPaths.length)for(var o=0;o<this.__clipPaths.length;++o)if(this.__clipPaths[o].isZeroArea())return!1;if(i&&this.parent)for(var a=this.parent;a;){if(a.ignore)return!1;a=a.parent}return!0},e.prototype.contain=function(t,e){return this.rectContain(t,e)},e.prototype.traverse=function(t,e){t.call(e,this)},e.prototype.rectContain=function(t,e){var n=this.transformCoordToLocal(t,e);return this.getBoundingRect().contain(n[0],n[1])},e.prototype.getPaintRect=function(){var t=this._paintRect;if(!this._paintRect||this.__dirty){var e=this.transform,n=this.getBoundingRect(),i=this.style,r=i.shadowBlur||0,o=i.shadowOffsetX||0,a=i.shadowOffsetY||0;t=this._paintRect||(this._paintRect=new Ve(0,0,0,0)),e?Ve.applyTransform(t,n,e):t.copy(n),(r||o||a)&&(t.width+=2*r+Math.abs(o),t.height+=2*r+Math.abs(a),t.x=Math.min(t.x,t.x+o-r),t.y=Math.min(t.y,t.y+a-r));var s=this.dirtyRectTolerance;t.isZero()||(t.x=Math.floor(t.x-s),t.y=Math.floor(t.y-s),t.width=Math.ceil(t.width+1+2*s),t.height=Math.ceil(t.height+1+2*s))}return t},e.prototype.setPrevPaintRect=function(t){t?(this._prevPaintRect=this._prevPaintRect||new Ve(0,0,0,0),this._prevPaintRect.copy(t)):this._prevPaintRect=null},e.prototype.getPrevPaintRect=function(){return this._prevPaintRect},e.prototype.animateStyle=function(t){return this.animate("style",t)},e.prototype.updateDuringAnimation=function(t){"style"===t?this.dirtyStyle():this.markRedraw()},e.prototype.attrKV=function(e,n){"style"!==e?t.prototype.attrKV.call(this,e,n):this.style?this.setStyle(n):this.useStyle(n)},e.prototype.setStyle=function(t,e){return"string"==typeof t?this.style[t]=e:D(this.style,t),this.dirtyStyle(),this},e.prototype.dirtyStyle=function(t){t||this.markRedraw(),this.__dirty|=2,this._rect&&(this._rect=null)},e.prototype.dirty=function(){this.dirtyStyle()},e.prototype.styleChanged=function(){return!!(2&this.__dirty)},e.prototype.styleUpdated=function(){this.__dirty&=-3},e.prototype.createStyle=function(t){return mt(Wa,t)},e.prototype.useStyle=function(t){t[Ha]||(t=this.createStyle(t)),this.__inHover?this.__hoverStyle=t:this.style=t,this.dirtyStyle()},e.prototype.isStyleObject=function(t){return t[Ha]},e.prototype._innerSaveToNormal=function(e){t.prototype._innerSaveToNormal.call(this,e);var n=this._normalState;e.style&&!n.style&&(n.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(e,n,Ua)},e.prototype._applyStateObj=function(e,n,i,r,o,a){t.prototype._applyStateObj.call(this,e,n,i,r,o,a);var s,l=!(n&&r);if(n&&n.style?o?r?s=n.style:(s=this._mergeStyle(this.createStyle(),i.style),this._mergeStyle(s,n.style)):(s=this._mergeStyle(this.createStyle(),r?this.style:i.style),this._mergeStyle(s,n.style)):l&&(s=i.style),s)if(o){var u=this.style;if(this.style=this.createStyle(l?{}:u),l)for(var h=H(u),c=0;c<h.length;c++){(d=h[c])in s&&(s[d]=s[d],this.style[d]=u[d])}var p=H(s);for(c=0;c<p.length;c++){var d=p[c];this.style[d]=this.style[d]}this._transitionState(e,{style:s},a,this.getAnimationStyleProps())}else this.useStyle(s);var f=this.__inHover?Za:Ua;for(c=0;c<f.length;c++){d=f[c];n&&null!=n[d]?this[d]=n[d]:l&&null!=i[d]&&(this[d]=i[d])}},e.prototype._mergeStates=function(e){for(var n,i=t.prototype._mergeStates.call(this,e),r=0;r<e.length;r++){var o=e[r];o.style&&(n=n||{},this._mergeStyle(n,o.style))}return n&&(i.style=n),i},e.prototype._mergeStyle=function(t,e){return D(t,e),t},e.prototype.getAnimationStyleProps=function(){return Ga},e.initDefaultProps=((i=e.prototype).type="displayable",i.invisible=!1,i.z=0,i.z2=0,i.zlevel=0,i.culling=!1,i.cursor="pointer",i.rectHover=!1,i.incremental=!1,i._rect=null,i.dirtyRectTolerance=0,void(i.__dirty=3)),e}(Gr),Xa=new Ve(0,0,0,0),ja=new Ve(0,0,0,0);var qa=Math.min,Ka=Math.max,$a=Math.sin,Qa=Math.cos,Ja=2*Math.PI,ts=Tt(),es=Tt(),ns=Tt();function is(t,e,n,i,r,o){r[0]=qa(t,n),r[1]=qa(e,i),o[0]=Ka(t,n),o[1]=Ka(e,i)}var rs=[],os=[];function as(t,e,n,i,r,o,a,s,l,u){var h=Cn,c=Mn,p=h(t,n,r,a,rs);l[0]=1/0,l[1]=1/0,u[0]=-1/0,u[1]=-1/0;for(var d=0;d<p;d++){var f=c(t,n,r,a,rs[d]);l[0]=qa(f,l[0]),u[0]=Ka(f,u[0])}p=h(e,i,o,s,os);for(d=0;d<p;d++){var g=c(e,i,o,s,os[d]);l[1]=qa(g,l[1]),u[1]=Ka(g,u[1])}l[0]=qa(t,l[0]),u[0]=Ka(t,u[0]),l[0]=qa(a,l[0]),u[0]=Ka(a,u[0]),l[1]=qa(e,l[1]),u[1]=Ka(e,u[1]),l[1]=qa(s,l[1]),u[1]=Ka(s,u[1])}function ss(t,e,n,i,r,o,a,s){var l=Ln,u=An,h=Ka(qa(l(t,n,r),1),0),c=Ka(qa(l(e,i,o),1),0),p=u(t,n,r,h),d=u(e,i,o,c);a[0]=qa(t,r,p),a[1]=qa(e,o,d),s[0]=Ka(t,r,p),s[1]=Ka(e,o,d)}function ls(t,e,n,i,r,o,a,s,l){var u=Ht,h=Wt,c=Math.abs(r-o);if(c%Ja<1e-4&&c>1e-4)return s[0]=t-n,s[1]=e-i,l[0]=t+n,void(l[1]=e+i);if(ts[0]=Qa(r)*n+t,ts[1]=$a(r)*i+e,es[0]=Qa(o)*n+t,es[1]=$a(o)*i+e,u(s,ts,es),h(l,ts,es),(r%=Ja)<0&&(r+=Ja),(o%=Ja)<0&&(o+=Ja),r>o&&!a?o+=Ja:r<o&&a&&(r+=Ja),a){var p=o;o=r,r=p}for(var d=0;d<o;d+=Math.PI/2)d>r&&(ns[0]=Qa(d)*n+t,ns[1]=$a(d)*i+e,u(s,ns,s),h(l,ns,l))}var us={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},hs=[],cs=[],ps=[],ds=[],fs=[],gs=[],vs=Math.min,ys=Math.max,ms=Math.cos,_s=Math.sin,xs=Math.abs,bs=Math.PI,ws=2*bs,Ss="undefined"!=typeof Float32Array,Ms=[];function Ts(t){return Math.round(t/bs*1e8)/1e8%2*bs}function ks(t,e){var n=Ts(t[0]);n<0&&(n+=ws);var i=n-t[0],r=t[1];r+=i,!e&&r-n>=ws?r=n+ws:e&&n-r>=ws?r=n-ws:!e&&n>r?r=n+(ws-Ts(n-r)):e&&n<r&&(r=n-(ws-Ts(r-n))),t[0]=n,t[1]=r}var Cs=function(){function t(t){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,t&&(this._saveData=!1),this._saveData&&(this.data=[])}var e;return t.prototype.increaseVersion=function(){this._version++},t.prototype.getVersion=function(){return this._version},t.prototype.setScale=function(t,e,n){(n=n||0)>0&&(this._ux=xs(n/cr/t)||0,this._uy=xs(n/cr/e)||0)},t.prototype.setDPR=function(t){this.dpr=t},t.prototype.setContext=function(t){this._ctx=t},t.prototype.getContext=function(){return this._ctx},t.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},t.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},t.prototype.moveTo=function(t,e){return this._drawPendingPt(),this.addData(us.M,t,e),this._ctx&&this._ctx.moveTo(t,e),this._x0=t,this._y0=e,this._xi=t,this._yi=e,this},t.prototype.lineTo=function(t,e){var n=xs(t-this._xi),i=xs(e-this._yi),r=n>this._ux||i>this._uy;if(this.addData(us.L,t,e),this._ctx&&r&&this._ctx.lineTo(t,e),r)this._xi=t,this._yi=e,this._pendingPtDist=0;else{var o=n*n+i*i;o>this._pendingPtDist&&(this._pendingPtX=t,this._pendingPtY=e,this._pendingPtDist=o)}return this},t.prototype.bezierCurveTo=function(t,e,n,i,r,o){return this._drawPendingPt(),this.addData(us.C,t,e,n,i,r,o),this._ctx&&this._ctx.bezierCurveTo(t,e,n,i,r,o),this._xi=r,this._yi=o,this},t.prototype.quadraticCurveTo=function(t,e,n,i){return this._drawPendingPt(),this.addData(us.Q,t,e,n,i),this._ctx&&this._ctx.quadraticCurveTo(t,e,n,i),this._xi=n,this._yi=i,this},t.prototype.arc=function(t,e,n,i,r,o){this._drawPendingPt(),Ms[0]=i,Ms[1]=r,ks(Ms,o),i=Ms[0];var a=(r=Ms[1])-i;return this.addData(us.A,t,e,n,n,i,a,0,o?0:1),this._ctx&&this._ctx.arc(t,e,n,i,r,o),this._xi=ms(r)*n+t,this._yi=_s(r)*n+e,this},t.prototype.arcTo=function(t,e,n,i,r){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(t,e,n,i,r),this},t.prototype.rect=function(t,e,n,i){return this._drawPendingPt(),this._ctx&&this._ctx.rect(t,e,n,i),this.addData(us.R,t,e,n,i),this},t.prototype.closePath=function(){this._drawPendingPt(),this.addData(us.Z);var t=this._ctx,e=this._x0,n=this._y0;return t&&t.closePath(),this._xi=e,this._yi=n,this},t.prototype.fill=function(t){t&&t.fill(),this.toStatic()},t.prototype.stroke=function(t){t&&t.stroke(),this.toStatic()},t.prototype.len=function(){return this._len},t.prototype.setData=function(t){if(this._saveData){var e=t.length;this.data&&this.data.length===e||!Ss||(this.data=new Float32Array(e));for(var n=0;n<e;n++)this.data[n]=t[n];this._len=e}},t.prototype.appendPath=function(t){if(this._saveData){t instanceof Array||(t=[t]);for(var e=t.length,n=0,i=this._len,r=0;r<e;r++)n+=t[r].len();var o=this.data;if(Ss&&(o instanceof Float32Array||!o)&&(this.data=new Float32Array(i+n),i>0&&o))for(var a=0;a<i;a++)this.data[a]=o[a];for(r=0;r<e;r++){var s=t[r].data;for(a=0;a<s.length;a++)this.data[i++]=s[a]}this._len=i}},t.prototype.addData=function(t,e,n,i,r,o,a,s,l){if(this._saveData){var u=this.data;this._len+arguments.length>u.length&&(this._expandData(),u=this.data);for(var h=0;h<arguments.length;h++)u[this._len++]=arguments[h]}},t.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},t.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this._len;e++)t[e]=this.data[e];this.data=t}},t.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var t=this.data;t instanceof Array&&(t.length=this._len,Ss&&this._len>11&&(this.data=new Float32Array(t)))}},t.prototype.getBoundingRect=function(){ps[0]=ps[1]=fs[0]=fs[1]=Number.MAX_VALUE,ds[0]=ds[1]=gs[0]=gs[1]=-Number.MAX_VALUE;var t,e=this.data,n=0,i=0,r=0,o=0;for(t=0;t<this._len;){var a=e[t++],s=1===t;switch(s&&(r=n=e[t],o=i=e[t+1]),a){case us.M:n=r=e[t++],i=o=e[t++],fs[0]=r,fs[1]=o,gs[0]=r,gs[1]=o;break;case us.L:is(n,i,e[t],e[t+1],fs,gs),n=e[t++],i=e[t++];break;case us.C:as(n,i,e[t++],e[t++],e[t++],e[t++],e[t],e[t+1],fs,gs),n=e[t++],i=e[t++];break;case us.Q:ss(n,i,e[t++],e[t++],e[t],e[t+1],fs,gs),n=e[t++],i=e[t++];break;case us.A:var l=e[t++],u=e[t++],h=e[t++],c=e[t++],p=e[t++],d=e[t++]+p;t+=1;var f=!e[t++];s&&(r=ms(p)*h+l,o=_s(p)*c+u),ls(l,u,h,c,p,d,f,fs,gs),n=ms(d)*h+l,i=_s(d)*c+u;break;case us.R:is(r=n=e[t++],o=i=e[t++],r+e[t++],o+e[t++],fs,gs);break;case us.Z:n=r,i=o}Ht(ps,ps,fs),Wt(ds,ds,gs)}return 0===t&&(ps[0]=ps[1]=ds[0]=ds[1]=0),new Ve(ps[0],ps[1],ds[0]-ps[0],ds[1]-ps[1])},t.prototype._calculateLength=function(){var t=this.data,e=this._len,n=this._ux,i=this._uy,r=0,o=0,a=0,s=0;this._pathSegLen||(this._pathSegLen=[]);for(var l=this._pathSegLen,u=0,h=0,c=0;c<e;){var p=t[c++],d=1===c;d&&(a=r=t[c],s=o=t[c+1]);var f=-1;switch(p){case us.M:r=a=t[c++],o=s=t[c++];break;case us.L:var g=t[c++],v=(_=t[c++])-o;(xs(D=g-r)>n||xs(v)>i||c===e-1)&&(f=Math.sqrt(D*D+v*v),r=g,o=_);break;case us.C:var y=t[c++],m=t[c++],_=(g=t[c++],t[c++]),x=t[c++],b=t[c++];f=Dn(r,o,y,m,g,_,x,b,10),r=x,o=b;break;case us.Q:f=Rn(r,o,y=t[c++],m=t[c++],g=t[c++],_=t[c++],10),r=g,o=_;break;case us.A:var w=t[c++],S=t[c++],M=t[c++],T=t[c++],k=t[c++],C=t[c++],I=C+k;c+=1,d&&(a=ms(k)*M+w,s=_s(k)*T+S),f=ys(M,T)*vs(ws,Math.abs(C)),r=ms(I)*M+w,o=_s(I)*T+S;break;case us.R:a=r=t[c++],s=o=t[c++],f=2*t[c++]+2*t[c++];break;case us.Z:var D=a-r;v=s-o;f=Math.sqrt(D*D+v*v),r=a,o=s}f>=0&&(l[h++]=f,u+=f)}return this._pathLen=u,u},t.prototype.rebuildPath=function(t,e){var n,i,r,o,a,s,l,u,h,c,p=this.data,d=this._ux,f=this._uy,g=this._len,v=e<1,y=0,m=0,_=0;if(!v||(this._pathSegLen||this._calculateLength(),l=this._pathSegLen,u=e*this._pathLen))t:for(var x=0;x<g;){var b=p[x++],w=1===x;switch(w&&(n=r=p[x],i=o=p[x+1]),b!==us.L&&_>0&&(t.lineTo(h,c),_=0),b){case us.M:n=r=p[x++],i=o=p[x++],t.moveTo(r,o);break;case us.L:a=p[x++],s=p[x++];var S=xs(a-r),M=xs(s-o);if(S>d||M>f){if(v){if(y+(j=l[m++])>u){var T=(u-y)/j;t.lineTo(r*(1-T)+a*T,o*(1-T)+s*T);break t}y+=j}t.lineTo(a,s),r=a,o=s,_=0}else{var k=S*S+M*M;k>_&&(h=a,c=s,_=k)}break;case us.C:var C=p[x++],I=p[x++],D=p[x++],A=p[x++],P=p[x++],L=p[x++];if(v){if(y+(j=l[m++])>u){In(r,C,D,P,T=(u-y)/j,hs),In(o,I,A,L,T,cs),t.bezierCurveTo(hs[1],cs[1],hs[2],cs[2],hs[3],cs[3]);break t}y+=j}t.bezierCurveTo(C,I,D,A,P,L),r=P,o=L;break;case us.Q:C=p[x++],I=p[x++],D=p[x++],A=p[x++];if(v){if(y+(j=l[m++])>u){On(r,C,D,T=(u-y)/j,hs),On(o,I,A,T,cs),t.quadraticCurveTo(hs[1],cs[1],hs[2],cs[2]);break t}y+=j}t.quadraticCurveTo(C,I,D,A),r=D,o=A;break;case us.A:var O=p[x++],R=p[x++],N=p[x++],B=p[x++],z=p[x++],E=p[x++],V=p[x++],F=!p[x++],H=N>B?N:B,W=xs(N-B)>.001,G=z+E,U=!1;if(v)y+(j=l[m++])>u&&(G=z+E*(u-y)/j,U=!0),y+=j;if(W&&t.ellipse?t.ellipse(O,R,N,B,V,z,G,F):t.arc(O,R,H,z,G,F),U)break t;w&&(n=ms(z)*N+O,i=_s(z)*B+R),r=ms(G)*N+O,o=_s(G)*B+R;break;case us.R:n=r=p[x],i=o=p[x+1],a=p[x++],s=p[x++];var Z=p[x++],Y=p[x++];if(v){if(y+(j=l[m++])>u){var X=u-y;t.moveTo(a,s),t.lineTo(a+vs(X,Z),s),(X-=Z)>0&&t.lineTo(a+Z,s+vs(X,Y)),(X-=Y)>0&&t.lineTo(a+ys(Z-X,0),s+Y),(X-=Z)>0&&t.lineTo(a,s+ys(Y-X,0));break t}y+=j}t.rect(a,s,Z,Y);break;case us.Z:if(v){var j;if(y+(j=l[m++])>u){T=(u-y)/j;t.lineTo(r*(1-T)+n*T,o*(1-T)+i*T);break t}y+=j}t.closePath(),r=n,o=i}}},t.prototype.clone=function(){var e=new t,n=this.data;return e.data=n.slice?n.slice():Array.prototype.slice.call(n),e._len=this._len,e},t.prototype.canSave=function(){return!!this._saveData},t.CMD=us,t.initDefaultProps=((e=t.prototype)._saveData=!0,e._ux=0,e._uy=0,e._pendingPtDist=0,void(e._version=0)),t}();function Is(t,e,n,i,r,o,a){if(0===r)return!1;var s=r,l=0;if(a>e+s&&a>i+s||a<e-s&&a<i-s||o>t+s&&o>n+s||o<t-s&&o<n-s)return!1;if(t===n)return Math.abs(o-t)<=s/2;var u=(l=(e-i)/(t-n))*o-a+(t*i-n*e)/(t-n);return u*u/(l*l+1)<=s/2*s/2}function Ds(t,e,n,i,r,o,a,s,l,u,h){if(0===l)return!1;var c=l;if(h>e+c&&h>i+c&&h>o+c&&h>s+c||h<e-c&&h<i-c&&h<o-c&&h<s-c||u>t+c&&u>n+c&&u>r+c&&u>a+c||u<t-c&&u<n-c&&u<r-c&&u<a-c)return!1;var p=function(t,e,n,i,r,o,a,s,l,u,h){var c,p,d,f,g,v=.005,y=1/0;_n[0]=l,_n[1]=u;for(var m=0;m<1;m+=.05)xn[0]=Mn(t,n,r,a,m),xn[1]=Mn(e,i,o,s,m),(f=Et(_n,xn))<y&&(c=m,y=f);y=1/0;for(var _=0;_<32&&!(v<vn);_++)p=c-v,d=c+v,xn[0]=Mn(t,n,r,a,p),xn[1]=Mn(e,i,o,s,p),f=Et(xn,_n),p>=0&&f<y?(c=p,y=f):(bn[0]=Mn(t,n,r,a,d),bn[1]=Mn(e,i,o,s,d),g=Et(bn,_n),d<=1&&g<y?(c=d,y=g):v*=.5);return h&&(h[0]=Mn(t,n,r,a,c),h[1]=Mn(e,i,o,s,c)),fn(y)}(t,e,n,i,r,o,a,s,u,h,null);return p<=c/2}function As(t,e,n,i,r,o,a,s,l){if(0===a)return!1;var u=a;if(l>e+u&&l>i+u&&l>o+u||l<e-u&&l<i-u&&l<o-u||s>t+u&&s>n+u&&s>r+u||s<t-u&&s<n-u&&s<r-u)return!1;var h=function(t,e,n,i,r,o,a,s,l){var u,h=.005,c=1/0;_n[0]=a,_n[1]=s;for(var p=0;p<1;p+=.05)xn[0]=An(t,n,r,p),xn[1]=An(e,i,o,p),(v=Et(_n,xn))<c&&(u=p,c=v);c=1/0;for(var d=0;d<32&&!(h<vn);d++){var f=u-h,g=u+h;xn[0]=An(t,n,r,f),xn[1]=An(e,i,o,f);var v=Et(xn,_n);if(f>=0&&v<c)u=f,c=v;else{bn[0]=An(t,n,r,g),bn[1]=An(e,i,o,g);var y=Et(bn,_n);g<=1&&y<c?(u=g,c=y):h*=.5}}return l&&(l[0]=An(t,n,r,u),l[1]=An(e,i,o,u)),fn(c)}(t,e,n,i,r,o,s,l,null);return h<=u/2}var Ps=2*Math.PI;function Ls(t){return(t%=Ps)<0&&(t+=Ps),t}var Os=2*Math.PI;function Rs(t,e,n,i,r,o,a,s,l){if(0===a)return!1;var u=a;s-=t,l-=e;var h=Math.sqrt(s*s+l*l);if(h-u>n||h+u<n)return!1;if(Math.abs(i-r)%Os<1e-4)return!0;if(o){var c=i;i=Ls(r),r=Ls(c)}else i=Ls(i),r=Ls(r);i>r&&(r+=Os);var p=Math.atan2(l,s);return p<0&&(p+=Os),p>=i&&p<=r||p+Os>=i&&p+Os<=r}function Ns(t,e,n,i,r,o){if(o>e&&o>i||o<e&&o<i)return 0;if(i===e)return 0;var a=(o-e)/(i-e),s=i<e?1:-1;1!==a&&0!==a||(s=i<e?.5:-.5);var l=a*(n-t)+t;return l===r?1/0:l>r?s:0}var Bs=Cs.CMD,zs=2*Math.PI;var Es=[-1,-1,-1],Vs=[-1,-1];function Fs(t,e,n,i,r,o,a,s,l,u){if(u>e&&u>i&&u>o&&u>s||u<e&&u<i&&u<o&&u<s)return 0;var h,c=kn(e,i,o,s,u,Es);if(0===c)return 0;for(var p=0,d=-1,f=void 0,g=void 0,v=0;v<c;v++){var y=Es[v],m=0===y||1===y?.5:1;Mn(t,n,r,a,y)<l||(d<0&&(d=Cn(e,i,o,s,Vs),Vs[1]<Vs[0]&&d>1&&(h=void 0,h=Vs[0],Vs[0]=Vs[1],Vs[1]=h),f=Mn(e,i,o,s,Vs[0]),d>1&&(g=Mn(e,i,o,s,Vs[1]))),2===d?y<Vs[0]?p+=f<e?m:-m:y<Vs[1]?p+=g<f?m:-m:p+=s<g?m:-m:y<Vs[0]?p+=f<e?m:-m:p+=s<f?m:-m)}return p}function Hs(t,e,n,i,r,o,a,s){if(s>e&&s>i&&s>o||s<e&&s<i&&s<o)return 0;var l=function(t,e,n,i,r){var o=t-2*e+n,a=2*(e-t),s=t-i,l=0;if(wn(o))Sn(a)&&(h=-s/a)>=0&&h<=1&&(r[l++]=h);else{var u=a*a-4*o*s;if(wn(u))(h=-a/(2*o))>=0&&h<=1&&(r[l++]=h);else if(u>0){var h,c=fn(u),p=(-a-c)/(2*o);(h=(-a+c)/(2*o))>=0&&h<=1&&(r[l++]=h),p>=0&&p<=1&&(r[l++]=p)}}return l}(e,i,o,s,Es);if(0===l)return 0;var u=Ln(e,i,o);if(u>=0&&u<=1){for(var h=0,c=An(e,i,o,u),p=0;p<l;p++){var d=0===Es[p]||1===Es[p]?.5:1;An(t,n,r,Es[p])<a||(Es[p]<u?h+=c<e?d:-d:h+=o<c?d:-d)}return h}d=0===Es[0]||1===Es[0]?.5:1;return An(t,n,r,Es[0])<a?0:o<e?d:-d}function Ws(t,e,n,i,r,o,a,s){if((s-=e)>n||s<-n)return 0;var l=Math.sqrt(n*n-s*s);Es[0]=-l,Es[1]=l;var u=Math.abs(i-r);if(u<1e-4)return 0;if(u>=zs-1e-4){i=0,r=zs;var h=o?1:-1;return a>=Es[0]+t&&a<=Es[1]+t?h:0}if(i>r){var c=i;i=r,r=c}i<0&&(i+=zs,r+=zs);for(var p=0,d=0;d<2;d++){var f=Es[d];if(f+t>a){var g=Math.atan2(s,f);h=o?1:-1;g<0&&(g=zs+g),(g>=i&&g<=r||g+zs>=i&&g+zs<=r)&&(g>Math.PI/2&&g<1.5*Math.PI&&(h=-h),p+=h)}}return p}function Gs(t,e,n,i,r){for(var o,a,s,l,u=t.data,h=t.len(),c=0,p=0,d=0,f=0,g=0,v=0;v<h;){var y=u[v++],m=1===v;switch(y===Bs.M&&v>1&&(n||(c+=Ns(p,d,f,g,i,r))),m&&(f=p=u[v],g=d=u[v+1]),y){case Bs.M:p=f=u[v++],d=g=u[v++];break;case Bs.L:if(n){if(Is(p,d,u[v],u[v+1],e,i,r))return!0}else c+=Ns(p,d,u[v],u[v+1],i,r)||0;p=u[v++],d=u[v++];break;case Bs.C:if(n){if(Ds(p,d,u[v++],u[v++],u[v++],u[v++],u[v],u[v+1],e,i,r))return!0}else c+=Fs(p,d,u[v++],u[v++],u[v++],u[v++],u[v],u[v+1],i,r)||0;p=u[v++],d=u[v++];break;case Bs.Q:if(n){if(As(p,d,u[v++],u[v++],u[v],u[v+1],e,i,r))return!0}else c+=Hs(p,d,u[v++],u[v++],u[v],u[v+1],i,r)||0;p=u[v++],d=u[v++];break;case Bs.A:var _=u[v++],x=u[v++],b=u[v++],w=u[v++],S=u[v++],M=u[v++];v+=1;var T=!!(1-u[v++]);o=Math.cos(S)*b+_,a=Math.sin(S)*w+x,m?(f=o,g=a):c+=Ns(p,d,o,a,i,r);var k=(i-_)*w/b+_;if(n){if(Rs(_,x,w,S,S+M,T,e,k,r))return!0}else c+=Ws(_,x,w,S,S+M,T,k,r);p=Math.cos(S+M)*b+_,d=Math.sin(S+M)*w+x;break;case Bs.R:if(f=p=u[v++],g=d=u[v++],o=f+u[v++],a=g+u[v++],n){if(Is(f,g,o,g,e,i,r)||Is(o,g,o,a,e,i,r)||Is(o,a,f,a,e,i,r)||Is(f,a,f,g,e,i,r))return!0}else c+=Ns(o,g,o,a,i,r),c+=Ns(f,a,f,g,i,r);break;case Bs.Z:if(n){if(Is(p,d,f,g,e,i,r))return!0}else c+=Ns(p,d,f,g,i,r);p=f,d=g}}return n||(s=d,l=g,Math.abs(s-l)<1e-4)||(c+=Ns(p,d,f,g,i,r)||0),0!==c}var Us=A({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},Wa),Zs={style:A({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},Ga.style)},Ys=Sr.concat(["invisible","culling","z","z2","zlevel","parent"]),Xs=function(t){function e(e){return t.call(this,e)||this}var i;return n(e,t),e.prototype.update=function(){var n=this;t.prototype.update.call(this);var i=this.style;if(i.decal){var r=this._decalEl=this._decalEl||new e;r.buildPath===e.prototype.buildPath&&(r.buildPath=function(t){n.buildPath(t,n.shape)}),r.silent=!0;var o=r.style;for(var a in i)o[a]!==i[a]&&(o[a]=i[a]);o.fill=i.fill?i.decal:null,o.decal=null,o.shadowColor=null,i.strokeFirst&&(o.stroke=null);for(var s=0;s<Ys.length;++s)r[Ys[s]]=this[Ys[s]];r.__dirty|=1}else this._decalEl&&(this._decalEl=null)},e.prototype.getDecalElement=function(){return this._decalEl},e.prototype._init=function(e){var n=H(e);this.shape=this.getDefaultShape();var i=this.getDefaultStyle();i&&this.useStyle(i);for(var r=0;r<n.length;r++){var o=n[r],a=e[o];"style"===o?this.style?D(this.style,a):this.useStyle(a):"shape"===o?D(this.shape,a):t.prototype.attrKV.call(this,o,a)}this.style||this.useStyle({})},e.prototype.getDefaultStyle=function(){return null},e.prototype.getDefaultShape=function(){return{}},e.prototype.canBeInsideText=function(){return this.hasFill()},e.prototype.getInsideTextFill=function(){var t=this.style.fill;if("none"!==t){if(Y(t)){var e=ui(t,0);return e>.5?pr:e>.2?"#eee":dr}if(t)return dr}return pr},e.prototype.getInsideTextStroke=function(t){var e=this.style.fill;if(Y(e)){var n=this.__zr;if(!(!n||!n.isDarkMode())===ui(t,0)<.4)return e}},e.prototype.buildPath=function(t,e,n){},e.prototype.pathUpdated=function(){this.__dirty&=-5},e.prototype.getUpdatedPathProxy=function(t){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,t),this.path},e.prototype.createPathProxy=function(){this.path=new Cs(!1)},e.prototype.hasStroke=function(){var t=this.style,e=t.stroke;return!(null==e||"none"===e||!(t.lineWidth>0))},e.prototype.hasFill=function(){var t=this.style.fill;return null!=t&&"none"!==t},e.prototype.getBoundingRect=function(){var t=this._rect,e=this.style,n=!t;if(n){var i=!1;this.path||(i=!0,this.createPathProxy());var r=this.path;(i||4&this.__dirty)&&(r.beginPath(),this.buildPath(r,this.shape,!1),this.pathUpdated()),t=r.getBoundingRect()}if(this._rect=t,this.hasStroke()&&this.path&&this.path.len()>0){var o=this._rectStroke||(this._rectStroke=t.clone());if(this.__dirty||n){o.copy(t);var a=e.strokeNoScale?this.getLineScale():1,s=e.lineWidth;if(!this.hasFill()){var l=this.strokeContainThreshold;s=Math.max(s,null==l?4:l)}a>1e-10&&(o.width+=s/a,o.height+=s/a,o.x-=s/a/2,o.y-=s/a/2)}return o}return t},e.prototype.contain=function(t,e){var n=this.transformCoordToLocal(t,e),i=this.getBoundingRect(),r=this.style;if(t=n[0],e=n[1],i.contain(t,e)){var o=this.path;if(this.hasStroke()){var a=r.lineWidth,s=r.strokeNoScale?this.getLineScale():1;if(s>1e-10&&(this.hasFill()||(a=Math.max(a,this.strokeContainThreshold)),function(t,e,n,i){return Gs(t,e,!0,n,i)}(o,a/s,t,e)))return!0}if(this.hasFill())return function(t,e,n){return Gs(t,0,!1,e,n)}(o,t,e)}return!1},e.prototype.dirtyShape=function(){this.__dirty|=4,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},e.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},e.prototype.animateShape=function(t){return this.animate("shape",t)},e.prototype.updateDuringAnimation=function(t){"style"===t?this.dirtyStyle():"shape"===t?this.dirtyShape():this.markRedraw()},e.prototype.attrKV=function(e,n){"shape"===e?this.setShape(n):t.prototype.attrKV.call(this,e,n)},e.prototype.setShape=function(t,e){var n=this.shape;return n||(n=this.shape={}),"string"==typeof t?n[t]=e:D(n,t),this.dirtyShape(),this},e.prototype.shapeChanged=function(){return!!(4&this.__dirty)},e.prototype.createStyle=function(t){return mt(Us,t)},e.prototype._innerSaveToNormal=function(e){t.prototype._innerSaveToNormal.call(this,e);var n=this._normalState;e.shape&&!n.shape&&(n.shape=D({},this.shape))},e.prototype._applyStateObj=function(e,n,i,r,o,a){t.prototype._applyStateObj.call(this,e,n,i,r,o,a);var s,l=!(n&&r);if(n&&n.shape?o?r?s=n.shape:(s=D({},i.shape),D(s,n.shape)):(s=D({},r?this.shape:i.shape),D(s,n.shape)):l&&(s=i.shape),s)if(o){this.shape=D({},this.shape);for(var u={},h=H(s),c=0;c<h.length;c++){var p=h[c];"object"==typeof s[p]?this.shape[p]=s[p]:u[p]=s[p]}this._transitionState(e,{shape:u},a)}else this.shape=s,this.dirtyShape()},e.prototype._mergeStates=function(e){for(var n,i=t.prototype._mergeStates.call(this,e),r=0;r<e.length;r++){var o=e[r];o.shape&&(n=n||{},this._mergeStyle(n,o.shape))}return n&&(i.shape=n),i},e.prototype.getAnimationStyleProps=function(){return Zs},e.prototype.isZeroArea=function(){return!1},e.extend=function(t){var i=function(e){function i(n){var i=e.call(this,n)||this;return t.init&&t.init.call(i,n),i}return n(i,e),i.prototype.getDefaultStyle=function(){return k(t.style)},i.prototype.getDefaultShape=function(){return k(t.shape)},i}(e);for(var r in t)"function"==typeof t[r]&&(i.prototype[r]=t[r]);return i},e.initDefaultProps=((i=e.prototype).type="path",i.strokeContainThreshold=5,i.segmentIgnoreThreshold=0,i.subPixelOptimize=!1,i.autoBatch=!1,void(i.__dirty=7)),e}(Ya),js=A({strokeFirst:!0,font:a,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},Us),qs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.hasStroke=function(){return Fa(this.style)},e.prototype.hasFill=function(){var t=this.style.fill;return null!=t&&"none"!==t},e.prototype.createStyle=function(t){return mt(js,t)},e.prototype.setBoundingRect=function(t){this._rect=t},e.prototype.getBoundingRect=function(){var t,e,n;return this._rect||(this._rect=(t=this.style,e=Ea(t.text),n=t.font,Va(t,Dr(Tr(n),e),Rr(n),null))),this._rect},e.initDefaultProps=void(e.prototype.dirtyRectTolerance=10),e}(Ya);qs.prototype.type="tspan";var Ks=A({x:0,y:0},Wa),$s={style:A({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},Ga.style)};var Qs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.createStyle=function(t){return mt(Ks,t)},e.prototype._getSize=function(t){var e=this.style,n=e[t];if(null!=n)return n;var i,r=(i=e.image)&&"string"!=typeof i&&i.width&&i.height?e.image:this.__image;if(!r)return 0;var o="width"===t?"height":"width",a=e[o];return null==a?r[t]:r[t]/r[o]*a},e.prototype.getWidth=function(){return this._getSize("width")},e.prototype.getHeight=function(){return this._getSize("height")},e.prototype.getAnimationStyleProps=function(){return $s},e.prototype.getBoundingRect=function(){var t=this.style;return this._rect||(this._rect=new Ve(t.x||0,t.y||0,this.getWidth(),this.getHeight())),this._rect},e}(Ya);Qs.prototype.type="image";var Js=Math.round;function tl(t,e,n){if(e){var i=e.x1,r=e.x2,o=e.y1,a=e.y2;t.x1=i,t.x2=r,t.y1=o,t.y2=a;var s=n&&n.lineWidth;return s?(Js(2*i)===Js(2*r)&&(t.x1=t.x2=nl(i,s,!0)),Js(2*o)===Js(2*a)&&(t.y1=t.y2=nl(o,s,!0)),t):t}}function el(t,e,n){if(e){var i=e.x,r=e.y,o=e.width,a=e.height;t.x=i,t.y=r,t.width=o,t.height=a;var s=n&&n.lineWidth;return s?(t.x=nl(i,s,!0),t.y=nl(r,s,!0),t.width=Math.max(nl(i+o,s,!1)-t.x,0===o?0:1),t.height=Math.max(nl(r+a,s,!1)-t.y,0===a?0:1),t):t}}function nl(t,e,n){if(!e)return t;var i=Js(2*t);return(i+Js(e))%2==0?i/2:(i+(n?1:-1))/2}var il=function(){this.x=0,this.y=0,this.width=0,this.height=0},rl={},ol=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultShape=function(){return new il},e.prototype.buildPath=function(t,e){var n,i,r,o;if(this.subPixelOptimize){var a=el(rl,e,this.style);n=a.x,i=a.y,r=a.width,o=a.height,a.r=e.r,e=a}else n=e.x,i=e.y,r=e.width,o=e.height;e.r?function(t,e){var n,i,r,o,a,s=e.x,l=e.y,u=e.width,h=e.height,c=e.r;u<0&&(s+=u,u=-u),h<0&&(l+=h,h=-h),"number"==typeof c?n=i=r=o=c:c instanceof Array?1===c.length?n=i=r=o=c[0]:2===c.length?(n=r=c[0],i=o=c[1]):3===c.length?(n=c[0],i=o=c[1],r=c[2]):(n=c[0],i=c[1],r=c[2],o=c[3]):n=i=r=o=0,n+i>u&&(n*=u/(a=n+i),i*=u/a),r+o>u&&(r*=u/(a=r+o),o*=u/a),i+r>h&&(i*=h/(a=i+r),r*=h/a),n+o>h&&(n*=h/(a=n+o),o*=h/a),t.moveTo(s+n,l),t.lineTo(s+u-i,l),0!==i&&t.arc(s+u-i,l+i,i,-Math.PI/2,0),t.lineTo(s+u,l+h-r),0!==r&&t.arc(s+u-r,l+h-r,r,0,Math.PI/2),t.lineTo(s+o,l+h),0!==o&&t.arc(s+o,l+h-o,o,Math.PI/2,Math.PI),t.lineTo(s,l+n),0!==n&&t.arc(s+n,l+n,n,Math.PI,1.5*Math.PI)}(t,e):t.rect(n,i,r,o)},e.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},e}(Xs);ol.prototype.type="rect";var al={fill:"#000"},sl={},ll={style:A({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},Ga.style)},ul=function(t){function e(e){var n=t.call(this)||this;return n.type="text",n._children=[],n._defaultStyle=al,n.attr(e),n}return n(e,t),e.prototype.childrenRef=function(){return this._children},e.prototype.update=function(){t.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var e=0;e<this._children.length;e++){var n=this._children[e];n.zlevel=this.zlevel,n.z=this.z,n.z2=this.z2,n.culling=this.culling,n.cursor=this.cursor,n.invisible=this.invisible}},e.prototype.updateTransform=function(){var e=this.innerTransformable;e?(e.updateTransform(),e.transform&&(this.transform=e.transform)):t.prototype.updateTransform.call(this)},e.prototype.getLocalTransform=function(e){var n=this.innerTransformable;return n?n.getLocalTransform(e):t.prototype.getLocalTransform.call(this,e)},e.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),t.prototype.getComputedTransform.call(this)},e.prototype._updateSubTexts=function(){var t;this._childCursor=0,vl(t=this.style),B(t.rich,vl),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},e.prototype.addSelfToZr=function(e){t.prototype.addSelfToZr.call(this,e);for(var n=0;n<this._children.length;n++)this._children[n].__zr=e},e.prototype.removeSelfFromZr=function(e){t.prototype.removeSelfFromZr.call(this,e);for(var n=0;n<this._children.length;n++)this._children[n].__zr=null},e.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var t=new Ve(0,0,0,0),e=this._children,n=[],i=null,r=0;r<e.length;r++){var o=e[r],a=o.getBoundingRect(),s=o.getLocalTransform(n);s?(t.copy(a),t.applyTransform(s),(i=i||t.clone()).union(t)):(i=i||a.clone()).union(a)}this._rect=i||t}return this._rect},e.prototype.setDefaultTextStyle=function(t){this._defaultStyle=t||al},e.prototype.setTextContent=function(t){0},e.prototype._mergeStyle=function(t,e){if(!e)return t;var n=e.rich,i=t.rich||n&&{};return D(t,e),n&&i?(this._mergeRich(i,n),t.rich=i):i&&(t.rich=i),t},e.prototype._mergeRich=function(t,e){for(var n=H(e),i=0;i<n.length;i++){var r=n[i];t[r]=t[r]||{},D(t[r],e[r])}},e.prototype.getAnimationStyleProps=function(){return ll},e.prototype._getOrCreateChild=function(t){var e=this._children[this._childCursor];return e&&e instanceof t||(e=new t),this._children[this._childCursor++]=e,e.__zr=this.__zr,e.parent=this,e},e.prototype._updatePlainTexts=function(){var t=this.style,e=t.font||a,n=t.padding,i=this._defaultStyle,r=t.x||0,o=t.y||0,s=t.align||i.align||"left",l=t.verticalAlign||i.verticalAlign||"top";Na(sl,i.overflowRect,r,o,s,l),r=sl.baseX,o=sl.baseY;var u=function(t,e,n,i){var r=Ea(t),o=e.overflow,a=e.padding,s=a?a[1]+a[3]:0,l=a?a[0]+a[2]:0,u=e.font,h="truncate"===o,c=Rr(u),p=rt(e.lineHeight,c),d="truncate"===e.lineOverflow,f=!1,g=e.width;null==g&&null!=n&&(g=n-s);var v,y=e.height;null==y&&null!=i&&(y=i-l);var m=(v=null==g||"break"!==o&&"breakAll"!==o?r?r.split("\n"):[]:r?Ra(r,e.font,g,"breakAll"===o,0).lines:[]).length*p;if(null==y&&(y=m),m>y&&d){var _=Math.floor(y/p);f=f||v.length>_,m=(v=v.slice(0,_)).length*p}if(r&&h&&null!=g)for(var x=Ta(g,u,e.ellipsis,{minChar:e.truncateMinChar,placeholder:e.placeholder}),b={},w=0;w<v.length;w++)ka(b,v[w],x),v[w]=b.textLine,f=f||b.isTruncated;var S=y,M=0,T=Tr(u);for(w=0;w<v.length;w++)M=Math.max(Dr(T,v[w]),M);null==g&&(g=M);var k=g;return{lines:v,height:y,outerWidth:k+=s,outerHeight:S+=l,lineHeight:p,calculatedLineHeight:c,contentWidth:M,contentHeight:m,width:g,isTruncated:f}}(xl(t),t,sl.outerWidth,sl.outerHeight),h=bl(t),c=!!t.backgroundColor,p=u.outerHeight,d=u.outerWidth,f=u.lines,g=u.lineHeight;this.isTruncated=!!u.isTruncated;var v=r,y=Or(o,u.contentHeight,l);if(h||n){var m=Lr(r,d,s),_=Or(o,p,l);h&&this._renderBackground(t,t,m,_,d,p)}y+=g/2,n&&(v=_l(r,s,n),"top"===l?y+=n[0]:"bottom"===l&&(y-=n[2]));for(var x=0,b=!1,w=!1,S=(ml("fill"in t?t.fill:(w=!0,i.fill))),M=(yl("stroke"in t?t.stroke:c||i.autoStroke&&!w?null:(x=2,b=!0,i.stroke))),T=t.textShadowBlur>0,k=0;k<f.length;k++){var C=this._getOrCreateChild(qs),I=C.createStyle();C.useStyle(I),I.text=f[k],I.x=v,I.y=y,s&&(I.textAlign=s),I.textBaseline="middle",I.opacity=t.opacity,I.strokeFirst=!0,T&&(I.shadowBlur=t.textShadowBlur||0,I.shadowColor=t.textShadowColor||"transparent",I.shadowOffsetX=t.textShadowOffsetX||0,I.shadowOffsetY=t.textShadowOffsetY||0),I.stroke=M,I.fill=S,M&&(I.lineWidth=t.lineWidth||x,I.lineDash=t.lineDash,I.lineDashOffset=t.lineDashOffset||0),I.font=e,fl(I,t),y+=g,C.setBoundingRect(Va(I,u.contentWidth,u.calculatedLineHeight,b?0:null))}},e.prototype._updateRichTexts=function(){var t=this.style,e=this._defaultStyle,n=t.align||e.align,i=t.verticalAlign||e.verticalAlign,r=t.x||0,o=t.y||0;Na(sl,e.overflowRect,r,o,n,i),r=sl.baseX,o=sl.baseY;var a=function(t,e,n,i,r){var o=new Aa,a=Ea(t);if(!a)return o;var s=e.padding,l=s?s[1]+s[3]:0,u=s?s[0]+s[2]:0,h=e.width;null==h&&null!=n&&(h=n-l);var c=e.height;null==c&&null!=i&&(c=i-u);for(var p,d=e.overflow,f="break"!==d&&"breakAll"!==d||null==h?null:{width:h,accumWidth:0,breakAll:"breakAll"===d},g=Sa.lastIndex=0;null!=(p=Sa.exec(a));){var v=p.index;v>g&&Pa(o,a.substring(g,v),e,f),Pa(o,p[2],e,f,p[1]),g=Sa.lastIndex}g<a.length&&Pa(o,a.substring(g,a.length),e,f);var y=[],m=0,_=0,x="truncate"===d,b="truncate"===e.lineOverflow,w={};function S(t,e,n){t.width=e,t.lineHeight=n,m+=n,_=Math.max(_,e)}t:for(var M=0;M<o.lines.length;M++){for(var T=o.lines[M],k=0,C=0,I=0;I<T.tokens.length;I++){var D=(F=T.tokens[I]).styleName&&e.rich[F.styleName]||{},A=F.textPadding=D.padding,P=A?A[1]+A[3]:0,L=F.font=D.font||e.font;F.contentHeight=Rr(L);var O=rt(D.height,F.contentHeight);if(F.innerHeight=O,A&&(O+=A[0]+A[2]),F.height=O,F.lineHeight=ot(D.lineHeight,e.lineHeight,O),F.align=D&&D.align||r,F.verticalAlign=D&&D.verticalAlign||"middle",b&&null!=c&&m+F.lineHeight>c){var R=o.lines.length;I>0?(T.tokens=T.tokens.slice(0,I),S(T,C,k),o.lines=o.lines.slice(0,M+1)):o.lines=o.lines.slice(0,M),o.isTruncated=o.isTruncated||o.lines.length<R;break t}var N=D.width,B=null==N||"auto"===N;if("string"==typeof N&&"%"===N.charAt(N.length-1))F.percentWidth=N,y.push(F),F.contentWidth=Dr(Tr(L),F.text);else{if(B){var z=D.backgroundColor,E=z&&z.image;E&&wa(E=_a(E))&&(F.width=Math.max(F.width,E.width*O/E.height))}var V=x&&null!=h?h-C:null;null!=V&&V<F.width?!B||V<P?(F.text="",F.width=F.contentWidth=0):(Ma(w,F.text,V-P,L,e.ellipsis,{minChar:e.truncateMinChar}),F.text=w.text,o.isTruncated=o.isTruncated||w.isTruncated,F.width=F.contentWidth=Dr(Tr(L),F.text)):F.contentWidth=Dr(Tr(L),F.text)}F.width+=P,C+=F.width,D&&(k=Math.max(k,F.lineHeight))}S(T,C,k)}for(o.outerWidth=o.width=rt(h,_),o.outerHeight=o.height=rt(c,m),o.contentHeight=m,o.contentWidth=_,o.outerWidth+=l,o.outerHeight+=u,M=0;M<y.length;M++){var F,H=(F=y[M]).percentWidth;F.width=parseInt(H,10)/100*o.width}return o}(xl(t),t,sl.outerWidth,sl.outerHeight,n),s=a.width,l=a.outerWidth,u=a.outerHeight,h=t.padding;this.isTruncated=!!a.isTruncated;var c=Lr(r,l,n),p=Or(o,u,i),d=c,f=p;h&&(d+=h[3],f+=h[0]);var g=d+s;bl(t)&&this._renderBackground(t,t,c,p,l,u);for(var v=!!t.backgroundColor,y=0;y<a.lines.length;y++){for(var m=a.lines[y],_=m.tokens,x=_.length,b=m.lineHeight,w=m.width,S=0,M=d,T=g,k=x-1,C=void 0;S<x&&(!(C=_[S]).align||"left"===C.align);)this._placeToken(C,t,b,f,M,"left",v),w-=C.width,M+=C.width,S++;for(;k>=0&&"right"===(C=_[k]).align;)this._placeToken(C,t,b,f,T,"right",v),w-=C.width,T-=C.width,k--;for(M+=(s-(M-d)-(g-T)-w)/2;S<=k;)C=_[S],this._placeToken(C,t,b,f,M+C.width/2,"center",v),M+=C.width,S++;f+=b}},e.prototype._placeToken=function(t,e,n,i,r,o,s){var l=e.rich[t.styleName]||{};l.text=t.text;var u=t.verticalAlign,h=i+n/2;"top"===u?h=i+t.height/2:"bottom"===u&&(h=i+n-t.height/2),!t.isLineHolder&&bl(l)&&this._renderBackground(l,e,"right"===o?r-t.width:"center"===o?r-t.width/2:r,h-t.height/2,t.width,t.height);var c=!!l.backgroundColor,p=t.textPadding;p&&(r=_l(r,o,p),h-=t.height/2-p[0]-t.innerHeight/2);var d=this._getOrCreateChild(qs),f=d.createStyle();d.useStyle(f);var g=this._defaultStyle,v=!1,y=0,m=!1,_=ml("fill"in l?l.fill:"fill"in e?e.fill:(v=!0,g.fill)),x=yl("stroke"in l?l.stroke:"stroke"in e?e.stroke:c||s||g.autoStroke&&!v?null:(y=2,m=!0,g.stroke)),b=l.textShadowBlur>0||e.textShadowBlur>0;f.text=t.text,f.x=r,f.y=h,b&&(f.shadowBlur=l.textShadowBlur||e.textShadowBlur||0,f.shadowColor=l.textShadowColor||e.textShadowColor||"transparent",f.shadowOffsetX=l.textShadowOffsetX||e.textShadowOffsetX||0,f.shadowOffsetY=l.textShadowOffsetY||e.textShadowOffsetY||0),f.textAlign=o,f.textBaseline="middle",f.font=t.font||a,f.opacity=ot(l.opacity,e.opacity,1),fl(f,l),x&&(f.lineWidth=ot(l.lineWidth,e.lineWidth,y),f.lineDash=rt(l.lineDash,e.lineDash),f.lineDashOffset=e.lineDashOffset||0,f.stroke=x),_&&(f.fill=_),d.setBoundingRect(Va(f,t.contentWidth,t.contentHeight,m?0:null))},e.prototype._renderBackground=function(t,e,n,i,r,o){var a,s,l,u=t.backgroundColor,h=t.borderWidth,c=t.borderColor,p=u&&u.image,d=u&&!p,f=t.borderRadius,g=this;if(d||t.lineHeight||h&&c){(a=this._getOrCreateChild(ol)).useStyle(a.createStyle()),a.style.fill=null;var v=a.shape;v.x=n,v.y=i,v.width=r,v.height=o,v.r=f,a.dirtyShape()}if(d)(l=a.style).fill=u||null,l.fillOpacity=rt(t.fillOpacity,1);else if(p){(s=this._getOrCreateChild(Qs)).onload=function(){g.dirtyStyle()};var y=s.style;y.image=u.image,y.x=n,y.y=i,y.width=r,y.height=o}h&&c&&((l=a.style).lineWidth=h,l.stroke=c,l.strokeOpacity=rt(t.strokeOpacity,1),l.lineDash=t.borderDash,l.lineDashOffset=t.borderDashOffset||0,a.strokeContainThreshold=0,a.hasFill()&&a.hasStroke()&&(l.strokeFirst=!0,l.lineWidth*=2));var m=(a||s).style;m.shadowBlur=t.shadowBlur||0,m.shadowColor=t.shadowColor||"transparent",m.shadowOffsetX=t.shadowOffsetX||0,m.shadowOffsetY=t.shadowOffsetY||0,m.opacity=ot(t.opacity,e.opacity,1)},e.makeFont=function(t){var e="";return gl(t)&&(e=[t.fontStyle,t.fontWeight,dl(t.fontSize),t.fontFamily||"sans-serif"].join(" ")),e&&ut(e)||t.textFont||t.font},e}(Ya),hl={left:!0,right:1,center:1},cl={top:1,bottom:1,middle:1},pl=["fontStyle","fontWeight","fontSize","fontFamily"];function dl(t){return"string"!=typeof t||-1===t.indexOf("px")&&-1===t.indexOf("rem")&&-1===t.indexOf("em")?isNaN(+t)?"12px":t+"px":t}function fl(t,e){for(var n=0;n<pl.length;n++){var i=pl[n],r=e[i];null!=r&&(t[i]=r)}}function gl(t){return null!=t.fontSize||t.fontFamily||t.fontWeight}function vl(t){if(t){t.font=ul.makeFont(t);var e=t.align;"middle"===e&&(e="center"),t.align=null==e||hl[e]?e:"left";var n=t.verticalAlign;"center"===n&&(n="middle"),t.verticalAlign=null==n||cl[n]?n:"top",t.padding&&(t.padding=st(t.padding))}}function yl(t,e){return null==t||e<=0||"transparent"===t||"none"===t?null:t.image||t.colorStops?"#000":t}function ml(t){return null==t||"none"===t?null:t.image||t.colorStops?"#000":t}function _l(t,e,n){return"right"===e?t-n[1]:"center"===e?t+n[3]/2-n[1]/2:t+n[3]}function xl(t){var e=t.text;return null!=e&&(e+=""),e}function bl(t){return!!(t.backgroundColor||t.lineHeight||t.borderWidth&&t.borderColor)}var wl=Qo(),Sl=1,Ml={},Tl=Qo(),kl=Qo(),Cl=["emphasis","blur","select"],Il=["normal","emphasis","blur","select"],Dl="highlight",Al="downplay",Pl="select",Ll="unselect",Ol="toggleSelect",Rl="selectchanged";function Nl(t){return null!=t&&"none"!==t}function Bl(t,e,n){t.onHoverStateChange&&(t.hoverState||0)!==n&&t.onHoverStateChange(e),t.hoverState=n}function zl(t){Bl(t,"emphasis",2)}function El(t){2===t.hoverState&&Bl(t,"normal",0)}function Vl(t){Bl(t,"blur",1)}function Fl(t){1===t.hoverState&&Bl(t,"normal",0)}function Hl(t){t.selected=!0}function Wl(t){t.selected=!1}function Gl(t,e,n){e(t,n)}function Ul(t,e,n){Gl(t,e,n),t.isGroup&&t.traverse((function(t){Gl(t,e,n)}))}function Zl(t,e){switch(e){case"emphasis":t.hoverState=2;break;case"normal":t.hoverState=0;break;case"blur":t.hoverState=1;break;case"select":t.selected=!0}}function Yl(t,e){var n=this.states[t];if(this.style){if("emphasis"===t)return function(t,e,n,i){var r=n&&L(n,"select")>=0,o=!1;if(t instanceof Xs){var a=Tl(t),s=r&&a.selectFill||a.normalFill,l=r&&a.selectStroke||a.normalStroke;if(Nl(s)||Nl(l)){var u=(i=i||{}).style||{};"inherit"===u.fill?(o=!0,i=D({},i),(u=D({},u)).fill=s):!Nl(u.fill)&&Nl(s)?(o=!0,i=D({},i),(u=D({},u)).fill=ci(s)):!Nl(u.stroke)&&Nl(l)&&(o||(i=D({},i),u=D({},u)),u.stroke=ci(l)),i.style=u}}if(i&&null==i.z2){o||(i=D({},i));var h=t.z2EmphasisLift;i.z2=t.z2+(null!=h?h:10)}return i}(this,0,e,n);if("blur"===t)return function(t,e,n){var i=L(t.currentStates,e)>=0,r=t.style.opacity,o=i?null:function(t,e,n,i){for(var r=t.style,o={},a=0;a<e.length;a++){var s=e[a],l=r[s];o[s]=null==l?i&&i[s]:l}for(a=0;a<t.animators.length;a++){var u=t.animators[a];u.__fromStateTransition&&u.__fromStateTransition.indexOf(n)<0&&"style"===u.targetName&&u.saveTo(o,e)}return o}(t,["opacity"],e,{opacity:1}),a=(n=n||{}).style||{};return null==a.opacity&&(n=D({},n),a=D({opacity:i?r:.1*o.opacity},a),n.style=a),n}(this,t,n);if("select"===t)return function(t,e,n){if(n&&null==n.z2){n=D({},n);var i=t.z2SelectLift;n.z2=t.z2+(null!=i?i:9)}return n}(this,0,n)}return n}function Xl(t){t.stateProxy=Yl;var e=t.getTextContent(),n=t.getTextGuideLine();e&&(e.stateProxy=Yl),n&&(n.stateProxy=Yl)}function jl(t,e){!nu(t,e)&&!t.__highByOuter&&Ul(t,zl)}function ql(t,e){!nu(t,e)&&!t.__highByOuter&&Ul(t,El)}function Kl(t,e){t.__highByOuter|=1<<(e||0),Ul(t,zl)}function $l(t,e){!(t.__highByOuter&=~(1<<(e||0)))&&Ul(t,El)}function Ql(t){Ul(t,Vl)}function Jl(t){Ul(t,Fl)}function tu(t){Ul(t,Hl)}function eu(t){Ul(t,Wl)}function nu(t,e){return t.__highDownSilentOnTouch&&e.zrByTouch}function iu(t){var e=t.getModel(),n=[],i=[];e.eachComponent((function(e,r){var o=kl(r),a="series"===e,s=a?t.getViewOfSeriesModel(r):t.getViewOfComponentModel(r);!a&&i.push(s),o.isBlured&&(s.group.traverse((function(t){Fl(t)})),a&&n.push(r)),o.isBlured=!1})),B(i,(function(t){t&&t.toggleBlurSeries&&t.toggleBlurSeries(n,!1,e)}))}function ru(t,e,n,i){var r=i.getModel();function o(t,e){for(var n=0;n<e.length;n++){var i=t.getItemGraphicEl(e[n]);i&&Jl(i)}}if(n=n||"coordinateSystem",null!=t&&e&&"none"!==e){var a=r.getSeriesByIndex(t),s=a.coordinateSystem;s&&s.master&&(s=s.master);var l=[];r.eachSeries((function(t){var r=a===t,u=t.coordinateSystem;if(u&&u.master&&(u=u.master),!("series"===n&&!r||"coordinateSystem"===n&&!(u&&s?u===s:r)||"series"===e&&r)){if(i.getViewOfSeriesModel(t).group.traverse((function(t){t.__highByOuter&&r&&"self"===e||Vl(t)})),N(e))o(t.getData(),e);else if(q(e))for(var h=H(e),c=0;c<h.length;c++)o(t.getData(h[c]),e[h[c]]);l.push(t),kl(t).isBlured=!0}})),r.eachComponent((function(t,e){if("series"!==t){var n=i.getViewOfComponentModel(e);n&&n.toggleBlurSeries&&n.toggleBlurSeries(l,!0,r)}}))}}function ou(t,e,n){if(null!=t&&null!=e){var i=n.getModel().getComponent(t,e);if(i){kl(i).isBlured=!0;var r=n.getViewOfComponentModel(i);r&&r.focusBlurEnabled&&r.group.traverse((function(t){Vl(t)}))}}}function au(t,e,n,i){var r={focusSelf:!1,dispatchers:null};if(null==t||"series"===t||null==e||null==n)return r;var o=i.getModel().getComponent(t,e);if(!o)return r;var a=i.getViewOfComponentModel(o);if(!a||!a.findHighDownDispatchers)return r;for(var s,l=a.findHighDownDispatchers(n),u=0;u<l.length;u++)if("self"===wl(l[u]).focus){s=!0;break}return{focusSelf:s,dispatchers:l}}function su(t){B(t.getAllData(),(function(e){var n=e.data,i=e.type;n.eachItemGraphicEl((function(e,n){t.isSelected(n,i)?tu(e):eu(e)}))}))}function lu(t){var e=[];return t.eachSeries((function(t){B(t.getAllData(),(function(n){n.data;var i=n.type,r=t.getSelectedDataIndices();if(r.length>0){var o={dataIndex:r,seriesIndex:t.seriesIndex};null!=i&&(o.dataType=i),e.push(o)}}))})),e}function uu(t,e,n){fu(t,!0),Ul(t,Xl),function(t,e,n){var i=wl(t);null!=e?(i.focus=e,i.blurScope=n):i.focus&&(i.focus=null)}(t,e,n)}function hu(t,e,n,i){i?function(t){fu(t,!1)}(t):uu(t,e,n)}var cu=["emphasis","blur","select"],pu={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function du(t,e,n,i){n=n||"itemStyle";for(var r=0;r<cu.length;r++){var o=cu[r],a=e.getModel([o,n]);t.ensureState(o).style=i?i(a):a[pu[n]]()}}function fu(t,e){var n=!1===e,i=t;t.highDownSilentOnTouch&&(i.__highDownSilentOnTouch=t.highDownSilentOnTouch),n&&!i.__highDownDispatcher||(i.__highByOuter=i.__highByOuter||0,i.__highDownDispatcher=!n)}function gu(t){return!(!t||!t.__highDownDispatcher)}function vu(t){var e=t.type;return e===Pl||e===Ll||e===Ol}function yu(t){var e=t.type;return e===Dl||e===Al}var mu=Cs.CMD,_u=[[],[],[]],xu=Math.sqrt,bu=Math.atan2;var wu=Math.sqrt,Su=Math.sin,Mu=Math.cos,Tu=Math.PI;function ku(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Cu(t,e){return(t[0]*e[0]+t[1]*e[1])/(ku(t)*ku(e))}function Iu(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(Cu(t,e))}function Du(t,e,n,i,r,o,a,s,l,u,h){var c=l*(Tu/180),p=Mu(c)*(t-n)/2+Su(c)*(e-i)/2,d=-1*Su(c)*(t-n)/2+Mu(c)*(e-i)/2,f=p*p/(a*a)+d*d/(s*s);f>1&&(a*=wu(f),s*=wu(f));var g=(r===o?-1:1)*wu((a*a*(s*s)-a*a*(d*d)-s*s*(p*p))/(a*a*(d*d)+s*s*(p*p)))||0,v=g*a*d/s,y=g*-s*p/a,m=(t+n)/2+Mu(c)*v-Su(c)*y,_=(e+i)/2+Su(c)*v+Mu(c)*y,x=Iu([1,0],[(p-v)/a,(d-y)/s]),b=[(p-v)/a,(d-y)/s],w=[(-1*p-v)/a,(-1*d-y)/s],S=Iu(b,w);if(Cu(b,w)<=-1&&(S=Tu),Cu(b,w)>=1&&(S=0),S<0){var M=Math.round(S/Tu*1e6)/1e6;S=2*Tu+M%2*Tu}h.addData(u,m,_,a,s,x,S,c,o)}var Au=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/gi,Pu=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;var Lu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return n(e,t),e.prototype.applyTransform=function(t){},e}(Xs);function Ou(t){return null!=t.setData}function Ru(t,e){var n=function(t){var e=new Cs;if(!t)return e;var n,i=0,r=0,o=i,a=r,s=Cs.CMD,l=t.match(Au);if(!l)return e;for(var u=0;u<l.length;u++){for(var h=l[u],c=h.charAt(0),p=void 0,d=h.match(Pu)||[],f=d.length,g=0;g<f;g++)d[g]=parseFloat(d[g]);for(var v=0;v<f;){var y=void 0,m=void 0,_=void 0,x=void 0,b=void 0,w=void 0,S=void 0,M=i,T=r,k=void 0,C=void 0;switch(c){case"l":i+=d[v++],r+=d[v++],p=s.L,e.addData(p,i,r);break;case"L":i=d[v++],r=d[v++],p=s.L,e.addData(p,i,r);break;case"m":i+=d[v++],r+=d[v++],p=s.M,e.addData(p,i,r),o=i,a=r,c="l";break;case"M":i=d[v++],r=d[v++],p=s.M,e.addData(p,i,r),o=i,a=r,c="L";break;case"h":i+=d[v++],p=s.L,e.addData(p,i,r);break;case"H":i=d[v++],p=s.L,e.addData(p,i,r);break;case"v":r+=d[v++],p=s.L,e.addData(p,i,r);break;case"V":r=d[v++],p=s.L,e.addData(p,i,r);break;case"C":p=s.C,e.addData(p,d[v++],d[v++],d[v++],d[v++],d[v++],d[v++]),i=d[v-2],r=d[v-1];break;case"c":p=s.C,e.addData(p,d[v++]+i,d[v++]+r,d[v++]+i,d[v++]+r,d[v++]+i,d[v++]+r),i+=d[v-2],r+=d[v-1];break;case"S":y=i,m=r,k=e.len(),C=e.data,n===s.C&&(y+=i-C[k-4],m+=r-C[k-3]),p=s.C,M=d[v++],T=d[v++],i=d[v++],r=d[v++],e.addData(p,y,m,M,T,i,r);break;case"s":y=i,m=r,k=e.len(),C=e.data,n===s.C&&(y+=i-C[k-4],m+=r-C[k-3]),p=s.C,M=i+d[v++],T=r+d[v++],i+=d[v++],r+=d[v++],e.addData(p,y,m,M,T,i,r);break;case"Q":M=d[v++],T=d[v++],i=d[v++],r=d[v++],p=s.Q,e.addData(p,M,T,i,r);break;case"q":M=d[v++]+i,T=d[v++]+r,i+=d[v++],r+=d[v++],p=s.Q,e.addData(p,M,T,i,r);break;case"T":y=i,m=r,k=e.len(),C=e.data,n===s.Q&&(y+=i-C[k-4],m+=r-C[k-3]),i=d[v++],r=d[v++],p=s.Q,e.addData(p,y,m,i,r);break;case"t":y=i,m=r,k=e.len(),C=e.data,n===s.Q&&(y+=i-C[k-4],m+=r-C[k-3]),i+=d[v++],r+=d[v++],p=s.Q,e.addData(p,y,m,i,r);break;case"A":_=d[v++],x=d[v++],b=d[v++],w=d[v++],S=d[v++],Du(M=i,T=r,i=d[v++],r=d[v++],w,S,_,x,b,p=s.A,e);break;case"a":_=d[v++],x=d[v++],b=d[v++],w=d[v++],S=d[v++],Du(M=i,T=r,i+=d[v++],r+=d[v++],w,S,_,x,b,p=s.A,e)}}"z"!==c&&"Z"!==c||(p=s.Z,e.addData(p),i=o,r=a),n=p}return e.toStatic(),e}(t),i=D({},e);return i.buildPath=function(t){var e,i=Ou(t);i&&t.canSave()?(t.appendPath(n),(e=t.getContext())&&t.rebuildPath(e,1)):(e=i?t.getContext():t)&&n.rebuildPath(e,1)},i.applyTransform=function(t){!function(t,e){if(e){var n,i,r,o,a,s,l=t.data,u=t.len(),h=mu.M,c=mu.C,p=mu.L,d=mu.R,f=mu.A,g=mu.Q;for(r=0,o=0;r<u;){switch(n=l[r++],o=r,i=0,n){case h:case p:i=1;break;case c:i=3;break;case g:i=2;break;case f:var v=e[4],y=e[5],m=xu(e[0]*e[0]+e[1]*e[1]),_=xu(e[2]*e[2]+e[3]*e[3]),x=bu(-e[1]/_,e[0]/m);l[r]*=m,l[r++]+=v,l[r]*=_,l[r++]+=y,l[r++]*=m,l[r++]*=_,l[r++]+=x,l[r++]+=x,o=r+=2;break;case d:s[0]=l[r++],s[1]=l[r++],Ft(s,s,e),l[o++]=s[0],l[o++]=s[1],s[0]+=l[r++],s[1]+=l[r++],Ft(s,s,e),l[o++]=s[0],l[o++]=s[1]}for(a=0;a<i;a++){var b=_u[a];b[0]=l[r++],b[1]=l[r++],Ft(b,b,e),l[o++]=b[0],l[o++]=b[1]}}t.increaseVersion()}}(n,t),this.dirtyShape()},i}var Nu=function(){this.cx=0,this.cy=0,this.r=0},Bu=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultShape=function(){return new Nu},e.prototype.buildPath=function(t,e){t.moveTo(e.cx+e.r,e.cy),t.arc(e.cx,e.cy,e.r,0,2*Math.PI)},e}(Xs);Bu.prototype.type="circle";var zu=function(){this.cx=0,this.cy=0,this.rx=0,this.ry=0},Eu=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultShape=function(){return new zu},e.prototype.buildPath=function(t,e){var n=.5522848,i=e.cx,r=e.cy,o=e.rx,a=e.ry,s=o*n,l=a*n;t.moveTo(i-o,r),t.bezierCurveTo(i-o,r-l,i-s,r-a,i,r-a),t.bezierCurveTo(i+s,r-a,i+o,r-l,i+o,r),t.bezierCurveTo(i+o,r+l,i+s,r+a,i,r+a),t.bezierCurveTo(i-s,r+a,i-o,r+l,i-o,r),t.closePath()},e}(Xs);Eu.prototype.type="ellipse";var Vu=Math.PI,Fu=2*Vu,Hu=Math.sin,Wu=Math.cos,Gu=Math.acos,Uu=Math.atan2,Zu=Math.abs,Yu=Math.sqrt,Xu=Math.max,ju=Math.min,qu=1e-4;function Ku(t,e,n,i,r,o,a){var s=t-n,l=e-i,u=(a?o:-o)/Yu(s*s+l*l),h=u*l,c=-u*s,p=t+h,d=e+c,f=n+h,g=i+c,v=(p+f)/2,y=(d+g)/2,m=f-p,_=g-d,x=m*m+_*_,b=r-o,w=p*g-f*d,S=(_<0?-1:1)*Yu(Xu(0,b*b*x-w*w)),M=(w*_-m*S)/x,T=(-w*m-_*S)/x,k=(w*_+m*S)/x,C=(-w*m+_*S)/x,I=M-v,D=T-y,A=k-v,P=C-y;return I*I+D*D>A*A+P*P&&(M=k,T=C),{cx:M,cy:T,x0:-h,y0:-c,x1:M*(r/b-1),y1:T*(r/b-1)}}function $u(t,e){var n,i=Xu(e.r,0),r=Xu(e.r0||0,0),o=i>0;if(o||r>0){if(o||(i=r,r=0),r>i){var a=i;i=r,r=a}var s=e.startAngle,l=e.endAngle;if(!isNaN(s)&&!isNaN(l)){var u=e.cx,h=e.cy,c=!!e.clockwise,p=Zu(l-s),d=p>Fu&&p%Fu;if(d>qu&&(p=d),i>qu)if(p>Fu-qu)t.moveTo(u+i*Wu(s),h+i*Hu(s)),t.arc(u,h,i,s,l,!c),r>qu&&(t.moveTo(u+r*Wu(l),h+r*Hu(l)),t.arc(u,h,r,l,s,c));else{var f=void 0,g=void 0,v=void 0,y=void 0,m=void 0,_=void 0,x=void 0,b=void 0,w=void 0,S=void 0,M=void 0,T=void 0,k=void 0,C=void 0,I=void 0,D=void 0,A=i*Wu(s),P=i*Hu(s),L=r*Wu(l),O=r*Hu(l),R=p>qu;if(R){var N=e.cornerRadius;N&&(n=function(t){var e;if(U(t)){var n=t.length;if(!n)return t;e=1===n?[t[0],t[0],0,0]:2===n?[t[0],t[0],t[1],t[1]]:3===n?t.concat(t[2]):t}else e=[t,t,t,t];return e}(N),f=n[0],g=n[1],v=n[2],y=n[3]);var B=Zu(i-r)/2;if(m=ju(B,v),_=ju(B,y),x=ju(B,f),b=ju(B,g),M=w=Xu(m,_),T=S=Xu(x,b),(w>qu||S>qu)&&(k=i*Wu(l),C=i*Hu(l),I=r*Wu(s),D=r*Hu(s),p<Vu)){var z=function(t,e,n,i,r,o,a,s){var l=n-t,u=i-e,h=a-r,c=s-o,p=c*l-h*u;if(!(p*p<qu))return[t+(p=(h*(e-o)-c*(t-r))/p)*l,e+p*u]}(A,P,I,D,k,C,L,O);if(z){var E=A-z[0],V=P-z[1],F=k-z[0],H=C-z[1],W=1/Hu(Gu((E*F+V*H)/(Yu(E*E+V*V)*Yu(F*F+H*H)))/2),G=Yu(z[0]*z[0]+z[1]*z[1]);M=ju(w,(i-G)/(W+1)),T=ju(S,(r-G)/(W-1))}}}if(R)if(M>qu){var Z=ju(v,M),Y=ju(y,M),X=Ku(I,D,A,P,i,Z,c),j=Ku(k,C,L,O,i,Y,c);t.moveTo(u+X.cx+X.x0,h+X.cy+X.y0),M<w&&Z===Y?t.arc(u+X.cx,h+X.cy,M,Uu(X.y0,X.x0),Uu(j.y0,j.x0),!c):(Z>0&&t.arc(u+X.cx,h+X.cy,Z,Uu(X.y0,X.x0),Uu(X.y1,X.x1),!c),t.arc(u,h,i,Uu(X.cy+X.y1,X.cx+X.x1),Uu(j.cy+j.y1,j.cx+j.x1),!c),Y>0&&t.arc(u+j.cx,h+j.cy,Y,Uu(j.y1,j.x1),Uu(j.y0,j.x0),!c))}else t.moveTo(u+A,h+P),t.arc(u,h,i,s,l,!c);else t.moveTo(u+A,h+P);if(r>qu&&R)if(T>qu){Z=ju(f,T),X=Ku(L,O,k,C,r,-(Y=ju(g,T)),c),j=Ku(A,P,I,D,r,-Z,c);t.lineTo(u+X.cx+X.x0,h+X.cy+X.y0),T<S&&Z===Y?t.arc(u+X.cx,h+X.cy,T,Uu(X.y0,X.x0),Uu(j.y0,j.x0),!c):(Y>0&&t.arc(u+X.cx,h+X.cy,Y,Uu(X.y0,X.x0),Uu(X.y1,X.x1),!c),t.arc(u,h,r,Uu(X.cy+X.y1,X.cx+X.x1),Uu(j.cy+j.y1,j.cx+j.x1),c),Z>0&&t.arc(u+j.cx,h+j.cy,Z,Uu(j.y1,j.x1),Uu(j.y0,j.x0),!c))}else t.lineTo(u+L,h+O),t.arc(u,h,r,l,s,c);else t.lineTo(u+L,h+O)}else t.moveTo(u,h);t.closePath()}}}var Qu=function(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0,this.cornerRadius=0},Ju=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultShape=function(){return new Qu},e.prototype.buildPath=function(t,e){$u(t,e)},e.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},e}(Xs);Ju.prototype.type="sector";var th=function(){this.cx=0,this.cy=0,this.r=0,this.r0=0},eh=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultShape=function(){return new th},e.prototype.buildPath=function(t,e){var n=e.cx,i=e.cy,r=2*Math.PI;t.moveTo(n+e.r,i),t.arc(n,i,e.r,0,r,!1),t.moveTo(n+e.r0,i),t.arc(n,i,e.r0,0,r,!0)},e}(Xs);function nh(t,e,n){var i=e.smooth,r=e.points;if(r&&r.length>=2){if(i){var o=function(t,e,n,i){var r,o,a,s,l=[],u=[],h=[],c=[];if(i){a=[1/0,1/0],s=[-1/0,-1/0];for(var p=0,d=t.length;p<d;p++)Ht(a,a,t[p]),Wt(s,s,t[p]);Ht(a,a,i[0]),Wt(s,s,i[1])}for(p=0,d=t.length;p<d;p++){var f=t[p];if(n)r=t[p?p-1:d-1],o=t[(p+1)%d];else{if(0===p||p===d-1){l.push(kt(t[p]));continue}r=t[p-1],o=t[p+1]}It(u,o,r),Ot(u,u,e);var g=Nt(f,r),v=Nt(f,o),y=g+v;0!==y&&(g/=y,v/=y),Ot(h,u,-g),Ot(c,u,v);var m=Ct([],f,h),_=Ct([],f,c);i&&(Wt(m,m,a),Ht(m,m,s),Wt(_,_,a),Ht(_,_,s)),l.push(m),l.push(_)}return n&&l.push(l.shift()),l}(r,i,n,e.smoothConstraint);t.moveTo(r[0][0],r[0][1]);for(var a=r.length,s=0;s<(n?a:a-1);s++){var l=o[2*s],u=o[2*s+1],h=r[(s+1)%a];t.bezierCurveTo(l[0],l[1],u[0],u[1],h[0],h[1])}}else{t.moveTo(r[0][0],r[0][1]);s=1;for(var c=r.length;s<c;s++)t.lineTo(r[s][0],r[s][1])}n&&t.closePath()}}eh.prototype.type="ring";var ih=function(){this.points=null,this.smooth=0,this.smoothConstraint=null},rh=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultShape=function(){return new ih},e.prototype.buildPath=function(t,e){nh(t,e,!0)},e}(Xs);rh.prototype.type="polygon";var oh=function(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null},ah=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new oh},e.prototype.buildPath=function(t,e){nh(t,e,!1)},e}(Xs);ah.prototype.type="polyline";var sh={},lh=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1},uh=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new lh},e.prototype.buildPath=function(t,e){var n,i,r,o;if(this.subPixelOptimize){var a=tl(sh,e,this.style);n=a.x1,i=a.y1,r=a.x2,o=a.y2}else n=e.x1,i=e.y1,r=e.x2,o=e.y2;var s=e.percent;0!==s&&(t.moveTo(n,i),s<1&&(r=n*(1-s)+r*s,o=i*(1-s)+o*s),t.lineTo(r,o))},e.prototype.pointAt=function(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t]},e}(Xs);uh.prototype.type="line";var hh=[],ch=function(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1};function ph(t,e,n){var i=t.cpx2,r=t.cpy2;return null!=i||null!=r?[(n?Tn:Mn)(t.x1,t.cpx1,t.cpx2,t.x2,e),(n?Tn:Mn)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(n?Pn:An)(t.x1,t.cpx1,t.x2,e),(n?Pn:An)(t.y1,t.cpy1,t.y2,e)]}var dh=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new ch},e.prototype.buildPath=function(t,e){var n=e.x1,i=e.y1,r=e.x2,o=e.y2,a=e.cpx1,s=e.cpy1,l=e.cpx2,u=e.cpy2,h=e.percent;0!==h&&(t.moveTo(n,i),null==l||null==u?(h<1&&(On(n,a,r,h,hh),a=hh[1],r=hh[2],On(i,s,o,h,hh),s=hh[1],o=hh[2]),t.quadraticCurveTo(a,s,r,o)):(h<1&&(In(n,a,l,r,h,hh),a=hh[1],l=hh[2],r=hh[3],In(i,s,u,o,h,hh),s=hh[1],u=hh[2],o=hh[3]),t.bezierCurveTo(a,s,l,u,r,o)))},e.prototype.pointAt=function(t){return ph(this.shape,t,!1)},e.prototype.tangentAt=function(t){var e=ph(this.shape,t,!0);return Rt(e,e)},e}(Xs);dh.prototype.type="bezier-curve";var fh=function(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=2*Math.PI,this.clockwise=!0},gh=function(t){function e(e){return t.call(this,e)||this}return n(e,t),e.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},e.prototype.getDefaultShape=function(){return new fh},e.prototype.buildPath=function(t,e){var n=e.cx,i=e.cy,r=Math.max(e.r,0),o=e.startAngle,a=e.endAngle,s=e.clockwise,l=Math.cos(o),u=Math.sin(o);t.moveTo(l*r+n,u*r+i),t.arc(n,i,r,o,a,!s)},e}(Xs);gh.prototype.type="arc";var vh=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.type="compound",e}return n(e,t),e.prototype._updatePathDirty=function(){for(var t=this.shape.paths,e=this.shapeChanged(),n=0;n<t.length;n++)e=e||t[n].shapeChanged();e&&this.dirtyShape()},e.prototype.beforeBrush=function(){this._updatePathDirty();for(var t=this.shape.paths||[],e=this.getGlobalScale(),n=0;n<t.length;n++)t[n].path||t[n].createPathProxy(),t[n].path.setScale(e[0],e[1],t[n].segmentIgnoreThreshold)},e.prototype.buildPath=function(t,e){for(var n=e.paths||[],i=0;i<n.length;i++)n[i].buildPath(t,n[i].shape,!0)},e.prototype.afterBrush=function(){for(var t=this.shape.paths||[],e=0;e<t.length;e++)t[e].pathUpdated()},e.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),Xs.prototype.getBoundingRect.call(this)},e}(Xs),yh=function(){function t(t){this.colorStops=t||[]}return t.prototype.addColorStop=function(t,e){this.colorStops.push({offset:t,color:e})},t}(),mh=function(t){function e(e,n,i,r,o,a){var s=t.call(this,o)||this;return s.x=null==e?0:e,s.y=null==n?0:n,s.x2=null==i?1:i,s.y2=null==r?0:r,s.type="linear",s.global=a||!1,s}return n(e,t),e}(yh),_h=function(t){function e(e,n,i,r,o){var a=t.call(this,r)||this;return a.x=null==e?.5:e,a.y=null==n?.5:n,a.r=null==i?.5:i,a.type="radial",a.global=o||!1,a}return n(e,t),e}(yh),xh=Math.min,bh=Math.max,wh=Math.abs,Sh=[0,0],Mh=[0,0],Th=Ge(),kh=Th.minTv,Ch=Th.maxTv,Ih=function(){function t(t,e){this._corners=[],this._axes=[],this._origin=[0,0];for(var n=0;n<4;n++)this._corners[n]=new Te;for(n=0;n<2;n++)this._axes[n]=new Te;t&&this.fromBoundingRect(t,e)}return t.prototype.fromBoundingRect=function(t,e){var n=this._corners,i=this._axes,r=t.x,o=t.y,a=r+t.width,s=o+t.height;if(n[0].set(r,o),n[1].set(a,o),n[2].set(a,s),n[3].set(r,s),e)for(var l=0;l<4;l++)n[l].transform(e);Te.sub(i[0],n[1],n[0]),Te.sub(i[1],n[3],n[0]),i[0].normalize(),i[1].normalize();for(l=0;l<2;l++)this._origin[l]=i[l].dot(n[0])},t.prototype.intersect=function(t,e,n){var i=!0,r=!e;return e&&Te.set(e,0,0),Th.reset(n,!r),!this._intersectCheckOneSide(this,t,r,1)&&(i=!1,r)||!this._intersectCheckOneSide(t,this,r,-1)&&(i=!1,r)||r||Th.negativeSize||Te.copy(e,i?Th.useDir?Th.dirMinTv:kh:Ch),i},t.prototype._intersectCheckOneSide=function(t,e,n,i){for(var r=!0,o=0;o<2;o++){var a=t._axes[o];if(t._getProjMinMaxOnAxis(o,t._corners,Sh),t._getProjMinMaxOnAxis(o,e._corners,Mh),Th.negativeSize||Sh[1]<Mh[0]||Sh[0]>Mh[1]){if(r=!1,Th.negativeSize||n)return r;var s=wh(Mh[0]-Sh[1]),l=wh(Sh[0]-Mh[1]);xh(s,l)>Ch.len()&&(s<l?Te.scale(Ch,a,-s*i):Te.scale(Ch,a,l*i))}else if(!n){s=wh(Mh[0]-Sh[1]),l=wh(Sh[0]-Mh[1]);(Th.useDir||xh(s,l)<kh.len())&&((s<l||!Th.bidirectional)&&(Te.scale(kh,a,s*i),Th.useDir&&Th.calcDirMTV()),(s>=l||!Th.bidirectional)&&(Te.scale(kh,a,-l*i),Th.useDir&&Th.calcDirMTV()))}}return r},t.prototype._getProjMinMaxOnAxis=function(t,e,n){for(var i=this._axes[t],r=this._origin,o=e[0].dot(i)+r[t],a=o,s=o,l=1;l<e.length;l++){var u=e[l].dot(i)+r[t];a=xh(u,a),s=bh(u,s)}n[0]=a+Th.touchThreshold,n[1]=s-Th.touchThreshold,Th.negativeSize=n[1]<n[0]},t}(),Dh=[],Ah=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.notClear=!0,e.incremental=!0,e._displayables=[],e._temporaryDisplayables=[],e._cursor=0,e}return n(e,t),e.prototype.traverse=function(t,e){t.call(e,this)},e.prototype.useStyle=function(){this.style={}},e.prototype.getCursor=function(){return this._cursor},e.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},e.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},e.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},e.prototype.addDisplayable=function(t,e){e?this._temporaryDisplayables.push(t):this._displayables.push(t),this.markRedraw()},e.prototype.addDisplayables=function(t,e){e=e||!1;for(var n=0;n<t.length;n++)this.addDisplayable(t[n],e)},e.prototype.getDisplayables=function(){return this._displayables},e.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},e.prototype.eachPendingDisplayable=function(t){for(var e=this._cursor;e<this._displayables.length;e++)t&&t(this._displayables[e]);for(e=0;e<this._temporaryDisplayables.length;e++)t&&t(this._temporaryDisplayables[e])},e.prototype.update=function(){this.updateTransform();for(var t=this._cursor;t<this._displayables.length;t++){(e=this._displayables[t]).parent=this,e.update(),e.parent=null}for(t=0;t<this._temporaryDisplayables.length;t++){var e;(e=this._temporaryDisplayables[t]).parent=this,e.update(),e.parent=null}},e.prototype.getBoundingRect=function(){if(!this._rect){for(var t=new Ve(1/0,1/0,-1/0,-1/0),e=0;e<this._displayables.length;e++){var n=this._displayables[e],i=n.getBoundingRect().clone();n.needLocalTransform()&&i.applyTransform(n.getLocalTransform(Dh)),t.union(i)}this._rect=t}return this._rect},e.prototype.contain=function(t,e){var n=this.transformCoordToLocal(t,e);if(this.getBoundingRect().contain(n[0],n[1]))for(var i=0;i<this._displayables.length;i++){if(this._displayables[i].contain(t,e))return!0}return!1},e}(Ya),Ph=Qo();function Lh(t,e,n,i,r){var o;if(e&&e.ecModel){var a=e.ecModel.getUpdatePayload();o=a&&a.animation}var s="update"===t;if(e&&e.isAnimationEnabled()){var l=void 0,u=void 0,h=void 0;return i?(l=rt(i.duration,200),u=rt(i.easing,"cubicOut"),h=0):(l=e.getShallow(s?"animationDurationUpdate":"animationDuration"),u=e.getShallow(s?"animationEasingUpdate":"animationEasing"),h=e.getShallow(s?"animationDelayUpdate":"animationDelay")),o&&(null!=o.duration&&(l=o.duration),null!=o.easing&&(u=o.easing),null!=o.delay&&(h=o.delay)),Z(h)&&(h=h(n,r)),Z(l)&&(l=l(n)),{duration:l||0,delay:h,easing:u}}return null}function Oh(t,e,n,i,r,o,a){var s,l=!1;Z(r)?(a=o,o=r,r=null):q(r)&&(o=r.cb,a=r.during,l=r.isFrom,s=r.removeOpt,r=r.dataIndex);var u="leave"===t;u||e.stopAnimation("leave");var h=Lh(t,i,r,u?s||{}:null,i&&i.getAnimationDelayParams?i.getAnimationDelayParams(e,r):null);if(h&&h.duration>0){var c={duration:h.duration,delay:h.delay||0,easing:h.easing,done:o,force:!!o||!!a,setToFinal:!u,scope:t,during:a};l?e.animateFrom(n,c):e.animateTo(n,c)}else e.stopAnimation(),!l&&e.attr(n),a&&a(1),o&&o()}function Rh(t,e,n,i,r,o){Oh("update",t,e,n,i,r,o)}function Nh(t,e,n,i,r,o){Oh("enter",t,e,n,i,r,o)}function Bh(t){if(!t.__zr)return!0;for(var e=0;e<t.animators.length;e++){if("leave"===t.animators[e].scope)return!0}return!1}function zh(t,e,n,i,r,o){Bh(t)||Oh("leave",t,e,n,i,r,o)}function Eh(t,e,n,i){t.removeTextContent(),t.removeTextGuideLine(),zh(t,{style:{opacity:0}},e,n,i)}function Vh(t,e,n){function i(){t.parent&&t.parent.remove(t)}t.isGroup?t.traverse((function(t){t.isGroup||Eh(t,e,n,i)})):Eh(t,e,n,i)}function Fh(t){Ph(t).oldStyle=t.style}var Hh={},Wh=["x","y"],Gh=["width","height"];function Uh(t){return Xs.extend(t)}var Zh=function(t,e){var i=Ru(t,e);return function(t){function e(e){var n=t.call(this,e)||this;return n.applyTransform=i.applyTransform,n.buildPath=i.buildPath,n}return n(e,t),e}(Lu)};function Yh(t,e){return Zh(t,e)}function Xh(t,e){Hh[t]=e}function jh(t){if(Hh.hasOwnProperty(t))return Hh[t]}function qh(t,e,n,i){var r=function(t,e){return new Lu(Ru(t,e))}(t,e);return n&&("center"===i&&(n=$h(n,r.getBoundingRect())),Jh(r,n)),r}function Kh(t,e,n){var i=new Qs({style:{image:t,x:e.x,y:e.y,width:e.width,height:e.height},onload:function(t){if("center"===n){var r={width:t.width,height:t.height};i.setStyle($h(e,r))}}});return i}function $h(t,e){var n,i=e.width/e.height,r=t.height*i;return n=r<=t.width?t.height:(r=t.width)/i,{x:t.x+t.width/2-r/2,y:t.y+t.height/2-n/2,width:r,height:n}}var Qh=function(t,e){for(var n=[],i=t.length,r=0;r<i;r++){var o=t[r];n.push(o.getUpdatedPathProxy(!0))}var a=new Xs(e);return a.createPathProxy(),a.buildPath=function(t){if(Ou(t)){t.appendPath(n);var e=t.getContext();e&&t.rebuildPath(e,1)}},a};function Jh(t,e){if(t.applyTransform){var n=t.getBoundingRect().calculateTransform(e);t.applyTransform(n)}}function tc(t,e){return tl(t,t,{lineWidth:e}),t}var ec=nl;function nc(t,e){for(var n=ye([]);t&&t!==e;)_e(n,t.getLocalTransform(),n),t=t.parent;return n}function ic(t,e,n){return e&&!N(e)&&(e=wr.getLocalTransform(e)),n&&(e=Se([],e)),Ft([],t,e)}function rc(t,e,n){var i=0===e[4]||0===e[5]||0===e[0]?1:so(2*e[4]/e[0]),r=0===e[4]||0===e[5]||0===e[2]?1:so(2*e[4]/e[2]),o=["left"===t?-i:"right"===t?i:0,"top"===t?-r:"bottom"===t?r:0];return o=ic(o,e,n),so(o[0])>so(o[1])?o[0]>0?"right":"left":o[1]>0?"bottom":"top"}function oc(t){return!t.isGroup}function ac(t,e,n){if(t&&e){var i,r=(i={},t.traverse((function(t){oc(t)&&t.anid&&(i[t.anid]=t)})),i);e.traverse((function(t){if(oc(t)&&t.anid){var e=r[t.anid];if(e){var i=o(t);t.attr(o(e)),Rh(t,i,n,wl(t).dataIndex)}}}))}function o(t){var e={x:t.x,y:t.y,rotation:t.rotation};return function(t){return null!=t.shape}(t)&&(e.shape=k(t.shape)),e}}function sc(t,e){return z(t,(function(t){var n=t[0];n=ao(n,e.x),n=oo(n,e.x+e.width);var i=t[1];return i=ao(i,e.y),[n,i=oo(i,e.y+e.height)]}))}function lc(t,e){var n=ao(t.x,e.x),i=oo(t.x+t.width,e.x+e.width),r=ao(t.y,e.y),o=oo(t.y+t.height,e.y+e.height);if(i>=n&&o>=r)return{x:n,y:r,width:i-n,height:o-r}}function uc(t,e,n){var i=D({rectHover:!0},e),r=i.style={strokeNoScale:!0};if(n=n||{x:-1,y:-1,width:2,height:2},t)return 0===t.indexOf("image://")?(r.image=t.slice(8),A(r,n),new Qs(i)):qh(t.replace("path://",""),i,n,"center")}function hc(t,e,n,i,r,o,a,s){var l,u=n-t,h=i-e,c=a-r,p=s-o,d=cc(c,p,u,h);if((l=d)<=1e-6&&l>=-1e-6)return!1;var f=t-r,g=e-o,v=cc(f,g,u,h)/d;if(v<0||v>1)return!1;var y=cc(f,g,c,p)/d;return!(y<0||y>1)}function cc(t,e,n,i){return t*i-n*e}function pc(t,e,n,i,r){return null==e||(j(e)?dc[0]=dc[1]=dc[2]=dc[3]=e:(dc[0]=e[0],dc[1]=e[1],dc[2]=e[2],dc[3]=e[3]),i&&(dc[0]=ao(0,dc[0]),dc[1]=ao(0,dc[1]),dc[2]=ao(0,dc[2]),dc[3]=ao(0,dc[3])),n&&(dc[0]=-dc[0],dc[1]=-dc[1],dc[2]=-dc[2],dc[3]=-dc[3]),fc(t,dc,"x","width",3,1,r&&r[0]||0),fc(t,dc,"y","height",0,2,r&&r[1]||0)),t}var dc=[0,0,0,0];function fc(t,e,n,i,r,o,a){var s=e[o]+e[r],l=t[i];t[i]+=s,a=ao(0,oo(a,l)),t[i]<a?(t[i]=a,t[n]+=e[r]>=0?-e[r]:e[o]>=0?l+e[o]:so(s)>1e-8?(l-a)*e[r]/s:0):t[n]-=e[r]}function gc(t){var e=t.itemTooltipOption,n=t.componentModel,i=t.itemName,r=Y(e)?{formatter:e}:e,o=n.mainType,a=n.componentIndex,s={componentType:o,name:i,$vars:["name"]};s[o+"Index"]=a;var l=t.formatterParamsExtra;l&&B(H(l),(function(t){xt(s,t)||(s[t]=l[t],s.$vars.push(t))}));var u=wl(t.el);u.componentMainType=o,u.componentIndex=a,u.tooltipConfig={name:i,option:A({content:i,encodeHTMLContent:!0,formatterParams:s},r)}}function vc(t,e){var n;t.isGroup&&(n=e(t)),n||t.traverse(e)}function yc(t,e){if(t)if(U(t))for(var n=0;n<t.length;n++)vc(t[n],e);else vc(t,e)}function mc(t){return!t||so(t[1])<_c&&so(t[2])<_c||so(t[0])<_c&&so(t[3])<_c}var _c=1e-5;function xc(t,e){return t?Ve.copy(t,e):e.clone()}function bc(t,e){return e?me(t||[1,0,0,1,0,0],e):void 0}function wc(t){return{z:t.get("z")||0,zlevel:t.get("zlevel")||0}}function Sc(t,e,n){Mc(t,e,n,-1/0)}function Mc(t,e,n,i){if(t.ignoreModelZ)return i;var r=t.getTextContent(),o=t.getTextGuideLine();if(t.isGroup)for(var a=t.childrenRef(),s=0;s<a.length;s++)i=ao(Mc(a[s],e,n,i),i);else t.z=e,t.zlevel=n,i=ao(t.z2||0,i);if(r&&(r.z=e,r.zlevel=n,isFinite(i)&&(r.z2=i+2)),o){var l=t.textGuideLineConfig;o.z=e,o.zlevel=n,isFinite(i)&&(o.z2=i+(l&&l.showAbove?1:-1))}return i}Xh("circle",Bu),Xh("ellipse",Eu),Xh("sector",Ju),Xh("ring",eh),Xh("polygon",rh),Xh("polyline",ah),Xh("rect",ol),Xh("line",uh),Xh("bezierCurve",dh),Xh("arc",gh);var Tc=Object.freeze({__proto__:null,updateProps:Rh,initProps:Nh,removeElement:zh,removeElementWithFadeOut:Vh,isElementRemoved:Bh,XY:Wh,WH:Gh,extendShape:Uh,extendPath:Yh,registerShape:Xh,getShapeClass:jh,makePath:qh,makeImage:Kh,mergePath:Qh,resizePath:Jh,subPixelOptimizeLine:tc,subPixelOptimizeRect:function(t,e){return el(t,t,e),t},subPixelOptimize:ec,getTransform:nc,applyTransform:ic,transformDirection:rc,groupTransition:ac,clipPointsByRect:sc,clipRectByRect:lc,createIcon:uc,linePolygonIntersect:function(t,e,n,i,r){for(var o=0,a=r[r.length-1];o<r.length;o++){var s=r[o];if(hc(t,e,n,i,s[0],s[1],a[0],a[1]))return!0;a=s}},lineLineIntersect:hc,expandOrShrinkRect:pc,setTooltipConfig:gc,traverseElements:yc,isBoundingRectAxisAligned:mc,ensureCopyRect:xc,ensureCopyTransform:bc,retrieveZInfo:wc,calcZ2Range:function(t){var e=-1/0,n=1/0;function i(t){if(t&&!t.isGroup){var e=t.currentStates;if(e.length)for(var n=0;n<e.length;n++)r(t.states[e[n]]);r(t)}}function r(t){if(t){var i=t.z2;i>e&&(e=i),i<n&&(n=i)}}return vc(t,(function(t){i(t),i(t.getTextContent()),i(t.getTextGuideLine())})),n>e&&(n=e=0),{min:n,max:e}},traverseUpdateZ:Sc,Group:jr,Image:Qs,Text:ul,Circle:Bu,Ellipse:Eu,Sector:Ju,Ring:eh,Polygon:rh,Polyline:ah,Rect:ol,Line:uh,BezierCurve:dh,Arc:gh,IncrementalDisplayable:Ah,CompoundPath:vh,LinearGradient:mh,RadialGradient:_h,BoundingRect:Ve,OrientedBoundingRect:Ih,Point:Te,Path:Xs}),kc={};function Cc(t,e,n){var i,r=t.labelFetcher,o=t.labelDataIndex,a=t.labelDimIndex,s=e.normal;r&&(i=r.getFormattedLabel(o,"normal",null,a,s&&s.get("formatter"),null!=n?{interpolatedValue:n}:null)),null==i&&(i=Z(t.defaultText)?t.defaultText(o,t,n):t.defaultText);for(var l={normal:i},u=0;u<Cl.length;u++){var h=Cl[u],c=e[h];l[h]=rt(r?r.getFormattedLabel(o,h,null,a,c&&c.get("formatter")):null,i)}return l}function Ic(t,e,n,i){n=n||kc;for(var r=t instanceof ul,o=!1,a=0;a<Il.length;a++){if((p=e[Il[a]])&&p.getShallow("show")){o=!0;break}}var s=r?t:t.getTextContent();if(o){r||(s||(s=new ul,t.setTextContent(s)),t.stateProxy&&(s.stateProxy=t.stateProxy));var l=Cc(n,e),u=e.normal,h=!!u.getShallow("show"),c=Ac(u,i&&i.normal,n,!1,!r);c.text=l.normal,r||t.setTextConfig(Pc(u,n,!1));for(a=0;a<Cl.length;a++){var p,d=Cl[a];if(p=e[d]){var f=s.ensureState(d),g=!!rt(p.getShallow("show"),h);if(g!==h&&(f.ignore=!g),f.style=Ac(p,i&&i[d],n,!0,!r),f.style.text=l[d],!r)t.ensureState(d).textConfig=Pc(p,n,!0)}}s.silent=!!u.getShallow("silent"),null!=s.style.x&&(c.x=s.style.x),null!=s.style.y&&(c.y=s.style.y),s.ignore=!h,s.useStyle(c),s.dirty(),n.enableTextSetter&&(zc(s).setLabelText=function(t){var i=Cc(n,e,t);!function(t,e){for(var n=0;n<Cl.length;n++){var i=Cl[n],r=e[i],o=t.ensureState(i);o.style=o.style||{},o.style.text=r}var a=t.currentStates.slice();t.clearStates(!0),t.setStyle({text:e.normal}),t.useStates(a,!0)}(s,i)})}else s&&(s.ignore=!0);t.dirty()}function Dc(t,e){e=e||"label";for(var n={normal:t.getModel(e)},i=0;i<Cl.length;i++){var r=Cl[i];n[r]=t.getModel([r,e])}return n}function Ac(t,e,n,i,r){var o={};return function(t,e,n,i,r){n=n||kc;var o,a=e.ecModel,s=a&&a.option.textStyle,l=function(t){var e;for(;t&&t!==t.ecModel;){var n=(t.option||kc).rich;if(n){e=e||{};for(var i=H(n),r=0;r<i.length;r++){e[i[r]]=1}}t=t.parentModel}return e}(e);if(l){o={};var u="richInheritPlainLabel",h=rt(e.get(u),a?a.get(u):void 0);for(var c in l)if(l.hasOwnProperty(c)){var p=e.getModel(["rich",c]);Nc(o[c]={},p,s,e,h,n,i,r,!1,!0)}}o&&(t.rich=o);var d=e.get("overflow");d&&(t.overflow=d);var f=e.get("lineOverflow");f&&(t.lineOverflow=f);var g=t,v=e.get("minMargin");if(null!=v)v=j(v)?v/2:0,g.margin=[v,v,v,v],g.__marginType=Fc.minMargin;else{var y=e.get("textMargin");null!=y&&(g.margin=st(y),g.__marginType=Fc.textMargin)}Nc(t,e,s,null,null,n,i,r,!0,!1)}(o,t,n,i,r),e&&D(o,e),o}function Pc(t,e,n){e=e||{};var i,r={},o=t.getShallow("rotate"),a=rt(t.getShallow("distance"),n?null:5),s=t.getShallow("offset");return"outside"===(i=t.getShallow("position")||(n?null:"inside"))&&(i=e.defaultOutsidePosition||"top"),null!=i&&(r.position=i),null!=s&&(r.offset=s),null!=o&&(o*=Math.PI/180,r.rotation=o),null!=a&&(r.distance=a),r.outsideFill="inherit"===t.get("color")?e.inheritColor||null:"auto",null!=e.autoOverflowArea&&(r.autoOverflowArea=e.autoOverflowArea),null!=e.layoutRect&&(r.layoutRect=e.layoutRect),r}var Lc=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],Oc=["align","lineHeight","width","height","tag","verticalAlign","ellipsis"],Rc=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function Nc(t,e,n,i,r,o,a,s,l,u){n=!a&&n||kc;var h=o&&o.inheritColor,c=e.getShallow("color"),p=e.getShallow("textBorderColor"),d=rt(e.getShallow("opacity"),n.opacity);"inherit"!==c&&"auto"!==c||(c=h||null),"inherit"!==p&&"auto"!==p||(p=h||null),s||(c=c||n.color,p=p||n.textBorderColor),null!=c&&(t.fill=c),null!=p&&(t.stroke=p);var f=rt(e.getShallow("textBorderWidth"),n.textBorderWidth);null!=f&&(t.lineWidth=f);var g=rt(e.getShallow("textBorderType"),n.textBorderType);null!=g&&(t.lineDash=g);var v=rt(e.getShallow("textBorderDashOffset"),n.textBorderDashOffset);null!=v&&(t.lineDashOffset=v),a||null!=d||u||(d=o&&o.defaultOpacity),null!=d&&(t.opacity=d),a||s||null==t.fill&&o.inheritColor&&(t.fill=o.inheritColor);for(var y=0;y<Lc.length;y++){var m=Lc[y];null!=(x=!1!==r&&i?ot(e.getShallow(m),i.getShallow(m),n[m]):rt(e.getShallow(m),n[m]))&&(t[m]=x)}for(y=0;y<Oc.length;y++){m=Oc[y];null!=(x=e.getShallow(m))&&(t[m]=x)}if(null==t.verticalAlign){var _=e.getShallow("baseline");null!=_&&(t.verticalAlign=_)}if(!l||!o.disableBox){for(y=0;y<Rc.length;y++){var x;m=Rc[y];null!=(x=e.getShallow(m))&&(t[m]=x)}var b=e.getShallow("borderType");null!=b&&(t.borderDash=b),"auto"!==t.backgroundColor&&"inherit"!==t.backgroundColor||!h||(t.backgroundColor=h),"auto"!==t.borderColor&&"inherit"!==t.borderColor||!h||(t.borderColor=h)}}function Bc(t,e){var n=e&&e.getModel("textStyle");return ut([t.fontStyle||n&&n.getShallow("fontStyle")||"",t.fontWeight||n&&n.getShallow("fontWeight")||"",(t.fontSize||n&&n.getShallow("fontSize")||12)+"px",t.fontFamily||n&&n.getShallow("fontFamily")||"sans-serif"].join(" "))}var zc=Qo();var Ec,Vc,Fc={minMargin:1,textMargin:2},Hc=["textStyle","color"],Wc=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],Gc=new ul,Uc=function(){function t(){}return t.prototype.getTextColor=function(t){var e=this.ecModel;return this.getShallow("color")||(!t&&e?e.get(Hc):null)},t.prototype.getFont=function(){return Bc({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},t.prototype.getTextRect=function(t){for(var e={text:t,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},n=0;n<Wc.length;n++)e[Wc[n]]=this.getShallow(Wc[n]);return Gc.useStyle(e),Gc.update(),Gc.getBoundingRect()},t}(),Zc=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],Yc=ga(Zc),Xc=function(){function t(){}return t.prototype.getLineStyle=function(t){return Yc(this,t)},t}(),jc=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],qc=ga(jc),Kc=function(){function t(){}return t.prototype.getItemStyle=function(t,e){return qc(this,t,e)},t}(),$c=function(){function t(t,e,n){this.parentModel=e,this.ecModel=n,this.option=t}return t.prototype.init=function(t,e,n){for(var i=[],r=3;r<arguments.length;r++)i[r-3]=arguments[r]},t.prototype.mergeOption=function(t,e){C(this.option,t,!0)},t.prototype.get=function(t,e){return null==t?this.option:this._doGet(this.parsePath(t),!e&&this.parentModel)},t.prototype.getShallow=function(t,e){var n=this.option,i=null==n?n:n[t];if(null==i&&!e){var r=this.parentModel;r&&(i=r.getShallow(t))}return i},t.prototype.getModel=function(e,n){var i=null!=e,r=i?this.parsePath(e):null;return new t(i?this._doGet(r):this.option,n=n||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(r)),this.ecModel)},t.prototype.isEmpty=function(){return null==this.option},t.prototype.restoreData=function(){},t.prototype.clone=function(){return new(0,this.constructor)(k(this.option))},t.prototype.parsePath=function(t){return"string"==typeof t?t.split("."):t},t.prototype.resolveParentPath=function(t){return t},t.prototype.isAnimationEnabled=function(){if(!r.node&&this.option){if(null!=this.option.animation)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},t.prototype._doGet=function(t,e){var n=this.option;if(!t)return n;for(var i=0;i<t.length&&(!t[i]||null!=(n=n&&"object"==typeof n?n[t[i]]:null));i++);return null==n&&e&&(n=e._doGet(this.resolveParentPath(t),e.parentModel)),n},t}();ua($c),Ec=$c,Vc=["__\0is_clz",ca++].join("_"),Ec.prototype[Vc]=!0,Ec.isInstance=function(t){return!(!t||!t[Vc])},R($c,Xc),R($c,Kc),R($c,ya),R($c,Uc);var Qc=Math.round(10*Math.random());function Jc(t){return[t||"",Qc++].join("_")}function tp(t,e){return C(C({},t,!0),e,!0)}var ep="ZH",np="EN",ip=np,rp={},op={},ap=r.domSupported&&(document.documentElement.lang||navigator.language||navigator.browserLanguage||ip).toUpperCase().indexOf(ep)>-1?ep:ip;function sp(t,e){t=t.toUpperCase(),op[t]=new $c(e),rp[t]=e}sp(np,{time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst",custom:"Custom chart",chart:"Chart"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}}),sp(ep,{time:{month:["涓€鏈?,"浜屾湀","涓夋湀","鍥涙湀","浜旀湀","鍏湀","涓冩湀","鍏湀","涔濇湀","鍗佹湀","鍗佷竴鏈?,"鍗佷簩鏈?],monthAbbr:["1鏈?,"2鏈?,"3鏈?,"4鏈?,"5鏈?,"6鏈?,"7鏈?,"8鏈?,"9鏈?,"10鏈?,"11鏈?,"12鏈?],dayOfWeek:["鏄熸湡鏃?,"鏄熸湡涓€","鏄熸湡浜?,"鏄熸湡涓?,"鏄熸湡鍥?,"鏄熸湡浜?,"鏄熸湡鍏?],dayOfWeekAbbr:["鏃?,"涓€","浜?,"涓?,"鍥?,"浜?,"鍏?]},legend:{selector:{all:"鍏ㄩ€?,inverse:"鍙嶉€?}},toolbox:{bruFINDSTR: 写入错误